exports.id=95,exports.ids=[95],exports.modules={456:(a,b,c)=>{a.exports.buildBn128=c(3049),a.exports.buildBls12381=c(3125),c(8614)},1357:(a,b,c)=>{let d=c(7032),e=c(5780),f=c(3140);a.exports=function(a,b,c,g){let h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW,aX,aY,aZ,a$,a_,a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG;if(a.modules[c])return c;let bH=8*a.modules[g].n64,bI=a.modules[g].q;return a.modules[c]={n64:2*a.modules[g].n64},(h=a.addFunction(c+"_isZero")).addParam("x","i32"),h.setReturnType("i32"),j=(i=h.getCodeBuilder()).getLocal("x"),k=i.i32_add(i.getLocal("x"),i.i32_const(bH)),h.addCode(i.i32_and(i.call(g+"_isZero",j),i.call(g+"_isZero",k))),(l=a.addFunction(c+"_isOne")).addParam("x","i32"),l.setReturnType("i32"),n=(m=l.getCodeBuilder()).getLocal("x"),o=m.i32_add(m.getLocal("x"),m.i32_const(bH)),l.addCode(m.ret(m.i32_and(m.call(g+"_isOne",n),m.call(g+"_isZero",o)))),(p=a.addFunction(c+"_zero")).addParam("x","i32"),r=(q=p.getCodeBuilder()).getLocal("x"),s=q.i32_add(q.getLocal("x"),q.i32_const(bH)),p.addCode(q.call(g+"_zero",r),q.call(g+"_zero",s)),(t=a.addFunction(c+"_one")).addParam("x","i32"),v=(u=t.getCodeBuilder()).getLocal("x"),w=u.i32_add(u.getLocal("x"),u.i32_const(bH)),t.addCode(u.call(g+"_one",v),u.call(g+"_zero",w)),(x=a.addFunction(c+"_copy")).addParam("x","i32"),x.addParam("r","i32"),z=(y=x.getCodeBuilder()).getLocal("x"),A=y.i32_add(y.getLocal("x"),y.i32_const(bH)),B=y.getLocal("r"),C=y.i32_add(y.getLocal("r"),y.i32_const(bH)),x.addCode(y.call(g+"_copy",z,B),y.call(g+"_copy",A,C)),(D=a.addFunction(c+"_mul")).addParam("x","i32"),D.addParam("y","i32"),D.addParam("r","i32"),F=(E=D.getCodeBuilder()).getLocal("x"),G=E.i32_add(E.getLocal("x"),E.i32_const(bH)),H=E.getLocal("y"),I=E.i32_add(E.getLocal("y"),E.i32_const(bH)),J=E.getLocal("r"),K=E.i32_add(E.getLocal("r"),E.i32_const(bH)),L=E.i32_const(a.alloc(bH)),M=E.i32_const(a.alloc(bH)),N=E.i32_const(a.alloc(bH)),O=E.i32_const(a.alloc(bH)),D.addCode(E.call(g+"_mul",F,H,L),E.call(g+"_mul",G,I,M),E.call(g+"_add",F,G,N),E.call(g+"_add",H,I,O),E.call(g+"_mul",N,O,N),E.call(b,M,J),E.call(g+"_add",L,J,J),E.call(g+"_add",L,M,K),E.call(g+"_sub",N,K,K)),(P=a.addFunction(c+"_mul1")).addParam("x","i32"),P.addParam("y","i32"),P.addParam("r","i32"),R=(Q=P.getCodeBuilder()).getLocal("x"),S=Q.i32_add(Q.getLocal("x"),Q.i32_const(bH)),T=Q.getLocal("y"),U=Q.getLocal("r"),V=Q.i32_add(Q.getLocal("r"),Q.i32_const(bH)),P.addCode(Q.call(g+"_mul",R,T,U),Q.call(g+"_mul",S,T,V)),(W=a.addFunction(c+"_square")).addParam("x","i32"),W.addParam("r","i32"),Y=(X=W.getCodeBuilder()).getLocal("x"),Z=X.i32_add(X.getLocal("x"),X.i32_const(bH)),$=X.getLocal("r"),_=X.i32_add(X.getLocal("r"),X.i32_const(bH)),aa=X.i32_const(a.alloc(bH)),ab=X.i32_const(a.alloc(bH)),ac=X.i32_const(a.alloc(bH)),ad=X.i32_const(a.alloc(bH)),W.addCode(X.call(g+"_mul",Y,Z,aa),X.call(g+"_add",Y,Z,ab),X.call(b,Z,ac),X.call(g+"_add",Y,ac,ac),X.call(b,aa,ad),X.call(g+"_add",ad,aa,ad),X.call(g+"_mul",ab,ac,$),X.call(g+"_sub",$,ad,$),X.call(g+"_add",aa,aa,_)),(ae=a.addFunction(c+"_add")).addParam("x","i32"),ae.addParam("y","i32"),ae.addParam("r","i32"),ag=(af=ae.getCodeBuilder()).getLocal("x"),ah=af.i32_add(af.getLocal("x"),af.i32_const(bH)),ai=af.getLocal("y"),aj=af.i32_add(af.getLocal("y"),af.i32_const(bH)),ak=af.getLocal("r"),al=af.i32_add(af.getLocal("r"),af.i32_const(bH)),ae.addCode(af.call(g+"_add",ag,ai,ak),af.call(g+"_add",ah,aj,al)),(am=a.addFunction(c+"_sub")).addParam("x","i32"),am.addParam("y","i32"),am.addParam("r","i32"),ao=(an=am.getCodeBuilder()).getLocal("x"),ap=an.i32_add(an.getLocal("x"),an.i32_const(bH)),aq=an.getLocal("y"),ar=an.i32_add(an.getLocal("y"),an.i32_const(bH)),as=an.getLocal("r"),at=an.i32_add(an.getLocal("r"),an.i32_const(bH)),am.addCode(an.call(g+"_sub",ao,aq,as),an.call(g+"_sub",ap,ar,at)),(au=a.addFunction(c+"_neg")).addParam("x","i32"),au.addParam("r","i32"),aw=(av=au.getCodeBuilder()).getLocal("x"),ax=av.i32_add(av.getLocal("x"),av.i32_const(bH)),ay=av.getLocal("r"),az=av.i32_add(av.getLocal("r"),av.i32_const(bH)),au.addCode(av.call(g+"_neg",aw,ay),av.call(g+"_neg",ax,az)),(aA=a.addFunction(c+"_conjugate")).addParam("x","i32"),aA.addParam("r","i32"),aC=(aB=aA.getCodeBuilder()).getLocal("x"),aD=aB.i32_add(aB.getLocal("x"),aB.i32_const(bH)),aE=aB.getLocal("r"),aF=aB.i32_add(aB.getLocal("r"),aB.i32_const(bH)),aA.addCode(aB.call(g+"_copy",aC,aE),aB.call(g+"_neg",aD,aF)),(aG=a.addFunction(c+"_toMontgomery")).addParam("x","i32"),aG.addParam("r","i32"),aI=(aH=aG.getCodeBuilder()).getLocal("x"),aJ=aH.i32_add(aH.getLocal("x"),aH.i32_const(bH)),aK=aH.getLocal("r"),aL=aH.i32_add(aH.getLocal("r"),aH.i32_const(bH)),aG.addCode(aH.call(g+"_toMontgomery",aI,aK),aH.call(g+"_toMontgomery",aJ,aL)),(aM=a.addFunction(c+"_fromMontgomery")).addParam("x","i32"),aM.addParam("r","i32"),aO=(aN=aM.getCodeBuilder()).getLocal("x"),aP=aN.i32_add(aN.getLocal("x"),aN.i32_const(bH)),aQ=aN.getLocal("r"),aR=aN.i32_add(aN.getLocal("r"),aN.i32_const(bH)),aM.addCode(aN.call(g+"_fromMontgomery",aO,aQ),aN.call(g+"_fromMontgomery",aP,aR)),(aS=a.addFunction(c+"_eq")).addParam("x","i32"),aS.addParam("y","i32"),aS.setReturnType("i32"),aU=(aT=aS.getCodeBuilder()).getLocal("x"),aV=aT.i32_add(aT.getLocal("x"),aT.i32_const(bH)),aW=aT.getLocal("y"),aX=aT.i32_add(aT.getLocal("y"),aT.i32_const(bH)),aS.addCode(aT.i32_and(aT.call(g+"_eq",aU,aW),aT.call(g+"_eq",aV,aX))),(aY=a.addFunction(c+"_inverse")).addParam("x","i32"),aY.addParam("r","i32"),a$=(aZ=aY.getCodeBuilder()).getLocal("x"),a_=aZ.i32_add(aZ.getLocal("x"),aZ.i32_const(bH)),a0=aZ.getLocal("r"),a1=aZ.i32_add(aZ.getLocal("r"),aZ.i32_const(bH)),a2=aZ.i32_const(a.alloc(bH)),a3=aZ.i32_const(a.alloc(bH)),a4=aZ.i32_const(a.alloc(bH)),a5=aZ.i32_const(a.alloc(bH)),aY.addCode(aZ.call(g+"_square",a$,a2),aZ.call(g+"_square",a_,a3),aZ.call(b,a3,a4),aZ.call(g+"_sub",a2,a4,a4),aZ.call(g+"_inverse",a4,a5),aZ.call(g+"_mul",a$,a5,a0),aZ.call(g+"_mul",a_,a5,a1),aZ.call(g+"_neg",a1,a1)),(a6=a.addFunction(c+"_timesScalar")).addParam("x","i32"),a6.addParam("scalar","i32"),a6.addParam("scalarLen","i32"),a6.addParam("r","i32"),a8=(a7=a6.getCodeBuilder()).getLocal("x"),a9=a7.i32_add(a7.getLocal("x"),a7.i32_const(bH)),ba=a7.getLocal("r"),bb=a7.i32_add(a7.getLocal("r"),a7.i32_const(bH)),a6.addCode(a7.call(g+"_timesScalar",a8,a7.getLocal("scalar"),a7.getLocal("scalarLen"),ba),a7.call(g+"_timesScalar",a9,a7.getLocal("scalar"),a7.getLocal("scalarLen"),bb)),(bc=a.addFunction(c+"_sign")).addParam("x","i32"),bc.addLocal("s","i32"),bc.setReturnType("i32"),be=(bd=bc.getCodeBuilder()).getLocal("x"),bf=bd.i32_add(bd.getLocal("x"),bd.i32_const(bH)),bc.addCode(bd.setLocal("s",bd.call(g+"_sign",bf)),bd.if(bd.getLocal("s"),bd.ret(bd.getLocal("s"))),bd.ret(bd.call(g+"_sign",be))),(bg=a.addFunction(c+"_isNegative")).addParam("x","i32"),bg.setReturnType("i32"),bi=(bh=bg.getCodeBuilder()).getLocal("x"),bj=bh.i32_add(bh.getLocal("x"),bh.i32_const(bH)),bg.addCode(bh.if(bh.call(g+"_isZero",bj),bh.ret(bh.call(g+"_isNegative",bi))),bh.ret(bh.call(g+"_isNegative",bj))),a.exportFunction(c+"_isZero"),a.exportFunction(c+"_isOne"),a.exportFunction(c+"_zero"),a.exportFunction(c+"_one"),a.exportFunction(c+"_copy"),a.exportFunction(c+"_mul"),a.exportFunction(c+"_mul1"),a.exportFunction(c+"_square"),a.exportFunction(c+"_add"),a.exportFunction(c+"_sub"),a.exportFunction(c+"_neg"),a.exportFunction(c+"_sign"),a.exportFunction(c+"_conjugate"),a.exportFunction(c+"_fromMontgomery"),a.exportFunction(c+"_toMontgomery"),a.exportFunction(c+"_eq"),a.exportFunction(c+"_inverse"),e(a,c),d(a,c+"_exp",2*bH,c+"_mul",c+"_square",c+"_copy",c+"_one"),(bk=a.addFunction(c+"_sqrt")).addParam("a","i32"),bk.addParam("pr","i32"),bm=(bl=bk.getCodeBuilder()).i32_const(a.alloc(f.bigInt2BytesLE((BigInt(bI||0)-3n)/4n,bH))),bn=bl.i32_const(a.alloc(f.bigInt2BytesLE((BigInt(bI||0)-1n)/2n,bH))),bo=bl.getLocal("a"),bp=bl.i32_const(a.alloc(2*bH)),bq=bl.i32_const(a.alloc(2*bH)),br=bl.i32_const(a.alloc(2*bH)),bs=a.alloc(2*bH),bt=bl.i32_const(bs),bu=bl.i32_const(bs),bv=bl.i32_const(bs+bH),bw=bl.i32_const(a.alloc(2*bH)),bx=bl.i32_const(a.alloc(2*bH)),bk.addCode(bl.call(c+"_one",bt),bl.call(c+"_neg",bt,bt),bl.call(c+"_exp",bo,bm,bl.i32_const(bH),bp),bl.call(c+"_square",bp,bq),bl.call(c+"_mul",bo,bq,bq),bl.call(c+"_conjugate",bq,br),bl.call(c+"_mul",br,bq,br),bl.if(bl.call(c+"_eq",br,bt),bl.unreachable()),bl.call(c+"_mul",bp,bo,bw),bl.if(bl.call(c+"_eq",bq,bt),[...bl.call(g+"_zero",bu),...bl.call(g+"_one",bv),...bl.call(c+"_mul",bt,bw,bl.getLocal("pr"))],[...bl.call(c+"_one",bx),...bl.call(c+"_add",bx,bq,bx),...bl.call(c+"_exp",bx,bn,bl.i32_const(bH),bx),...bl.call(c+"_mul",bx,bw,bl.getLocal("pr"))])),(by=a.addFunction(c+"_isSquare")).addParam("a","i32"),by.setReturnType("i32"),bA=(bz=by.getCodeBuilder()).i32_const(a.alloc(f.bigInt2BytesLE((BigInt(bI||0)-3n)/4n,bH))),bB=bz.getLocal("a"),bC=bz.i32_const(a.alloc(2*bH)),bD=bz.i32_const(a.alloc(2*bH)),bE=bz.i32_const(a.alloc(2*bH)),bF=a.alloc(2*bH),bG=bz.i32_const(bF),by.addCode(bz.call(c+"_one",bG),bz.call(c+"_neg",bG,bG),bz.call(c+"_exp",bB,bA,bz.i32_const(bH),bC),bz.call(c+"_square",bC,bD),bz.call(c+"_mul",bB,bD,bD),bz.call(c+"_conjugate",bD,bE),bz.call(c+"_mul",bE,bD,bE),bz.if(bz.call(c+"_eq",bE,bG),bz.ret(bz.i32_const(0))),bz.ret(bz.i32_const(1))),a.exportFunction(c+"_exp"),a.exportFunction(c+"_timesScalar"),a.exportFunction(c+"_batchInverse"),a.exportFunction(c+"_sqrt"),a.exportFunction(c+"_isSquare"),a.exportFunction(c+"_isNegative"),c}},1572:(a,b,c)=>{let d=c(1932),e=c(371),f=c(3566),g=Symbol.for("worker"),h=Symbol.for("events");class i{constructor(){Object.defineProperty(this,h,{value:new Map})}dispatchEvent(a){if(a.target=a.currentTarget=this,this["on"+a.type])try{this["on"+a.type](a)}catch(a){console.error(a)}let b=this[h].get(a.type);null!=b&&b.forEach(b=>{try{b.call(this,a)}catch(a){console.error(a)}})}addEventListener(a,b){let c=this[h].get(a);c||this[h].set(a,c=[]),c.push(b)}removeEventListener(a,b){let c=this[h].get(a);if(c){let a=c.indexOf(b);-1!==a&&c.splice(a,1)}}}function j(a,b){this.type=a,this.timeStamp=Date.now(),this.target=this.currentTarget=this.data=null}a.exports=f.isMainThread?function(){class a extends i{constructor(a,b){let c;super();const{name:e,type:h}=b||{};a+="",c=/^data:/.test(a)?a:d.fileURLToPath(new d.URL(a,k));const i=new f.Worker(__filename,{workerData:{mod:c,name:e,type:h}});Object.defineProperty(this,g,{value:i}),i.on("message",a=>{let b=new j("message");b.data=a,this.dispatchEvent(b)}),i.on("error",a=>{a.type="error",this.dispatchEvent(a)}),i.on("exit",()=>{this.dispatchEvent(new j("close"))})}postMessage(a,b){this[g].postMessage(a,b)}terminate(){this[g].terminate()}}return a.prototype.onmessage=a.prototype.onerror=a.prototype.onclose=null,a}():function(){let{mod:a,name:b,type:d}=f.workerData,e=global.self=global,g=[];function h(){let a=g;g=null,a.forEach(a=>{e.dispatchEvent(a)})}f.parentPort.on("message",a=>{let b=new j("message");b.data=a,null==g?e.dispatchEvent(b):g.push(b)}),f.parentPort.on("error",a=>{a.type="Error",e.dispatchEvent(a)});class k extends i{postMessage(a,b){f.parentPort.postMessage(a,b)}close(){process.exit()}}let m=Object.getPrototypeOf(global);delete m.constructor,Object.defineProperties(k.prototype,m),m=Object.setPrototypeOf(global,new k),["postMessage","addEventListener","removeEventListener","dispatchEvent"].forEach(a=>{m[a]=m[a].bind(global)}),global.name=b;let n=/^data:/.test(a);if("module"===d)c(6129)(a).catch(c=>{if(n&&"Not supported"===c.message)return console.warn("Worker(): Importing data: URLs requires Node 12.10+. Falling back to classic worker."),l(a,b);console.error(c)}).then(h);else{try{/^data:/.test(a)?l(a,b):c(7706)(a)}catch(a){console.error(a)}Promise.resolve().then(h)}}();let k=d.pathToFileURL(process.cwd()+"/");function l(a,b){let{data:c}=function(a){let[b,c,d,e]=a.match(/^data: *([^;,]*)(?: *; *([^,]*))? *,(.*)$/)||[];if(!b)throw Error("Invalid Data URL.");if(d)if("base64"===d.toLowerCase())e=Buffer.from(e,"base64").toString();else throw Error('Unknown Data URL encoding "'+d+'"');return{type:c,data:e}}(a);return e.runInThisContext(c,{filename:"worker.<"+(b||"data:")+">"})}},2045:a=>{a.exports=function(a,b,c,d,e,f){void 0===f&&(f=d<e);let g=a.addFunction(b);g.addParam("pIn","i32"),g.addParam("n","i32"),g.addParam("pOut","i32"),g.addLocal("i","i32"),g.addLocal("itIn","i32"),g.addLocal("itOut","i32");let h=g.getCodeBuilder();f?g.addCode(h.setLocal("itIn",h.i32_add(h.getLocal("pIn"),h.i32_mul(h.i32_sub(h.getLocal("n"),h.i32_const(1)),h.i32_const(d)))),h.setLocal("itOut",h.i32_add(h.getLocal("pOut"),h.i32_mul(h.i32_sub(h.getLocal("n"),h.i32_const(1)),h.i32_const(e)))),h.setLocal("i",h.i32_const(0)),h.block(h.loop(h.br_if(1,h.i32_eq(h.getLocal("i"),h.getLocal("n"))),h.call(c,h.getLocal("itIn"),h.getLocal("itOut")),h.setLocal("itIn",h.i32_sub(h.getLocal("itIn"),h.i32_const(d))),h.setLocal("itOut",h.i32_sub(h.getLocal("itOut"),h.i32_const(e))),h.setLocal("i",h.i32_add(h.getLocal("i"),h.i32_const(1))),h.br(0)))):g.addCode(h.setLocal("itIn",h.getLocal("pIn")),h.setLocal("itOut",h.getLocal("pOut")),h.setLocal("i",h.i32_const(0)),h.block(h.loop(h.br_if(1,h.i32_eq(h.getLocal("i"),h.getLocal("n"))),h.call(c,h.getLocal("itIn"),h.getLocal("itOut")),h.setLocal("itIn",h.i32_add(h.getLocal("itIn"),h.i32_const(d))),h.setLocal("itOut",h.i32_add(h.getLocal("itOut"),h.i32_const(e))),h.setLocal("i",h.i32_add(h.getLocal("i"),h.i32_const(1))),h.br(0))))}},2090:a=>{function b(a,b){return a===b?0:a>b?1:-1}function c(a){return a%2n!==0n}function d(a){return a%2n===0n}function e(a){return a<0n?a.toString(2).length-1:a.toString(2).length}function f(a){return a<0n?-a:a}function g(a){return 1n===f(a)}function h(a,c){for(var d,e,h,i=0n,j=1n,k=c,l=f(a);0n!==l;)d=k/l,e=i,h=k,i=j,k=l,j=e-d*j,l=h-d*l;if(!g(k))throw Error(a.toString()+" and "+c.toString()+" are not co-prime");return(-1===b(i,0n)&&(i+=c),a<0n)?-i:i}function i(a,b,d){if(0n===d)throw Error("Cannot take modPow with modulus 0");var e,f=1n,g=a%d;for(b<0n&&(b=-(1n*b),g=h(g,d));b>0n;){if(0n===g)return 0n;c(b)&&(f=f*g%d),b/=2n,g=(e=g)*e%d}return f}function j(a,b){var c,e;return 0n!==b&&(!!g(b)||(0==(e=2n,(c=(c=b)>=0n?c:-c)===(e=e>=0n?e:-e)?0:c>e?1:-1)?d(a):a%b===0n))}function k(a,b){for(var c,e,f,h,j=a-1n,k=j,l=0;d(k);)k/=2n,l++;a:for(f=0;f<b.length;f++)if(!(a<b[f])&&!g(h=i(BigInt(b[f]),k,a))&&h!==j){for(e=l-1;0!=e&&!g(h=(c=h)*c%a);e--){;if(h===j)continue a}return!1}return!0}a.exports.bitLength=e,a.exports.isOdd=c,a.exports.isNegative=function(a){return a<0n},a.exports.abs=f,a.exports.isUnit=g,a.exports.compare=b,a.exports.modInv=h,a.exports.modPow=i,a.exports.isPrime=function(a){var b,c=!g(b=f(a))&&(2n===b||3n===b||5n===b||!(d(b)||j(b,3n)||j(b,5n))&&(b<49n||void 0));if(void 0!==c)return c;var h=f(a),i=e(h);if(i<=64)return k(h,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var l=Math.ceil(Math.log(2)*Number(i)),m=[],n=0;n<l;n++)m.push(BigInt(n+2));return k(h,m)},a.exports.square=function(a){return a*a}},2509:(a,b,c)=>{let d=c(4319),e=c(2045),f=c(2868);a.exports=function(a,b,c,g){let h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW,aX,aY,aZ,a$,a_,a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b$,b_,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO,cP,cQ,cR,cS,cT,cU,cV=a.modules[c].n64,cW=8*cV;if(a.modules[b])return b;a.modules[b]={n64:3*cV},(h=a.addFunction(b+"_isZeroAffine")).addParam("p1","i32"),h.setReturnType("i32"),i=h.getCodeBuilder(),h.addCode(i.i32_and(i.call(c+"_isZero",i.getLocal("p1")),i.call(c+"_isZero",i.i32_add(i.getLocal("p1"),i.i32_const(cW))))),(j=a.addFunction(b+"_isZero")).addParam("p1","i32"),j.setReturnType("i32"),k=j.getCodeBuilder(),j.addCode(k.call(c+"_isZero",k.i32_add(k.getLocal("p1"),k.i32_const(2*cW)))),(l=a.addFunction(b+"_zeroAffine")).addParam("pr","i32"),m=l.getCodeBuilder(),l.addCode(m.call(c+"_zero",m.getLocal("pr"))),l.addCode(m.call(c+"_zero",m.i32_add(m.getLocal("pr"),m.i32_const(cW)))),(n=a.addFunction(b+"_zero")).addParam("pr","i32"),o=n.getCodeBuilder(),n.addCode(o.call(c+"_zero",o.getLocal("pr"))),n.addCode(o.call(c+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(cW)))),n.addCode(o.call(c+"_zero",o.i32_add(o.getLocal("pr"),o.i32_const(2*cW))));let cX=a.addFunction(b+"_copyAffine");cX.addParam("ps","i32"),cX.addParam("pd","i32");let cY=cX.getCodeBuilder();for(let a=0;a<2*cV;a++)cX.addCode(cY.i64_store(cY.getLocal("pd"),8*a,cY.i64_load(cY.getLocal("ps"),8*a)));let cZ=a.addFunction(b+"_copy");cZ.addParam("ps","i32"),cZ.addParam("pd","i32");let c$=cZ.getCodeBuilder();for(let a=0;a<3*cV;a++)cZ.addCode(c$.i64_store(c$.getLocal("pd"),8*a,c$.i64_load(c$.getLocal("ps"),8*a)));(p=a.addFunction(b+"_toJacobian")).addParam("p1","i32"),p.addParam("pr","i32"),r=(q=p.getCodeBuilder()).getLocal("p1"),s=q.i32_add(q.getLocal("p1"),q.i32_const(cW)),t=q.getLocal("pr"),u=q.i32_add(q.getLocal("pr"),q.i32_const(cW)),v=q.i32_add(q.getLocal("pr"),q.i32_const(2*cW)),p.addCode(q.if(q.call(b+"_isZeroAffine",q.getLocal("p1")),q.call(b+"_zero",q.getLocal("pr")),[...q.call(c+"_one",v),...q.call(c+"_copy",s,u),...q.call(c+"_copy",r,t)])),(w=a.addFunction(b+"_eqAffine")).addParam("p1","i32"),w.addParam("p2","i32"),w.setReturnType("i32"),w.addLocal("z1","i32"),x=w.getCodeBuilder(),w.addCode(x.ret(x.i32_and(x.call(c+"_eq",x.getLocal("p1"),x.getLocal("p2")),x.call(c+"_eq",x.i32_add(x.getLocal("p1"),x.i32_const(cW)),x.i32_add(x.getLocal("p2"),x.i32_const(cW)))))),(y=a.addFunction(b+"_eqMixed")).addParam("p1","i32"),y.addParam("p2","i32"),y.setReturnType("i32"),y.addLocal("z1","i32"),A=(z=y.getCodeBuilder()).getLocal("p1"),B=z.i32_add(z.getLocal("p1"),z.i32_const(cW)),y.addCode(z.setLocal("z1",z.i32_add(z.getLocal("p1"),z.i32_const(2*cW)))),C=z.getLocal("z1"),D=z.getLocal("p2"),E=z.i32_add(z.getLocal("p2"),z.i32_const(cW)),F=z.i32_const(a.alloc(cW)),G=z.i32_const(a.alloc(cW)),H=z.i32_const(a.alloc(cW)),I=z.i32_const(a.alloc(cW)),y.addCode(z.if(z.call(b+"_isZero",z.getLocal("p1")),z.ret(z.call(b+"_isZeroAffine",z.getLocal("p2")))),z.if(z.call(b+"_isZeroAffine",z.getLocal("p2")),z.ret(z.i32_const(0))),z.if(z.call(c+"_isOne",C),z.ret(z.call(b+"_eqAffine",z.getLocal("p1"),z.getLocal("p2")))),z.call(c+"_square",C,F),z.call(c+"_mul",D,F,G),z.call(c+"_mul",C,F,H),z.call(c+"_mul",E,H,I),z.if(z.call(c+"_eq",A,G),z.if(z.call(c+"_eq",B,I),z.ret(z.i32_const(1)))),z.ret(z.i32_const(0))),(J=a.addFunction(b+"_eq")).addParam("p1","i32"),J.addParam("p2","i32"),J.setReturnType("i32"),J.addLocal("z1","i32"),J.addLocal("z2","i32"),L=(K=J.getCodeBuilder()).getLocal("p1"),M=K.i32_add(K.getLocal("p1"),K.i32_const(cW)),J.addCode(K.setLocal("z1",K.i32_add(K.getLocal("p1"),K.i32_const(2*cW)))),N=K.getLocal("z1"),O=K.getLocal("p2"),P=K.i32_add(K.getLocal("p2"),K.i32_const(cW)),J.addCode(K.setLocal("z2",K.i32_add(K.getLocal("p2"),K.i32_const(2*cW)))),Q=K.getLocal("z2"),R=K.i32_const(a.alloc(cW)),S=K.i32_const(a.alloc(cW)),T=K.i32_const(a.alloc(cW)),U=K.i32_const(a.alloc(cW)),V=K.i32_const(a.alloc(cW)),W=K.i32_const(a.alloc(cW)),X=K.i32_const(a.alloc(cW)),Y=K.i32_const(a.alloc(cW)),J.addCode(K.if(K.call(b+"_isZero",K.getLocal("p1")),K.ret(K.call(b+"_isZero",K.getLocal("p2")))),K.if(K.call(b+"_isZero",K.getLocal("p2")),K.ret(K.i32_const(0))),K.if(K.call(c+"_isOne",N),K.ret(K.call(b+"_eqMixed",K.getLocal("p2"),K.getLocal("p1")))),K.if(K.call(c+"_isOne",Q),K.ret(K.call(b+"_eqMixed",K.getLocal("p1"),K.getLocal("p2")))),K.call(c+"_square",N,R),K.call(c+"_square",Q,S),K.call(c+"_mul",L,S,T),K.call(c+"_mul",O,R,U),K.call(c+"_mul",N,R,V),K.call(c+"_mul",Q,S,W),K.call(c+"_mul",M,W,X),K.call(c+"_mul",P,V,Y),K.if(K.call(c+"_eq",T,U),K.if(K.call(c+"_eq",X,Y),K.ret(K.i32_const(1)))),K.ret(K.i32_const(0))),(Z=a.addFunction(b+"_doubleAffine")).addParam("p1","i32"),Z.addParam("pr","i32"),_=($=Z.getCodeBuilder()).getLocal("p1"),aa=$.i32_add($.getLocal("p1"),$.i32_const(cW)),ab=$.getLocal("pr"),ac=$.i32_add($.getLocal("pr"),$.i32_const(cW)),ad=$.i32_add($.getLocal("pr"),$.i32_const(2*cW)),ae=$.i32_const(a.alloc(cW)),af=$.i32_const(a.alloc(cW)),ag=$.i32_const(a.alloc(cW)),ah=$.i32_const(a.alloc(cW)),ai=$.i32_const(a.alloc(cW)),aj=$.i32_const(a.alloc(cW)),Z.addCode($.if($.call(b+"_isZeroAffine",$.getLocal("p1")),[...$.call(b+"_toJacobian",$.getLocal("p1"),$.getLocal("pr")),...$.ret([])]),$.call(c+"_square",_,ae),$.call(c+"_square",aa,af),$.call(c+"_square",af,ag),$.call(c+"_add",_,af,ah),$.call(c+"_square",ah,ah),$.call(c+"_sub",ah,ae,ah),$.call(c+"_sub",ah,ag,ah),$.call(c+"_add",ah,ah,ah),$.call(c+"_add",ae,ae,ai),$.call(c+"_add",ai,ae,ai),$.call(c+"_add",aa,aa,ad),$.call(c+"_square",ai,ab),$.call(c+"_sub",ab,ah,ab),$.call(c+"_sub",ab,ah,ab),$.call(c+"_add",ag,ag,aj),$.call(c+"_add",aj,aj,aj),$.call(c+"_add",aj,aj,aj),$.call(c+"_sub",ah,ab,ac),$.call(c+"_mul",ac,ai,ac),$.call(c+"_sub",ac,aj,ac)),(ak=a.addFunction(b+"_double")).addParam("p1","i32"),ak.addParam("pr","i32"),am=(al=ak.getCodeBuilder()).getLocal("p1"),an=al.i32_add(al.getLocal("p1"),al.i32_const(cW)),ao=al.i32_add(al.getLocal("p1"),al.i32_const(2*cW)),ap=al.getLocal("pr"),aq=al.i32_add(al.getLocal("pr"),al.i32_const(cW)),ar=al.i32_add(al.getLocal("pr"),al.i32_const(2*cW)),as=al.i32_const(a.alloc(cW)),at=al.i32_const(a.alloc(cW)),au=al.i32_const(a.alloc(cW)),av=al.i32_const(a.alloc(cW)),aw=al.i32_const(a.alloc(cW)),ax=al.i32_const(a.alloc(cW)),ay=al.i32_const(a.alloc(cW)),az=al.i32_const(a.alloc(cW)),ak.addCode(al.if(al.call(b+"_isZero",al.getLocal("p1")),[...al.call(b+"_copy",al.getLocal("p1"),al.getLocal("pr")),...al.ret([])]),al.if(al.call(c+"_isOne",ao),[...al.ret(al.call(b+"_doubleAffine",al.getLocal("p1"),al.getLocal("pr"))),...al.ret([])]),al.call(c+"_square",am,as),al.call(c+"_square",an,at),al.call(c+"_square",at,au),al.call(c+"_add",am,at,av),al.call(c+"_square",av,av),al.call(c+"_sub",av,as,av),al.call(c+"_sub",av,au,av),al.call(c+"_add",av,av,av),al.call(c+"_add",as,as,aw),al.call(c+"_add",aw,as,aw),al.call(c+"_square",aw,ax),al.call(c+"_mul",an,ao,ay),al.call(c+"_add",av,av,ap),al.call(c+"_sub",ax,ap,ap),al.call(c+"_add",au,au,az),al.call(c+"_add",az,az,az),al.call(c+"_add",az,az,az),al.call(c+"_sub",av,ap,aq),al.call(c+"_mul",aq,aw,aq),al.call(c+"_sub",aq,az,aq),al.call(c+"_add",ay,ay,ar)),(aA=a.addFunction(b+"_addAffine")).addParam("p1","i32"),aA.addParam("p2","i32"),aA.addParam("pr","i32"),aA.addLocal("z1","i32"),aC=(aB=aA.getCodeBuilder()).getLocal("p1"),aD=aB.i32_add(aB.getLocal("p1"),aB.i32_const(cW)),aA.addCode(aB.setLocal("z1",aB.i32_add(aB.getLocal("p1"),aB.i32_const(2*cW)))),aE=aB.getLocal("p2"),aF=aB.i32_add(aB.getLocal("p2"),aB.i32_const(cW)),aG=aB.getLocal("pr"),aH=aB.i32_add(aB.getLocal("pr"),aB.i32_const(cW)),aI=aB.i32_add(aB.getLocal("pr"),aB.i32_const(2*cW)),aJ=aB.i32_const(a.alloc(cW)),aK=aB.i32_const(a.alloc(cW)),aL=aB.i32_const(a.alloc(cW)),aM=aB.i32_const(a.alloc(cW)),aN=aB.i32_const(a.alloc(cW)),aO=aB.i32_const(a.alloc(cW)),aP=aB.i32_const(a.alloc(cW)),aQ=aB.i32_const(a.alloc(cW)),aR=aB.i32_const(a.alloc(cW)),aS=aB.i32_const(a.alloc(cW)),aA.addCode(aB.if(aB.call(b+"_isZeroAffine",aB.getLocal("p1")),[...aB.call(b+"_copyAffine",aB.getLocal("p2"),aB.getLocal("pr")),...aB.call(c+"_one",aB.i32_add(aB.getLocal("pr"),aB.i32_const(2*cW))),...aB.ret([])]),aB.if(aB.call(b+"_isZeroAffine",aB.getLocal("p2")),[...aB.call(b+"_copyAffine",aB.getLocal("p1"),aB.getLocal("pr")),...aB.call(c+"_one",aB.i32_add(aB.getLocal("pr"),aB.i32_const(2*cW))),...aB.ret([])]),aB.if(aB.call(c+"_eq",aC,aE),aB.if(aB.call(c+"_eq",aD,aF),[...aB.call(b+"_doubleAffine",aB.getLocal("p2"),aB.getLocal("pr")),...aB.ret([])])),aB.call(c+"_sub",aE,aC,aJ),aB.call(c+"_sub",aF,aD,aL),aB.call(c+"_square",aJ,aK),aB.call(c+"_add",aK,aK,aM),aB.call(c+"_add",aM,aM,aM),aB.call(c+"_mul",aJ,aM,aN),aB.call(c+"_add",aL,aL,aO),aB.call(c+"_mul",aC,aM,aQ),aB.call(c+"_square",aO,aP),aB.call(c+"_add",aQ,aQ,aR),aB.call(c+"_sub",aP,aN,aG),aB.call(c+"_sub",aG,aR,aG),aB.call(c+"_mul",aD,aN,aS),aB.call(c+"_add",aS,aS,aS),aB.call(c+"_sub",aQ,aG,aH),aB.call(c+"_mul",aH,aO,aH),aB.call(c+"_sub",aH,aS,aH),aB.call(c+"_add",aJ,aJ,aI)),(aT=a.addFunction(b+"_addMixed")).addParam("p1","i32"),aT.addParam("p2","i32"),aT.addParam("pr","i32"),aT.addLocal("z1","i32"),aV=(aU=aT.getCodeBuilder()).getLocal("p1"),aW=aU.i32_add(aU.getLocal("p1"),aU.i32_const(cW)),aT.addCode(aU.setLocal("z1",aU.i32_add(aU.getLocal("p1"),aU.i32_const(2*cW)))),aX=aU.getLocal("z1"),aY=aU.getLocal("p2"),aZ=aU.i32_add(aU.getLocal("p2"),aU.i32_const(cW)),a$=aU.getLocal("pr"),a_=aU.i32_add(aU.getLocal("pr"),aU.i32_const(cW)),a0=aU.i32_add(aU.getLocal("pr"),aU.i32_const(2*cW)),a1=aU.i32_const(a.alloc(cW)),a2=aU.i32_const(a.alloc(cW)),a3=aU.i32_const(a.alloc(cW)),a4=aU.i32_const(a.alloc(cW)),a5=aU.i32_const(a.alloc(cW)),a6=aU.i32_const(a.alloc(cW)),a7=aU.i32_const(a.alloc(cW)),a8=aU.i32_const(a.alloc(cW)),a9=aU.i32_const(a.alloc(cW)),ba=aU.i32_const(a.alloc(cW)),bb=aU.i32_const(a.alloc(cW)),bc=aU.i32_const(a.alloc(cW)),bd=aU.i32_const(a.alloc(cW)),be=aU.i32_const(a.alloc(cW)),aT.addCode(aU.if(aU.call(b+"_isZero",aU.getLocal("p1")),[...aU.call(b+"_copyAffine",aU.getLocal("p2"),aU.getLocal("pr")),...aU.call(c+"_one",aU.i32_add(aU.getLocal("pr"),aU.i32_const(2*cW))),...aU.ret([])]),aU.if(aU.call(b+"_isZeroAffine",aU.getLocal("p2")),[...aU.call(b+"_copy",aU.getLocal("p1"),aU.getLocal("pr")),...aU.ret([])]),aU.if(aU.call(c+"_isOne",aX),[...aU.call(b+"_addAffine",aV,aY,a$),...aU.ret([])]),aU.call(c+"_square",aX,a1),aU.call(c+"_mul",aY,a1,a2),aU.call(c+"_mul",aX,a1,a3),aU.call(c+"_mul",aZ,a3,a4),aU.if(aU.call(c+"_eq",aV,a2),aU.if(aU.call(c+"_eq",aW,a4),[...aU.call(b+"_doubleAffine",aU.getLocal("p2"),aU.getLocal("pr")),...aU.ret([])])),aU.call(c+"_sub",a2,aV,a5),aU.call(c+"_sub",a4,aW,a7),aU.call(c+"_square",a5,a6),aU.call(c+"_add",a6,a6,a8),aU.call(c+"_add",a8,a8,a8),aU.call(c+"_mul",a5,a8,a9),aU.call(c+"_add",a7,a7,ba),aU.call(c+"_mul",aV,a8,bc),aU.call(c+"_square",ba,bb),aU.call(c+"_add",bc,bc,bd),aU.call(c+"_sub",bb,a9,a$),aU.call(c+"_sub",a$,bd,a$),aU.call(c+"_mul",aW,a9,be),aU.call(c+"_add",be,be,be),aU.call(c+"_sub",bc,a$,a_),aU.call(c+"_mul",a_,ba,a_),aU.call(c+"_sub",a_,be,a_),aU.call(c+"_add",aX,a5,a0),aU.call(c+"_square",a0,a0),aU.call(c+"_sub",a0,a1,a0),aU.call(c+"_sub",a0,a6,a0)),(bf=a.addFunction(b+"_add")).addParam("p1","i32"),bf.addParam("p2","i32"),bf.addParam("pr","i32"),bf.addLocal("z1","i32"),bf.addLocal("z2","i32"),bh=(bg=bf.getCodeBuilder()).getLocal("p1"),bi=bg.i32_add(bg.getLocal("p1"),bg.i32_const(cW)),bf.addCode(bg.setLocal("z1",bg.i32_add(bg.getLocal("p1"),bg.i32_const(2*cW)))),bj=bg.getLocal("z1"),bk=bg.getLocal("p2"),bl=bg.i32_add(bg.getLocal("p2"),bg.i32_const(cW)),bf.addCode(bg.setLocal("z2",bg.i32_add(bg.getLocal("p2"),bg.i32_const(2*cW)))),bm=bg.getLocal("z2"),bn=bg.getLocal("pr"),bo=bg.i32_add(bg.getLocal("pr"),bg.i32_const(cW)),bp=bg.i32_add(bg.getLocal("pr"),bg.i32_const(2*cW)),bq=bg.i32_const(a.alloc(cW)),br=bg.i32_const(a.alloc(cW)),bs=bg.i32_const(a.alloc(cW)),bt=bg.i32_const(a.alloc(cW)),bu=bg.i32_const(a.alloc(cW)),bv=bg.i32_const(a.alloc(cW)),bw=bg.i32_const(a.alloc(cW)),bx=bg.i32_const(a.alloc(cW)),by=bg.i32_const(a.alloc(cW)),bz=bg.i32_const(a.alloc(cW)),bA=bg.i32_const(a.alloc(cW)),bB=bg.i32_const(a.alloc(cW)),bC=bg.i32_const(a.alloc(cW)),bD=bg.i32_const(a.alloc(cW)),bE=bg.i32_const(a.alloc(cW)),bF=bg.i32_const(a.alloc(cW)),bG=bg.i32_const(a.alloc(cW)),bf.addCode(bg.if(bg.call(b+"_isZero",bg.getLocal("p1")),[...bg.call(b+"_copy",bg.getLocal("p2"),bg.getLocal("pr")),...bg.ret([])]),bg.if(bg.call(b+"_isZero",bg.getLocal("p2")),[...bg.call(b+"_copy",bg.getLocal("p1"),bg.getLocal("pr")),...bg.ret([])]),bg.if(bg.call(c+"_isOne",bj),[...bg.call(b+"_addMixed",bk,bh,bn),...bg.ret([])]),bg.if(bg.call(c+"_isOne",bm),[...bg.call(b+"_addMixed",bh,bk,bn),...bg.ret([])]),bg.call(c+"_square",bj,bq),bg.call(c+"_square",bm,br),bg.call(c+"_mul",bh,br,bs),bg.call(c+"_mul",bk,bq,bt),bg.call(c+"_mul",bj,bq,bu),bg.call(c+"_mul",bm,br,bv),bg.call(c+"_mul",bi,bv,bw),bg.call(c+"_mul",bl,bu,bx),bg.if(bg.call(c+"_eq",bs,bt),bg.if(bg.call(c+"_eq",bw,bx),[...bg.call(b+"_double",bg.getLocal("p1"),bg.getLocal("pr")),...bg.ret([])])),bg.call(c+"_sub",bt,bs,by),bg.call(c+"_sub",bx,bw,bz),bg.call(c+"_add",by,by,bA),bg.call(c+"_square",bA,bA),bg.call(c+"_mul",by,bA,bB),bg.call(c+"_add",bz,bz,bC),bg.call(c+"_mul",bs,bA,bE),bg.call(c+"_square",bC,bD),bg.call(c+"_add",bE,bE,bF),bg.call(c+"_sub",bD,bB,bn),bg.call(c+"_sub",bn,bF,bn),bg.call(c+"_mul",bw,bB,bG),bg.call(c+"_add",bG,bG,bG),bg.call(c+"_sub",bE,bn,bo),bg.call(c+"_mul",bo,bC,bo),bg.call(c+"_sub",bo,bG,bo),bg.call(c+"_add",bj,bm,bp),bg.call(c+"_square",bp,bp),bg.call(c+"_sub",bp,bq,bp),bg.call(c+"_sub",bp,br,bp),bg.call(c+"_mul",bp,by,bp)),(bH=a.addFunction(b+"_negAffine")).addParam("p1","i32"),bH.addParam("pr","i32"),bJ=(bI=bH.getCodeBuilder()).getLocal("p1"),bK=bI.i32_add(bI.getLocal("p1"),bI.i32_const(cW)),bL=bI.getLocal("pr"),bM=bI.i32_add(bI.getLocal("pr"),bI.i32_const(cW)),bH.addCode(bI.call(c+"_copy",bJ,bL),bI.call(c+"_neg",bK,bM)),(bN=a.addFunction(b+"_neg")).addParam("p1","i32"),bN.addParam("pr","i32"),bP=(bO=bN.getCodeBuilder()).getLocal("p1"),bQ=bO.i32_add(bO.getLocal("p1"),bO.i32_const(cW)),bR=bO.i32_add(bO.getLocal("p1"),bO.i32_const(2*cW)),bS=bO.getLocal("pr"),bT=bO.i32_add(bO.getLocal("pr"),bO.i32_const(cW)),bU=bO.i32_add(bO.getLocal("pr"),bO.i32_const(2*cW)),bN.addCode(bO.call(c+"_copy",bP,bS),bO.call(c+"_neg",bQ,bT),bO.call(c+"_copy",bR,bU)),(bV=a.addFunction(b+"_subAffine")).addParam("p1","i32"),bV.addParam("p2","i32"),bV.addParam("pr","i32"),bX=(bW=bV.getCodeBuilder()).i32_const(a.alloc(3*cW)),bV.addCode(bW.call(b+"_negAffine",bW.getLocal("p2"),bX),bW.call(b+"_addAffine",bW.getLocal("p1"),bX,bW.getLocal("pr"))),(bY=a.addFunction(b+"_subMixed")).addParam("p1","i32"),bY.addParam("p2","i32"),bY.addParam("pr","i32"),b$=(bZ=bY.getCodeBuilder()).i32_const(a.alloc(3*cW)),bY.addCode(bZ.call(b+"_negAffine",bZ.getLocal("p2"),b$),bZ.call(b+"_addMixed",bZ.getLocal("p1"),b$,bZ.getLocal("pr"))),(b_=a.addFunction(b+"_sub")).addParam("p1","i32"),b_.addParam("p2","i32"),b_.addParam("pr","i32"),b1=(b0=b_.getCodeBuilder()).i32_const(a.alloc(3*cW)),b_.addCode(b0.call(b+"_neg",b0.getLocal("p2"),b1),b0.call(b+"_add",b0.getLocal("p1"),b1,b0.getLocal("pr")));let c_=a.addFunction(b+"_fromMontgomeryAffine");c_.addParam("p1","i32"),c_.addParam("pr","i32");let c0=c_.getCodeBuilder();c_.addCode(c0.call(c+"_fromMontgomery",c0.getLocal("p1"),c0.getLocal("pr")));for(let a=1;a<2;a++)c_.addCode(c0.call(c+"_fromMontgomery",c0.i32_add(c0.getLocal("p1"),c0.i32_const(a*cW)),c0.i32_add(c0.getLocal("pr"),c0.i32_const(a*cW))));let c1=a.addFunction(b+"_fromMontgomery");c1.addParam("p1","i32"),c1.addParam("pr","i32");let c2=c1.getCodeBuilder();c1.addCode(c2.call(c+"_fromMontgomery",c2.getLocal("p1"),c2.getLocal("pr")));for(let a=1;a<3;a++)c1.addCode(c2.call(c+"_fromMontgomery",c2.i32_add(c2.getLocal("p1"),c2.i32_const(a*cW)),c2.i32_add(c2.getLocal("pr"),c2.i32_const(a*cW))));let c3=a.addFunction(b+"_toMontgomeryAffine");c3.addParam("p1","i32"),c3.addParam("pr","i32");let c4=c3.getCodeBuilder();c3.addCode(c4.call(c+"_toMontgomery",c4.getLocal("p1"),c4.getLocal("pr")));for(let a=1;a<2;a++)c3.addCode(c4.call(c+"_toMontgomery",c4.i32_add(c4.getLocal("p1"),c4.i32_const(a*cW)),c4.i32_add(c4.getLocal("pr"),c4.i32_const(a*cW))));let c5=a.addFunction(b+"_toMontgomery");c5.addParam("p1","i32"),c5.addParam("pr","i32");let c6=c5.getCodeBuilder();c5.addCode(c6.call(c+"_toMontgomery",c6.getLocal("p1"),c6.getLocal("pr")));for(let a=1;a<3;a++)c5.addCode(c6.call(c+"_toMontgomery",c6.i32_add(c6.getLocal("p1"),c6.i32_const(a*cW)),c6.i32_add(c6.getLocal("pr"),c6.i32_const(a*cW))));return(b2=a.addFunction(b+"_toAffine")).addParam("p1","i32"),b2.addParam("pr","i32"),b4=(b3=b2.getCodeBuilder()).getLocal("p1"),b5=b3.i32_add(b3.getLocal("p1"),b3.i32_const(cW)),b6=b3.i32_add(b3.getLocal("p1"),b3.i32_const(2*cW)),b7=b3.getLocal("pr"),b8=b3.i32_add(b3.getLocal("pr"),b3.i32_const(cW)),b9=b3.i32_const(a.alloc(cW)),ca=b3.i32_const(a.alloc(cW)),cb=b3.i32_const(a.alloc(cW)),b2.addCode(b3.if(b3.call(b+"_isZero",b3.getLocal("p1")),[...b3.call(c+"_zero",b7),...b3.call(c+"_zero",b8)],[...b3.call(c+"_inverse",b6,b9),...b3.call(c+"_square",b9,ca),...b3.call(c+"_mul",b9,ca,cb),...b3.call(c+"_mul",b4,ca,b7),...b3.call(c+"_mul",b5,cb,b8)])),(cc=a.addFunction(b+"_inCurveAffine")).addParam("pIn","i32"),cc.setReturnType("i32"),ce=(cd=cc.getCodeBuilder()).getLocal("pIn"),cf=cd.i32_add(cd.getLocal("pIn"),cd.i32_const(cW)),cg=cd.i32_const(a.alloc(cW)),ch=cd.i32_const(a.alloc(cW)),cc.addCode(cd.call(c+"_square",cf,cg),cd.call(c+"_square",ce,ch),cd.call(c+"_mul",ce,ch,ch),cd.call(c+"_add",ch,cd.i32_const(g),ch),cd.ret(cd.call(c+"_eq",cg,ch))),(ci=a.addFunction(b+"_inCurve")).addParam("pIn","i32"),ci.setReturnType("i32"),ck=(cj=ci.getCodeBuilder()).i32_const(a.alloc(2*cW)),ci.addCode(cj.call(b+"_toAffine",cj.getLocal("pIn"),ck),cj.ret(cj.call(b+"_inCurveAffine",ck))),(cl=a.addFunction(b+"_batchToAffine")).addParam("pIn","i32"),cl.addParam("n","i32"),cl.addParam("pOut","i32"),cl.addLocal("pAux","i32"),cl.addLocal("itIn","i32"),cl.addLocal("itAux","i32"),cl.addLocal("itOut","i32"),cl.addLocal("i","i32"),cn=(cm=cl.getCodeBuilder()).i32_const(a.alloc(cW)),cl.addCode(cm.setLocal("pAux",cm.i32_load(cm.i32_const(0))),cm.i32_store(cm.i32_const(0),cm.i32_add(cm.getLocal("pAux"),cm.i32_mul(cm.getLocal("n"),cm.i32_const(cW)))),cm.call(c+"_batchInverse",cm.i32_add(cm.getLocal("pIn"),cm.i32_const(2*cW)),cm.i32_const(3*cW),cm.getLocal("n"),cm.getLocal("pAux"),cm.i32_const(cW)),cm.setLocal("itIn",cm.getLocal("pIn")),cm.setLocal("itAux",cm.getLocal("pAux")),cm.setLocal("itOut",cm.getLocal("pOut")),cm.setLocal("i",cm.i32_const(0)),cm.block(cm.loop(cm.br_if(1,cm.i32_eq(cm.getLocal("i"),cm.getLocal("n"))),cm.if(cm.call(c+"_isZero",cm.getLocal("itAux")),[...cm.call(c+"_zero",cm.getLocal("itOut")),...cm.call(c+"_zero",cm.i32_add(cm.getLocal("itOut"),cm.i32_const(cW)))],[...cm.call(c+"_mul",cm.getLocal("itAux"),cm.i32_add(cm.getLocal("itIn"),cm.i32_const(cW)),cn),...cm.call(c+"_square",cm.getLocal("itAux"),cm.getLocal("itAux")),...cm.call(c+"_mul",cm.getLocal("itAux"),cm.getLocal("itIn"),cm.getLocal("itOut")),...cm.call(c+"_mul",cm.getLocal("itAux"),cn,cm.i32_add(cm.getLocal("itOut"),cm.i32_const(cW)))]),cm.setLocal("itIn",cm.i32_add(cm.getLocal("itIn"),cm.i32_const(3*cW))),cm.setLocal("itOut",cm.i32_add(cm.getLocal("itOut"),cm.i32_const(2*cW))),cm.setLocal("itAux",cm.i32_add(cm.getLocal("itAux"),cm.i32_const(cW))),cm.setLocal("i",cm.i32_add(cm.getLocal("i"),cm.i32_const(1))),cm.br(0))),cm.i32_store(cm.i32_const(0),cm.getLocal("pAux"))),(co=a.addFunction(b+"_normalize")).addParam("p1","i32"),co.addParam("pr","i32"),cq=(cp=co.getCodeBuilder()).getLocal("p1"),cr=cp.i32_add(cp.getLocal("p1"),cp.i32_const(cW)),cs=cp.i32_add(cp.getLocal("p1"),cp.i32_const(2*cW)),ct=cp.getLocal("pr"),cu=cp.i32_add(cp.getLocal("pr"),cp.i32_const(cW)),cv=cp.i32_add(cp.getLocal("pr"),cp.i32_const(2*cW)),cw=cp.i32_const(a.alloc(cW)),cx=cp.i32_const(a.alloc(cW)),cy=cp.i32_const(a.alloc(cW)),co.addCode(cp.if(cp.call(b+"_isZero",cp.getLocal("p1")),cp.call(b+"_zero",cp.getLocal("pr")),[...cp.call(c+"_inverse",cs,cw),...cp.call(c+"_square",cw,cx),...cp.call(c+"_mul",cw,cx,cy),...cp.call(c+"_mul",cq,cx,ct),...cp.call(c+"_mul",cr,cy,cu),...cp.call(c+"_one",cv)])),(cz=a.addFunction(b+"__reverseBytes")).addParam("pIn","i32"),cz.addParam("n","i32"),cz.addParam("pOut","i32"),cz.addLocal("itOut","i32"),cz.addLocal("itIn","i32"),cA=cz.getCodeBuilder(),cz.addCode(cA.setLocal("itOut",cA.i32_sub(cA.i32_add(cA.getLocal("pOut"),cA.getLocal("n")),cA.i32_const(1))),cA.setLocal("itIn",cA.getLocal("pIn")),cA.block(cA.loop(cA.br_if(1,cA.i32_lt_s(cA.getLocal("itOut"),cA.getLocal("pOut"))),cA.i32_store8(cA.getLocal("itOut"),cA.i32_load8_u(cA.getLocal("itIn"))),cA.setLocal("itOut",cA.i32_sub(cA.getLocal("itOut"),cA.i32_const(1))),cA.setLocal("itIn",cA.i32_add(cA.getLocal("itIn"),cA.i32_const(1))),cA.br(0)))),(cB=a.addFunction(b+"_LEMtoU")).addParam("pIn","i32"),cB.addParam("pOut","i32"),cC=cB.getCodeBuilder(),cD=a.alloc(2*cW),cE=cC.i32_const(cD),cF=cC.i32_const(cD),cG=cC.i32_const(cD+cW),cB.addCode(cC.if(cC.call(b+"_isZeroAffine",cC.getLocal("pIn")),[...cC.call(b+"_zeroAffine",cC.getLocal("pOut")),...cC.ret([])]),cC.call(b+"_fromMontgomeryAffine",cC.getLocal("pIn"),cE),cC.call(b+"__reverseBytes",cF,cC.i32_const(cW),cC.getLocal("pOut")),cC.call(b+"__reverseBytes",cG,cC.i32_const(cW),cC.i32_add(cC.getLocal("pOut"),cC.i32_const(cW)))),(cH=a.addFunction(b+"_LEMtoC")).addParam("pIn","i32"),cH.addParam("pOut","i32"),cJ=(cI=cH.getCodeBuilder()).i32_const(a.alloc(cW)),cH.addCode(cI.if(cI.call(b+"_isZeroAffine",cI.getLocal("pIn")),[...cI.call(c+"_zero",cI.getLocal("pOut")),...cI.i32_store8(cI.getLocal("pOut"),cI.i32_const(64)),...cI.ret([])]),cI.call(c+"_fromMontgomery",cI.getLocal("pIn"),cJ),cI.call(b+"__reverseBytes",cJ,cI.i32_const(cW),cI.getLocal("pOut")),cI.if(cI.i32_eq(cI.call(c+"_sign",cI.i32_add(cI.getLocal("pIn"),cI.i32_const(cW))),cI.i32_const(-1)),cI.i32_store8(cI.getLocal("pOut"),cI.i32_or(cI.i32_load8_u(cI.getLocal("pOut")),cI.i32_const(128))))),(cK=a.addFunction(b+"_UtoLEM")).addParam("pIn","i32"),cK.addParam("pOut","i32"),cL=cK.getCodeBuilder(),cM=a.alloc(2*cW),cN=cL.i32_const(cM),cO=cL.i32_const(cM),cP=cL.i32_const(cM+cW),cK.addCode(cL.if(cL.i32_and(cL.i32_load8_u(cL.getLocal("pIn")),cL.i32_const(64)),[...cL.call(b+"_zeroAffine",cL.getLocal("pOut")),...cL.ret([])]),cL.call(b+"__reverseBytes",cL.getLocal("pIn"),cL.i32_const(cW),cO),cL.call(b+"__reverseBytes",cL.i32_add(cL.getLocal("pIn"),cL.i32_const(cW)),cL.i32_const(cW),cP),cL.call(b+"_toMontgomeryAffine",cN,cL.getLocal("pOut"))),(cQ=a.addFunction(b+"_CtoLEM")).addParam("pIn","i32"),cQ.addParam("pOut","i32"),cQ.addLocal("firstByte","i32"),cQ.addLocal("greatest","i32"),cR=cQ.getCodeBuilder(),cS=a.alloc(2*cW),cT=cR.i32_const(cS),cU=cR.i32_const(cS+cW),cQ.addCode(cR.setLocal("firstByte",cR.i32_load8_u(cR.getLocal("pIn"))),cR.if(cR.i32_and(cR.getLocal("firstByte"),cR.i32_const(64)),[...cR.call(b+"_zeroAffine",cR.getLocal("pOut")),...cR.ret([])]),cR.setLocal("greatest",cR.i32_and(cR.getLocal("firstByte"),cR.i32_const(128))),cR.call(c+"_copy",cR.getLocal("pIn"),cU),cR.i32_store8(cU,cR.i32_and(cR.getLocal("firstByte"),cR.i32_const(63))),cR.call(b+"__reverseBytes",cU,cR.i32_const(cW),cT),cR.call(c+"_toMontgomery",cT,cR.getLocal("pOut")),cR.call(c+"_square",cR.getLocal("pOut"),cU),cR.call(c+"_mul",cR.getLocal("pOut"),cU,cU),cR.call(c+"_add",cU,cR.i32_const(g),cU),cR.call(c+"_sqrt",cU,cU),cR.call(c+"_neg",cU,cT),cR.if(cR.i32_eq(cR.call(c+"_sign",cU),cR.i32_const(-1)),cR.if(cR.getLocal("greatest"),cR.call(c+"_copy",cU,cR.i32_add(cR.getLocal("pOut"),cR.i32_const(cW))),cR.call(c+"_neg",cU,cR.i32_add(cR.getLocal("pOut"),cR.i32_const(cW)))),cR.if(cR.getLocal("greatest"),cR.call(c+"_neg",cU,cR.i32_add(cR.getLocal("pOut"),cR.i32_const(cW))),cR.call(c+"_copy",cU,cR.i32_add(cR.getLocal("pOut"),cR.i32_const(cW)))))),e(a,b+"_batchLEMtoU",b+"_LEMtoU",2*cW,2*cW),e(a,b+"_batchLEMtoC",b+"_LEMtoC",2*cW,cW),e(a,b+"_batchUtoLEM",b+"_UtoLEM",2*cW,2*cW),e(a,b+"_batchCtoLEM",b+"_CtoLEM",cW,2*cW,!0),e(a,b+"_batchToJacobian",b+"_toJacobian",2*cW,3*cW,!0),f(a,b,b+"_multiexp",b+"_add",3*cW),f(a,b,b+"_multiexpAffine",b+"_addMixed",2*cW),d(a,b+"_timesScalar",3*cW,b+"_add",b+"_double",b+"_sub",b+"_copy",b+"_zero"),d(a,b+"_timesScalarAffine",2*cW,b+"_addMixed",b+"_double",b+"_subMixed",b+"_copyAffine",b+"_zero"),a.exportFunction(b+"_isZero"),a.exportFunction(b+"_isZeroAffine"),a.exportFunction(b+"_eq"),a.exportFunction(b+"_eqMixed"),a.exportFunction(b+"_eqAffine"),a.exportFunction(b+"_copy"),a.exportFunction(b+"_copyAffine"),a.exportFunction(b+"_zero"),a.exportFunction(b+"_zeroAffine"),a.exportFunction(b+"_double"),a.exportFunction(b+"_doubleAffine"),a.exportFunction(b+"_add"),a.exportFunction(b+"_addMixed"),a.exportFunction(b+"_addAffine"),a.exportFunction(b+"_neg"),a.exportFunction(b+"_negAffine"),a.exportFunction(b+"_sub"),a.exportFunction(b+"_subMixed"),a.exportFunction(b+"_subAffine"),a.exportFunction(b+"_fromMontgomery"),a.exportFunction(b+"_fromMontgomeryAffine"),a.exportFunction(b+"_toMontgomery"),a.exportFunction(b+"_toMontgomeryAffine"),a.exportFunction(b+"_timesScalar"),a.exportFunction(b+"_timesScalarAffine"),a.exportFunction(b+"_normalize"),a.exportFunction(b+"_LEMtoU"),a.exportFunction(b+"_LEMtoC"),a.exportFunction(b+"_UtoLEM"),a.exportFunction(b+"_CtoLEM"),a.exportFunction(b+"_batchLEMtoU"),a.exportFunction(b+"_batchLEMtoC"),a.exportFunction(b+"_batchUtoLEM"),a.exportFunction(b+"_batchCtoLEM"),a.exportFunction(b+"_toAffine"),a.exportFunction(b+"_toJacobian"),a.exportFunction(b+"_batchToAffine"),a.exportFunction(b+"_batchToJacobian"),a.exportFunction(b+"_inCurve"),a.exportFunction(b+"_inCurveAffine"),b}},2572:(a,b,c)=>{"use strict";var d=c(9021),e=c(3873),f=c(8865),g=!1,h=c(3664).rE,i="locals",j=["delimiter","scope","context","debug","compileDebug","client","_with","rmWhitespace","strict","filename","async"],k=j.concat("cache"),l=/^\uFEFF/,m=/^[a-zA-Z_$][0-9a-zA-Z_$]*$/;function n(a,c){var e;if(c.some(function(c){return e=b.resolveInclude(a,c,!0),d.existsSync(e)}))return e}function o(a,c){var d,e=a.filename,f=arguments.length>1;if(a.cache){if(!e)throw Error("cache option requires a filename");if(d=b.cache.get(e))return d;f||(c=p(e).toString().replace(l,""))}else if(!f){if(!e)throw Error("Internal EJS error: no file name or template provided");c=p(e).toString().replace(l,"")}return d=b.compile(c,a),a.cache&&b.cache.set(e,d),d}function p(a){return b.fileLoader(a)}function q(a,b,c,d,e){var f=b.split("\n"),g=Math.max(d-3,0),h=Math.min(f.length,d+3),i=e(c),j=f.slice(g,h).map(function(a,b){var c=b+g+1;return(c==d?" >> ":"    ")+c+"| "+a}).join("\n");throw a.path=i,a.message=(i||"ejs")+":"+d+"\n"+j+"\n\n"+a.message,a}function r(a){return a.replace(/;(\s*$)/,"$1")}function s(a,c){var d=f.hasOwnOnlyObject(c),e=f.createNullProtoObjWherePossible();this.templateText=a,this.mode=null,this.truncate=!1,this.currentLine=1,this.source="",e.client=d.client||!1,e.escapeFunction=d.escape||d.escapeFunction||f.escapeXML,e.compileDebug=!1!==d.compileDebug,e.debug=!!d.debug,e.filename=d.filename,e.openDelimiter=d.openDelimiter||b.openDelimiter||"<",e.closeDelimiter=d.closeDelimiter||b.closeDelimiter||">",e.delimiter=d.delimiter||b.delimiter||"%",e.strict=d.strict||!1,e.context=d.context,e.cache=d.cache||!1,e.rmWhitespace=d.rmWhitespace,e.root=d.root,e.includer=d.includer,e.outputFunctionName=d.outputFunctionName,e.localsName=d.localsName||b.localsName||i,e.views=d.views,e.async=d.async,e.destructuredLocals=d.destructuredLocals,e.legacyInclude=void 0===d.legacyInclude||!!d.legacyInclude,e.strict?e._with=!1:e._with=void 0===d._with||d._with,this.opts=e,this.regex=this.createRegex()}b.cache=f.cache,b.fileLoader=d.readFileSync,b.localsName=i,b.promiseImpl=Function("return this;")().Promise,b.resolveInclude=function(a,b,c){var d=e.dirname,f=e.extname,g=(0,e.resolve)(c?b:d(b),a);return f(a)||(g+=".ejs"),g},b.compile=function(a,b){return b&&b.scope&&(g||(console.warn("`scope` option is deprecated and will be removed in EJS 3"),g=!0),b.context||(b.context=b.scope),delete b.scope),new s(a,b).compile()},b.render=function(a,b,c){var d=b||f.createNullProtoObjWherePossible(),e=c||f.createNullProtoObjWherePossible();return 2==arguments.length&&f.shallowCopyFromList(e,d,j),o(e,a)(d)},b.renderFile=function(){var a,c,d,e,g=Array.prototype.slice.call(arguments),h=g.shift(),i={filename:h};"function"==typeof arguments[arguments.length-1]&&(c=g.pop()),g.length?(d=g.shift(),g.length?f.shallowCopy(i,g.pop()):(d.settings&&(d.settings.views&&(i.views=d.settings.views),d.settings["view cache"]&&(i.cache=!0),(e=d.settings["view options"])&&f.shallowCopy(i,e)),f.shallowCopyFromList(i,d,k)),i.filename=h):d=f.createNullProtoObjWherePossible();var j=d,l=c;if(l){try{a=o(i)(j)}catch(a){return l(a)}l(null,a)}else if("function"==typeof b.promiseImpl)return new b.promiseImpl(function(b,c){try{a=o(i)(j),b(a)}catch(a){c(a)}});else throw Error("Please provide a callback function")},b.Template=s,b.clearCache=function(){b.cache.reset()},s.modes={EVAL:"eval",ESCAPED:"escaped",RAW:"raw",COMMENT:"comment",LITERAL:"literal"},s.prototype={createRegex:function(){var a="(<%%|%%>|<%=|<%-|<%_|<%#|<%|%>|-%>|_%>)",b=f.escapeRegExpChars(this.opts.delimiter),c=f.escapeRegExpChars(this.opts.openDelimiter),d=f.escapeRegExpChars(this.opts.closeDelimiter);return new RegExp(a=a.replace(/%/g,b).replace(/</g,c).replace(/>/g,d))},compile:function(){var a,c,g,h=this.opts,i="",j="",k=h.escapeFunction,l=h.filename?JSON.stringify(h.filename):"undefined";if(!this.source){if(this.generateSource(),i+='  var __output = "";\n  function __append(s) { if (s !== undefined && s !== null) __output += s }\n',h.outputFunctionName){if(!m.test(h.outputFunctionName))throw Error("outputFunctionName is not a valid JS identifier.");i+="  var "+h.outputFunctionName+" = __append;\n"}if(h.localsName&&!m.test(h.localsName))throw Error("localsName is not a valid JS identifier.");if(h.destructuredLocals&&h.destructuredLocals.length){for(var p="  var __locals = ("+h.localsName+" || {}),\n",r=0;r<h.destructuredLocals.length;r++){var s=h.destructuredLocals[r];if(!m.test(s))throw Error("destructuredLocals["+r+"] is not a valid JS identifier.");r>0&&(p+=",\n  "),p+=s+" = __locals."+s}i+=p+";\n"}!1!==h._with&&(i+="  with ("+h.localsName+" || {}) {\n",j+="  }\n"),j+="  return __output;\n",this.source=i+this.source+j}a=h.compileDebug?"var __line = 1\n  , __lines = "+JSON.stringify(this.templateText)+"\n  , __filename = "+l+";\ntry {\n"+this.source+"} catch (e) {\n  rethrow(e, __lines, __filename, __line, escapeFn);\n}\n":this.source,h.client&&(a="escapeFn = escapeFn || "+k.toString()+";\n"+a,h.compileDebug&&(a="rethrow = rethrow || "+q.toString()+";\n"+a)),h.strict&&(a='"use strict";\n'+a),h.debug&&console.log(a),h.compileDebug&&h.filename&&(a=a+"\n//# sourceURL="+l+"\n");try{if(h.async)try{g=Function("return (async function(){}).constructor;")()}catch(a){if(a instanceof SyntaxError)throw Error("This environment does not support async/await");throw a}else g=Function;c=new g(h.localsName+", escapeFn, include, rethrow",a)}catch(a){throw a instanceof SyntaxError&&(h.filename&&(a.message+=" in "+h.filename),a.message+=" while compiling ejs\n\n",a.message+="If the above error is not helpful, you may want to try EJS-Lint:\n",a.message+="https://github.com/RyanZim/EJS-Lint",h.async||(a.message+="\n",a.message+="Or, if you meant to create an async function, pass `async: true` as an option.")),a}var t=h.client?c:function(a){return c.apply(h.context,[a||f.createNullProtoObjWherePossible(),k,function(c,e){var g=f.shallowCopy(f.createNullProtoObjWherePossible(),a);return e&&(g=f.shallowCopy(g,e)),(function(a,c){var e=f.shallowCopy(f.createNullProtoObjWherePossible(),c);if(e.filename=function(a,c){var e,f,g=c.views,h=/^[A-Za-z]+:\\|^\//.exec(a);if(h&&h.length)a=a.replace(/^\/*/,""),e=Array.isArray(c.root)?n(a,c.root):b.resolveInclude(a,c.root||"/",!0);else if(c.filename&&(f=b.resolveInclude(a,c.filename),d.existsSync(f)&&(e=f)),!e&&Array.isArray(g)&&(e=n(a,g)),!e&&"function"!=typeof c.includer)throw Error('Could not find the include file "'+c.escapeFunction(a)+'"');return e}(a,e),"function"==typeof c.includer){var g=c.includer(a,e.filename);if(g&&(g.filename&&(e.filename=g.filename),g.template))return o(e,g.template)}return o(e)})(c,h)(g)},q])};if(h.filename&&"function"==typeof Object.defineProperty){var u=h.filename,v=e.basename(u,e.extname(u));try{Object.defineProperty(t,"name",{value:v,writable:!1,enumerable:!1,configurable:!0})}catch(a){}}return t},generateSource:function(){this.opts.rmWhitespace&&(this.templateText=this.templateText.replace(/[\r\n]+/g,"\n").replace(/^\s+|\s+$/gm,"")),this.templateText=this.templateText.replace(/[ \t]*<%_/gm,"<%_").replace(/_%>[ \t]*/gm,"_%>");var a=this,b=this.parseTemplateText(),c=this.opts.delimiter,d=this.opts.openDelimiter,e=this.opts.closeDelimiter;b&&b.length&&b.forEach(function(f,g){var h;if(0===f.indexOf(d+c)&&0!==f.indexOf(d+c+c)&&(h=b[g+2])!=c+e&&h!="-"+c+e&&h!="_"+c+e)throw Error('Could not find matching close tag for "'+f+'".');a.scanLine(f)})},parseTemplateText:function(){for(var a,b=this.templateText,c=this.regex,d=c.exec(b),e=[];d;)0!==(a=d.index)&&(e.push(b.substring(0,a)),b=b.slice(a)),e.push(d[0]),b=b.slice(d[0].length),d=c.exec(b);return b&&e.push(b),e},_addOutput:function(a){if(this.truncate&&(a=a.replace(/^(?:\r\n|\r|\n)/,""),this.truncate=!1),!a)return a;a=(a=(a=(a=a.replace(/\\/g,"\\\\")).replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace(/"/g,'\\"'),this.source+='    ; __append("'+a+'")\n'},scanLine:function(a){var b=this.opts.delimiter,c=this.opts.openDelimiter,d=this.opts.closeDelimiter,e=0;switch(e=a.split("\n").length-1,a){case c+b:case c+b+"_":this.mode=s.modes.EVAL;break;case c+b+"=":this.mode=s.modes.ESCAPED;break;case c+b+"-":this.mode=s.modes.RAW;break;case c+b+"#":this.mode=s.modes.COMMENT;break;case c+b+b:this.mode=s.modes.LITERAL,this.source+='    ; __append("'+a.replace(c+b+b,c+b)+'")\n';break;case b+b+d:this.mode=s.modes.LITERAL,this.source+='    ; __append("'+a.replace(b+b+d,b+d)+'")\n';break;case b+d:case"-"+b+d:case"_"+b+d:this.mode==s.modes.LITERAL&&this._addOutput(a),this.mode=null,this.truncate=0===a.indexOf("-")||0===a.indexOf("_");break;default:if(this.mode){switch(this.mode){case s.modes.EVAL:case s.modes.ESCAPED:case s.modes.RAW:a.lastIndexOf("//")>a.lastIndexOf("\n")&&(a+="\n")}switch(this.mode){case s.modes.EVAL:this.source+="    ; "+a+"\n";break;case s.modes.ESCAPED:this.source+="    ; __append(escapeFn("+r(a)+"))\n";break;case s.modes.RAW:this.source+="    ; __append("+r(a)+")\n";break;case s.modes.COMMENT:break;case s.modes.LITERAL:this._addOutput(a)}}else this._addOutput(a)}this.opts.compileDebug&&e&&(this.currentLine+=e,this.source+="    ; __line = "+this.currentLine+"\n")}},b.escapeXML=f.escapeXML,b.__express=b.renderFile,b.VERSION=h,b.name="ejs","u">typeof window&&(window.ejs=b)},2868:a=>{a.exports=function(a,b,c,d,e){let f,g,h,i,j,k,l,m,n,o,p=8*a.modules[b].n64;(f=a.addFunction(c+"_getChunk")).addParam("pScalar","i32"),f.addParam("scalarSize","i32"),f.addParam("startBit","i32"),f.addParam("chunkSize","i32"),f.addLocal("bitsToEnd","i32"),f.addLocal("mask","i32"),f.setReturnType("i32"),g=f.getCodeBuilder(),f.addCode(g.setLocal("bitsToEnd",g.i32_sub(g.i32_mul(g.getLocal("scalarSize"),g.i32_const(8)),g.getLocal("startBit"))),g.if(g.i32_gt_s(g.getLocal("chunkSize"),g.getLocal("bitsToEnd")),g.setLocal("mask",g.i32_sub(g.i32_shl(g.i32_const(1),g.getLocal("bitsToEnd")),g.i32_const(1))),g.setLocal("mask",g.i32_sub(g.i32_shl(g.i32_const(1),g.getLocal("chunkSize")),g.i32_const(1)))),g.i32_and(g.i32_shr_u(g.i32_load(g.i32_add(g.getLocal("pScalar"),g.i32_shr_u(g.getLocal("startBit"),g.i32_const(3))),0,0),g.i32_and(g.getLocal("startBit"),g.i32_const(7))),g.getLocal("mask"))),(h=a.addFunction(c+"_reduceTable")).addParam("pTable","i32"),h.addParam("p","i32"),h.addLocal("half","i32"),h.addLocal("it1","i32"),h.addLocal("it2","i32"),h.addLocal("pAcc","i32"),i=h.getCodeBuilder(),h.addCode(i.if(i.i32_eq(i.getLocal("p"),i.i32_const(1)),i.ret([])),i.setLocal("half",i.i32_shl(i.i32_const(1),i.i32_sub(i.getLocal("p"),i.i32_const(1)))),i.setLocal("it1",i.getLocal("pTable")),i.setLocal("it2",i.i32_add(i.getLocal("pTable"),i.i32_mul(i.getLocal("half"),i.i32_const(p)))),i.setLocal("pAcc",i.i32_sub(i.getLocal("it2"),i.i32_const(p))),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("it1"),i.getLocal("pAcc"))),i.call(b+"_add",i.getLocal("it1"),i.getLocal("it2"),i.getLocal("it1")),i.call(b+"_add",i.getLocal("pAcc"),i.getLocal("it2"),i.getLocal("pAcc")),i.setLocal("it1",i.i32_add(i.getLocal("it1"),i.i32_const(p))),i.setLocal("it2",i.i32_add(i.getLocal("it2"),i.i32_const(p))),i.br(0))),i.call(c+"_reduceTable",i.getLocal("pTable"),i.i32_sub(i.getLocal("p"),i.i32_const(1))),i.setLocal("p",i.i32_sub(i.getLocal("p"),i.i32_const(1))),i.block(i.loop(i.br_if(1,i.i32_eqz(i.getLocal("p"))),i.call(b+"_double",i.getLocal("pAcc"),i.getLocal("pAcc")),i.setLocal("p",i.i32_sub(i.getLocal("p"),i.i32_const(1))),i.br(0))),i.call(b+"_add",i.getLocal("pTable"),i.getLocal("pAcc"),i.getLocal("pTable"))),(j=a.addFunction(c+"_chunk")).addParam("pBases","i32"),j.addParam("pScalars","i32"),j.addParam("scalarSize","i32"),j.addParam("n","i32"),j.addParam("startBit","i32"),j.addParam("chunkSize","i32"),j.addParam("pr","i32"),j.addLocal("nChunks","i32"),j.addLocal("itScalar","i32"),j.addLocal("endScalar","i32"),j.addLocal("itBase","i32"),j.addLocal("i","i32"),j.addLocal("j","i32"),j.addLocal("nTable","i32"),j.addLocal("pTable","i32"),j.addLocal("idx","i32"),j.addLocal("pIdxTable","i32"),k=j.getCodeBuilder(),j.addCode(k.if(k.i32_eqz(k.getLocal("n")),[...k.call(b+"_zero",k.getLocal("pr")),...k.ret([])]),k.setLocal("nTable",k.i32_shl(k.i32_const(1),k.getLocal("chunkSize"))),k.setLocal("pTable",k.i32_load(k.i32_const(0))),k.i32_store(k.i32_const(0),k.i32_add(k.getLocal("pTable"),k.i32_mul(k.getLocal("nTable"),k.i32_const(p)))),k.setLocal("j",k.i32_const(0)),k.block(k.loop(k.br_if(1,k.i32_eq(k.getLocal("j"),k.getLocal("nTable"))),k.call(b+"_zero",k.i32_add(k.getLocal("pTable"),k.i32_mul(k.getLocal("j"),k.i32_const(p)))),k.setLocal("j",k.i32_add(k.getLocal("j"),k.i32_const(1))),k.br(0))),k.setLocal("itBase",k.getLocal("pBases")),k.setLocal("itScalar",k.getLocal("pScalars")),k.setLocal("endScalar",k.i32_add(k.getLocal("pScalars"),k.i32_mul(k.getLocal("n"),k.getLocal("scalarSize")))),k.block(k.loop(k.br_if(1,k.i32_eq(k.getLocal("itScalar"),k.getLocal("endScalar"))),k.setLocal("idx",k.call(c+"_getChunk",k.getLocal("itScalar"),k.getLocal("scalarSize"),k.getLocal("startBit"),k.getLocal("chunkSize"))),k.if(k.getLocal("idx"),[...k.setLocal("pIdxTable",k.i32_add(k.getLocal("pTable"),k.i32_mul(k.i32_sub(k.getLocal("idx"),k.i32_const(1)),k.i32_const(p)))),...k.call(d,k.getLocal("pIdxTable"),k.getLocal("itBase"),k.getLocal("pIdxTable"))]),k.setLocal("itScalar",k.i32_add(k.getLocal("itScalar"),k.getLocal("scalarSize"))),k.setLocal("itBase",k.i32_add(k.getLocal("itBase"),k.i32_const(e))),k.br(0))),k.call(c+"_reduceTable",k.getLocal("pTable"),k.getLocal("chunkSize")),k.call(b+"_copy",k.getLocal("pTable"),k.getLocal("pr")),k.i32_store(k.i32_const(0),k.getLocal("pTable"))),(l=a.addFunction(c)).addParam("pBases","i32"),l.addParam("pScalars","i32"),l.addParam("scalarSize","i32"),l.addParam("n","i32"),l.addParam("pr","i32"),l.addLocal("chunkSize","i32"),l.addLocal("nChunks","i32"),l.addLocal("itScalar","i32"),l.addLocal("endScalar","i32"),l.addLocal("itBase","i32"),l.addLocal("itBit","i32"),l.addLocal("i","i32"),l.addLocal("j","i32"),l.addLocal("nTable","i32"),l.addLocal("pTable","i32"),l.addLocal("idx","i32"),l.addLocal("pIdxTable","i32"),n=(m=l.getCodeBuilder()).i32_const(a.alloc(p)),o=a.alloc([17,17,17,17,17,17,17,17,17,17,16,16,15,14,13,13,12,11,10,9,8,7,7,6,5,4,3,2,1,1,1,1]),l.addCode(m.call(b+"_zero",m.getLocal("pr")),m.if(m.i32_eqz(m.getLocal("n")),m.ret([])),m.setLocal("chunkSize",m.i32_load8_u(m.i32_clz(m.getLocal("n")),o)),m.setLocal("nChunks",m.i32_add(m.i32_div_u(m.i32_sub(m.i32_shl(m.getLocal("scalarSize"),m.i32_const(3)),m.i32_const(1)),m.getLocal("chunkSize")),m.i32_const(1))),m.setLocal("itBit",m.i32_mul(m.i32_sub(m.getLocal("nChunks"),m.i32_const(1)),m.getLocal("chunkSize"))),m.block(m.loop(m.br_if(1,m.i32_lt_s(m.getLocal("itBit"),m.i32_const(0))),m.if(m.i32_eqz(m.call(b+"_isZero",m.getLocal("pr"))),[...m.setLocal("j",m.i32_const(0)),...m.block(m.loop(m.br_if(1,m.i32_eq(m.getLocal("j"),m.getLocal("chunkSize"))),m.call(b+"_double",m.getLocal("pr"),m.getLocal("pr")),m.setLocal("j",m.i32_add(m.getLocal("j"),m.i32_const(1))),m.br(0)))]),m.call(c+"_chunk",m.getLocal("pBases"),m.getLocal("pScalars"),m.getLocal("scalarSize"),m.getLocal("n"),m.getLocal("itBit"),m.getLocal("chunkSize"),n),m.call(b+"_add",m.getLocal("pr"),n,m.getLocal("pr")),m.setLocal("itBit",m.i32_sub(m.getLocal("itBit"),m.getLocal("chunkSize"))),m.br(0)))),a.exportFunction(c),a.exportFunction(c+"_chunk")}},3049:(a,b,c)=>{let d=c(3140),e=c(8614),f=c(6169),g=c(1357),h=c(3900),i=c(2509),j=c(8558),k=c(6681),l=c(7456),m=c(7027),{bitLength:n,modInv:o,isOdd:p,isNegative:q}=c(2090);a.exports=function(a,b){let c,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW,aX,aY,aZ,a$,a_,a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b$,b_,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA=b||"bn128";if(a.modules[cA])return cA;let cB=Math.floor((n(0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n-1n)-1)/64)+1,cC=8*cB,cD=2*cC,cE=12*cC,cF=a.alloc(d.bigInt2BytesLE(0x30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f0000001n,cC)),cG=e(a,0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n,"f1m");f(a,0x30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f0000001n,"fr","frm");let cH=a.alloc(d.bigInt2BytesLE(cN(3n),cC)),cI=i(a,"g1m","f1m",cH);j(a,"frm","frm","frm","frm_mul"),k(a,"pol","frm"),l(a,"qap","frm");let cJ=g(a,"f1m_neg","f2m","f1m"),cK=a.alloc([...d.bigInt2BytesLE(cN(0x2b149d40ceb8aaae81be18991be06ac3b5b4c5e559dbefa33267e6dc24a138e5n),cC),...d.bigInt2BytesLE(cN(0x9713b03af0fed4cd2cafadeed8fdf4a74fa084e52d1852e4a2bd0685c315d2n),cC)]),cL=i(a,"g2m","f2m",cK);function cM(b,c){let d=a.addFunction(b);d.addParam("pG","i32"),d.addParam("pFr","i32"),d.addParam("pr","i32");let e=d.getCodeBuilder(),f=e.i32_const(a.alloc(cC));d.addCode(e.call("frm_fromMontgomery",e.getLocal("pFr"),f),e.call(c,e.getLocal("pG"),f,e.i32_const(cC),e.getLocal("pr"))),a.exportFunction(b)}function cN(a){return BigInt(a)*(1n<<BigInt(8*cC))%0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n}cM("g1m_timesFr","g1m_timesScalar"),j(a,"g1m","g1m","frm","g1m_timesFr"),cM("g2m_timesFr","g2m_timesScalar"),j(a,"g2m","g2m","frm","g2m_timesFr"),cM("g1m_timesFrAffine","g1m_timesScalarAffine"),cM("g2m_timesFrAffine","g2m_timesScalarAffine"),m(a,"frm_batchApplyKey","fmr","frm",cC,cC,cC,"frm_mul"),m(a,"g1m_batchApplyKey","g1m","frm",3*cC,3*cC,cC,"g1m_timesFr"),m(a,"g1m_batchApplyKeyMixed","g1m","frm",2*cC,3*cC,cC,"g1m_timesFrAffine"),m(a,"g2m_batchApplyKey","g2m","frm",2*cC*3,3*cC*2,cC,"g2m_timesFr"),m(a,"g2m_batchApplyKeyMixed","g2m","frm",2*cC*2,3*cC*2,cC,"g2m_timesFrAffine");let cO=a.alloc([...d.bigInt2BytesLE(cN(1n),cC),...d.bigInt2BytesLE(cN(2n),cC),...d.bigInt2BytesLE(cN(1n),cC)]),cP=a.alloc([...d.bigInt2BytesLE(cN(0n),cC),...d.bigInt2BytesLE(cN(1n),cC),...d.bigInt2BytesLE(cN(0n),cC)]),cQ=[[0x1800deef121f1e76426a00665e5c4479674322d4f75edadd46debd5cd992f6edn,0x198e9393920d483a7260bfb731fb5d25f1aa493335a9e71297e485b7aef312c2n],[0x12c85ea5db8c6deb4aab71808dcb408fe3d1e7690c43d37b4ce6cc0166fa7daan,0x90689d0585ff075ec9e99ad690c3395bc4b313370b38ef355acdadcd122975bn],[1n,0n]],cR=a.alloc([...d.bigInt2BytesLE(cN(cQ[0][0]),cC),...d.bigInt2BytesLE(cN(cQ[0][1]),cC),...d.bigInt2BytesLE(cN(cQ[1][0]),cC),...d.bigInt2BytesLE(cN(cQ[1][1]),cC),...d.bigInt2BytesLE(cN(cQ[2][0]),cC),...d.bigInt2BytesLE(cN(cQ[2][1]),cC)]),cS=[[0n,0n],[1n,0n],[0n,0n]],cT=a.alloc([...d.bigInt2BytesLE(cN(cS[0][0]),cC),...d.bigInt2BytesLE(cN(cS[0][1]),cC),...d.bigInt2BytesLE(cN(cS[1][0]),cC),...d.bigInt2BytesLE(cN(cS[1][1]),cC),...d.bigInt2BytesLE(cN(cS[2][0]),cC),...d.bigInt2BytesLE(cN(cS[2][1]),cC)]),cU=a.alloc([...d.bigInt2BytesLE(cN(1),cC),...d.bigInt2BytesLE(cN(0),cC),...d.bigInt2BytesLE(cN(0),cC),...d.bigInt2BytesLE(cN(0),cC),...d.bigInt2BytesLE(cN(0),cC),...d.bigInt2BytesLE(cN(0),cC),...d.bigInt2BytesLE(cN(0),cC),...d.bigInt2BytesLE(cN(0),cC),...d.bigInt2BytesLE(cN(0),cC),...d.bigInt2BytesLE(cN(0),cC),...d.bigInt2BytesLE(cN(0),cC),...d.bigInt2BytesLE(cN(0),cC)]),cV=a.alloc([...d.bigInt2BytesLE(cN(9),cC),...d.bigInt2BytesLE(cN(1),cC)]),cW=a.alloc([...d.bigInt2BytesLE(cN(o(2n,0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n)),cC),...d.bigInt2BytesLE(0n,cC)]),cX=a.alloc([...d.bigInt2BytesLE(cN(0x2b149d40ceb8aaae81be18991be06ac3b5b4c5e559dbefa33267e6dc24a138e5n),cC),...d.bigInt2BytesLE(cN(0x9713b03af0fed4cd2cafadeed8fdf4a74fa084e52d1852e4a2bd0685c315d2n),cC)]);(c=a.addFunction(cA+"_mulNR6")).addParam("x","i32"),c.addParam("pr","i32"),r=c.getCodeBuilder(),c.addCode(r.call(cJ+"_mul",r.i32_const(cV),r.getLocal("x"),r.getLocal("pr")));let cY=h(a,cA+"_mulNR6","f6m","f2m");(s=a.addFunction(cA+"_mulNR12")).addParam("x","i32"),s.addParam("pr","i32"),t=s.getCodeBuilder(),s.addCode(t.call(cJ+"_mul",t.i32_const(cV),t.i32_add(t.getLocal("x"),t.i32_const(4*cC)),t.getLocal("pr")),t.call(cJ+"_copy",t.getLocal("x"),t.i32_add(t.getLocal("pr"),t.i32_const(2*cC))),t.call(cJ+"_copy",t.i32_add(t.getLocal("x"),t.i32_const(2*cC)),t.i32_add(t.getLocal("pr"),t.i32_const(4*cC))));let cZ=g(a,cA+"_mulNR12","ftm",cY),c$=function(a){let b=0x19d797039be763ba8n,c=[];for(;b>0n;)p(b)?c.push(1):c.push(0),b>>=1n;return c}(0x19d797039be763ba8n),c_=a.alloc(c$),c0=3*cD,c1=c$.length-1,c2=c$.reduce((a,b)=>a+ +(0!=b),0),c3=6*cC,c4=3*cC*2+(c2+c1+1)*c0;a.modules[cA]={n64:cB,pG1gen:cO,pG1zero:cP,pG1b:cH,pG2gen:cR,pG2zero:cT,pG2b:cK,pq:a.modules.f1m.pq,pr:cF,pOneT:cU,prePSize:c3,preQSize:c4,r:0x30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f0000001n.toString(),q:0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n.toString()};let c5=a.alloc(c3),c6=a.alloc(c4);(u=a.addFunction(cA+"_prepAddStep")).addParam("pQ","i32"),u.addParam("pR","i32"),u.addParam("pCoef","i32"),w=(v=u.getCodeBuilder()).getLocal("pQ"),x=v.i32_add(v.getLocal("pQ"),v.i32_const(cD)),y=v.getLocal("pR"),z=v.i32_add(v.getLocal("pR"),v.i32_const(cD)),A=v.i32_add(v.getLocal("pR"),v.i32_const(2*cD)),B=v.getLocal("pCoef"),C=v.i32_add(v.getLocal("pCoef"),v.i32_const(cD)),D=v.i32_add(v.getLocal("pCoef"),v.i32_const(2*cD)),E=v.i32_const(a.alloc(cD)),F=v.i32_const(a.alloc(cD)),G=v.i32_const(a.alloc(cD)),H=v.i32_const(a.alloc(cD)),I=v.i32_const(a.alloc(cD)),J=v.i32_const(a.alloc(cD)),K=v.i32_const(a.alloc(cD)),u.addCode(v.call(cJ+"_mul",w,A,C),v.call(cJ+"_sub",y,C,C),v.call(cJ+"_mul",x,A,E),v.call(cJ+"_sub",z,E,E),v.call(cJ+"_square",C,F),v.call(cJ+"_square",E,G),v.call(cJ+"_mul",C,F,H),v.call(cJ+"_mul",y,F,I),v.call(cJ+"_add",I,I,K),v.call(cJ+"_mul",A,G,J),v.call(cJ+"_add",H,J,J),v.call(cJ+"_sub",J,K,J),v.call(cJ+"_mul",C,J,y),v.call(cJ+"_mul",H,z,z),v.call(cJ+"_sub",I,J,K),v.call(cJ+"_mul",E,K,K),v.call(cJ+"_sub",K,z,z),v.call(cJ+"_mul",A,H,A),v.call(cJ+"_mul",C,x,K),v.call(cJ+"_mul",E,w,B),v.call(cJ+"_sub",B,K,B),v.call(cJ+"_mul",B,v.i32_const(cV),B),v.call(cJ+"_neg",E,D)),(L=a.addFunction(cA+"_prepDblStep")).addParam("pR","i32"),L.addParam("pCoef","i32"),N=(M=L.getCodeBuilder()).getLocal("pR"),O=M.i32_add(M.getLocal("pR"),M.i32_const(cD)),P=M.i32_add(M.getLocal("pR"),M.i32_const(2*cD)),Q=M.getLocal("pCoef"),R=M.i32_add(M.getLocal("pCoef"),M.i32_const(cD)),S=M.i32_add(M.getLocal("pCoef"),M.i32_const(2*cD)),T=M.i32_const(a.alloc(cD)),U=M.i32_const(a.alloc(cD)),V=M.i32_const(a.alloc(cD)),W=M.i32_const(a.alloc(cD)),X=M.i32_const(a.alloc(cD)),Y=M.i32_const(a.alloc(cD)),Z=M.i32_const(a.alloc(cD)),$=M.i32_const(a.alloc(cD)),_=M.i32_const(a.alloc(cD)),aa=M.i32_const(a.alloc(cD)),ab=M.i32_const(a.alloc(cD)),ac=M.i32_const(a.alloc(cD)),L.addCode(M.call(cJ+"_mul",O,M.i32_const(cW),T),M.call(cJ+"_mul",N,T,T),M.call(cJ+"_square",O,U),M.call(cJ+"_square",P,V),M.call(cJ+"_add",V,V,W),M.call(cJ+"_add",W,V,W),M.call(cJ+"_mul",M.i32_const(cX),W,X),M.call(cJ+"_add",X,X,Y),M.call(cJ+"_add",X,Y,Y),M.call(cJ+"_add",U,Y,Z),M.call(cJ+"_mul",Z,M.i32_const(cW),Z),M.call(cJ+"_add",U,V,ac),M.call(cJ+"_add",O,P,$),M.call(cJ+"_square",$,$),M.call(cJ+"_sub",$,ac,$),M.call(cJ+"_sub",X,U,_),M.call(cJ+"_square",N,aa),M.call(cJ+"_square",X,ab),M.call(cJ+"_sub",U,Y,ac),M.call(cJ+"_mul",T,ac,N),M.call(cJ+"_add",ab,ab,ac),M.call(cJ+"_add",ab,ac,ac),M.call(cJ+"_square",Z,O),M.call(cJ+"_sub",O,ac,O),M.call(cJ+"_mul",U,$,P),M.call(cJ+"_mul",M.i32_const(cV),_,Q),M.call(cJ+"_neg",$,R),M.call(cJ+"_add",aa,aa,S),M.call(cJ+"_add",aa,S,S)),(ad=a.addFunction(cA+"_prepareG1")).addParam("pP","i32"),ad.addParam("ppreP","i32"),ae=ad.getCodeBuilder(),ad.addCode(ae.call(cI+"_normalize",ae.getLocal("pP"),ae.getLocal("ppreP"))),(af=a.addFunction(cA+"_mulByQ")).addParam("p1","i32"),af.addParam("pr","i32"),ah=(ag=af.getCodeBuilder()).getLocal("p1"),ai=ag.i32_add(ag.getLocal("p1"),ag.i32_const(cD)),aj=ag.i32_add(ag.getLocal("p1"),ag.i32_const(2*cD)),ak=ag.getLocal("pr"),al=ag.i32_add(ag.getLocal("pr"),ag.i32_const(cD)),am=ag.i32_add(ag.getLocal("pr"),ag.i32_const(2*cD)),an=ag.i32_const(a.alloc([...d.bigInt2BytesLE(cN("21575463638280843010398324269430826099269044274347216827212613867836435027261"),cC),...d.bigInt2BytesLE(cN("10307601595873709700152284273816112264069230130616436755625194854815875713954"),cC)])),ao=ag.i32_const(a.alloc([...d.bigInt2BytesLE(cN("2821565182194536844548159561693502659359617185244120367078079554186484126554"),cC),...d.bigInt2BytesLE(cN("3505843767911556378687030309984248845540243509899259641013678093033130930403"),cC)])),af.addCode(ag.call(cJ+"_conjugate",ah,ak),ag.call(cJ+"_mul",an,ak,ak),ag.call(cJ+"_conjugate",ai,al),ag.call(cJ+"_mul",ao,al,al),ag.call(cJ+"_conjugate",aj,am)),(ap=a.addFunction(cA+"_prepareG2")).addParam("pQ","i32"),ap.addParam("ppreQ","i32"),ap.addLocal("pCoef","i32"),ap.addLocal("i","i32"),ar=(aq=ap.getCodeBuilder()).getLocal("pQ"),as=a.alloc(3*cD),at=aq.i32_const(as),au=aq.i32_const(as),av=aq.i32_const(as+cD),aw=aq.i32_const(as+2*cD),ax=aq.i32_add(aq.getLocal("ppreQ"),aq.i32_const(0)),ay=aq.i32_add(aq.getLocal("ppreQ"),aq.i32_const(cD)),az=a.alloc(3*cD),aA=aq.i32_const(az),aB=a.alloc(3*cD),aC=aq.i32_const(aB),aD=aq.i32_const(aB+cD),ap.addCode(aq.call(cL+"_normalize",ar,ax),aq.call(cJ+"_copy",ax,au),aq.call(cJ+"_copy",ay,av),aq.call(cJ+"_one",aw)),ap.addCode(aq.setLocal("pCoef",aq.i32_add(aq.getLocal("ppreQ"),aq.i32_const(3*cD))),aq.setLocal("i",aq.i32_const(c$.length-2)),aq.block(aq.loop(aq.call(cA+"_prepDblStep",at,aq.getLocal("pCoef")),aq.setLocal("pCoef",aq.i32_add(aq.getLocal("pCoef"),aq.i32_const(c0))),aq.if(aq.i32_load8_s(aq.getLocal("i"),c_),[...aq.call(cA+"_prepAddStep",ax,at,aq.getLocal("pCoef")),...aq.setLocal("pCoef",aq.i32_add(aq.getLocal("pCoef"),aq.i32_const(c0)))]),aq.br_if(1,aq.i32_eqz(aq.getLocal("i"))),aq.setLocal("i",aq.i32_sub(aq.getLocal("i"),aq.i32_const(1))),aq.br(0)))),ap.addCode(aq.call(cA+"_mulByQ",ax,aA),aq.call(cA+"_mulByQ",aA,aC)),ap.addCode(aq.call(cJ+"_neg",aD,aD),aq.call(cA+"_prepAddStep",aA,at,aq.getLocal("pCoef")),aq.setLocal("pCoef",aq.i32_add(aq.getLocal("pCoef"),aq.i32_const(c0))),aq.call(cA+"_prepAddStep",aC,at,aq.getLocal("pCoef")),aq.setLocal("pCoef",aq.i32_add(aq.getLocal("pCoef"),aq.i32_const(c0)))),(aE=a.addFunction(cA+"__mulBy024")).addParam("pEll0","i32"),aE.addParam("pEllVW","i32"),aE.addParam("pEllVV","i32"),aE.addParam("pR","i32"),aG=(aF=aE.getCodeBuilder()).getLocal("pEll0"),aH=aF.getLocal("pEllVV"),aI=aF.getLocal("pEllVW"),aJ=aF.getLocal("pR"),aK=aF.i32_add(aF.getLocal("pR"),aF.i32_const(2*cC)),aL=aF.i32_add(aF.getLocal("pR"),aF.i32_const(4*cC)),aM=aF.i32_add(aF.getLocal("pR"),aF.i32_const(6*cC)),aN=aF.i32_add(aF.getLocal("pR"),aF.i32_const(8*cC)),aO=aF.i32_add(aF.getLocal("pR"),aF.i32_const(10*cC)),aP=aF.i32_const(a.alloc(cD)),aQ=aF.i32_const(a.alloc(cD)),aR=aF.i32_const(a.alloc(cD)),aS=aF.i32_const(a.alloc(cD)),aT=aF.i32_const(a.alloc(cD)),aU=aF.i32_const(a.alloc(cD)),aV=aF.i32_const(a.alloc(cD)),aW=aF.i32_const(a.alloc(cD)),aX=aF.i32_const(a.alloc(cD)),aY=aF.i32_const(a.alloc(cD)),aZ=aF.i32_const(a.alloc(cD)),aE.addCode(aF.call(cJ+"_mul",aJ,aG,aV),aF.call(cJ+"_mul",aL,aH,aW),aF.call(cJ+"_mul",aN,aI,aX),aF.call(cJ+"_add",aJ,aN,aR),aF.call(cJ+"_add",aJ,aL,aQ),aF.call(cJ+"_add",aK,aM,aS),aF.call(cJ+"_add",aS,aO,aS),aF.call(cJ+"_mul",aK,aH,aY),aF.call(cJ+"_add",aY,aX,aT),aF.call(cJ+"_mul",aF.i32_const(cV),aT,aU),aF.call(cJ+"_add",aU,aV,aJ),aF.call(cJ+"_mul",aO,aI,aT),aF.call(cJ+"_add",aY,aT,aY),aF.call(cJ+"_add",aT,aW,aT),aF.call(cJ+"_mul",aF.i32_const(cV),aT,aU),aF.call(cJ+"_mul",aK,aG,aT),aF.call(cJ+"_add",aY,aT,aY),aF.call(cJ+"_add",aU,aT,aK),aF.call(cJ+"_add",aG,aH,aP),aF.call(cJ+"_mul",aQ,aP,aT),aF.call(cJ+"_add",aV,aW,aZ),aF.call(cJ+"_sub",aT,aZ,aT),aF.call(cJ+"_mul",aM,aI,aU),aF.call(cJ+"_add",aY,aU,aY),aF.call(cJ+"_add",aL,aN,aP),aF.call(cJ+"_add",aT,aU,aL),aF.call(cJ+"_add",aH,aI,aQ),aF.call(cJ+"_mul",aQ,aP,aT),aF.call(cJ+"_add",aW,aX,aZ),aF.call(cJ+"_sub",aT,aZ,aT),aF.call(cJ+"_mul",aF.i32_const(cV),aT,aU),aF.call(cJ+"_mul",aM,aG,aT),aF.call(cJ+"_add",aY,aT,aY),aF.call(cJ+"_add",aU,aT,aM),aF.call(cJ+"_mul",aO,aH,aT),aF.call(cJ+"_add",aY,aT,aY),aF.call(cJ+"_mul",aF.i32_const(cV),aT,aU),aF.call(cJ+"_add",aG,aI,aP),aF.call(cJ+"_mul",aR,aP,aT),aF.call(cJ+"_add",aV,aX,aZ),aF.call(cJ+"_sub",aT,aZ,aT),aF.call(cJ+"_add",aU,aT,aN),aF.call(cJ+"_add",aG,aH,aP),aF.call(cJ+"_add",aP,aI,aP),aF.call(cJ+"_mul",aS,aP,aT),aF.call(cJ+"_sub",aT,aY,aO)),(a$=a.addFunction(cA+"__mulBy024Old")).addParam("pEll0","i32"),a$.addParam("pEllVW","i32"),a$.addParam("pEllVV","i32"),a$.addParam("pR","i32"),a0=(a_=a$.getCodeBuilder()).getLocal("pEll0"),a1=a_.getLocal("pEllVV"),a2=a_.getLocal("pEllVW"),a3=a_.getLocal("pR"),a4=a.alloc(cE),a5=a_.i32_const(a4),a6=a_.i32_const(a4),a7=a_.i32_const(a4+cD),a8=a_.i32_const(a4+2*cD),a9=a_.i32_const(a4+3*cD),ba=a_.i32_const(a4+4*cD),bb=a_.i32_const(a4+5*cD),a$.addCode(a_.call(cJ+"_copy",a0,a6),a_.call(cJ+"_zero",a7),a_.call(cJ+"_copy",a1,a8),a_.call(cJ+"_zero",a9),a_.call(cJ+"_copy",a2,ba),a_.call(cJ+"_zero",bb),a_.call(cZ+"_mul",a5,a3,a3)),(bc=a.addFunction(cA+"_millerLoop")).addParam("ppreP","i32"),bc.addParam("ppreQ","i32"),bc.addParam("r","i32"),bc.addLocal("pCoef","i32"),bc.addLocal("i","i32"),be=(bd=bc.getCodeBuilder()).getLocal("ppreP"),bf=bd.i32_add(bd.getLocal("ppreP"),bd.i32_const(cC)),bg=bd.getLocal("pCoef"),bh=bd.i32_add(bd.getLocal("pCoef"),bd.i32_const(cD)),bi=bd.i32_add(bd.getLocal("pCoef"),bd.i32_const(2*cD)),bj=a.alloc(cD),bk=bd.i32_const(bj),bl=a.alloc(cD),bm=bd.i32_const(bl),bn=bd.getLocal("r"),bc.addCode(bd.call(cZ+"_one",bn),bd.setLocal("pCoef",bd.i32_add(bd.getLocal("ppreQ"),bd.i32_const(3*cD))),bd.setLocal("i",bd.i32_const(c$.length-2)),bd.block(bd.loop(bd.call(cZ+"_square",bn,bn),bd.call(cJ+"_mul1",bh,bf,bk),bd.call(cJ+"_mul1",bi,be,bm),bd.call(cA+"__mulBy024",bg,bk,bm,bn),bd.setLocal("pCoef",bd.i32_add(bd.getLocal("pCoef"),bd.i32_const(c0))),bd.if(bd.i32_load8_s(bd.getLocal("i"),c_),[...bd.call(cJ+"_mul1",bh,bf,bk),...bd.call(cJ+"_mul1",bi,be,bm),...bd.call(cA+"__mulBy024",bg,bk,bm,bn),...bd.setLocal("pCoef",bd.i32_add(bd.getLocal("pCoef"),bd.i32_const(c0)))]),bd.br_if(1,bd.i32_eqz(bd.getLocal("i"))),bd.setLocal("i",bd.i32_sub(bd.getLocal("i"),bd.i32_const(1))),bd.br(0)))),bc.addCode(bd.call(cJ+"_mul1",bh,bf,bk),bd.call(cJ+"_mul1",bi,be,bm),bd.call(cA+"__mulBy024",bg,bk,bm,bn),bd.setLocal("pCoef",bd.i32_add(bd.getLocal("pCoef"),bd.i32_const(c0))),bd.call(cJ+"_mul1",bh,bf,bk),bd.call(cJ+"_mul1",bi,be,bm),bd.call(cA+"__mulBy024",bg,bk,bm,bn),bd.setLocal("pCoef",bd.i32_add(bd.getLocal("pCoef"),bd.i32_const(c0))));for(let b=0;b<10;b++)!function(b){let c=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0x1284b71c2865a7dfe8b99fdd76e68b605c521e08292f2176d60b35dadcc9e470n,0x246996f3b4fae7e6a6327cfe12150b8e747992778eeec7e5ca5cf05f80f362acn],[0x30644e72e131a0295e6dd9e7e0acccb0c28f069fbb966e3de4bd44e5607cfd49n,0n],[0x19dc81cfcc82e4bbefe9608cd0acaa90894cb38dbe55d24ae86f7d391ed4a67fn,0xabf8b60be77d7306cbeee33576139d7f03a5e397d439ec7694aa2bf4c0c101n],[0x30644e72e131a0295e6dd9e7e0acccb0c28f069fbb966e3de4bd44e5607cfd48n,0n],[0x757cab3a41d3cdc072fc0af59c61f302cfa95859526b0d41264475e420ac20fn,0xca6b035381e35b618e9b79ba4e2606ca20b7dfd71573c93e85845e34c4a5b9cn],[0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd46n,0n],[0x1ddf9756b8cbf849cf96a5d90a9accfd3b2f4c893f42a9166615563bfbb318d7n,0xbfab77f2c36b843121dc8b86f6c4ccf2307d819d98302a771c39bb757899a9bn],[0x59e26bcea0d48bacd4f263f1acdb5c4f5763473177fffffen,0n],[0x1687cca314aebb6dc866e529b0d4adcd0e34b703aa1bf84253b10eddb9a856c8n,0x2fb855bcd54a22b6b18456d34c0b44c0187dc4add09d90a0c58be1eae3bc3c46n],[0x59e26bcea0d48bacd4f263f1acdb5c4f5763473177ffffffn,0n],[0x290c83bf3d14634db120850727bb392d6a86d50bd34b19b929bc44b896723b38n,0x23bd9e3da9136a739f668e1adc9ef7f0f575ec93f71a8df953c846338c32a1abn]]],e=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0x2fb347984f7911f74c0bec3cf559b143b78cc310c2c3330c99e39557176f553dn,0x16c9e55061ebae204ba4cc8bd75a079432ae2a1d0b7c9dce1665d51c640fcba2n],[0x30644e72e131a0295e6dd9e7e0acccb0c28f069fbb966e3de4bd44e5607cfd48n,0n],[0x856e078b755ef0abaff1c77959f25ac805ffd3d5d6942d37b746ee87bdcfb6dn,0x4f1de41b3d1766fa9f30e6dec26094f0fdf31bf98ff2631380cab2baaa586den],[0x59e26bcea0d48bacd4f263f1acdb5c4f5763473177fffffen,0n],[0x28be74d4bb943f51699582b87809d9caf71614d4b0b71f3a62e913ee1dada9e4n,0x14a88ae0cb747b99c2b86abcbe01477a54f40eb4c3f6068dedae0bcec9c7aac7n]],[[1n,0n],[0x5b54f5e64eea80180f3c0b75a181e84d33365f7be94ec72848a1f55921ea762n,0x2c145edbe7fd8aee9f3a80b03b0b1c923685d2ea1bdec763c13b4711cd2b8126n],[0x59e26bcea0d48bacd4f263f1acdb5c4f5763473177fffffen,0n],[0xbc58c6611c08dab19bee0f7b5b2444ee633094575b06bcb0e1a92bc3ccbf066n,0x23d5e999e1910a12feb0f6ef0cd21d04a44a9e08737f96e55fe3ed9d730c239fn],[0x30644e72e131a0295e6dd9e7e0acccb0c28f069fbb966e3de4bd44e5607cfd48n,0n],[0x1ee972ae6a826a7d1d9da40771b6f589de1afb54342c724fa97bda050992657fn,0x10de546ff8d4ab51d2b513cdbb25772454326430418536d15721e37e70c255c9n]]],f=a.addFunction(cA+"__frobeniusMap"+b);f.addParam("x","i32"),f.addParam("r","i32");let g=f.getCodeBuilder();for(let h=0;h<6;h++){let i=0==h?g.getLocal("x"):g.i32_add(g.getLocal("x"),g.i32_const(h*cD)),j=g.i32_add(g.getLocal("x"),g.i32_const(h*cD+cC)),k=0==h?g.getLocal("r"):g.i32_add(g.getLocal("r"),g.i32_const(h*cD)),l=g.i32_add(g.getLocal("r"),g.i32_const(h*cD+cC)),m=function(a,b){let c=BigInt(a[0]),d=BigInt(a[1]),e=BigInt(b[0]),f=BigInt(b[1]),g=[(c*e-d*f)%0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n,(c*f+d*e)%0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n];return q(g[0])&&(g[0]=g[0]+0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n),g}(c[Math.floor(h/3)][b%12],e[h%3][b%6]),n=a.alloc([...d.bigInt2BytesLE(cN(m[0]),32),...d.bigInt2BytesLE(cN(m[1]),32)]);b%2==1?f.addCode(g.call(cG+"_copy",i,k),g.call(cG+"_neg",j,l),g.call(cJ+"_mul",k,g.i32_const(n),k)):f.addCode(g.call(cJ+"_mul",i,g.i32_const(n),k))}}(b),a.exportFunction(cA+"__frobeniusMap"+b);(bo=a.addFunction(cA+"_finalExponentiationOld")).addParam("x","i32"),bo.addParam("r","i32"),bp=a.alloc(d.bigInt2BytesLE(0x2f4b6dc97020fddadf107d20bc842d43bf6369b1ff6a1c71015f3f7be2e1e30a73bb94fec0daf15466b2383a5d3ec3d15ad524d8f70c54efee1bd8c3b21377e563a09a1b705887e72eceaddea3790364a61f676baaf977870e88d5c6c8fef0781361e443ae77f5b63a2a2264487f2940a8b1ddb3d15062cd0fb2015dfc6668449aed3cc48a82d0d602d268c7daab6a41294c0cc4ebe5664568dfc50e1648a45a4a1e3a5195846a3ed011a337a02088ec80e0ebae8755cfe107acf3aafb40494e406f804216bb10cf430b0f37856b42db8dc5514724ee93dfb10826f0dd4a0364b9580291d2cd65664814fde37ca80bb4ea44eacc5e641bbadf423f9a2cbf813b8d145da90029baee7ddadda71c7f3811c4105262945bba1668c3be69a3c230974d83561841d766f9c9d570bb7fbe04c7e8a6c3c760c0de81def35692da361102b6b9b2b918837fa97896e84abb40a4efb7e54523a486964b64ca86f120n,352)),bq=bo.getCodeBuilder(),bo.addCode(bq.call(cZ+"_exp",bq.getLocal("x"),bq.i32_const(bp),bq.i32_const(352),bq.getLocal("r"))),(br=a.addFunction(cA+"__finalExponentiationFirstChunk")).addParam("x","i32"),br.addParam("r","i32"),bt=(bs=br.getCodeBuilder()).getLocal("x"),bu=bs.i32_add(bt,bs.i32_const(6*cC)),bv=bs.getLocal("r"),bw=a.alloc(cE),bx=bs.i32_const(bw),by=bs.i32_const(bw+6*cC),bz=bs.i32_const(a.alloc(cE)),bA=bs.i32_const(a.alloc(cE)),bB=bs.i32_const(a.alloc(cE)),br.addCode(bs.call(cY+"_copy",bt,bx),bs.call(cY+"_neg",bu,by),bs.call(cZ+"_inverse",bt,bz),bs.call(cZ+"_mul",bx,bz,bA),bs.call(cA+"__frobeniusMap2",bA,bB),bs.call(cZ+"_mul",bA,bB,bv)),(bC=a.addFunction(cA+"__cyclotomicSquare")).addParam("x","i32"),bC.addParam("r","i32"),bE=(bD=bC.getCodeBuilder()).getLocal("x"),bF=bD.i32_add(bD.getLocal("x"),bD.i32_const(cD)),bG=bD.i32_add(bD.getLocal("x"),bD.i32_const(2*cD)),bH=bD.i32_add(bD.getLocal("x"),bD.i32_const(3*cD)),bI=bD.i32_add(bD.getLocal("x"),bD.i32_const(4*cD)),bJ=bD.i32_add(bD.getLocal("x"),bD.i32_const(5*cD)),bK=bD.getLocal("r"),bL=bD.i32_add(bD.getLocal("r"),bD.i32_const(cD)),bM=bD.i32_add(bD.getLocal("r"),bD.i32_const(2*cD)),bN=bD.i32_add(bD.getLocal("r"),bD.i32_const(3*cD)),bO=bD.i32_add(bD.getLocal("r"),bD.i32_const(4*cD)),bP=bD.i32_add(bD.getLocal("r"),bD.i32_const(5*cD)),bQ=bD.i32_const(a.alloc(cD)),bR=bD.i32_const(a.alloc(cD)),bS=bD.i32_const(a.alloc(cD)),bT=bD.i32_const(a.alloc(cD)),bU=bD.i32_const(a.alloc(cD)),bV=bD.i32_const(a.alloc(cD)),bW=bD.i32_const(a.alloc(cD)),bX=bD.i32_const(a.alloc(cD)),bC.addCode(bD.call(cJ+"_mul",bE,bI,bW),bD.call(cJ+"_mul",bI,bD.i32_const(cV),bQ),bD.call(cJ+"_add",bE,bQ,bQ),bD.call(cJ+"_add",bE,bI,bX),bD.call(cJ+"_mul",bX,bQ,bQ),bD.call(cJ+"_mul",bD.i32_const(cV),bW,bX),bD.call(cJ+"_add",bW,bX,bX),bD.call(cJ+"_sub",bQ,bX,bQ),bD.call(cJ+"_add",bW,bW,bR),bD.call(cJ+"_mul",bH,bG,bW),bD.call(cJ+"_mul",bG,bD.i32_const(cV),bS),bD.call(cJ+"_add",bH,bS,bS),bD.call(cJ+"_add",bH,bG,bX),bD.call(cJ+"_mul",bX,bS,bS),bD.call(cJ+"_mul",bD.i32_const(cV),bW,bX),bD.call(cJ+"_add",bW,bX,bX),bD.call(cJ+"_sub",bS,bX,bS),bD.call(cJ+"_add",bW,bW,bT),bD.call(cJ+"_mul",bF,bJ,bW),bD.call(cJ+"_mul",bJ,bD.i32_const(cV),bU),bD.call(cJ+"_add",bF,bU,bU),bD.call(cJ+"_add",bF,bJ,bX),bD.call(cJ+"_mul",bX,bU,bU),bD.call(cJ+"_mul",bD.i32_const(cV),bW,bX),bD.call(cJ+"_add",bW,bX,bX),bD.call(cJ+"_sub",bU,bX,bU),bD.call(cJ+"_add",bW,bW,bV),bD.call(cJ+"_sub",bQ,bE,bK),bD.call(cJ+"_add",bK,bK,bK),bD.call(cJ+"_add",bQ,bK,bK),bD.call(cJ+"_add",bR,bI,bO),bD.call(cJ+"_add",bO,bO,bO),bD.call(cJ+"_add",bR,bO,bO),bD.call(cJ+"_mul",bV,bD.i32_const(cV),bX),bD.call(cJ+"_add",bX,bH,bN),bD.call(cJ+"_add",bN,bN,bN),bD.call(cJ+"_add",bX,bN,bN),bD.call(cJ+"_sub",bU,bG,bM),bD.call(cJ+"_add",bM,bM,bM),bD.call(cJ+"_add",bU,bM,bM),bD.call(cJ+"_sub",bS,bF,bL),bD.call(cJ+"_add",bL,bL,bL),bD.call(cJ+"_add",bS,bL,bL),bD.call(cJ+"_add",bT,bJ,bP),bD.call(cJ+"_add",bP,bP,bP),bD.call(cJ+"_add",bT,bP,bP)),bY=(function(a){let b=0x44e992b44a6909f1n,c=[];for(;b>0n;){if(p(b)){let a=2-Number(b%4n);c.push(a),b-=BigInt(a)}else c.push(0);b>>=1n}return c})(0x44e992b44a6909f1n).map(a=>-1==a?255:a),bZ=a.alloc(bY),(b$=a.addFunction(cA+"__cyclotomicExp_w0")).addParam("x","i32"),b$.addParam("r","i32"),b$.addLocal("bit","i32"),b$.addLocal("i","i32"),b0=(b_=b$.getCodeBuilder()).getLocal("x"),b1=b_.getLocal("r"),b2=b_.i32_const(a.alloc(cE)),b$.addCode(b_.call(cZ+"_conjugate",b0,b2),b_.call(cZ+"_one",b1),b_.if(b_.teeLocal("bit",b_.i32_load8_s(b_.i32_const(bY.length-1),bZ)),b_.if(b_.i32_eq(b_.getLocal("bit"),b_.i32_const(1)),b_.call(cZ+"_mul",b1,b0,b1),b_.call(cZ+"_mul",b1,b2,b1))),b_.setLocal("i",b_.i32_const(bY.length-2)),b_.block(b_.loop(b_.call(cA+"__cyclotomicSquare",b1,b1),b_.if(b_.teeLocal("bit",b_.i32_load8_s(b_.getLocal("i"),bZ)),b_.if(b_.i32_eq(b_.getLocal("bit"),b_.i32_const(1)),b_.call(cZ+"_mul",b1,b0,b1),b_.call(cZ+"_mul",b1,b2,b1))),b_.br_if(1,b_.i32_eqz(b_.getLocal("i"))),b_.setLocal("i",b_.i32_sub(b_.getLocal("i"),b_.i32_const(1))),b_.br(0)))),(b3=a.addFunction(cA+"__finalExponentiationLastChunk")).addParam("x","i32"),b3.addParam("r","i32"),b5=(b4=b3.getCodeBuilder()).getLocal("x"),b6=b4.getLocal("r"),b7=b4.i32_const(a.alloc(cE)),b8=b4.i32_const(a.alloc(cE)),b9=b4.i32_const(a.alloc(cE)),ca=b4.i32_const(a.alloc(cE)),cb=b4.i32_const(a.alloc(cE)),cc=b4.i32_const(a.alloc(cE)),cd=b4.i32_const(a.alloc(cE)),ce=b4.i32_const(a.alloc(cE)),cf=b4.i32_const(a.alloc(cE)),cg=b4.i32_const(a.alloc(cE)),ch=b4.i32_const(a.alloc(cE)),ci=b4.i32_const(a.alloc(cE)),cj=b4.i32_const(a.alloc(cE)),ck=b4.i32_const(a.alloc(cE)),cl=b4.i32_const(a.alloc(cE)),cm=b4.i32_const(a.alloc(cE)),cn=b4.i32_const(a.alloc(cE)),co=b4.i32_const(a.alloc(cE)),cp=b4.i32_const(a.alloc(cE)),cq=b4.i32_const(a.alloc(cE)),cr=b4.i32_const(a.alloc(cE)),b3.addCode(b4.call(cA+"__cyclotomicExp_w0",b5,b7),b4.call(cZ+"_conjugate",b7,b7),b4.call(cA+"__cyclotomicSquare",b7,b8),b4.call(cA+"__cyclotomicSquare",b8,b9),b4.call(cZ+"_mul",b9,b8,ca),b4.call(cA+"__cyclotomicExp_w0",ca,cb),b4.call(cZ+"_conjugate",cb,cb),b4.call(cA+"__cyclotomicSquare",cb,cc),b4.call(cA+"__cyclotomicExp_w0",cc,cd),b4.call(cZ+"_conjugate",cd,cd),b4.call(cZ+"_conjugate",ca,ce),b4.call(cZ+"_conjugate",cd,cf),b4.call(cZ+"_mul",cf,cb,cg),b4.call(cZ+"_mul",cg,ce,ch),b4.call(cZ+"_mul",ch,b8,ci),b4.call(cZ+"_mul",ch,cb,cj),b4.call(cZ+"_mul",cj,b5,ck),b4.call(cA+"__frobeniusMap1",ci,cl),b4.call(cZ+"_mul",cl,ck,cm),b4.call(cA+"__frobeniusMap2",ch,cn),b4.call(cZ+"_mul",cn,cm,co),b4.call(cZ+"_conjugate",b5,cp),b4.call(cZ+"_mul",cp,ci,cq),b4.call(cA+"__frobeniusMap3",cq,cr),b4.call(cZ+"_mul",cr,co,b6)),(cs=a.addFunction(cA+"_finalExponentiation")).addParam("x","i32"),cs.addParam("r","i32"),cu=(ct=cs.getCodeBuilder()).getLocal("x"),cv=ct.getLocal("r"),cw=ct.i32_const(a.alloc(cE)),cs.addCode(ct.call(cA+"__finalExponentiationFirstChunk",cu,cw),ct.call(cA+"__finalExponentiationLastChunk",cw,cv));for(let b=1;b<=5;b++)!function(b){let c=a.addFunction(cA+"_pairingEq"+b);for(let a=0;a<b;a++)c.addParam("p_"+a,"i32"),c.addParam("q_"+a,"i32");c.addParam("c","i32"),c.setReturnType("i32");let d=c.getCodeBuilder(),e=d.i32_const(a.alloc(cE)),f=d.i32_const(a.alloc(cE));c.addCode(d.call(cZ+"_one",e));for(let a=0;a<b;a++)c.addCode(d.call(cA+"_prepareG1",d.getLocal("p_"+a),d.i32_const(c5))),c.addCode(d.call(cA+"_prepareG2",d.getLocal("q_"+a),d.i32_const(c6))),c.addCode(d.call(cA+"_millerLoop",d.i32_const(c5),d.i32_const(c6),f)),c.addCode(d.call(cZ+"_mul",e,f,e));c.addCode(d.call(cA+"_finalExponentiation",e,e)),c.addCode(d.call(cZ+"_eq",e,d.getLocal("c")))}(b),a.exportFunction(cA+"_pairingEq"+b);(cx=a.addFunction(cA+"_pairing")).addParam("p","i32"),cx.addParam("q","i32"),cx.addParam("r","i32"),cz=(cy=cx.getCodeBuilder()).i32_const(a.alloc(cE)),cx.addCode(cy.call(cA+"_prepareG1",cy.getLocal("p"),cy.i32_const(c5))),cx.addCode(cy.call(cA+"_prepareG2",cy.getLocal("q"),cy.i32_const(c6))),cx.addCode(cy.call(cA+"_millerLoop",cy.i32_const(c5),cy.i32_const(c6),cz)),cx.addCode(cy.call(cA+"_finalExponentiation",cz,cy.getLocal("r"))),a.exportFunction(cA+"_pairing"),a.exportFunction(cA+"_prepareG1"),a.exportFunction(cA+"_prepareG2"),a.exportFunction(cA+"_millerLoop"),a.exportFunction(cA+"_finalExponentiation"),a.exportFunction(cA+"_finalExponentiationOld"),a.exportFunction(cA+"__mulBy024"),a.exportFunction(cA+"__mulBy024Old"),a.exportFunction(cA+"__cyclotomicSquare"),a.exportFunction(cA+"__cyclotomicExp_w0")}},3125:(a,b,c)=>{let d=c(3140),e=c(8614),f=c(6169),g=c(1357),h=c(3900),i=c(2509),j=c(8558),k=c(6681),l=c(7456),m=c(7027),{bitLength:n,isOdd:o,isNegative:p}=c(2090);a.exports=function(a,b){let c,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW,aX,aY,aZ,a$,a_,a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b$,b_,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO=b||"bls12381";if(a.modules[cO])return cO;let cP=Math.floor((n(0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn-1n)-1)/64)+1,cQ=8*cP,cR=2*cQ,cS=12*cQ,cT=Math.floor((n(0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n-1n)-1)/64)+1,cU=8*cT,cV=a.alloc(d.bigInt2BytesLE(0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,cU)),cW=e(a,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,"f1m","intq");f(a,0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,"fr","frm","intr");let cX=a.alloc(d.bigInt2BytesLE(c1(4n),cQ)),cY=i(a,"g1m","f1m",cX);j(a,"frm","frm","frm","frm_mul"),k(a,"pol","frm"),l(a,"qap","frm");let cZ=g(a,"f1m_neg","f2m","f1m"),c$=a.alloc([...d.bigInt2BytesLE(c1(4n),cQ),...d.bigInt2BytesLE(c1(4n),cQ)]),c_=i(a,"g2m","f2m",c$);function c0(b,c){let d=a.addFunction(b);d.addParam("pG","i32"),d.addParam("pFr","i32"),d.addParam("pr","i32");let e=d.getCodeBuilder(),f=e.i32_const(a.alloc(cU));d.addCode(e.call("frm_fromMontgomery",e.getLocal("pFr"),f),e.call(c,e.getLocal("pG"),f,e.i32_const(cU),e.getLocal("pr"))),a.exportFunction(b)}function c1(a){return BigInt(a)*(1n<<BigInt(8*cQ))%0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn}c0("g1m_timesFr","g1m_timesScalar"),j(a,"g1m","g1m","frm","g1m_timesFr"),c0("g2m_timesFr","g2m_timesScalar"),j(a,"g2m","g2m","frm","g2m_timesFr"),c0("g1m_timesFrAffine","g1m_timesScalarAffine"),c0("g2m_timesFrAffine","g2m_timesScalarAffine"),m(a,"frm_batchApplyKey","fmr","frm",cU,cU,cU,"frm_mul"),m(a,"g1m_batchApplyKey","g1m","frm",3*cQ,3*cQ,cU,"g1m_timesFr"),m(a,"g1m_batchApplyKeyMixed","g1m","frm",2*cQ,3*cQ,cU,"g1m_timesFrAffine"),m(a,"g2m_batchApplyKey","g2m","frm",2*cQ*3,3*cQ*2,cU,"g2m_timesFr"),m(a,"g2m_batchApplyKeyMixed","g2m","frm",2*cQ*2,3*cQ*2,cU,"g2m_timesFrAffine");let c2=a.alloc([...d.bigInt2BytesLE(c1(0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bbn),cQ),...d.bigInt2BytesLE(c1(0x8b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1n),cQ),...d.bigInt2BytesLE(c1(1n),cQ)]),c3=a.alloc([...d.bigInt2BytesLE(c1(0n),cQ),...d.bigInt2BytesLE(c1(1n),cQ),...d.bigInt2BytesLE(c1(0n),cQ)]),c4=[[0x24aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8n,0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7en],[0xce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801n,0x606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79ben],[1n,0n]],c5=a.alloc([...d.bigInt2BytesLE(c1(c4[0][0]),cQ),...d.bigInt2BytesLE(c1(c4[0][1]),cQ),...d.bigInt2BytesLE(c1(c4[1][0]),cQ),...d.bigInt2BytesLE(c1(c4[1][1]),cQ),...d.bigInt2BytesLE(c1(c4[2][0]),cQ),...d.bigInt2BytesLE(c1(c4[2][1]),cQ)]),c6=[[0n,0n],[1n,0n],[0n,0n]],c7=a.alloc([...d.bigInt2BytesLE(c1(c6[0][0]),cQ),...d.bigInt2BytesLE(c1(c6[0][1]),cQ),...d.bigInt2BytesLE(c1(c6[1][0]),cQ),...d.bigInt2BytesLE(c1(c6[1][1]),cQ),...d.bigInt2BytesLE(c1(c6[2][0]),cQ),...d.bigInt2BytesLE(c1(c6[2][1]),cQ)]),c8=a.alloc([...d.bigInt2BytesLE(c1(1n),cQ),...d.bigInt2BytesLE(c1(0n),cQ),...d.bigInt2BytesLE(c1(0n),cQ),...d.bigInt2BytesLE(c1(0n),cQ),...d.bigInt2BytesLE(c1(0n),cQ),...d.bigInt2BytesLE(c1(0n),cQ),...d.bigInt2BytesLE(c1(0n),cQ),...d.bigInt2BytesLE(c1(0n),cQ),...d.bigInt2BytesLE(c1(0n),cQ),...d.bigInt2BytesLE(c1(0n),cQ),...d.bigInt2BytesLE(c1(0n),cQ),...d.bigInt2BytesLE(c1(0n),cQ)]),c9=a.alloc([...d.bigInt2BytesLE(c1(1n),cQ),...d.bigInt2BytesLE(c1(1n),cQ)]);(c=a.addFunction(cZ+"_mulNR")).addParam("x","i32"),c.addParam("pr","i32"),r=(q=c.getCodeBuilder()).i32_const(a.alloc(cQ)),s=q.getLocal("x"),t=q.i32_add(q.getLocal("x"),q.i32_const(cQ)),u=q.getLocal("pr"),v=q.i32_add(q.getLocal("pr"),q.i32_const(cQ)),c.addCode(q.call(cW+"_copy",s,r),q.call(cW+"_sub",s,t,u),q.call(cW+"_add",r,t,v));let da=h(a,cZ+"_mulNR","f6m","f2m");(w=a.addFunction(da+"_mulNR")).addParam("x","i32"),w.addParam("pr","i32"),y=(x=w.getCodeBuilder()).i32_const(a.alloc(2*cQ)),w.addCode(x.call(cZ+"_copy",x.getLocal("x"),y),x.call(cZ+"_mulNR",x.i32_add(x.getLocal("x"),x.i32_const(4*cQ)),x.getLocal("pr")),x.call(cZ+"_copy",x.i32_add(x.getLocal("x"),x.i32_const(2*cQ)),x.i32_add(x.getLocal("pr"),x.i32_const(4*cQ))),x.call(cZ+"_copy",y,x.i32_add(x.getLocal("pr"),x.i32_const(2*cQ))));let db=g(a,da+"_mulNR","ftm",da),dc=function(a){let b=0xd201000000010000n,c=[];for(;b>0n;)o(b)?c.push(1):c.push(0),b>>=1n;return c}(0xd201000000010000n),dd=a.alloc(dc),de=3*cR,df=dc.length-1,dg=dc.reduce((a,b)=>a+ +(0!=b),0),dh=6*cQ,di=3*cQ*2+(dg+df+1)*de;a.modules[cO]={n64q:cP,n64r:cT,n8q:cQ,n8r:cU,pG1gen:c2,pG1zero:c3,pG1b:cX,pG2gen:c5,pG2zero:c7,pG2b:c$,pq:a.modules.f1m.pq,pr:cV,pOneT:c8,r:0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,q:0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,prePSize:dh,preQSize:di},(z=a.addFunction(da+"_mul1")).addParam("pA","i32"),z.addParam("pC1","i32"),z.addParam("pR","i32"),B=(A=z.getCodeBuilder()).getLocal("pA"),C=A.i32_add(A.getLocal("pA"),A.i32_const(2*cQ)),D=A.i32_add(A.getLocal("pA"),A.i32_const(4*cQ)),E=A.getLocal("pC1"),F=A.getLocal("pR"),G=A.i32_add(A.getLocal("pR"),A.i32_const(2*cQ)),H=A.i32_add(A.getLocal("pR"),A.i32_const(4*cQ)),I=A.i32_const(a.alloc(2*cQ)),J=A.i32_const(a.alloc(2*cQ)),z.addCode(A.call(cZ+"_add",B,C,I),A.call(cZ+"_add",C,D,J),A.call(cZ+"_mul",C,E,H),A.call(cZ+"_mul",J,E,F),A.call(cZ+"_sub",F,H,F),A.call(cZ+"_mulNR",F,F),A.call(cZ+"_mul",I,E,G),A.call(cZ+"_sub",G,H,G)),(K=a.addFunction(da+"_mul01")).addParam("pA","i32"),K.addParam("pC0","i32"),K.addParam("pC1","i32"),K.addParam("pR","i32"),M=(L=K.getCodeBuilder()).getLocal("pA"),N=L.i32_add(L.getLocal("pA"),L.i32_const(2*cQ)),O=L.i32_add(L.getLocal("pA"),L.i32_const(4*cQ)),P=L.getLocal("pC0"),Q=L.getLocal("pC1"),R=L.getLocal("pR"),S=L.i32_add(L.getLocal("pR"),L.i32_const(2*cQ)),T=L.i32_add(L.getLocal("pR"),L.i32_const(4*cQ)),U=L.i32_const(a.alloc(2*cQ)),V=L.i32_const(a.alloc(2*cQ)),W=L.i32_const(a.alloc(2*cQ)),X=L.i32_const(a.alloc(2*cQ)),K.addCode(L.call(cZ+"_mul",M,P,U),L.call(cZ+"_mul",N,Q,V),L.call(cZ+"_add",M,N,W),L.call(cZ+"_add",M,O,X),L.call(cZ+"_add",N,O,R),L.call(cZ+"_mul",R,Q,R),L.call(cZ+"_sub",R,V,R),L.call(cZ+"_mulNR",R,R),L.call(cZ+"_add",R,U,R),L.call(cZ+"_add",P,Q,S),L.call(cZ+"_mul",S,W,S),L.call(cZ+"_sub",S,U,S),L.call(cZ+"_sub",S,V,S),L.call(cZ+"_mul",X,P,T),L.call(cZ+"_sub",T,U,T),L.call(cZ+"_add",T,V,T)),(Y=a.addFunction(db+"_mul014")).addParam("pA","i32"),Y.addParam("pC0","i32"),Y.addParam("pC1","i32"),Y.addParam("pC4","i32"),Y.addParam("pR","i32"),$=(Z=Y.getCodeBuilder()).getLocal("pA"),_=Z.i32_add(Z.getLocal("pA"),Z.i32_const(6*cQ)),aa=Z.getLocal("pC0"),ab=Z.getLocal("pC1"),ac=Z.getLocal("pC4"),ad=Z.i32_const(a.alloc(6*cQ)),ae=Z.i32_const(a.alloc(6*cQ)),af=Z.i32_const(a.alloc(2*cQ)),ag=Z.getLocal("pR"),ah=Z.i32_add(Z.getLocal("pR"),Z.i32_const(6*cQ)),Y.addCode(Z.call(da+"_mul01",$,aa,ab,ad),Z.call(da+"_mul1",_,ac,ae),Z.call(cZ+"_add",ab,ac,af),Z.call(da+"_add",_,$,ah),Z.call(da+"_mul01",ah,aa,af,ah),Z.call(da+"_sub",ah,ad,ah),Z.call(da+"_sub",ah,ae,ah),Z.call(da+"_copy",ae,ag),Z.call(da+"_mulNR",ag,ag),Z.call(da+"_add",ag,ad,ag)),(ai=a.addFunction(cO+"_ell")).addParam("pP","i32"),ai.addParam("pCoefs","i32"),ai.addParam("pF","i32"),ak=(aj=ai.getCodeBuilder()).getLocal("pP"),al=aj.i32_add(aj.getLocal("pP"),aj.i32_const(cQ)),am=aj.getLocal("pF"),an=aj.getLocal("pCoefs"),ao=aj.i32_add(aj.getLocal("pCoefs"),aj.i32_const(cQ)),ap=aj.i32_add(aj.getLocal("pCoefs"),aj.i32_const(2*cQ)),aq=aj.i32_add(aj.getLocal("pCoefs"),aj.i32_const(3*cQ)),ar=aj.i32_add(aj.getLocal("pCoefs"),aj.i32_const(4*cQ)),as=a.alloc(2*cQ),at=aj.i32_const(as),au=aj.i32_const(as),av=aj.i32_const(as+cQ),aw=a.alloc(2*cQ),ax=aj.i32_const(aw),ay=aj.i32_const(aw),az=aj.i32_const(aw+cQ),ai.addCode(aj.call(cW+"_mul",an,al,au),aj.call(cW+"_mul",ao,al,av),aj.call(cW+"_mul",ap,ak,ay),aj.call(cW+"_mul",aq,ak,az),aj.call(db+"_mul014",am,ar,ax,at,am));let dj=a.alloc(dh),dk=a.alloc(di);for(let b=0;b<10;b++)!function(b){let c=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8n,0xfc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3n],[0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffffn,0n],[0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n,0x6af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n],[0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0n],[0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995n,0x5b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116n],[0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan,0n],[0xfc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3n,0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0n],[0x6af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n,0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaadn,0n],[0x5b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116n,0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995n]]],e=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0n,0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn],[0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0n],[0n,1n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0n],[0n,0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen]],[[1n,0n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaadn,0n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0n],[0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan,0n],[0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0n],[0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffffn,0n]]],f=a.addFunction(db+"_frobeniusMap"+b);f.addParam("x","i32"),f.addParam("r","i32");let g=f.getCodeBuilder();for(let h=0;h<6;h++){let i=0==h?g.getLocal("x"):g.i32_add(g.getLocal("x"),g.i32_const(h*cR)),j=g.i32_add(g.getLocal("x"),g.i32_const(h*cR+cQ)),k=0==h?g.getLocal("r"):g.i32_add(g.getLocal("r"),g.i32_const(h*cR)),l=g.i32_add(g.getLocal("r"),g.i32_const(h*cR+cQ)),m=function(a,b){let c=a[0],d=a[1],e=b[0],f=b[1],g=[(c*e-d*f)%0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,(c*f+d*e)%0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn];return p(g[0])&&(g[0]=g[0]+0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn),g}(c[Math.floor(h/3)][b%12],e[h%3][b%6]),n=a.alloc([...d.bigInt2BytesLE(c1(m[0]),cQ),...d.bigInt2BytesLE(c1(m[1]),cQ)]);b%2==1?f.addCode(g.call(cW+"_copy",i,k),g.call(cW+"_neg",j,l),g.call(cZ+"_mul",k,g.i32_const(n),k)):f.addCode(g.call(cZ+"_mul",i,g.i32_const(n),k))}}(b),a.exportFunction(db+"_frobeniusMap"+b);(aA=a.addFunction(cY+"_inGroupAffine")).addParam("p","i32"),aA.setReturnType("i32"),aC=(aB=aA.getCodeBuilder()).i32_const(a.alloc(d.bigInt2BytesLE(c1(0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn),cQ))),aD=aB.i32_const(a.alloc(d.bigInt2BytesLE(c1(0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen),cQ))),aE=aB.i32_const(a.alloc(d.bigInt2BytesLE((0xd201000000010000n*0xd201000000010000n-1n)/3n,16))),aF=aB.getLocal("p"),aG=aB.i32_add(aB.getLocal("p"),aB.i32_const(cQ)),aH=a.alloc(3*cQ),aI=aB.i32_const(aH),aJ=aB.i32_const(aH),aK=aB.i32_const(aH+cQ),aL=a.alloc(2*cQ),aM=aB.i32_const(aL),aN=aB.i32_const(aL),aO=aB.i32_const(aL+cQ),aA.addCode(aB.if(aB.call(cY+"_isZeroAffine",aB.getLocal("p")),aB.ret(aB.i32_const(1))),aB.if(aB.i32_eqz(aB.call(cY+"_inCurveAffine",aB.getLocal("p"))),aB.ret(aB.i32_const(0))),aB.call(cW+"_mul",aF,aC,aJ),aB.call(cW+"_copy",aG,aK),aB.call(cW+"_mul",aF,aD,aN),aB.call(cW+"_copy",aG,aO),aB.call(cY+"_doubleAffine",aI,aI),aB.call(cY+"_subMixed",aI,aB.getLocal("p"),aI),aB.call(cY+"_subMixed",aI,aM,aI),aB.call(cY+"_timesScalar",aI,aE,aB.i32_const(16),aI),aB.ret(aB.call(cY+"_eqMixed",aI,aM))),(aP=a.addFunction(cY+"_inGroup")).addParam("pIn","i32"),aP.setReturnType("i32"),aR=(aQ=aP.getCodeBuilder()).i32_const(a.alloc(2*cQ)),aP.addCode(aQ.call(cY+"_toAffine",aQ.getLocal("pIn"),aR),aQ.ret(aQ.call(cY+"_inGroupAffine",aR))),(aS=a.addFunction(c_+"_inGroupAffine")).addParam("p","i32"),aS.setReturnType("i32"),aT=aS.getCodeBuilder(),aU=aT.i32_const(a.alloc([...d.bigInt2BytesLE(c1(0xd0088f51cbff34d258dd3db21a5d66bb23ba5c279c2895fb39869507b587b120f55ffff58a9ffffdcff7fffffffd556n),cQ),...d.bigInt2BytesLE(c1(0xd0088f51cbff34d258dd3db21a5d66bb23ba5c279c2895fb39869507b587b120f55ffff58a9ffffdcff7fffffffd555n),cQ)])),aV=aT.i32_const(a.alloc(d.bigInt2BytesLE(c1(0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn),cQ))),aW=aT.i32_const(a.alloc([...d.bigInt2BytesLE(c1(0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n),cQ),...d.bigInt2BytesLE(c1(0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n),cQ)])),aX=aT.i32_const(a.alloc(d.bigInt2BytesLE(0xd201000000010000n,8))),aY=aT.getLocal("p"),aZ=aT.i32_add(aT.getLocal("p"),aT.i32_const(cR)),a$=aT.i32_const(a.alloc(cQ)),a_=aT.i32_const(a.alloc(cR)),a0=aT.i32_const(a.alloc(cR)),a1=a.alloc(2*cR),a2=aT.i32_const(a1),a3=aT.i32_const(a1),a4=aT.i32_const(a1),a5=aT.i32_const(a1+cQ),a6=aT.i32_const(a1+cR),a7=aT.i32_const(a1+cR),a8=aT.i32_const(a1+cR+cQ),a9=a.alloc(3*cR),ba=aT.i32_const(a9),bb=aT.i32_const(a9),bc=aT.i32_const(a9),bd=aT.i32_const(a9+cQ),be=aT.i32_const(a9+cR),bf=aT.i32_const(a9+cR),bg=aT.i32_const(a9+cR+cQ),bh=aT.i32_const(a9+2*cR),aS.addCode(aT.if(aT.call(c_+"_isZeroAffine",aT.getLocal("p")),aT.ret(aT.i32_const(1))),aT.if(aT.i32_eqz(aT.call(c_+"_inCurveAffine",aT.getLocal("p"))),aT.ret(aT.i32_const(0))),aT.call(cZ+"_mul",aY,aU,a_),aT.call(cZ+"_mul",aZ,aU,a0),aT.call(cZ+"_mul1",a_,aV,a3),aT.call(cZ+"_neg",a0,a6),aT.call(cZ+"_neg",a_,bb),aT.call(cZ+"_mul",a0,aW,be),aT.call(cW+"_sub",a4,a5,a$),aT.call(cW+"_add",a4,a5,a5),aT.call(cW+"_copy",a$,a4),aT.call(cW+"_sub",a7,a8,a$),aT.call(cW+"_add",a7,a8,a8),aT.call(cW+"_copy",a$,a7),aT.call(cW+"_add",bc,bd,a$),aT.call(cW+"_sub",bc,bd,bd),aT.call(cW+"_copy",a$,bc),aT.call(cW+"_sub",bg,bf,a$),aT.call(cW+"_add",bf,bg,bg),aT.call(cW+"_copy",a$,bf),aT.call(cZ+"_one",bh),aT.call(c_+"_timesScalar",ba,aX,aT.i32_const(8),ba),aT.call(c_+"_addMixed",ba,a2,ba),aT.ret(aT.call(c_+"_eqMixed",ba,aT.getLocal("p")))),(bi=a.addFunction(c_+"_inGroup")).addParam("pIn","i32"),bi.setReturnType("i32"),bk=(bj=bi.getCodeBuilder()).i32_const(a.alloc(2*cR)),bi.addCode(bj.call(c_+"_toAffine",bj.getLocal("pIn"),bk),bj.ret(bj.call(c_+"_inGroupAffine",bk))),(bl=a.addFunction(cO+"_prepAddStep")).addParam("R","i32"),bl.addParam("Q","i32"),bl.addParam("r","i32"),bn=(bm=bl.getCodeBuilder()).getLocal("R"),bo=bm.i32_add(bm.getLocal("R"),bm.i32_const(2*cQ)),bp=bm.i32_add(bm.getLocal("R"),bm.i32_const(4*cQ)),bq=bm.getLocal("Q"),br=bm.i32_add(bm.getLocal("Q"),bm.i32_const(2*cQ)),bs=bm.getLocal("r"),bt=bm.i32_add(bm.getLocal("r"),bm.i32_const(2*cQ)),bu=bm.i32_add(bm.getLocal("r"),bm.i32_const(4*cQ)),bv=bm.i32_const(a.alloc(cR)),bw=bm.i32_const(a.alloc(cR)),bx=bm.i32_const(a.alloc(cR)),by=bm.i32_const(a.alloc(cR)),bz=bm.i32_const(a.alloc(cR)),bA=bm.i32_const(a.alloc(cR)),bB=bm.i32_const(a.alloc(cR)),bC=bm.i32_const(a.alloc(cR)),bD=bm.i32_const(a.alloc(cR)),bE=bm.i32_const(a.alloc(cR)),bF=bm.i32_const(a.alloc(cR)),bl.addCode(bm.call(cZ+"_square",bp,bv),bm.call(cZ+"_square",br,bw),bm.call(cZ+"_mul",bv,bq,by),bm.call(cZ+"_add",br,bp,bt),bm.call(cZ+"_square",bt,bt),bm.call(cZ+"_sub",bt,bw,bt),bm.call(cZ+"_sub",bt,bv,bt),bm.call(cZ+"_mul",bt,bv,bt),bm.call(cZ+"_sub",by,bn,bz),bm.call(cZ+"_square",bz,bA),bm.call(cZ+"_add",bA,bA,bB),bm.call(cZ+"_add",bB,bB,bB),bm.call(cZ+"_mul",bB,bz,bC),bm.call(cZ+"_sub",bt,bo,bD),bm.call(cZ+"_sub",bD,bo,bD),bm.call(cZ+"_mul",bD,bq,bu),bm.call(cZ+"_mul",bB,bn,bE),bm.call(cZ+"_square",bD,bn),bm.call(cZ+"_sub",bn,bC,bn),bm.call(cZ+"_sub",bn,bE,bn),bm.call(cZ+"_sub",bn,bE,bn),bm.call(cZ+"_add",bp,bz,bp),bm.call(cZ+"_square",bp,bp),bm.call(cZ+"_sub",bp,bv,bp),bm.call(cZ+"_sub",bp,bA,bp),bm.call(cZ+"_add",br,bp,bs),bm.call(cZ+"_sub",bE,bn,bF),bm.call(cZ+"_mul",bF,bD,bF),bm.call(cZ+"_mul",bo,bC,by),bm.call(cZ+"_add",by,by,by),bm.call(cZ+"_sub",bF,by,bo),bm.call(cZ+"_square",bs,bs),bm.call(cZ+"_sub",bs,bw,bs),bm.call(cZ+"_square",bp,bx),bm.call(cZ+"_sub",bs,bx,bs),bm.call(cZ+"_add",bu,bu,bu),bm.call(cZ+"_sub",bu,bs,bu),bm.call(cZ+"_add",bp,bp,bs),bm.call(cZ+"_neg",bD,bD),bm.call(cZ+"_add",bD,bD,bt)),(bG=a.addFunction(cO+"_prepDblStep")).addParam("R","i32"),bG.addParam("r","i32"),bI=(bH=bG.getCodeBuilder()).getLocal("R"),bJ=bH.i32_add(bH.getLocal("R"),bH.i32_const(2*cQ)),bK=bH.i32_add(bH.getLocal("R"),bH.i32_const(4*cQ)),bL=bH.getLocal("r"),bM=bH.i32_add(bH.getLocal("r"),bH.i32_const(2*cQ)),bN=bH.i32_add(bH.getLocal("r"),bH.i32_const(4*cQ)),bO=bH.i32_const(a.alloc(cR)),bP=bH.i32_const(a.alloc(cR)),bQ=bH.i32_const(a.alloc(cR)),bR=bH.i32_const(a.alloc(cR)),bS=bH.i32_const(a.alloc(cR)),bG.addCode(bH.call(cZ+"_square",bI,bL),bH.call(cZ+"_square",bJ,bP),bH.call(cZ+"_square",bP,bQ),bH.call(cZ+"_add",bP,bI,bM),bH.call(cZ+"_square",bM,bM),bH.call(cZ+"_sub",bM,bL,bM),bH.call(cZ+"_sub",bM,bQ,bM),bH.call(cZ+"_add",bM,bM,bM),bH.call(cZ+"_add",bL,bL,bR),bH.call(cZ+"_add",bR,bL,bR),bH.call(cZ+"_add",bI,bR,bN),bH.call(cZ+"_square",bR,bS),bH.call(cZ+"_square",bK,bO),bH.call(cZ+"_sub",bS,bM,bI),bH.call(cZ+"_sub",bI,bM,bI),bH.call(cZ+"_add",bK,bJ,bK),bH.call(cZ+"_square",bK,bK),bH.call(cZ+"_sub",bK,bP,bK),bH.call(cZ+"_sub",bK,bO,bK),bH.call(cZ+"_sub",bM,bI,bJ),bH.call(cZ+"_mul",bJ,bR,bJ),bH.call(cZ+"_add",bQ,bQ,bQ),bH.call(cZ+"_add",bQ,bQ,bQ),bH.call(cZ+"_add",bQ,bQ,bQ),bH.call(cZ+"_sub",bJ,bQ,bJ),bH.call(cZ+"_mul",bR,bO,bM),bH.call(cZ+"_add",bM,bM,bM),bH.call(cZ+"_neg",bM,bM),bH.call(cZ+"_square",bN,bN),bH.call(cZ+"_sub",bN,bL,bN),bH.call(cZ+"_sub",bN,bS,bN),bH.call(cZ+"_add",bP,bP,bP),bH.call(cZ+"_add",bP,bP,bP),bH.call(cZ+"_sub",bN,bP,bN),bH.call(cZ+"_mul",bK,bO,bL),bH.call(cZ+"_add",bL,bL,bL)),(bT=a.addFunction(cO+"_prepareG1")).addParam("pP","i32"),bT.addParam("ppreP","i32"),bU=bT.getCodeBuilder(),bT.addCode(bU.call(cY+"_normalize",bU.getLocal("pP"),bU.getLocal("ppreP"))),(bV=a.addFunction(cO+"_prepareG2")).addParam("pQ","i32"),bV.addParam("ppreQ","i32"),bV.addLocal("pCoef","i32"),bV.addLocal("i","i32"),bX=(bW=bV.getCodeBuilder()).getLocal("pQ"),bY=a.alloc(3*cR),bZ=bW.i32_const(bY),b$=bW.getLocal("ppreQ"),bV.addCode(bW.call(c_+"_normalize",bX,b$),bW.if(bW.call(c_+"_isZero",b$),bW.ret([])),bW.call(c_+"_copy",b$,bZ),bW.setLocal("pCoef",bW.i32_add(bW.getLocal("ppreQ"),bW.i32_const(3*cR)))),bV.addCode(bW.setLocal("i",bW.i32_const(dc.length-2)),bW.block(bW.loop(bW.call(cO+"_prepDblStep",bZ,bW.getLocal("pCoef")),bW.setLocal("pCoef",bW.i32_add(bW.getLocal("pCoef"),bW.i32_const(de))),bW.if(bW.i32_load8_s(bW.getLocal("i"),dd),[...bW.call(cO+"_prepAddStep",bZ,b$,bW.getLocal("pCoef")),...bW.setLocal("pCoef",bW.i32_add(bW.getLocal("pCoef"),bW.i32_const(de)))]),bW.br_if(1,bW.i32_eqz(bW.getLocal("i"))),bW.setLocal("i",bW.i32_sub(bW.getLocal("i"),bW.i32_const(1))),bW.br(0)))),(b_=a.addFunction(cO+"_millerLoop")).addParam("ppreP","i32"),b_.addParam("ppreQ","i32"),b_.addParam("r","i32"),b_.addLocal("pCoef","i32"),b_.addLocal("i","i32"),b1=(b0=b_.getCodeBuilder()).getLocal("ppreP"),b2=b0.getLocal("pCoef"),b3=b0.getLocal("r"),b_.addCode(b0.call(db+"_one",b3),b0.if(b0.call(cY+"_isZero",b1),b0.ret([])),b0.if(b0.call(cY+"_isZero",b0.getLocal("ppreQ")),b0.ret([])),b0.setLocal("pCoef",b0.i32_add(b0.getLocal("ppreQ"),b0.i32_const(3*cR))),b0.setLocal("i",b0.i32_const(dc.length-2)),b0.block(b0.loop(b0.call(cO+"_ell",b1,b2,b3),b0.setLocal("pCoef",b0.i32_add(b0.getLocal("pCoef"),b0.i32_const(de))),b0.if(b0.i32_load8_s(b0.getLocal("i"),dd),[...b0.call(cO+"_ell",b1,b2,b3),...b0.setLocal("pCoef",b0.i32_add(b0.getLocal("pCoef"),b0.i32_const(de)))]),b0.call(db+"_square",b3,b3),b0.br_if(1,b0.i32_eq(b0.getLocal("i"),b0.i32_const(1))),b0.setLocal("i",b0.i32_sub(b0.getLocal("i"),b0.i32_const(1))),b0.br(0))),b0.call(cO+"_ell",b1,b2,b3)),b_.addCode(b0.call(db+"_conjugate",b3,b3)),(b4=a.addFunction(cO+"_finalExponentiationOld")).addParam("x","i32"),b4.addParam("r","i32"),b5=a.alloc(d.bigInt2BytesLE(0x2ee1db5dcc825b7e1bda9c0496a1c0a89ee0193d4977b3f7d4507d07363baa13f8d14a917848517badc3a43d1073776ab353f2c30698e8cc7deada9c0aadff5e9cfee9a074e43b9a660835cc872ee83ff3a0f0f1c0ad0d6106feaf4e347aa68ad49466fa927e7bb9375331807a0dce2630d9aa4b113f414386b0e8819328148978e2b0dd39099b86e1ab656d2670d93e4d7acdd350da5359bc73ab61a0c5bf24c374693c49f570bcd2b01f3077ffb10bf24dde41064837f27611212596bc293c8d4c01f25118790f4684d0b9c40a68eb74bb22a40ee7169cdc1041296532fef459f12438dfc8e2886ef965e61a474c5c85b0129127a1b5ad0463434724538411d1676a53b5a62eb34c05739334f46c02c3f0bd0c55d3109cd15948d0a1fad20044ce6ad4c6bec3ec03ef19592004cedd556952c6d8823b19dadd7c2498345c6e5308f1c511291097db60b1749bf9b71a9f9e0100418a3ef0bc627751bbd81367066bca6a4c1b6dcfc5cceb73fc56947a403577dfa9e13c24ea820b09c1d9f7c31759c3635de3f7a3639991708e88adce88177456c49637fd7961be1a4c7e79fb02faa732e2f3ec2bea83d196283313492caa9d4aff1c910e9622d2a73f62537f2701aaef6539314043f7bbce5b78c7869aeb2181a67e49eeed2161daf3f881bd88592d767f67c4717489119226c2f011d4cab803e9d71650a6f80698e2f8491d12191a04406fbc8fbd5f48925f98630e68bfb24c0bcb9b55df57510n,544)),b6=b4.getCodeBuilder(),b4.addCode(b6.call(db+"_exp",b6.getLocal("x"),b6.i32_const(b5),b6.i32_const(544),b6.getLocal("r"))),(b7=a.addFunction(cO+"__cyclotomicSquare")).addParam("x","i32"),b7.addParam("r","i32"),b9=(b8=b7.getCodeBuilder()).getLocal("x"),ca=b8.i32_add(b8.getLocal("x"),b8.i32_const(cR)),cb=b8.i32_add(b8.getLocal("x"),b8.i32_const(2*cR)),cc=b8.i32_add(b8.getLocal("x"),b8.i32_const(3*cR)),cd=b8.i32_add(b8.getLocal("x"),b8.i32_const(4*cR)),ce=b8.i32_add(b8.getLocal("x"),b8.i32_const(5*cR)),cf=b8.getLocal("r"),cg=b8.i32_add(b8.getLocal("r"),b8.i32_const(cR)),ch=b8.i32_add(b8.getLocal("r"),b8.i32_const(2*cR)),ci=b8.i32_add(b8.getLocal("r"),b8.i32_const(3*cR)),cj=b8.i32_add(b8.getLocal("r"),b8.i32_const(4*cR)),ck=b8.i32_add(b8.getLocal("r"),b8.i32_const(5*cR)),cl=b8.i32_const(a.alloc(cR)),cm=b8.i32_const(a.alloc(cR)),cn=b8.i32_const(a.alloc(cR)),co=b8.i32_const(a.alloc(cR)),cp=b8.i32_const(a.alloc(cR)),cq=b8.i32_const(a.alloc(cR)),cr=b8.i32_const(a.alloc(cR)),cs=b8.i32_const(a.alloc(cR)),b7.addCode(b8.call(cZ+"_mul",b9,cd,cr),b8.call(cZ+"_mulNR",cd,cl),b8.call(cZ+"_add",b9,cl,cl),b8.call(cZ+"_add",b9,cd,cs),b8.call(cZ+"_mul",cs,cl,cl),b8.call(cZ+"_mulNR",cr,cs),b8.call(cZ+"_add",cr,cs,cs),b8.call(cZ+"_sub",cl,cs,cl),b8.call(cZ+"_add",cr,cr,cm),b8.call(cZ+"_mul",cc,cb,cr),b8.call(cZ+"_mulNR",cb,cn),b8.call(cZ+"_add",cc,cn,cn),b8.call(cZ+"_add",cc,cb,cs),b8.call(cZ+"_mul",cs,cn,cn),b8.call(cZ+"_mulNR",cr,cs),b8.call(cZ+"_add",cr,cs,cs),b8.call(cZ+"_sub",cn,cs,cn),b8.call(cZ+"_add",cr,cr,co),b8.call(cZ+"_mul",ca,ce,cr),b8.call(cZ+"_mulNR",ce,cp),b8.call(cZ+"_add",ca,cp,cp),b8.call(cZ+"_add",ca,ce,cs),b8.call(cZ+"_mul",cs,cp,cp),b8.call(cZ+"_mulNR",cr,cs),b8.call(cZ+"_add",cr,cs,cs),b8.call(cZ+"_sub",cp,cs,cp),b8.call(cZ+"_add",cr,cr,cq),b8.call(cZ+"_sub",cl,b9,cf),b8.call(cZ+"_add",cf,cf,cf),b8.call(cZ+"_add",cl,cf,cf),b8.call(cZ+"_add",cm,cd,cj),b8.call(cZ+"_add",cj,cj,cj),b8.call(cZ+"_add",cm,cj,cj),b8.call(cZ+"_mul",cq,b8.i32_const(c9),cs),b8.call(cZ+"_add",cs,cc,ci),b8.call(cZ+"_add",ci,ci,ci),b8.call(cZ+"_add",cs,ci,ci),b8.call(cZ+"_sub",cp,cb,ch),b8.call(cZ+"_add",ch,ch,ch),b8.call(cZ+"_add",cp,ch,ch),b8.call(cZ+"_sub",cn,ca,cg),b8.call(cZ+"_add",cg,cg,cg),b8.call(cZ+"_add",cn,cg,cg),b8.call(cZ+"_add",co,ce,ck),b8.call(cZ+"_add",ck,ck,ck),b8.call(cZ+"_add",co,ck,ck)),ct=(function(a){let b=0xd201000000010000n,c=[];for(;b>0n;){if(o(b)){let a=2-Number(b%4n);c.push(a),b-=BigInt(a)}else c.push(0);b>>=1n}return c})(0xd201000000010000n).map(a=>-1==a?255:a),cu=a.alloc(ct),(cv=a.addFunction(cO+"__cyclotomicExp_w0")).addParam("x","i32"),cv.addParam("r","i32"),cv.addLocal("bit","i32"),cv.addLocal("i","i32"),cx=(cw=cv.getCodeBuilder()).getLocal("x"),cy=cw.getLocal("r"),cz=cw.i32_const(a.alloc(cS)),cv.addCode(cw.call(db+"_conjugate",cx,cz),cw.call(db+"_one",cy),cw.if(cw.teeLocal("bit",cw.i32_load8_s(cw.i32_const(ct.length-1),cu)),cw.if(cw.i32_eq(cw.getLocal("bit"),cw.i32_const(1)),cw.call(db+"_mul",cy,cx,cy),cw.call(db+"_mul",cy,cz,cy))),cw.setLocal("i",cw.i32_const(ct.length-2)),cw.block(cw.loop(cw.call(cO+"__cyclotomicSquare",cy,cy),cw.if(cw.teeLocal("bit",cw.i32_load8_s(cw.getLocal("i"),cu)),cw.if(cw.i32_eq(cw.getLocal("bit"),cw.i32_const(1)),cw.call(db+"_mul",cy,cx,cy),cw.call(db+"_mul",cy,cz,cy))),cw.br_if(1,cw.i32_eqz(cw.getLocal("i"))),cw.setLocal("i",cw.i32_sub(cw.getLocal("i"),cw.i32_const(1))),cw.br(0)))),cv.addCode(cw.call(db+"_conjugate",cy,cy)),(cA=a.addFunction(cO+"_finalExponentiation")).addParam("x","i32"),cA.addParam("r","i32"),cC=(cB=cA.getCodeBuilder()).getLocal("x"),cD=cB.getLocal("r"),cE=cB.i32_const(a.alloc(cS)),cF=cB.i32_const(a.alloc(cS)),cG=cB.i32_const(a.alloc(cS)),cH=cB.i32_const(a.alloc(cS)),cI=cB.i32_const(a.alloc(cS)),cJ=cB.i32_const(a.alloc(cS)),cK=cB.i32_const(a.alloc(cS)),cA.addCode(cB.call(db+"_frobeniusMap6",cC,cE),cB.call(db+"_inverse",cC,cF),cB.call(db+"_mul",cE,cF,cG),cB.call(db+"_copy",cG,cF),cB.call(db+"_frobeniusMap2",cG,cG),cB.call(db+"_mul",cG,cF,cG),cB.call(cO+"__cyclotomicSquare",cG,cF),cB.call(db+"_conjugate",cF,cF),cB.call(cO+"__cyclotomicExp_w0",cG,cH),cB.call(cO+"__cyclotomicSquare",cH,cI),cB.call(db+"_mul",cF,cH,cJ),cB.call(cO+"__cyclotomicExp_w0",cJ,cF),cB.call(cO+"__cyclotomicExp_w0",cF,cE),cB.call(cO+"__cyclotomicExp_w0",cE,cK),cB.call(db+"_mul",cK,cI,cK),cB.call(cO+"__cyclotomicExp_w0",cK,cI),cB.call(db+"_conjugate",cJ,cJ),cB.call(db+"_mul",cI,cJ,cI),cB.call(db+"_mul",cI,cG,cI),cB.call(db+"_conjugate",cG,cJ),cB.call(db+"_mul",cF,cG,cF),cB.call(db+"_frobeniusMap3",cF,cF),cB.call(db+"_mul",cK,cJ,cK),cB.call(db+"_frobeniusMap1",cK,cK),cB.call(db+"_mul",cH,cE,cH),cB.call(db+"_frobeniusMap2",cH,cH),cB.call(db+"_mul",cH,cF,cH),cB.call(db+"_mul",cH,cK,cH),cB.call(db+"_mul",cH,cI,cD));for(let b=1;b<=5;b++)!function(b){let c=a.addFunction(cO+"_pairingEq"+b);for(let a=0;a<b;a++)c.addParam("p_"+a,"i32"),c.addParam("q_"+a,"i32");c.addParam("c","i32"),c.setReturnType("i32");let d=c.getCodeBuilder(),e=d.i32_const(a.alloc(cS)),f=d.i32_const(a.alloc(cS));c.addCode(d.call(db+"_one",e));for(let a=0;a<b;a++)c.addCode(d.call(cO+"_prepareG1",d.getLocal("p_"+a),d.i32_const(dj))),c.addCode(d.call(cO+"_prepareG2",d.getLocal("q_"+a),d.i32_const(dk))),c.addCode(d.if(d.i32_eqz(d.call(cY+"_inGroupAffine",d.i32_const(dj))),d.ret(d.i32_const(0))),d.if(d.i32_eqz(d.call(c_+"_inGroupAffine",d.i32_const(dk))),d.ret(d.i32_const(0)))),c.addCode(d.call(cO+"_millerLoop",d.i32_const(dj),d.i32_const(dk),f)),c.addCode(d.call(db+"_mul",e,f,e));c.addCode(d.call(cO+"_finalExponentiation",e,e)),c.addCode(d.call(db+"_eq",e,d.getLocal("c")))}(b),a.exportFunction(cO+"_pairingEq"+b);(cL=a.addFunction(cO+"_pairing")).addParam("p","i32"),cL.addParam("q","i32"),cL.addParam("r","i32"),cN=(cM=cL.getCodeBuilder()).i32_const(a.alloc(cS)),cL.addCode(cM.call(cO+"_prepareG1",cM.getLocal("p"),cM.i32_const(dj))),cL.addCode(cM.call(cO+"_prepareG2",cM.getLocal("q"),cM.i32_const(dk))),cL.addCode(cM.call(cO+"_millerLoop",cM.i32_const(dj),cM.i32_const(dk),cN)),cL.addCode(cM.call(cO+"_finalExponentiation",cN,cM.getLocal("r"))),a.exportFunction(cO+"_pairing"),a.exportFunction(cO+"_prepareG1"),a.exportFunction(cO+"_prepareG2"),a.exportFunction(cO+"_millerLoop"),a.exportFunction(cO+"_finalExponentiation"),a.exportFunction(cO+"_finalExponentiationOld"),a.exportFunction(cO+"__cyclotomicSquare"),a.exportFunction(cO+"__cyclotomicExp_w0"),a.exportFunction(da+"_mul1"),a.exportFunction(da+"_mul01"),a.exportFunction(db+"_mul014"),a.exportFunction(cY+"_inGroupAffine"),a.exportFunction(cY+"_inGroup"),a.exportFunction(c_+"_inGroupAffine"),a.exportFunction(c_+"_inGroup")}},3140:(a,b)=>{b.bigInt2BytesLE=function(a,b){let c=Array(b),d=BigInt(a);for(let a=0;a<b;a++)c[a]=Number(255n&d),d>>=8n;return c},b.bigInt2U32LE=function(a,b){let c=Array(b),d=BigInt(a);for(let a=0;a<b;a++)c[a]=Number(4294967295n&d),d>>=32n;return c},b.isOcamNum=function(a){return!!Array.isArray(a)&&3==a.length&&"number"==typeof a[0]&&"number"==typeof a[1]&&!!Array.isArray(a[2])}},3664:a=>{"use strict";a.exports={rE:"3.1.10"}},3900:(a,b,c)=>{let d=c(7032),e=c(5780);a.exports=function(a,b,c,f){let g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW,aX,aY,aZ,a$,a_,a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT;if(a.modules[c])return c;let bU=8*a.modules[f].n64;return a.modules[c]={n64:3*a.modules[f].n64},(g=a.addFunction(c+"_isZero")).addParam("x","i32"),g.setReturnType("i32"),i=(h=g.getCodeBuilder()).getLocal("x"),j=h.i32_add(h.getLocal("x"),h.i32_const(bU)),k=h.i32_add(h.getLocal("x"),h.i32_const(2*bU)),g.addCode(h.i32_and(h.i32_and(h.call(f+"_isZero",i),h.call(f+"_isZero",j)),h.call(f+"_isZero",k))),(l=a.addFunction(c+"_isOne")).addParam("x","i32"),l.setReturnType("i32"),n=(m=l.getCodeBuilder()).getLocal("x"),o=m.i32_add(m.getLocal("x"),m.i32_const(bU)),p=m.i32_add(m.getLocal("x"),m.i32_const(2*bU)),l.addCode(m.ret(m.i32_and(m.i32_and(m.call(f+"_isOne",n),m.call(f+"_isZero",o)),m.call(f+"_isZero",p)))),(q=a.addFunction(c+"_zero")).addParam("x","i32"),s=(r=q.getCodeBuilder()).getLocal("x"),t=r.i32_add(r.getLocal("x"),r.i32_const(bU)),u=r.i32_add(r.getLocal("x"),r.i32_const(2*bU)),q.addCode(r.call(f+"_zero",s),r.call(f+"_zero",t),r.call(f+"_zero",u)),(v=a.addFunction(c+"_one")).addParam("x","i32"),x=(w=v.getCodeBuilder()).getLocal("x"),y=w.i32_add(w.getLocal("x"),w.i32_const(bU)),z=w.i32_add(w.getLocal("x"),w.i32_const(2*bU)),v.addCode(w.call(f+"_one",x),w.call(f+"_zero",y),w.call(f+"_zero",z)),(A=a.addFunction(c+"_copy")).addParam("x","i32"),A.addParam("r","i32"),C=(B=A.getCodeBuilder()).getLocal("x"),D=B.i32_add(B.getLocal("x"),B.i32_const(bU)),E=B.i32_add(B.getLocal("x"),B.i32_const(2*bU)),F=B.getLocal("r"),G=B.i32_add(B.getLocal("r"),B.i32_const(bU)),H=B.i32_add(B.getLocal("r"),B.i32_const(2*bU)),A.addCode(B.call(f+"_copy",C,F),B.call(f+"_copy",D,G),B.call(f+"_copy",E,H)),(I=a.addFunction(c+"_mul")).addParam("x","i32"),I.addParam("y","i32"),I.addParam("r","i32"),K=(J=I.getCodeBuilder()).getLocal("x"),L=J.i32_add(J.getLocal("x"),J.i32_const(bU)),M=J.i32_add(J.getLocal("x"),J.i32_const(2*bU)),N=J.getLocal("y"),O=J.i32_add(J.getLocal("y"),J.i32_const(bU)),P=J.i32_add(J.getLocal("y"),J.i32_const(2*bU)),Q=J.getLocal("r"),R=J.i32_add(J.getLocal("r"),J.i32_const(bU)),S=J.i32_add(J.getLocal("r"),J.i32_const(2*bU)),T=J.i32_const(a.alloc(bU)),U=J.i32_const(a.alloc(bU)),V=J.i32_const(a.alloc(bU)),W=J.i32_const(a.alloc(bU)),X=J.i32_const(a.alloc(bU)),Y=J.i32_const(a.alloc(bU)),Z=J.i32_const(a.alloc(bU)),$=J.i32_const(a.alloc(bU)),_=J.i32_const(a.alloc(bU)),aa=J.i32_const(a.alloc(bU)),ab=J.i32_const(a.alloc(bU)),ac=J.i32_const(a.alloc(bU)),ad=J.i32_const(a.alloc(bU)),I.addCode(J.call(f+"_mul",K,N,T),J.call(f+"_mul",L,O,U),J.call(f+"_mul",M,P,V),J.call(f+"_add",K,L,W),J.call(f+"_add",N,O,X),J.call(f+"_add",K,M,Y),J.call(f+"_add",N,P,Z),J.call(f+"_add",L,M,$),J.call(f+"_add",O,P,_),J.call(f+"_add",T,U,aa),J.call(f+"_add",T,V,ab),J.call(f+"_add",U,V,ac),J.call(f+"_mul",$,_,Q),J.call(f+"_sub",Q,ac,Q),J.call(b,Q,Q),J.call(f+"_add",T,Q,Q),J.call(f+"_mul",W,X,R),J.call(f+"_sub",R,aa,R),J.call(b,V,ad),J.call(f+"_add",R,ad,R),J.call(f+"_mul",Y,Z,S),J.call(f+"_sub",S,ab,S),J.call(f+"_add",S,U,S)),(ae=a.addFunction(c+"_square")).addParam("x","i32"),ae.addParam("r","i32"),ag=(af=ae.getCodeBuilder()).getLocal("x"),ah=af.i32_add(af.getLocal("x"),af.i32_const(bU)),ai=af.i32_add(af.getLocal("x"),af.i32_const(2*bU)),aj=af.getLocal("r"),ak=af.i32_add(af.getLocal("r"),af.i32_const(bU)),al=af.i32_add(af.getLocal("r"),af.i32_const(2*bU)),am=af.i32_const(a.alloc(bU)),an=af.i32_const(a.alloc(bU)),ao=af.i32_const(a.alloc(bU)),ap=af.i32_const(a.alloc(bU)),aq=af.i32_const(a.alloc(bU)),ar=af.i32_const(a.alloc(bU)),as=af.i32_const(a.alloc(bU)),ae.addCode(af.call(f+"_square",ag,am),af.call(f+"_mul",ag,ah,an),af.call(f+"_add",an,an,ao),af.call(f+"_sub",ag,ah,ap),af.call(f+"_add",ap,ai,ap),af.call(f+"_square",ap,ap),af.call(f+"_mul",ah,ai,aq),af.call(f+"_add",aq,aq,ar),af.call(f+"_square",ai,as),af.call(b,ar,aj),af.call(f+"_add",am,aj,aj),af.call(b,as,ak),af.call(f+"_add",ao,ak,ak),af.call(f+"_add",am,as,al),af.call(f+"_sub",ar,al,al),af.call(f+"_add",ap,al,al),af.call(f+"_add",ao,al,al)),(at=a.addFunction(c+"_add")).addParam("x","i32"),at.addParam("y","i32"),at.addParam("r","i32"),av=(au=at.getCodeBuilder()).getLocal("x"),aw=au.i32_add(au.getLocal("x"),au.i32_const(bU)),ax=au.i32_add(au.getLocal("x"),au.i32_const(2*bU)),ay=au.getLocal("y"),az=au.i32_add(au.getLocal("y"),au.i32_const(bU)),aA=au.i32_add(au.getLocal("y"),au.i32_const(2*bU)),aB=au.getLocal("r"),aC=au.i32_add(au.getLocal("r"),au.i32_const(bU)),aD=au.i32_add(au.getLocal("r"),au.i32_const(2*bU)),at.addCode(au.call(f+"_add",av,ay,aB),au.call(f+"_add",aw,az,aC),au.call(f+"_add",ax,aA,aD)),(aE=a.addFunction(c+"_sub")).addParam("x","i32"),aE.addParam("y","i32"),aE.addParam("r","i32"),aG=(aF=aE.getCodeBuilder()).getLocal("x"),aH=aF.i32_add(aF.getLocal("x"),aF.i32_const(bU)),aI=aF.i32_add(aF.getLocal("x"),aF.i32_const(2*bU)),aJ=aF.getLocal("y"),aK=aF.i32_add(aF.getLocal("y"),aF.i32_const(bU)),aL=aF.i32_add(aF.getLocal("y"),aF.i32_const(2*bU)),aM=aF.getLocal("r"),aN=aF.i32_add(aF.getLocal("r"),aF.i32_const(bU)),aO=aF.i32_add(aF.getLocal("r"),aF.i32_const(2*bU)),aE.addCode(aF.call(f+"_sub",aG,aJ,aM),aF.call(f+"_sub",aH,aK,aN),aF.call(f+"_sub",aI,aL,aO)),(aP=a.addFunction(c+"_neg")).addParam("x","i32"),aP.addParam("r","i32"),aR=(aQ=aP.getCodeBuilder()).getLocal("x"),aS=aQ.i32_add(aQ.getLocal("x"),aQ.i32_const(bU)),aT=aQ.i32_add(aQ.getLocal("x"),aQ.i32_const(2*bU)),aU=aQ.getLocal("r"),aV=aQ.i32_add(aQ.getLocal("r"),aQ.i32_const(bU)),aW=aQ.i32_add(aQ.getLocal("r"),aQ.i32_const(2*bU)),aP.addCode(aQ.call(f+"_neg",aR,aU),aQ.call(f+"_neg",aS,aV),aQ.call(f+"_neg",aT,aW)),(aX=a.addFunction(c+"_sign")).addParam("x","i32"),aX.addLocal("s","i32"),aX.setReturnType("i32"),aZ=(aY=aX.getCodeBuilder()).getLocal("x"),a$=aY.i32_add(aY.getLocal("x"),aY.i32_const(bU)),a_=aY.i32_add(aY.getLocal("x"),aY.i32_const(2*bU)),aX.addCode(aY.setLocal("s",aY.call(f+"_sign",a_)),aY.if(aY.getLocal("s"),aY.ret(aY.getLocal("s"))),aY.setLocal("s",aY.call(f+"_sign",a$)),aY.if(aY.getLocal("s"),aY.ret(aY.getLocal("s"))),aY.ret(aY.call(f+"_sign",aZ))),(a0=a.addFunction(c+"_toMontgomery")).addParam("x","i32"),a0.addParam("r","i32"),a2=(a1=a0.getCodeBuilder()).getLocal("x"),a3=a1.i32_add(a1.getLocal("x"),a1.i32_const(bU)),a4=a1.i32_add(a1.getLocal("x"),a1.i32_const(2*bU)),a5=a1.getLocal("r"),a6=a1.i32_add(a1.getLocal("r"),a1.i32_const(bU)),a7=a1.i32_add(a1.getLocal("r"),a1.i32_const(2*bU)),a0.addCode(a1.call(f+"_toMontgomery",a2,a5),a1.call(f+"_toMontgomery",a3,a6),a1.call(f+"_toMontgomery",a4,a7)),(a8=a.addFunction(c+"_fromMontgomery")).addParam("x","i32"),a8.addParam("r","i32"),ba=(a9=a8.getCodeBuilder()).getLocal("x"),bb=a9.i32_add(a9.getLocal("x"),a9.i32_const(bU)),bc=a9.i32_add(a9.getLocal("x"),a9.i32_const(2*bU)),bd=a9.getLocal("r"),be=a9.i32_add(a9.getLocal("r"),a9.i32_const(bU)),bf=a9.i32_add(a9.getLocal("r"),a9.i32_const(2*bU)),a8.addCode(a9.call(f+"_fromMontgomery",ba,bd),a9.call(f+"_fromMontgomery",bb,be),a9.call(f+"_fromMontgomery",bc,bf)),(bg=a.addFunction(c+"_eq")).addParam("x","i32"),bg.addParam("y","i32"),bg.setReturnType("i32"),bi=(bh=bg.getCodeBuilder()).getLocal("x"),bj=bh.i32_add(bh.getLocal("x"),bh.i32_const(bU)),bk=bh.i32_add(bh.getLocal("x"),bh.i32_const(2*bU)),bl=bh.getLocal("y"),bm=bh.i32_add(bh.getLocal("y"),bh.i32_const(bU)),bn=bh.i32_add(bh.getLocal("y"),bh.i32_const(2*bU)),bg.addCode(bh.i32_and(bh.i32_and(bh.call(f+"_eq",bi,bl),bh.call(f+"_eq",bj,bm)),bh.call(f+"_eq",bk,bn))),(bo=a.addFunction(c+"_inverse")).addParam("x","i32"),bo.addParam("r","i32"),bq=(bp=bo.getCodeBuilder()).getLocal("x"),br=bp.i32_add(bp.getLocal("x"),bp.i32_const(bU)),bs=bp.i32_add(bp.getLocal("x"),bp.i32_const(2*bU)),bt=bp.getLocal("r"),bu=bp.i32_add(bp.getLocal("r"),bp.i32_const(bU)),bv=bp.i32_add(bp.getLocal("r"),bp.i32_const(2*bU)),bw=bp.i32_const(a.alloc(bU)),bx=bp.i32_const(a.alloc(bU)),by=bp.i32_const(a.alloc(bU)),bz=bp.i32_const(a.alloc(bU)),bA=bp.i32_const(a.alloc(bU)),bB=bp.i32_const(a.alloc(bU)),bC=bp.i32_const(a.alloc(bU)),bD=bp.i32_const(a.alloc(bU)),bE=bp.i32_const(a.alloc(bU)),bF=bp.i32_const(a.alloc(bU)),bG=bp.i32_const(a.alloc(bU)),bo.addCode(bp.call(f+"_square",bq,bw),bp.call(f+"_square",br,bx),bp.call(f+"_square",bs,by),bp.call(f+"_mul",bq,br,bz),bp.call(f+"_mul",bq,bs,bA),bp.call(f+"_mul",br,bs,bB),bp.call(b,bB,bC),bp.call(f+"_sub",bw,bC,bC),bp.call(b,by,bD),bp.call(f+"_sub",bD,bz,bD),bp.call(f+"_sub",bx,bA,bE),bp.call(f+"_mul",bs,bD,bF),bp.call(f+"_mul",br,bE,bG),bp.call(f+"_add",bF,bG,bF),bp.call(b,bF,bF),bp.call(f+"_mul",bq,bC,bG),bp.call(f+"_add",bG,bF,bF),bp.call(f+"_inverse",bF,bF),bp.call(f+"_mul",bF,bC,bt),bp.call(f+"_mul",bF,bD,bu),bp.call(f+"_mul",bF,bE,bv)),(bH=a.addFunction(c+"_timesScalar")).addParam("x","i32"),bH.addParam("scalar","i32"),bH.addParam("scalarLen","i32"),bH.addParam("r","i32"),bJ=(bI=bH.getCodeBuilder()).getLocal("x"),bK=bI.i32_add(bI.getLocal("x"),bI.i32_const(bU)),bL=bI.i32_add(bI.getLocal("x"),bI.i32_const(2*bU)),bM=bI.getLocal("r"),bN=bI.i32_add(bI.getLocal("r"),bI.i32_const(bU)),bO=bI.i32_add(bI.getLocal("r"),bI.i32_const(2*bU)),bH.addCode(bI.call(f+"_timesScalar",bJ,bI.getLocal("scalar"),bI.getLocal("scalarLen"),bM),bI.call(f+"_timesScalar",bK,bI.getLocal("scalar"),bI.getLocal("scalarLen"),bN),bI.call(f+"_timesScalar",bL,bI.getLocal("scalar"),bI.getLocal("scalarLen"),bO)),(bP=a.addFunction(c+"_isNegative")).addParam("x","i32"),bP.setReturnType("i32"),bR=(bQ=bP.getCodeBuilder()).getLocal("x"),bS=bQ.i32_add(bQ.getLocal("x"),bQ.i32_const(bU)),bT=bQ.i32_add(bQ.getLocal("x"),bQ.i32_const(2*bU)),bP.addCode(bQ.if(bQ.call(f+"_isZero",bT),bQ.if(bQ.call(f+"_isZero",bS),bQ.ret(bQ.call(f+"_isNegative",bR)),bQ.ret(bQ.call(f+"_isNegative",bS)))),bQ.ret(bQ.call(f+"_isNegative",bT))),a.exportFunction(c+"_isZero"),a.exportFunction(c+"_isOne"),a.exportFunction(c+"_zero"),a.exportFunction(c+"_one"),a.exportFunction(c+"_copy"),a.exportFunction(c+"_mul"),a.exportFunction(c+"_square"),a.exportFunction(c+"_add"),a.exportFunction(c+"_sub"),a.exportFunction(c+"_neg"),a.exportFunction(c+"_sign"),a.exportFunction(c+"_fromMontgomery"),a.exportFunction(c+"_toMontgomery"),a.exportFunction(c+"_eq"),a.exportFunction(c+"_inverse"),e(a,c),d(a,c+"_exp",3*bU,c+"_mul",c+"_square",c+"_copy",c+"_one"),a.exportFunction(c+"_exp"),a.exportFunction(c+"_timesScalar"),a.exportFunction(c+"_batchInverse"),a.exportFunction(c+"_isNegative"),c}},4211:a=>{a.exports=function(a,b,c){let d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=c||"int";if(a.modules[v])return v;a.modules[v]={};let w=2*b,x=8*b,y=a.addFunction(v+"_copy");y.addParam("px","i32"),y.addParam("pr","i32");let z=y.getCodeBuilder();for(let a=0;a<b;a++)y.addCode(z.i64_store(z.getLocal("pr"),8*a,z.i64_load(z.getLocal("px"),8*a)));let A=a.addFunction(v+"_zero");A.addParam("pr","i32");let B=A.getCodeBuilder();for(let a=0;a<b;a++)A.addCode(B.i64_store(B.getLocal("pr"),8*a,B.i64_const(0)));(d=a.addFunction(v+"_isZero")).addParam("px","i32"),d.setReturnType("i32"),e=d.getCodeBuilder(),d.addCode(function a(b){return 0==b?e.ret(e.i64_eqz(e.i64_load(e.getLocal("px")))):e.if(e.i64_eqz(e.i64_load(e.getLocal("px"),8*b)),a(b-1),e.ret(e.i32_const(0)))}(b-1)),d.addCode(e.ret(e.i32_const(0)));let C=a.addFunction(v+"_one");C.addParam("pr","i32");let D=C.getCodeBuilder();C.addCode(D.i64_store(D.getLocal("pr"),0,D.i64_const(1)));for(let a=1;a<b;a++)C.addCode(D.i64_store(D.getLocal("pr"),8*a,D.i64_const(0)));(f=a.addFunction(v+"_eq")).addParam("px","i32"),f.addParam("py","i32"),f.setReturnType("i32"),g=f.getCodeBuilder(),f.addCode(function a(b){return 0==b?g.ret(g.i64_eq(g.i64_load(g.getLocal("px")),g.i64_load(g.getLocal("py")))):g.if(g.i64_eq(g.i64_load(g.getLocal("px"),8*b),g.i64_load(g.getLocal("py"),8*b)),a(b-1),g.ret(g.i32_const(0)))}(b-1)),f.addCode(g.ret(g.i32_const(0))),(h=a.addFunction(v+"_gte")).addParam("px","i32"),h.addParam("py","i32"),h.setReturnType("i32"),i=h.getCodeBuilder(),h.addCode(function a(b){return 0==b?i.ret(i.i64_ge_u(i.i64_load(i.getLocal("px")),i.i64_load(i.getLocal("py")))):i.if(i.i64_lt_u(i.i64_load(i.getLocal("px"),8*b),i.i64_load(i.getLocal("py"),8*b)),i.ret(i.i32_const(0)),i.if(i.i64_gt_u(i.i64_load(i.getLocal("px"),8*b),i.i64_load(i.getLocal("py"),8*b)),i.ret(i.i32_const(1)),a(b-1)))}(b-1)),h.addCode(i.ret(i.i32_const(0)));let E=a.addFunction(v+"_add");E.addParam("x","i32"),E.addParam("y","i32"),E.addParam("r","i32"),E.setReturnType("i32"),E.addLocal("c","i64");let F=E.getCodeBuilder();E.addCode(F.setLocal("c",F.i64_add(F.i64_load32_u(F.getLocal("x")),F.i64_load32_u(F.getLocal("y"))))),E.addCode(F.i64_store32(F.getLocal("r"),F.getLocal("c")));for(let a=1;a<w;a++)E.addCode(F.setLocal("c",F.i64_add(F.i64_add(F.i64_load32_u(F.getLocal("x"),4*a),F.i64_load32_u(F.getLocal("y"),4*a)),F.i64_shr_u(F.getLocal("c"),F.i64_const(32))))),E.addCode(F.i64_store32(F.getLocal("r"),4*a,F.getLocal("c")));E.addCode(F.i32_wrap_i64(F.i64_shr_u(F.getLocal("c"),F.i64_const(32))));let G=a.addFunction(v+"_sub");G.addParam("x","i32"),G.addParam("y","i32"),G.addParam("r","i32"),G.setReturnType("i32"),G.addLocal("c","i64");let H=G.getCodeBuilder();G.addCode(H.setLocal("c",H.i64_sub(H.i64_load32_u(H.getLocal("x")),H.i64_load32_u(H.getLocal("y"))))),G.addCode(H.i64_store32(H.getLocal("r"),H.i64_and(H.getLocal("c"),H.i64_const("0xFFFFFFFF"))));for(let a=1;a<w;a++)G.addCode(H.setLocal("c",H.i64_add(H.i64_sub(H.i64_load32_u(H.getLocal("x"),4*a),H.i64_load32_u(H.getLocal("y"),4*a)),H.i64_shr_s(H.getLocal("c"),H.i64_const(32))))),G.addCode(H.i64_store32(H.getLocal("r"),4*a,H.i64_and(H.getLocal("c"),H.i64_const("0xFFFFFFFF"))));return G.addCode(H.i32_wrap_i64(H.i64_shr_s(H.getLocal("c"),H.i64_const(32)))),function(){let b=a.addFunction(v+"_mul");b.addParam("x","i32"),b.addParam("y","i32"),b.addParam("r","i32"),b.addLocal("c0","i64"),b.addLocal("c1","i64");for(let a=0;a<w;a++)b.addLocal("x"+a,"i64"),b.addLocal("y"+a,"i64");let c=b.getCodeBuilder(),d=[],e=[],f="c0",g="c1";for(let a=0;a<2*w-1;a++){for(let h=Math.max(0,a-w+1);h<=a&&h<w;h++){let i=a-h;b.addCode(c.setLocal(f,c.i64_add(c.i64_and(c.getLocal(f),c.i64_const(0xffffffff)),function(a,b){let f,g;return d[a]?f=c.getLocal("x"+a):(f=c.teeLocal("x"+a,c.i64_load32_u(c.getLocal("x"),4*a)),d[a]=!0),e[b]?g=c.getLocal("y"+b):(g=c.teeLocal("y"+b,c.i64_load32_u(c.getLocal("y"),4*b)),e[b]=!0),c.i64_mul(f,g)}(h,i)))),b.addCode(c.setLocal(g,c.i64_add(c.getLocal(g),c.i64_shr_u(c.getLocal(f),c.i64_const(32)))))}b.addCode(c.i64_store32(c.getLocal("r"),4*a,c.getLocal(f))),[f,g]=[g,f],b.addCode(c.setLocal(g,c.i64_shr_u(c.getLocal(f),c.i64_const(32))))}b.addCode(c.i64_store32(c.getLocal("r"),4*w*2-4,c.getLocal(f)))}(),function(){let b=a.addFunction(v+"_square");b.addParam("x","i32"),b.addParam("r","i32"),b.addLocal("c0","i64"),b.addLocal("c1","i64"),b.addLocal("c0_old","i64"),b.addLocal("c1_old","i64");for(let a=0;a<w;a++)b.addLocal("x"+a,"i64");let c=b.getCodeBuilder(),d=[];function e(a,b){let e,f;return d[a]?e=c.getLocal("x"+a):(e=c.teeLocal("x"+a,c.i64_load32_u(c.getLocal("x"),4*a)),d[a]=!0),d[b]?f=c.getLocal("x"+b):(f=c.teeLocal("x"+b,c.i64_load32_u(c.getLocal("x"),4*b)),d[b]=!0),c.i64_mul(e,f)}let f="c0_old",g="c1_old";for(let a=0;a<2*w-1;a++){b.addCode(c.setLocal("c0",c.i64_const(0)),c.setLocal("c1",c.i64_const(0)));for(let d=Math.max(0,a-w+1);d<a+1>>1&&d<w;d++){let f=a-d;b.addCode(c.setLocal("c0",c.i64_add(c.i64_and(c.getLocal("c0"),c.i64_const(0xffffffff)),e(d,f)))),b.addCode(c.setLocal("c1",c.i64_add(c.getLocal("c1"),c.i64_shr_u(c.getLocal("c0"),c.i64_const(32)))))}b.addCode(c.setLocal("c0",c.i64_shl(c.i64_and(c.getLocal("c0"),c.i64_const(0xffffffff)),c.i64_const(1)))),b.addCode(c.setLocal("c1",c.i64_add(c.i64_shl(c.getLocal("c1"),c.i64_const(1)),c.i64_shr_u(c.getLocal("c0"),c.i64_const(32))))),a%2==0&&(b.addCode(c.setLocal("c0",c.i64_add(c.i64_and(c.getLocal("c0"),c.i64_const(0xffffffff)),e(a>>1,a>>1)))),b.addCode(c.setLocal("c1",c.i64_add(c.getLocal("c1"),c.i64_shr_u(c.getLocal("c0"),c.i64_const(32)))))),a>0&&(b.addCode(c.setLocal("c0",c.i64_add(c.i64_and(c.getLocal("c0"),c.i64_const(0xffffffff)),c.i64_and(c.getLocal(f),c.i64_const(0xffffffff))))),b.addCode(c.setLocal("c1",c.i64_add(c.i64_add(c.getLocal("c1"),c.i64_shr_u(c.getLocal("c0"),c.i64_const(32))),c.getLocal(g))))),b.addCode(c.i64_store32(c.getLocal("r"),4*a,c.getLocal("c0"))),b.addCode(c.setLocal(f,c.getLocal("c1")),c.setLocal(g,c.i64_shr_u(c.getLocal(f),c.i64_const(32))))}b.addCode(c.i64_store32(c.getLocal("r"),4*w*2-4,c.getLocal(f)))}(),(j=a.addFunction(v+"_squareOld")).addParam("x","i32"),j.addParam("r","i32"),k=j.getCodeBuilder(),j.addCode(k.call(v+"_mul",k.getLocal("x"),k.getLocal("x"),k.getLocal("r"))),function(){let b,c,d=a.addFunction(v+"__mul1");d.addParam("px","i32"),d.addParam("y","i64"),d.addParam("pr","i32"),d.addLocal("c","i64");let e=d.getCodeBuilder();d.addCode(e.setLocal("c",e.i64_mul(e.i64_load32_u(e.getLocal("px"),0,0),e.getLocal("y")))),d.addCode(e.i64_store32(e.getLocal("pr"),0,0,e.getLocal("c")));for(let a=1;a<w;a++)d.addCode(e.setLocal("c",e.i64_add(e.i64_mul(e.i64_load32_u(e.getLocal("px"),4*a,0),e.getLocal("y")),e.i64_shr_u(e.getLocal("c"),e.i64_const(32))))),d.addCode(e.i64_store32(e.getLocal("pr"),4*a,0,e.getLocal("c")));(b=a.addFunction(v+"__add1")).addParam("x","i32"),b.addParam("y","i64"),b.addLocal("c","i64"),b.addLocal("px","i32"),c=b.getCodeBuilder(),b.addCode(c.setLocal("px",c.getLocal("x"))),b.addCode(c.setLocal("c",c.i64_add(c.i64_load32_u(c.getLocal("px"),0,0),c.getLocal("y")))),b.addCode(c.i64_store32(c.getLocal("px"),0,0,c.getLocal("c"))),b.addCode(c.setLocal("c",c.i64_shr_u(c.getLocal("c"),c.i64_const(32)))),b.addCode(c.block(c.loop(c.br_if(1,c.i64_eqz(c.getLocal("c"))),c.setLocal("px",c.i32_add(c.getLocal("px"),c.i32_const(4))),c.setLocal("c",c.i64_add(c.i64_load32_u(c.getLocal("px"),0,0),c.getLocal("c"))),c.i64_store32(c.getLocal("px"),0,0,c.getLocal("c")),c.setLocal("c",c.i64_shr_u(c.getLocal("c"),c.i64_const(32))),c.br(0))));let f=a.addFunction(v+"_div");f.addParam("x","i32"),f.addParam("y","i32"),f.addParam("c","i32"),f.addParam("r","i32"),f.addLocal("rr","i32"),f.addLocal("cc","i32"),f.addLocal("eX","i32"),f.addLocal("eY","i32"),f.addLocal("sy","i64"),f.addLocal("sx","i64"),f.addLocal("ec","i32");let g=f.getCodeBuilder(),h=g.i32_const(a.alloc(x)),i=g.i32_const(a.alloc(x)),j=g.i32_const(a.alloc(x)),k=g.getLocal("cc"),l=g.getLocal("rr"),m=a.alloc(2*x),n=g.i32_const(m),o=g.i32_const(m+x);f.addCode(g.if(g.getLocal("c"),g.setLocal("cc",g.getLocal("c")),g.setLocal("cc",i))),f.addCode(g.if(g.getLocal("r"),g.setLocal("rr",g.getLocal("r")),g.setLocal("rr",j))),f.addCode(g.call(v+"_copy",g.getLocal("x"),l)),f.addCode(g.call(v+"_copy",g.getLocal("y"),h)),f.addCode(g.call(v+"_zero",k)),f.addCode(g.call(v+"_zero",n)),f.addCode(g.setLocal("eX",g.i32_const(x-1))),f.addCode(g.setLocal("eY",g.i32_const(x-1))),f.addCode(g.block(g.loop(g.br_if(1,g.i32_or(g.i32_load8_u(g.i32_add(h,g.getLocal("eY")),0,0),g.i32_eq(g.getLocal("eY"),g.i32_const(3)))),g.setLocal("eY",g.i32_sub(g.getLocal("eY"),g.i32_const(1))),g.br(0)))),f.addCode(g.setLocal("sy",g.i64_add(g.i64_load32_u(g.i32_sub(g.i32_add(h,g.getLocal("eY")),g.i32_const(3)),0,0),g.i64_const(1)))),f.addCode(g.if(g.i64_eq(g.getLocal("sy"),g.i64_const(1)),g.drop(g.i64_div_u(g.i64_const(0),g.i64_const(0))))),f.addCode(g.block(g.loop(g.block(g.loop(g.br_if(1,g.i32_or(g.i32_load8_u(g.i32_add(l,g.getLocal("eX")),0,0),g.i32_eq(g.getLocal("eX"),g.i32_const(7)))),g.setLocal("eX",g.i32_sub(g.getLocal("eX"),g.i32_const(1))),g.br(0))),g.setLocal("sx",g.i64_load(g.i32_sub(g.i32_add(l,g.getLocal("eX")),g.i32_const(7)),0,0)),g.setLocal("sx",g.i64_div_u(g.getLocal("sx"),g.getLocal("sy"))),g.setLocal("ec",g.i32_sub(g.i32_sub(g.getLocal("eX"),g.getLocal("eY")),g.i32_const(4))),g.block(g.loop(g.br_if(1,g.i32_and(g.i64_eqz(g.i64_and(g.getLocal("sx"),g.i64_const("0xFFFFFFFF00000000"))),g.i32_ge_s(g.getLocal("ec"),g.i32_const(0)))),g.setLocal("sx",g.i64_shr_u(g.getLocal("sx"),g.i64_const(8))),g.setLocal("ec",g.i32_add(g.getLocal("ec"),g.i32_const(1))),g.br(0))),g.if(g.i64_eqz(g.getLocal("sx")),[...g.br_if(2,g.i32_eqz(g.call(v+"_gte",l,h))),...g.setLocal("sx",g.i64_const(1)),...g.setLocal("ec",g.i32_const(0))]),g.call(v+"__mul1",h,g.getLocal("sx"),o),g.drop(g.call(v+"_sub",l,g.i32_sub(o,g.getLocal("ec")),l)),g.call(v+"__add1",g.i32_add(k,g.getLocal("ec")),g.getLocal("sx")),g.br(0))))}(),(l=a.addFunction(v+"_inverseMod")).addParam("px","i32"),l.addParam("pm","i32"),l.addParam("pr","i32"),l.addLocal("t","i32"),l.addLocal("newt","i32"),l.addLocal("r","i32"),l.addLocal("qq","i32"),l.addLocal("qr","i32"),l.addLocal("newr","i32"),l.addLocal("swp","i32"),l.addLocal("x","i32"),l.addLocal("signt","i32"),l.addLocal("signnewt","i32"),l.addLocal("signx","i32"),n=(m=l.getCodeBuilder()).i32_const(a.alloc(x)),o=m.i32_const(a.alloc(x)),p=m.i32_const(a.alloc(x)),q=m.i32_const(a.alloc(x)),r=m.i32_const(a.alloc(x)),s=m.i32_const(a.alloc(x)),t=m.i32_const(a.alloc(2*x)),u=m.i32_const(a.alloc(x)),l.addCode(m.setLocal("t",n),m.call(v+"_zero",n),m.setLocal("signt",m.i32_const(0))),l.addCode(m.setLocal("r",o),m.call(v+"_copy",m.getLocal("pm"),o)),l.addCode(m.setLocal("newt",p),m.call(v+"_one",p),m.setLocal("signnewt",m.i32_const(0))),l.addCode(m.setLocal("newr",q),m.call(v+"_copy",m.getLocal("px"),q)),l.addCode(m.setLocal("qq",r)),l.addCode(m.setLocal("qr",s)),l.addCode(m.setLocal("x",u)),l.addCode(m.block(m.loop(m.br_if(1,m.call(v+"_isZero",m.getLocal("newr"))),m.call(v+"_div",m.getLocal("r"),m.getLocal("newr"),m.getLocal("qq"),m.getLocal("qr")),m.call(v+"_mul",m.getLocal("qq"),m.getLocal("newt"),t),m.if(m.getLocal("signt"),m.if(m.getLocal("signnewt"),m.if(m.call(v+"_gte",t,m.getLocal("t")),[...m.drop(m.call(v+"_sub",t,m.getLocal("t"),m.getLocal("x"))),...m.setLocal("signx",m.i32_const(0))],[...m.drop(m.call(v+"_sub",m.getLocal("t"),t,m.getLocal("x"))),...m.setLocal("signx",m.i32_const(1))]),[...m.drop(m.call(v+"_add",t,m.getLocal("t"),m.getLocal("x"))),...m.setLocal("signx",m.i32_const(1))]),m.if(m.getLocal("signnewt"),[...m.drop(m.call(v+"_add",t,m.getLocal("t"),m.getLocal("x"))),...m.setLocal("signx",m.i32_const(0))],m.if(m.call(v+"_gte",m.getLocal("t"),t),[...m.drop(m.call(v+"_sub",m.getLocal("t"),t,m.getLocal("x"))),...m.setLocal("signx",m.i32_const(0))],[...m.drop(m.call(v+"_sub",t,m.getLocal("t"),m.getLocal("x"))),...m.setLocal("signx",m.i32_const(1))]))),m.setLocal("swp",m.getLocal("t")),m.setLocal("t",m.getLocal("newt")),m.setLocal("newt",m.getLocal("x")),m.setLocal("x",m.getLocal("swp")),m.setLocal("signt",m.getLocal("signnewt")),m.setLocal("signnewt",m.getLocal("signx")),m.setLocal("swp",m.getLocal("r")),m.setLocal("r",m.getLocal("newr")),m.setLocal("newr",m.getLocal("qr")),m.setLocal("qr",m.getLocal("swp")),m.br(0)))),l.addCode(m.if(m.getLocal("signt"),m.drop(m.call(v+"_sub",m.getLocal("pm"),m.getLocal("t"),m.getLocal("pr"))),m.call(v+"_copy",m.getLocal("t"),m.getLocal("pr")))),a.exportFunction(v+"_copy"),a.exportFunction(v+"_zero"),a.exportFunction(v+"_one"),a.exportFunction(v+"_isZero"),a.exportFunction(v+"_eq"),a.exportFunction(v+"_gte"),a.exportFunction(v+"_add"),a.exportFunction(v+"_sub"),a.exportFunction(v+"_mul"),a.exportFunction(v+"_square"),a.exportFunction(v+"_squareOld"),a.exportFunction(v+"_div"),a.exportFunction(v+"_inverseMod"),v}},4319:a=>{a.exports=function(a,b,c,d,e,f,g,h){let i=a.addFunction(b);i.addParam("base","i32"),i.addParam("scalar","i32"),i.addParam("scalarLength","i32"),i.addParam("r","i32"),i.addLocal("old0","i32"),i.addLocal("nbits","i32"),i.addLocal("i","i32"),i.addLocal("last","i32"),i.addLocal("cur","i32"),i.addLocal("carry","i32"),i.addLocal("p","i32");let j=i.getCodeBuilder(),k=j.i32_const(a.alloc(c));function l(a){return j.i32_and(j.i32_shr_u(j.i32_load(j.i32_add(j.getLocal("scalar"),j.i32_and(j.i32_shr_u(a,j.i32_const(3)),j.i32_const(0xfffffffc)))),j.i32_and(a,j.i32_const(31))),j.i32_const(1))}function m(a){return[...j.i32_store8(j.getLocal("p"),j.i32_const(a)),...j.setLocal("p",j.i32_add(j.getLocal("p"),j.i32_const(1)))]}i.addCode(j.if(j.i32_eqz(j.getLocal("scalarLength")),[...j.call(h,j.getLocal("r")),...j.ret([])]),j.setLocal("nbits",j.i32_shl(j.getLocal("scalarLength"),j.i32_const(3))),j.setLocal("old0",j.i32_load(j.i32_const(0))),j.setLocal("p",j.getLocal("old0")),j.i32_store(j.i32_const(0),j.i32_and(j.i32_add(j.i32_add(j.getLocal("old0"),j.i32_const(32)),j.getLocal("nbits")),j.i32_const(0xfffffff8))),j.setLocal("i",j.i32_const(1)),j.setLocal("last",l(j.i32_const(0))),j.setLocal("carry",j.i32_const(0)),j.block(j.loop(j.br_if(1,j.i32_eq(j.getLocal("i"),j.getLocal("nbits"))),j.setLocal("cur",l(j.getLocal("i"))),j.if(j.getLocal("last"),j.if(j.getLocal("cur"),j.if(j.getLocal("carry"),[...j.setLocal("last",j.i32_const(0)),...j.setLocal("carry",j.i32_const(1)),...m(1)],[...j.setLocal("last",j.i32_const(0)),...j.setLocal("carry",j.i32_const(1)),...m(255)]),j.if(j.getLocal("carry"),[...j.setLocal("last",j.i32_const(0)),...j.setLocal("carry",j.i32_const(1)),...m(255)],[...j.setLocal("last",j.i32_const(0)),...j.setLocal("carry",j.i32_const(0)),...m(1)])),j.if(j.getLocal("cur"),j.if(j.getLocal("carry"),[...j.setLocal("last",j.i32_const(0)),...j.setLocal("carry",j.i32_const(1)),...m(0)],[...j.setLocal("last",j.i32_const(1)),...j.setLocal("carry",j.i32_const(0)),...m(0)]),j.if(j.getLocal("carry"),[...j.setLocal("last",j.i32_const(1)),...j.setLocal("carry",j.i32_const(0)),...m(0)],[...j.setLocal("last",j.i32_const(0)),...j.setLocal("carry",j.i32_const(0)),...m(0)]))),j.setLocal("i",j.i32_add(j.getLocal("i"),j.i32_const(1))),j.br(0))),j.if(j.getLocal("last"),j.if(j.getLocal("carry"),[...m(255),...m(0),...m(1)],[...m(1)]),j.if(j.getLocal("carry"),[...m(0),...m(1)])),j.setLocal("p",j.i32_sub(j.getLocal("p"),j.i32_const(1))),j.call(g,j.getLocal("base"),k),j.call(h,j.getLocal("r")),j.block(j.loop(j.call(e,j.getLocal("r"),j.getLocal("r")),j.setLocal("cur",j.i32_load8_u(j.getLocal("p"))),j.if(j.getLocal("cur"),j.if(j.i32_eq(j.getLocal("cur"),j.i32_const(1)),j.call(d,j.getLocal("r"),k,j.getLocal("r")),j.call(f,j.getLocal("r"),k,j.getLocal("r")))),j.br_if(1,j.i32_eq(j.getLocal("old0"),j.getLocal("p"))),j.setLocal("p",j.i32_sub(j.getLocal("p"),j.i32_const(1))),j.br(0))),j.i32_store(j.i32_const(0),j.getLocal("old0")))}},5780:a=>{a.exports=function(a,b){let c=8*a.modules[b].n64,d=a.addFunction(b+"_batchInverse");d.addParam("pIn","i32"),d.addParam("inStep","i32"),d.addParam("n","i32"),d.addParam("pOut","i32"),d.addParam("outStep","i32"),d.addLocal("itAux","i32"),d.addLocal("itIn","i32"),d.addLocal("itOut","i32"),d.addLocal("i","i32");let e=d.getCodeBuilder(),f=e.i32_const(a.alloc(c));d.addCode(e.setLocal("itAux",e.i32_load(e.i32_const(0))),e.i32_store(e.i32_const(0),e.i32_add(e.getLocal("itAux"),e.i32_mul(e.i32_add(e.getLocal("n"),e.i32_const(1)),e.i32_const(c))))),d.addCode(e.call(b+"_one",e.getLocal("itAux")),e.setLocal("itIn",e.getLocal("pIn")),e.setLocal("itAux",e.i32_add(e.getLocal("itAux"),e.i32_const(c))),e.setLocal("i",e.i32_const(0)),e.block(e.loop(e.br_if(1,e.i32_eq(e.getLocal("i"),e.getLocal("n"))),e.if(e.call(b+"_isZero",e.getLocal("itIn")),e.call(b+"_copy",e.i32_sub(e.getLocal("itAux"),e.i32_const(c)),e.getLocal("itAux")),e.call(b+"_mul",e.getLocal("itIn"),e.i32_sub(e.getLocal("itAux"),e.i32_const(c)),e.getLocal("itAux"))),e.setLocal("itIn",e.i32_add(e.getLocal("itIn"),e.getLocal("inStep"))),e.setLocal("itAux",e.i32_add(e.getLocal("itAux"),e.i32_const(c))),e.setLocal("i",e.i32_add(e.getLocal("i"),e.i32_const(1))),e.br(0))),e.setLocal("itIn",e.i32_sub(e.getLocal("itIn"),e.getLocal("inStep"))),e.setLocal("itAux",e.i32_sub(e.getLocal("itAux"),e.i32_const(c))),e.setLocal("itOut",e.i32_add(e.getLocal("pOut"),e.i32_mul(e.i32_sub(e.getLocal("n"),e.i32_const(1)),e.getLocal("outStep")))),e.call(b+"_inverse",e.getLocal("itAux"),e.getLocal("itAux")),e.block(e.loop(e.br_if(1,e.i32_eqz(e.getLocal("i"))),e.if(e.call(b+"_isZero",e.getLocal("itIn")),[...e.call(b+"_copy",e.getLocal("itAux"),e.i32_sub(e.getLocal("itAux"),e.i32_const(c))),...e.call(b+"_zero",e.getLocal("itOut"))],[...e.call(b+"_copy",e.i32_sub(e.getLocal("itAux"),e.i32_const(c)),f),...e.call(b+"_mul",e.getLocal("itAux"),e.getLocal("itIn"),e.i32_sub(e.getLocal("itAux"),e.i32_const(c))),...e.call(b+"_mul",e.getLocal("itAux"),f,e.getLocal("itOut"))]),e.setLocal("itIn",e.i32_sub(e.getLocal("itIn"),e.getLocal("inStep"))),e.setLocal("itOut",e.i32_sub(e.getLocal("itOut"),e.getLocal("outStep"))),e.setLocal("itAux",e.i32_sub(e.getLocal("itAux"),e.i32_const(c))),e.setLocal("i",e.i32_sub(e.getLocal("i"),e.i32_const(1))),e.br(0)))),d.addCode(e.i32_store(e.i32_const(0),e.getLocal("itAux")))}},6129:a=>{function b(a){return Promise.resolve().then(()=>{var b=Error("Cannot find module '"+a+"'");throw b.code="MODULE_NOT_FOUND",b})}b.keys=()=>[],b.resolve=b,b.id=6129,a.exports=b},6169:(a,b,c)=>{let d=c(8614),{bitLength:e}=c(2090);a.exports=function(a,b,c,f,g){let h,i,j,k,l,m,n,o,p,q=BigInt(b),r=Math.floor((e(q-1n)-1)/64)+1,s=c||"f1";if(a.modules[s])return s;a.modules[s]={n64:r};let t=g||"int",u=d(a,q,f,t),v=a.modules[u].pR2,w=a.modules[u].pq,x=a.modules[u].pePlusOne;return h=a.alloc(8*r),(i=a.addFunction(s+"_mul")).addParam("x","i32"),i.addParam("y","i32"),i.addParam("r","i32"),j=i.getCodeBuilder(),i.addCode(j.call(u+"_mul",j.getLocal("x"),j.getLocal("y"),j.i32_const(h))),i.addCode(j.call(u+"_mul",j.i32_const(h),j.i32_const(v),j.getLocal("r"))),(k=a.addFunction(s+"_square")).addParam("x","i32"),k.addParam("r","i32"),l=k.getCodeBuilder(),k.addCode(l.call(s+"_mul",l.getLocal("x"),l.getLocal("x"),l.getLocal("r"))),(m=a.addFunction(s+"_inverse")).addParam("x","i32"),m.addParam("r","i32"),n=m.getCodeBuilder(),m.addCode(n.call(t+"_inverseMod",n.getLocal("x"),n.i32_const(w),n.getLocal("r"))),(o=a.addFunction(s+"_isNegative")).addParam("x","i32"),o.setReturnType("i32"),p=o.getCodeBuilder(),o.addCode(p.call(t+"_gte",p.getLocal("x"),p.i32_const(x))),a.exportFunction(u+"_add",s+"_add"),a.exportFunction(u+"_sub",s+"_sub"),a.exportFunction(u+"_neg",s+"_neg"),a.exportFunction(s+"_mul"),a.exportFunction(s+"_square"),a.exportFunction(s+"_inverse"),a.exportFunction(s+"_isNegative"),a.exportFunction(u+"_copy",s+"_copy"),a.exportFunction(u+"_zero",s+"_zero"),a.exportFunction(u+"_one",s+"_one"),a.exportFunction(u+"_isZero",s+"_isZero"),a.exportFunction(u+"_eq",s+"_eq"),s}},6681:a=>{a.exports=function(a,b,c){let d,e,f,g,h,i=8*a.modules[c].n64;return(d=a.addFunction(b+"_zero")).addParam("px","i32"),d.addParam("n","i32"),d.addLocal("lastp","i32"),d.addLocal("p","i32"),e=d.getCodeBuilder(),d.addCode(e.setLocal("p",e.getLocal("px")),e.setLocal("lastp",e.i32_add(e.getLocal("px"),e.i32_mul(e.getLocal("n"),e.i32_const(i)))),e.block(e.loop(e.br_if(1,e.i32_eq(e.getLocal("p"),e.getLocal("lastp"))),e.call(c+"_zero",e.getLocal("p")),e.setLocal("p",e.i32_add(e.getLocal("p"),e.i32_const(i))),e.br(0)))),(f=a.addFunction(b+"_constructLC")).addParam("ppolynomials","i32"),f.addParam("psignals","i32"),f.addParam("nSignals","i32"),f.addParam("pres","i32"),f.addLocal("i","i32"),f.addLocal("j","i32"),f.addLocal("pp","i32"),f.addLocal("ps","i32"),f.addLocal("pd","i32"),f.addLocal("ncoefs","i32"),h=(g=f.getCodeBuilder()).i32_const(a.alloc(i)),f.addCode(g.setLocal("i",g.i32_const(0)),g.setLocal("pp",g.getLocal("ppolynomials")),g.setLocal("ps",g.getLocal("psignals")),g.block(g.loop(g.br_if(1,g.i32_eq(g.getLocal("i"),g.getLocal("nSignals"))),g.setLocal("ncoefs",g.i32_load(g.getLocal("pp"))),g.setLocal("pp",g.i32_add(g.getLocal("pp"),g.i32_const(4))),g.setLocal("j",g.i32_const(0)),g.block(g.loop(g.br_if(1,g.i32_eq(g.getLocal("j"),g.getLocal("ncoefs"))),g.setLocal("pd",g.i32_add(g.getLocal("pres"),g.i32_mul(g.i32_load(g.getLocal("pp")),g.i32_const(i)))),g.setLocal("pp",g.i32_add(g.getLocal("pp"),g.i32_const(4))),g.call(c+"_mul",g.getLocal("ps"),g.getLocal("pp"),h),g.call(c+"_add",h,g.getLocal("pd"),g.getLocal("pd")),g.setLocal("pp",g.i32_add(g.getLocal("pp"),g.i32_const(i))),g.setLocal("j",g.i32_add(g.getLocal("j"),g.i32_const(1))),g.br(0))),g.setLocal("ps",g.i32_add(g.getLocal("ps"),g.i32_const(i))),g.setLocal("i",g.i32_add(g.getLocal("i"),g.i32_const(1))),g.br(0)))),a.exportFunction(b+"_zero"),a.exportFunction(b+"_constructLC"),b}},7027:a=>{a.exports=function(a,b,c,d,e,f,g,h){let i=a.addFunction(b);i.addParam("pIn","i32"),i.addParam("n","i32"),i.addParam("pFirst","i32"),i.addParam("pInc","i32"),i.addParam("pOut","i32"),i.addLocal("pOldFree","i32"),i.addLocal("i","i32"),i.addLocal("pFrom","i32"),i.addLocal("pTo","i32");let j=i.getCodeBuilder(),k=j.i32_const(a.alloc(g));i.addCode(j.setLocal("pFrom",j.getLocal("pIn")),j.setLocal("pTo",j.getLocal("pOut"))),i.addCode(j.call(d+"_copy",j.getLocal("pFirst"),k)),i.addCode(j.setLocal("i",j.i32_const(0)),j.block(j.loop(j.br_if(1,j.i32_eq(j.getLocal("i"),j.getLocal("n"))),j.call(h,j.getLocal("pFrom"),k,j.getLocal("pTo")),j.setLocal("pFrom",j.i32_add(j.getLocal("pFrom"),j.i32_const(e))),j.setLocal("pTo",j.i32_add(j.getLocal("pTo"),j.i32_const(f))),j.call(d+"_mul",k,j.getLocal("pInc"),k),j.setLocal("i",j.i32_add(j.getLocal("i"),j.i32_const(1))),j.br(0)))),a.exportFunction(b)}},7032:a=>{a.exports=function(a,b,c,d,e,f,g){let h=a.addFunction(b);h.addParam("base","i32"),h.addParam("scalar","i32"),h.addParam("scalarLength","i32"),h.addParam("r","i32"),h.addLocal("i","i32"),h.addLocal("b","i32");let i=h.getCodeBuilder(),j=i.i32_const(a.alloc(c));h.addCode(i.if(i.i32_eqz(i.getLocal("scalarLength")),[...i.call(g,i.getLocal("r")),...i.ret([])])),h.addCode(i.call(f,i.getLocal("base"),j)),h.addCode(i.call(g,i.getLocal("r"))),h.addCode(i.setLocal("i",i.getLocal("scalarLength"))),h.addCode(i.block(i.loop(i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.setLocal("b",i.i32_load8_u(i.i32_add(i.getLocal("scalar"),i.getLocal("i")))),...function(){let a=[];for(let b=0;b<8;b++)a.push(...i.call(e,i.getLocal("r"),i.getLocal("r")),...i.if(i.i32_ge_u(i.getLocal("b"),i.i32_const(128>>b)),[...i.setLocal("b",i.i32_sub(i.getLocal("b"),i.i32_const(128>>b))),...i.call(d,i.getLocal("r"),j,i.getLocal("r"))]));return a}(),i.br_if(1,i.i32_eqz(i.getLocal("i"))),i.br(0))))}},7456:a=>{a.exports=function(a,b,c){let d,e,f,g,h,i,j,k,l=8*a.modules[c].n64;return(d=a.addFunction(b+"_buildABC")).addParam("pCoefs","i32"),d.addParam("nCoefs","i32"),d.addParam("pWitness","i32"),d.addParam("pA","i32"),d.addParam("pB","i32"),d.addParam("pC","i32"),d.addParam("offsetOut","i32"),d.addParam("nOut","i32"),d.addParam("offsetWitness","i32"),d.addParam("nWitness","i32"),d.addLocal("it","i32"),d.addLocal("ita","i32"),d.addLocal("itb","i32"),d.addLocal("last","i32"),d.addLocal("m","i32"),d.addLocal("c","i32"),d.addLocal("s","i32"),d.addLocal("pOut","i32"),f=(e=d.getCodeBuilder()).i32_const(a.alloc(l)),d.addCode(e.setLocal("ita",e.getLocal("pA")),e.setLocal("itb",e.getLocal("pB")),e.setLocal("last",e.i32_add(e.getLocal("pA"),e.i32_mul(e.getLocal("nOut"),e.i32_const(l)))),e.block(e.loop(e.br_if(1,e.i32_eq(e.getLocal("ita"),e.getLocal("last"))),e.call(c+"_zero",e.getLocal("ita")),e.call(c+"_zero",e.getLocal("itb")),e.setLocal("ita",e.i32_add(e.getLocal("ita"),e.i32_const(l))),e.setLocal("itb",e.i32_add(e.getLocal("itb"),e.i32_const(l))),e.br(0))),e.setLocal("it",e.getLocal("pCoefs")),e.setLocal("last",e.i32_add(e.getLocal("pCoefs"),e.i32_mul(e.getLocal("nCoefs"),e.i32_const(l+12)))),e.block(e.loop(e.br_if(1,e.i32_eq(e.getLocal("it"),e.getLocal("last"))),e.setLocal("s",e.i32_load(e.getLocal("it"),8)),e.if(e.i32_or(e.i32_lt_u(e.getLocal("s"),e.getLocal("offsetWitness")),e.i32_ge_u(e.getLocal("s"),e.i32_add(e.getLocal("offsetWitness"),e.getLocal("nWitness")))),[...e.setLocal("it",e.i32_add(e.getLocal("it"),e.i32_const(l+12))),...e.br(1)]),e.setLocal("m",e.i32_load(e.getLocal("it"))),e.if(e.i32_eq(e.getLocal("m"),e.i32_const(0)),e.setLocal("pOut",e.getLocal("pA")),e.if(e.i32_eq(e.getLocal("m"),e.i32_const(1)),e.setLocal("pOut",e.getLocal("pB")),[...e.setLocal("it",e.i32_add(e.getLocal("it"),e.i32_const(l+12))),...e.br(1)])),e.setLocal("c",e.i32_load(e.getLocal("it"),4)),e.if(e.i32_or(e.i32_lt_u(e.getLocal("c"),e.getLocal("offsetOut")),e.i32_ge_u(e.getLocal("c"),e.i32_add(e.getLocal("offsetOut"),e.getLocal("nOut")))),[...e.setLocal("it",e.i32_add(e.getLocal("it"),e.i32_const(l+12))),...e.br(1)]),e.setLocal("pOut",e.i32_add(e.getLocal("pOut"),e.i32_mul(e.i32_sub(e.getLocal("c"),e.getLocal("offsetOut")),e.i32_const(l)))),e.call(c+"_mul",e.i32_add(e.getLocal("pWitness"),e.i32_mul(e.i32_sub(e.getLocal("s"),e.getLocal("offsetWitness")),e.i32_const(l))),e.i32_add(e.getLocal("it"),e.i32_const(12)),f),e.call(c+"_add",e.getLocal("pOut"),f,e.getLocal("pOut")),e.setLocal("it",e.i32_add(e.getLocal("it"),e.i32_const(l+12))),e.br(0))),e.setLocal("ita",e.getLocal("pA")),e.setLocal("itb",e.getLocal("pB")),e.setLocal("it",e.getLocal("pC")),e.setLocal("last",e.i32_add(e.getLocal("pA"),e.i32_mul(e.getLocal("nOut"),e.i32_const(l)))),e.block(e.loop(e.br_if(1,e.i32_eq(e.getLocal("ita"),e.getLocal("last"))),e.call(c+"_mul",e.getLocal("ita"),e.getLocal("itb"),e.getLocal("it")),e.setLocal("ita",e.i32_add(e.getLocal("ita"),e.i32_const(l))),e.setLocal("itb",e.i32_add(e.getLocal("itb"),e.i32_const(l))),e.setLocal("it",e.i32_add(e.getLocal("it"),e.i32_const(l))),e.br(0)))),(g=a.addFunction(b+"_joinABC")).addParam("pA","i32"),g.addParam("pB","i32"),g.addParam("pC","i32"),g.addParam("n","i32"),g.addParam("pP","i32"),g.addLocal("ita","i32"),g.addLocal("itb","i32"),g.addLocal("itc","i32"),g.addLocal("itp","i32"),g.addLocal("last","i32"),i=(h=g.getCodeBuilder()).i32_const(a.alloc(l)),g.addCode(h.setLocal("ita",h.getLocal("pA")),h.setLocal("itb",h.getLocal("pB")),h.setLocal("itc",h.getLocal("pC")),h.setLocal("itp",h.getLocal("pP")),h.setLocal("last",h.i32_add(h.getLocal("pA"),h.i32_mul(h.getLocal("n"),h.i32_const(l)))),h.block(h.loop(h.br_if(1,h.i32_eq(h.getLocal("ita"),h.getLocal("last"))),h.call(c+"_mul",h.getLocal("ita"),h.getLocal("itb"),i),h.call(c+"_sub",i,h.getLocal("itc"),h.getLocal("itp")),h.setLocal("ita",h.i32_add(h.getLocal("ita"),h.i32_const(l))),h.setLocal("itb",h.i32_add(h.getLocal("itb"),h.i32_const(l))),h.setLocal("itc",h.i32_add(h.getLocal("itc"),h.i32_const(l))),h.setLocal("itp",h.i32_add(h.getLocal("itp"),h.i32_const(l))),h.br(0)))),(j=a.addFunction(b+"_batchAdd")).addParam("pa","i32"),j.addParam("pb","i32"),j.addParam("n","i32"),j.addParam("pr","i32"),j.addLocal("ita","i32"),j.addLocal("itb","i32"),j.addLocal("itr","i32"),j.addLocal("last","i32"),k=j.getCodeBuilder(),j.addCode(k.setLocal("ita",k.getLocal("pa")),k.setLocal("itb",k.getLocal("pb")),k.setLocal("itr",k.getLocal("pr")),k.setLocal("last",k.i32_add(k.getLocal("pa"),k.i32_mul(k.getLocal("n"),k.i32_const(l)))),k.block(k.loop(k.br_if(1,k.i32_eq(k.getLocal("ita"),k.getLocal("last"))),k.call(c+"_add",k.getLocal("ita"),k.getLocal("itb"),k.getLocal("itr")),k.setLocal("ita",k.i32_add(k.getLocal("ita"),k.i32_const(l))),k.setLocal("itb",k.i32_add(k.getLocal("itb"),k.i32_const(l))),k.setLocal("itr",k.i32_add(k.getLocal("itr"),k.i32_const(l))),k.br(0)))),a.exportFunction(b+"_buildABC"),a.exportFunction(b+"_joinABC"),a.exportFunction(b+"_batchAdd"),b}},7706:a=>{function b(a){var b=Error("Cannot find module '"+a+"'");throw b.code="MODULE_NOT_FOUND",b}b.keys=()=>[],b.resolve=b,b.id=7706,a.exports=b},8558:(a,b,c)=>{let{isOdd:d,modInv:e,modPow:f}=c(2090),g=c(3140);a.exports=function(a,b,c,h,i){let j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa=8*a.modules[h].n64,ab=8*a.modules[c].n64,ac=a.modules[h].q,ad=ac-1n,ae=0;for(;!d(ad);)ae++,ad>>=1n;let af=2n;for(;1n===f(af,ac>>1n,ac);)af+=1n;let ag=Array(ae+1);ag[ae]=f(af,ad,ac);let ah=ae-1;for(;ah>=0;)ag[ah]=f(ag[ah+1],2n,ac),ah--;let ai=[],aj=(1n<<BigInt(8*aa))%ac;for(let a=0;a<ag.length;a++){let b=ag[a]*aj%ac;ai.push(...g.bigInt2BytesLE(b,aa))}let ak=a.alloc(ai),al=Array(ae+1);al[0]=1n;for(let a=1;a<=ae;a++)al[a]=2n*al[a-1];let am=[];for(let a=0;a<=ae;a++){let b=e(al[a],ac)*aj%ac;am.push(...g.bigInt2BytesLE(b,aa))}let an=a.alloc(am),ao=f(af,2n,ac),ap=[],aq=[];for(let a=0;a<=ae;a++){let b=f(ao,2n**BigInt(a),ac),c=e(ac+1n-b,ac);ap.push(...g.bigInt2BytesLE(b*aj%ac,aa)),aq.push(...g.bigInt2BytesLE(c*aj%ac,aa))}let ar=a.alloc(ap),as=a.alloc(aq),at=Array(256);for(let a=0;a<256;a++)at[a]=function(a){let b=0;for(let c=0;c<8;c++)a&1<<c&&(b|=128>>c);return b}(a);let au=a.alloc(at);(j=a.addFunction(b+"__rev")).addParam("x","i32"),j.addParam("bits","i32"),j.setReturnType("i32"),k=j.getCodeBuilder(),j.addCode(k.i32_rotl(k.i32_add(k.i32_add(k.i32_shl(k.i32_load8_u(k.i32_and(k.getLocal("x"),k.i32_const(255)),au,0),k.i32_const(24)),k.i32_shl(k.i32_load8_u(k.i32_and(k.i32_shr_u(k.getLocal("x"),k.i32_const(8)),k.i32_const(255)),au,0),k.i32_const(16))),k.i32_add(k.i32_shl(k.i32_load8_u(k.i32_and(k.i32_shr_u(k.getLocal("x"),k.i32_const(16)),k.i32_const(255)),au,0),k.i32_const(8)),k.i32_load8_u(k.i32_and(k.i32_shr_u(k.getLocal("x"),k.i32_const(24)),k.i32_const(255)),au,0))),k.getLocal("bits"))),(l=a.addFunction(b+"__reversePermutation")).addParam("px","i32"),l.addParam("bits","i32"),l.addLocal("n","i32"),l.addLocal("i","i32"),l.addLocal("ri","i32"),l.addLocal("idx1","i32"),l.addLocal("idx2","i32"),n=(m=l.getCodeBuilder()).i32_const(a.alloc(ab)),l.addCode(m.setLocal("n",m.i32_shl(m.i32_const(1),m.getLocal("bits"))),m.setLocal("i",m.i32_const(0)),m.block(m.loop(m.br_if(1,m.i32_eq(m.getLocal("i"),m.getLocal("n"))),m.setLocal("idx1",m.i32_add(m.getLocal("px"),m.i32_mul(m.getLocal("i"),m.i32_const(ab)))),m.setLocal("ri",m.call(b+"__rev",m.getLocal("i"),m.getLocal("bits"))),m.setLocal("idx2",m.i32_add(m.getLocal("px"),m.i32_mul(m.getLocal("ri"),m.i32_const(ab)))),m.if(m.i32_lt_u(m.getLocal("i"),m.getLocal("ri")),[...m.call(c+"_copy",m.getLocal("idx1"),n),...m.call(c+"_copy",m.getLocal("idx2"),m.getLocal("idx1")),...m.call(c+"_copy",n,m.getLocal("idx2"))]),m.setLocal("i",m.i32_add(m.getLocal("i"),m.i32_const(1))),m.br(0)))),(o=a.addFunction(b+"__fftFinal")).addParam("px","i32"),o.addParam("bits","i32"),o.addParam("reverse","i32"),o.addParam("mulFactor","i32"),o.addLocal("n","i32"),o.addLocal("ndiv2","i32"),o.addLocal("pInv2","i32"),o.addLocal("i","i32"),o.addLocal("mask","i32"),o.addLocal("idx1","i32"),o.addLocal("idx2","i32"),q=(p=o.getCodeBuilder()).i32_const(a.alloc(ab)),o.addCode(p.if(p.i32_and(p.i32_eqz(p.getLocal("reverse")),p.call(h+"_isOne",p.getLocal("mulFactor"))),p.ret([])),p.setLocal("n",p.i32_shl(p.i32_const(1),p.getLocal("bits"))),p.setLocal("mask",p.i32_sub(p.getLocal("n"),p.i32_const(1))),p.setLocal("i",p.i32_const(1)),p.setLocal("ndiv2",p.i32_shr_u(p.getLocal("n"),p.i32_const(1))),p.block(p.loop(p.br_if(1,p.i32_ge_u(p.getLocal("i"),p.getLocal("ndiv2"))),p.setLocal("idx1",p.i32_add(p.getLocal("px"),p.i32_mul(p.getLocal("i"),p.i32_const(ab)))),p.setLocal("idx2",p.i32_add(p.getLocal("px"),p.i32_mul(p.i32_sub(p.getLocal("n"),p.getLocal("i")),p.i32_const(ab)))),p.if(p.getLocal("reverse"),p.if(p.call(h+"_isOne",p.getLocal("mulFactor")),[...p.call(c+"_copy",p.getLocal("idx1"),q),...p.call(c+"_copy",p.getLocal("idx2"),p.getLocal("idx1")),...p.call(c+"_copy",q,p.getLocal("idx2"))],[...p.call(c+"_copy",p.getLocal("idx1"),q),...p.call(i,p.getLocal("idx2"),p.getLocal("mulFactor"),p.getLocal("idx1")),...p.call(i,q,p.getLocal("mulFactor"),p.getLocal("idx2"))]),p.if(p.call(h+"_isOne",p.getLocal("mulFactor")),[],[...p.call(i,p.getLocal("idx1"),p.getLocal("mulFactor"),p.getLocal("idx1")),...p.call(i,p.getLocal("idx2"),p.getLocal("mulFactor"),p.getLocal("idx2"))])),p.setLocal("i",p.i32_add(p.getLocal("i"),p.i32_const(1))),p.br(0))),p.if(p.call(h+"_isOne",p.getLocal("mulFactor")),[],[...p.call(i,p.getLocal("px"),p.getLocal("mulFactor"),p.getLocal("px")),...p.setLocal("idx2",p.i32_add(p.getLocal("px"),p.i32_mul(p.getLocal("ndiv2"),p.i32_const(ab)))),...p.call(i,p.getLocal("idx2"),p.getLocal("mulFactor"),p.getLocal("idx2"))])),(r=a.addFunction(b+"_rawfft")).addParam("px","i32"),r.addParam("bits","i32"),r.addParam("reverse","i32"),r.addParam("mulFactor","i32"),r.addLocal("s","i32"),r.addLocal("k","i32"),r.addLocal("j","i32"),r.addLocal("m","i32"),r.addLocal("mdiv2","i32"),r.addLocal("n","i32"),r.addLocal("pwm","i32"),r.addLocal("idx1","i32"),r.addLocal("idx2","i32"),t=(s=r.getCodeBuilder()).i32_const(a.alloc(aa)),u=s.i32_const(a.alloc(ab)),v=s.i32_const(a.alloc(ab)),r.addCode(s.call(b+"__reversePermutation",s.getLocal("px"),s.getLocal("bits")),s.setLocal("n",s.i32_shl(s.i32_const(1),s.getLocal("bits"))),s.setLocal("s",s.i32_const(1)),s.block(s.loop(s.br_if(1,s.i32_gt_u(s.getLocal("s"),s.getLocal("bits"))),s.setLocal("m",s.i32_shl(s.i32_const(1),s.getLocal("s"))),s.setLocal("pwm",s.i32_add(s.i32_const(ak),s.i32_mul(s.getLocal("s"),s.i32_const(aa)))),s.setLocal("k",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_ge_u(s.getLocal("k"),s.getLocal("n"))),s.call(h+"_one",t),s.setLocal("mdiv2",s.i32_shr_u(s.getLocal("m"),s.i32_const(1))),s.setLocal("j",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_ge_u(s.getLocal("j"),s.getLocal("mdiv2"))),s.setLocal("idx1",s.i32_add(s.getLocal("px"),s.i32_mul(s.i32_add(s.getLocal("k"),s.getLocal("j")),s.i32_const(ab)))),s.setLocal("idx2",s.i32_add(s.getLocal("idx1"),s.i32_mul(s.getLocal("mdiv2"),s.i32_const(ab)))),s.call(i,s.getLocal("idx2"),t,u),s.call(c+"_copy",s.getLocal("idx1"),v),s.call(c+"_add",v,u,s.getLocal("idx1")),s.call(c+"_sub",v,u,s.getLocal("idx2")),s.call(h+"_mul",t,s.getLocal("pwm"),t),s.setLocal("j",s.i32_add(s.getLocal("j"),s.i32_const(1))),s.br(0))),s.setLocal("k",s.i32_add(s.getLocal("k"),s.getLocal("m"))),s.br(0))),s.setLocal("s",s.i32_add(s.getLocal("s"),s.i32_const(1))),s.br(0))),s.call(b+"__fftFinal",s.getLocal("px"),s.getLocal("bits"),s.getLocal("reverse"),s.getLocal("mulFactor"))),(w=a.addFunction(b+"__log2")).addParam("n","i32"),w.setReturnType("i32"),w.addLocal("bits","i32"),w.addLocal("aux","i32"),x=w.getCodeBuilder(),w.addCode(x.setLocal("aux",x.i32_shr_u(x.getLocal("n"),x.i32_const(1)))),w.addCode(x.setLocal("bits",x.i32_const(0))),w.addCode(x.block(x.loop(x.br_if(1,x.i32_eqz(x.getLocal("aux"))),x.setLocal("aux",x.i32_shr_u(x.getLocal("aux"),x.i32_const(1))),x.setLocal("bits",x.i32_add(x.getLocal("bits"),x.i32_const(1))),x.br(0)))),w.addCode(x.if(x.i32_ne(x.getLocal("n"),x.i32_shl(x.i32_const(1),x.getLocal("bits"))),x.unreachable())),w.addCode(x.if(x.i32_gt_u(x.getLocal("bits"),x.i32_const(ae)),x.unreachable())),w.addCode(x.getLocal("bits")),(y=a.addFunction(b+"_fft")).addParam("px","i32"),y.addParam("n","i32"),y.addLocal("bits","i32"),A=(z=y.getCodeBuilder()).i32_const(a.alloc(aa)),y.addCode(z.setLocal("bits",z.call(b+"__log2",z.getLocal("n"))),z.call(h+"_one",A),z.call(b+"_rawfft",z.getLocal("px"),z.getLocal("bits"),z.i32_const(0),A)),(B=a.addFunction(b+"_ifft")).addParam("px","i32"),B.addParam("n","i32"),B.addLocal("bits","i32"),B.addLocal("pInv2","i32"),C=B.getCodeBuilder(),B.addCode(C.setLocal("bits",C.call(b+"__log2",C.getLocal("n"))),C.setLocal("pInv2",C.i32_add(C.i32_const(an),C.i32_mul(C.getLocal("bits"),C.i32_const(aa)))),C.call(b+"_rawfft",C.getLocal("px"),C.getLocal("bits"),C.i32_const(1),C.getLocal("pInv2"))),(D=a.addFunction(b+"_fftJoin")).addParam("pBuff1","i32"),D.addParam("pBuff2","i32"),D.addParam("n","i32"),D.addParam("first","i32"),D.addParam("inc","i32"),D.addLocal("idx1","i32"),D.addLocal("idx2","i32"),D.addLocal("i","i32"),F=(E=D.getCodeBuilder()).i32_const(a.alloc(aa)),G=E.i32_const(a.alloc(ab)),H=E.i32_const(a.alloc(ab)),D.addCode(E.call(h+"_copy",E.getLocal("first"),F),E.setLocal("i",E.i32_const(0)),E.block(E.loop(E.br_if(1,E.i32_eq(E.getLocal("i"),E.getLocal("n"))),E.setLocal("idx1",E.i32_add(E.getLocal("pBuff1"),E.i32_mul(E.getLocal("i"),E.i32_const(ab)))),E.setLocal("idx2",E.i32_add(E.getLocal("pBuff2"),E.i32_mul(E.getLocal("i"),E.i32_const(ab)))),E.call(i,E.getLocal("idx2"),F,G),E.call(c+"_copy",E.getLocal("idx1"),H),E.call(c+"_add",H,G,E.getLocal("idx1")),E.call(c+"_sub",H,G,E.getLocal("idx2")),E.call(h+"_mul",F,E.getLocal("inc"),F),E.setLocal("i",E.i32_add(E.getLocal("i"),E.i32_const(1))),E.br(0)))),(I=a.addFunction(b+"_fftJoinExt")).addParam("pBuff1","i32"),I.addParam("pBuff2","i32"),I.addParam("n","i32"),I.addParam("first","i32"),I.addParam("inc","i32"),I.addParam("totalBits","i32"),I.addLocal("idx1","i32"),I.addLocal("idx2","i32"),I.addLocal("i","i32"),I.addLocal("pShiftToM","i32"),K=(J=I.getCodeBuilder()).i32_const(a.alloc(aa)),L=J.i32_const(a.alloc(ab)),I.addCode(J.setLocal("pShiftToM",J.i32_add(J.i32_const(ar),J.i32_mul(J.getLocal("totalBits"),J.i32_const(aa)))),J.call(h+"_copy",J.getLocal("first"),K),J.setLocal("i",J.i32_const(0)),J.block(J.loop(J.br_if(1,J.i32_eq(J.getLocal("i"),J.getLocal("n"))),J.setLocal("idx1",J.i32_add(J.getLocal("pBuff1"),J.i32_mul(J.getLocal("i"),J.i32_const(ab)))),J.setLocal("idx2",J.i32_add(J.getLocal("pBuff2"),J.i32_mul(J.getLocal("i"),J.i32_const(ab)))),J.call(c+"_add",J.getLocal("idx1"),J.getLocal("idx2"),L),J.call(i,J.getLocal("idx2"),J.getLocal("pShiftToM"),J.getLocal("idx2")),J.call(c+"_add",J.getLocal("idx1"),J.getLocal("idx2"),J.getLocal("idx2")),J.call(i,J.getLocal("idx2"),K,J.getLocal("idx2")),J.call(c+"_copy",L,J.getLocal("idx1")),J.call(h+"_mul",K,J.getLocal("inc"),K),J.setLocal("i",J.i32_add(J.getLocal("i"),J.i32_const(1))),J.br(0)))),(M=a.addFunction(b+"_fftJoinExtInv")).addParam("pBuff1","i32"),M.addParam("pBuff2","i32"),M.addParam("n","i32"),M.addParam("first","i32"),M.addParam("inc","i32"),M.addParam("totalBits","i32"),M.addLocal("idx1","i32"),M.addLocal("idx2","i32"),M.addLocal("i","i32"),M.addLocal("pShiftToM","i32"),M.addLocal("pSConst","i32"),O=(N=M.getCodeBuilder()).i32_const(a.alloc(aa)),P=N.i32_const(a.alloc(ab)),M.addCode(N.setLocal("pShiftToM",N.i32_add(N.i32_const(ar),N.i32_mul(N.getLocal("totalBits"),N.i32_const(aa)))),N.setLocal("pSConst",N.i32_add(N.i32_const(as),N.i32_mul(N.getLocal("totalBits"),N.i32_const(aa)))),N.call(h+"_copy",N.getLocal("first"),O),N.setLocal("i",N.i32_const(0)),N.block(N.loop(N.br_if(1,N.i32_eq(N.getLocal("i"),N.getLocal("n"))),N.setLocal("idx1",N.i32_add(N.getLocal("pBuff1"),N.i32_mul(N.getLocal("i"),N.i32_const(ab)))),N.setLocal("idx2",N.i32_add(N.getLocal("pBuff2"),N.i32_mul(N.getLocal("i"),N.i32_const(ab)))),N.call(i,N.getLocal("idx2"),O,P),N.call(c+"_sub",N.getLocal("idx1"),P,N.getLocal("idx2")),N.call(i,N.getLocal("idx2"),N.getLocal("pSConst"),N.getLocal("idx2")),N.call(i,N.getLocal("idx1"),N.getLocal("pShiftToM"),N.getLocal("idx1")),N.call(c+"_sub",P,N.getLocal("idx1"),N.getLocal("idx1")),N.call(i,N.getLocal("idx1"),N.getLocal("pSConst"),N.getLocal("idx1")),N.call(h+"_mul",O,N.getLocal("inc"),O),N.setLocal("i",N.i32_add(N.getLocal("i"),N.i32_const(1))),N.br(0)))),(Q=a.addFunction(b+"_fftMix")).addParam("pBuff","i32"),Q.addParam("n","i32"),Q.addParam("exp","i32"),Q.addLocal("nGroups","i32"),Q.addLocal("nPerGroup","i32"),Q.addLocal("nPerGroupDiv2","i32"),Q.addLocal("pairOffset","i32"),Q.addLocal("idx1","i32"),Q.addLocal("idx2","i32"),Q.addLocal("i","i32"),Q.addLocal("j","i32"),Q.addLocal("pwm","i32"),S=(R=Q.getCodeBuilder()).i32_const(a.alloc(aa)),T=R.i32_const(a.alloc(ab)),U=R.i32_const(a.alloc(ab)),Q.addCode(R.setLocal("nPerGroup",R.i32_shl(R.i32_const(1),R.getLocal("exp"))),R.setLocal("nPerGroupDiv2",R.i32_shr_u(R.getLocal("nPerGroup"),R.i32_const(1))),R.setLocal("nGroups",R.i32_shr_u(R.getLocal("n"),R.getLocal("exp"))),R.setLocal("pairOffset",R.i32_mul(R.getLocal("nPerGroupDiv2"),R.i32_const(ab))),R.setLocal("pwm",R.i32_add(R.i32_const(ak),R.i32_mul(R.getLocal("exp"),R.i32_const(aa)))),R.setLocal("i",R.i32_const(0)),R.block(R.loop(R.br_if(1,R.i32_eq(R.getLocal("i"),R.getLocal("nGroups"))),R.call(h+"_one",S),R.setLocal("j",R.i32_const(0)),R.block(R.loop(R.br_if(1,R.i32_eq(R.getLocal("j"),R.getLocal("nPerGroupDiv2"))),R.setLocal("idx1",R.i32_add(R.getLocal("pBuff"),R.i32_mul(R.i32_add(R.i32_mul(R.getLocal("i"),R.getLocal("nPerGroup")),R.getLocal("j")),R.i32_const(ab)))),R.setLocal("idx2",R.i32_add(R.getLocal("idx1"),R.getLocal("pairOffset"))),R.call(i,R.getLocal("idx2"),S,T),R.call(c+"_copy",R.getLocal("idx1"),U),R.call(c+"_add",U,T,R.getLocal("idx1")),R.call(c+"_sub",U,T,R.getLocal("idx2")),R.call(h+"_mul",S,R.getLocal("pwm"),S),R.setLocal("j",R.i32_add(R.getLocal("j"),R.i32_const(1))),R.br(0))),R.setLocal("i",R.i32_add(R.getLocal("i"),R.i32_const(1))),R.br(0)))),(V=a.addFunction(b+"_fftFinal")).addParam("pBuff","i32"),V.addParam("n","i32"),V.addParam("factor","i32"),V.addLocal("idx1","i32"),V.addLocal("idx2","i32"),V.addLocal("i","i32"),V.addLocal("ndiv2","i32"),X=(W=V.getCodeBuilder()).i32_const(a.alloc(ab)),V.addCode(W.setLocal("ndiv2",W.i32_shr_u(W.getLocal("n"),W.i32_const(1))),W.if(W.i32_and(W.getLocal("n"),W.i32_const(1)),W.call(i,W.i32_add(W.getLocal("pBuff"),W.i32_mul(W.getLocal("ndiv2"),W.i32_const(ab))),W.getLocal("factor"),W.i32_add(W.getLocal("pBuff"),W.i32_mul(W.getLocal("ndiv2"),W.i32_const(ab))))),W.setLocal("i",W.i32_const(0)),W.block(W.loop(W.br_if(1,W.i32_ge_u(W.getLocal("i"),W.getLocal("ndiv2"))),W.setLocal("idx1",W.i32_add(W.getLocal("pBuff"),W.i32_mul(W.getLocal("i"),W.i32_const(ab)))),W.setLocal("idx2",W.i32_add(W.getLocal("pBuff"),W.i32_mul(W.i32_sub(W.i32_sub(W.getLocal("n"),W.i32_const(1)),W.getLocal("i")),W.i32_const(ab)))),W.call(i,W.getLocal("idx2"),W.getLocal("factor"),X),W.call(i,W.getLocal("idx1"),W.getLocal("factor"),W.getLocal("idx2")),W.call(c+"_copy",X,W.getLocal("idx1")),W.setLocal("i",W.i32_add(W.getLocal("i"),W.i32_const(1))),W.br(0)))),(Y=a.addFunction(b+"_prepareLagrangeEvaluation")).addParam("pBuff1","i32"),Y.addParam("pBuff2","i32"),Y.addParam("n","i32"),Y.addParam("first","i32"),Y.addParam("inc","i32"),Y.addParam("totalBits","i32"),Y.addLocal("idx1","i32"),Y.addLocal("idx2","i32"),Y.addLocal("i","i32"),Y.addLocal("pShiftToM","i32"),Y.addLocal("pSConst","i32"),$=(Z=Y.getCodeBuilder()).i32_const(a.alloc(aa)),_=Z.i32_const(a.alloc(ab)),Y.addCode(Z.setLocal("pShiftToM",Z.i32_add(Z.i32_const(ar),Z.i32_mul(Z.getLocal("totalBits"),Z.i32_const(aa)))),Z.setLocal("pSConst",Z.i32_add(Z.i32_const(as),Z.i32_mul(Z.getLocal("totalBits"),Z.i32_const(aa)))),Z.call(h+"_copy",Z.getLocal("first"),$),Z.setLocal("i",Z.i32_const(0)),Z.block(Z.loop(Z.br_if(1,Z.i32_eq(Z.getLocal("i"),Z.getLocal("n"))),Z.setLocal("idx1",Z.i32_add(Z.getLocal("pBuff1"),Z.i32_mul(Z.getLocal("i"),Z.i32_const(ab)))),Z.setLocal("idx2",Z.i32_add(Z.getLocal("pBuff2"),Z.i32_mul(Z.getLocal("i"),Z.i32_const(ab)))),Z.call(i,Z.getLocal("idx1"),Z.getLocal("pShiftToM"),_),Z.call(c+"_sub",Z.getLocal("idx2"),_,_),Z.call(c+"_sub",Z.getLocal("idx1"),Z.getLocal("idx2"),Z.getLocal("idx2")),Z.call(i,_,Z.getLocal("pSConst"),Z.getLocal("idx1")),Z.call(i,Z.getLocal("idx2"),$,Z.getLocal("idx2")),Z.call(h+"_mul",$,Z.getLocal("inc"),$),Z.setLocal("i",Z.i32_add(Z.getLocal("i"),Z.i32_const(1))),Z.br(0)))),a.exportFunction(b+"_fft"),a.exportFunction(b+"_ifft"),a.exportFunction(b+"_rawfft"),a.exportFunction(b+"_fftJoin"),a.exportFunction(b+"_fftJoinExt"),a.exportFunction(b+"_fftJoinExtInv"),a.exportFunction(b+"_fftMix"),a.exportFunction(b+"_fftFinal"),a.exportFunction(b+"_prepareLagrangeEvaluation")}},8614:(a,b,c)=>{let d=c(4211),e=c(3140),f=c(7032),g=c(5780),h=c(2045),i=c(9497),{bitLength:j,modInv:k,modPow:l,isPrime:m,isOdd:n,square:o}=c(2090);a.exports=function(a,b,c,p){let q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X=BigInt(b),Y=Math.floor((j(X-1n)-1)/64)+1,Z=2*Y,$=8*Y,_=c||"f1m";if(a.modules[_])return _;let aa=d(a,Y,p),ab=a.alloc($,e.bigInt2BytesLE(X,$)),ac=a.alloc(e.bigInt2BytesLE(o(1n<<BigInt(64*Y))%X,$)),ad=a.alloc(e.bigInt2BytesLE((1n<<BigInt(64*Y))%X,$)),ae=a.alloc(e.bigInt2BytesLE(0n,$)),af=X-1n,ag=af>>1n,ah=a.alloc($,e.bigInt2BytesLE(ag,$)),ai=a.alloc($,e.bigInt2BytesLE(ag+1n,$));a.modules[_]={pq:ab,pR2:ac,n64:Y,q:X,pOne:ad,pZero:ae,pePlusOne:ai};let aj=2n;if(m(X))for(;l(aj,ag,X)!==af;)aj+=1n;let ak=0,al=af;for(;!n(al)&&0n!==al;)ak++,al>>=1n;let am=a.alloc($,e.bigInt2BytesLE(al,$)),an=l(aj,al,X),ao=a.alloc(e.bigInt2BytesLE((an<<BigInt(64*Y))%X,$)),ap=al+1n>>1n,aq=a.alloc($,e.bigInt2BytesLE(ap,$));if(a.exportFunction(aa+"_copy",_+"_copy"),a.exportFunction(aa+"_zero",_+"_zero"),a.exportFunction(aa+"_isZero",_+"_isZero"),a.exportFunction(aa+"_eq",_+"_eq"),(q=a.addFunction(_+"_isOne")).addParam("x","i32"),q.setReturnType("i32"),r=q.getCodeBuilder(),q.addCode(r.ret(r.call(aa+"_eq",r.getLocal("x"),r.i32_const(ad)))),(s=a.addFunction(_+"_add")).addParam("x","i32"),s.addParam("y","i32"),s.addParam("r","i32"),t=s.getCodeBuilder(),s.addCode(t.if(t.call(aa+"_add",t.getLocal("x"),t.getLocal("y"),t.getLocal("r")),t.drop(t.call(aa+"_sub",t.getLocal("r"),t.i32_const(ab),t.getLocal("r"))),t.if(t.call(aa+"_gte",t.getLocal("r"),t.i32_const(ab)),t.drop(t.call(aa+"_sub",t.getLocal("r"),t.i32_const(ab),t.getLocal("r")))))),(u=a.addFunction(_+"_sub")).addParam("x","i32"),u.addParam("y","i32"),u.addParam("r","i32"),v=u.getCodeBuilder(),u.addCode(v.if(v.call(aa+"_sub",v.getLocal("x"),v.getLocal("y"),v.getLocal("r")),v.drop(v.call(aa+"_add",v.getLocal("r"),v.i32_const(ab),v.getLocal("r"))))),(w=a.addFunction(_+"_neg")).addParam("x","i32"),w.addParam("r","i32"),x=w.getCodeBuilder(),w.addCode(x.call(_+"_sub",x.i32_const(ae),x.getLocal("x"),x.getLocal("r"))),function(){let b=a.alloc(Z*Z*8),c=a.addFunction(_+"_mReduct");c.addParam("t","i32"),c.addParam("r","i32"),c.addLocal("np32","i64"),c.addLocal("c","i64"),c.addLocal("m","i64");let d=c.getCodeBuilder(),e=Number(4294967296n-k(X,4294967296n));c.addCode(d.setLocal("np32",d.i64_const(e)));for(let a=0;a<Z;a++){c.addCode(d.setLocal("c",d.i64_const(0))),c.addCode(d.setLocal("m",d.i64_and(d.i64_mul(d.i64_load32_u(d.getLocal("t"),4*a),d.getLocal("np32")),d.i64_const("0xFFFFFFFF"))));for(let b=0;b<Z;b++)c.addCode(d.setLocal("c",d.i64_add(d.i64_add(d.i64_load32_u(d.getLocal("t"),(a+b)*4),d.i64_shr_u(d.getLocal("c"),d.i64_const(32))),d.i64_mul(d.i64_load32_u(d.i32_const(ab),4*b),d.getLocal("m"))))),c.addCode(d.i64_store32(d.getLocal("t"),(a+b)*4,d.getLocal("c")));c.addCode(d.i64_store32(d.i32_const(b),4*a,d.i64_shr_u(d.getLocal("c"),d.i64_const(32))))}c.addCode(d.call(_+"_add",d.i32_const(b),d.i32_add(d.getLocal("t"),d.i32_const(4*Z)),d.getLocal("r")))}(),function(){let b=a.addFunction(_+"_mul");b.addParam("x","i32"),b.addParam("y","i32"),b.addParam("r","i32"),b.addLocal("c0","i64"),b.addLocal("c1","i64"),b.addLocal("np32","i64");for(let a=0;a<Z;a++)b.addLocal("x"+a,"i64"),b.addLocal("y"+a,"i64"),b.addLocal("m"+a,"i64"),b.addLocal("q"+a,"i64");let c=b.getCodeBuilder(),d=Number(4294967296n-k(X,4294967296n));b.addCode(c.setLocal("np32",c.i64_const(d)));let e=[],f=[],g=[];function h(a,b){let d,e;return g[a]?d=c.getLocal("q"+a):(d=c.teeLocal("q"+a,c.i64_load32_u(c.i32_const(0),ab+4*a)),g[a]=!0),e=c.getLocal("m"+b),c.i64_mul(d,e)}let i="c0",j="c1";for(let a=0;a<2*Z-1;a++){for(let d=Math.max(0,a-Z+1);d<=a&&d<Z;d++){let g=a-d;b.addCode(c.setLocal(i,c.i64_add(c.i64_and(c.getLocal(i),c.i64_const(0xffffffff)),function(a,b){let d,g;return e[a]?d=c.getLocal("x"+a):(d=c.teeLocal("x"+a,c.i64_load32_u(c.getLocal("x"),4*a)),e[a]=!0),f[b]?g=c.getLocal("y"+b):(g=c.teeLocal("y"+b,c.i64_load32_u(c.getLocal("y"),4*b)),f[b]=!0),c.i64_mul(d,g)}(d,g)))),b.addCode(c.setLocal(j,c.i64_add(c.getLocal(j),c.i64_shr_u(c.getLocal(i),c.i64_const(32)))))}for(let d=Math.max(1,a-Z+1);d<=a&&d<Z;d++){let e=a-d;b.addCode(c.setLocal(i,c.i64_add(c.i64_and(c.getLocal(i),c.i64_const(0xffffffff)),h(d,e)))),b.addCode(c.setLocal(j,c.i64_add(c.getLocal(j),c.i64_shr_u(c.getLocal(i),c.i64_const(32)))))}a<Z&&(b.addCode(c.setLocal("m"+a,c.i64_and(c.i64_mul(c.i64_and(c.getLocal(i),c.i64_const(0xffffffff)),c.getLocal("np32")),c.i64_const("0xFFFFFFFF")))),b.addCode(c.setLocal(i,c.i64_add(c.i64_and(c.getLocal(i),c.i64_const(0xffffffff)),h(0,a)))),b.addCode(c.setLocal(j,c.i64_add(c.getLocal(j),c.i64_shr_u(c.getLocal(i),c.i64_const(32)))))),a>=Z&&b.addCode(c.i64_store32(c.getLocal("r"),(a-Z)*4,c.getLocal(i))),[i,j]=[j,i],b.addCode(c.setLocal(j,c.i64_shr_u(c.getLocal(i),c.i64_const(32))))}b.addCode(c.i64_store32(c.getLocal("r"),4*Z-4,c.getLocal(i))),b.addCode(c.if(c.i32_wrap_i64(c.getLocal(j)),c.drop(c.call(aa+"_sub",c.getLocal("r"),c.i32_const(ab),c.getLocal("r"))),c.if(c.call(aa+"_gte",c.getLocal("r"),c.i32_const(ab)),c.drop(c.call(aa+"_sub",c.getLocal("r"),c.i32_const(ab),c.getLocal("r"))))))}(),function(){let b=a.addFunction(_+"_square");b.addParam("x","i32"),b.addParam("r","i32"),b.addLocal("c0","i64"),b.addLocal("c1","i64"),b.addLocal("c0_old","i64"),b.addLocal("c1_old","i64"),b.addLocal("np32","i64");for(let a=0;a<Z;a++)b.addLocal("x"+a,"i64"),b.addLocal("m"+a,"i64"),b.addLocal("q"+a,"i64");let c=b.getCodeBuilder(),d=Number(4294967296n-k(X,4294967296n));b.addCode(c.setLocal("np32",c.i64_const(d)));let e=[],f=[];function g(a,b){let d,f;return e[a]?d=c.getLocal("x"+a):(d=c.teeLocal("x"+a,c.i64_load32_u(c.getLocal("x"),4*a)),e[a]=!0),e[b]?f=c.getLocal("x"+b):(f=c.teeLocal("x"+b,c.i64_load32_u(c.getLocal("x"),4*b)),e[b]=!0),c.i64_mul(d,f)}function h(a,b){let d,e;return f[a]?d=c.getLocal("q"+a):(d=c.teeLocal("q"+a,c.i64_load32_u(c.i32_const(0),ab+4*a)),f[a]=!0),e=c.getLocal("m"+b),c.i64_mul(d,e)}let i="c0_old",j="c1_old";for(let a=0;a<2*Z-1;a++){b.addCode(c.setLocal("c0",c.i64_const(0)),c.setLocal("c1",c.i64_const(0)));for(let d=Math.max(0,a-Z+1);d<a+1>>1&&d<Z;d++){let e=a-d;b.addCode(c.setLocal("c0",c.i64_add(c.i64_and(c.getLocal("c0"),c.i64_const(0xffffffff)),g(d,e)))),b.addCode(c.setLocal("c1",c.i64_add(c.getLocal("c1"),c.i64_shr_u(c.getLocal("c0"),c.i64_const(32)))))}b.addCode(c.setLocal("c0",c.i64_shl(c.i64_and(c.getLocal("c0"),c.i64_const(0xffffffff)),c.i64_const(1)))),b.addCode(c.setLocal("c1",c.i64_add(c.i64_shl(c.getLocal("c1"),c.i64_const(1)),c.i64_shr_u(c.getLocal("c0"),c.i64_const(32))))),a%2==0&&(b.addCode(c.setLocal("c0",c.i64_add(c.i64_and(c.getLocal("c0"),c.i64_const(0xffffffff)),g(a>>1,a>>1)))),b.addCode(c.setLocal("c1",c.i64_add(c.getLocal("c1"),c.i64_shr_u(c.getLocal("c0"),c.i64_const(32)))))),a>0&&(b.addCode(c.setLocal("c0",c.i64_add(c.i64_and(c.getLocal("c0"),c.i64_const(0xffffffff)),c.i64_and(c.getLocal(i),c.i64_const(0xffffffff))))),b.addCode(c.setLocal("c1",c.i64_add(c.i64_add(c.getLocal("c1"),c.i64_shr_u(c.getLocal("c0"),c.i64_const(32))),c.getLocal(j)))));for(let d=Math.max(1,a-Z+1);d<=a&&d<Z;d++){let e=a-d;b.addCode(c.setLocal("c0",c.i64_add(c.i64_and(c.getLocal("c0"),c.i64_const(0xffffffff)),h(d,e)))),b.addCode(c.setLocal("c1",c.i64_add(c.getLocal("c1"),c.i64_shr_u(c.getLocal("c0"),c.i64_const(32)))))}a<Z&&(b.addCode(c.setLocal("m"+a,c.i64_and(c.i64_mul(c.i64_and(c.getLocal("c0"),c.i64_const(0xffffffff)),c.getLocal("np32")),c.i64_const("0xFFFFFFFF")))),b.addCode(c.setLocal("c0",c.i64_add(c.i64_and(c.getLocal("c0"),c.i64_const(0xffffffff)),h(0,a)))),b.addCode(c.setLocal("c1",c.i64_add(c.getLocal("c1"),c.i64_shr_u(c.getLocal("c0"),c.i64_const(32)))))),a>=Z&&b.addCode(c.i64_store32(c.getLocal("r"),(a-Z)*4,c.getLocal("c0"))),b.addCode(c.setLocal(i,c.getLocal("c1")),c.setLocal(j,c.i64_shr_u(c.getLocal(i),c.i64_const(32))))}b.addCode(c.i64_store32(c.getLocal("r"),4*Z-4,c.getLocal(i))),b.addCode(c.if(c.i32_wrap_i64(c.getLocal(j)),c.drop(c.call(aa+"_sub",c.getLocal("r"),c.i32_const(ab),c.getLocal("r"))),c.if(c.call(aa+"_gte",c.getLocal("r"),c.i32_const(ab)),c.drop(c.call(aa+"_sub",c.getLocal("r"),c.i32_const(ab),c.getLocal("r"))))))}(),(y=a.addFunction(_+"_squareOld")).addParam("x","i32"),y.addParam("r","i32"),z=y.getCodeBuilder(),y.addCode(z.call(_+"_mul",z.getLocal("x"),z.getLocal("x"),z.getLocal("r"))),(A=a.addFunction(_+"_toMontgomery")).addParam("x","i32"),A.addParam("r","i32"),B=A.getCodeBuilder(),A.addCode(B.call(_+"_mul",B.getLocal("x"),B.i32_const(ac),B.getLocal("r"))),C=a.alloc(2*$),(D=a.addFunction(_+"_fromMontgomery")).addParam("x","i32"),D.addParam("r","i32"),E=D.getCodeBuilder(),D.addCode(E.call(aa+"_copy",E.getLocal("x"),E.i32_const(C))),D.addCode(E.call(aa+"_zero",E.i32_const(C+$))),D.addCode(E.call(_+"_mReduct",E.i32_const(C),E.getLocal("r"))),(F=a.addFunction(_+"_isNegative")).addParam("x","i32"),F.setReturnType("i32"),H=(G=F.getCodeBuilder()).i32_const(a.alloc($)),F.addCode(G.call(_+"_fromMontgomery",G.getLocal("x"),H),G.call(aa+"_gte",H,G.i32_const(ai))),(I=a.addFunction(_+"_sign")).addParam("x","i32"),I.setReturnType("i32"),K=(J=I.getCodeBuilder()).i32_const(a.alloc($)),I.addCode(J.if(J.call(aa+"_isZero",J.getLocal("x")),J.ret(J.i32_const(0))),J.call(_+"_fromMontgomery",J.getLocal("x"),K),J.if(J.call(aa+"_gte",K,J.i32_const(ai)),J.ret(J.i32_const(-1))),J.ret(J.i32_const(1))),(L=a.addFunction(_+"_inverse")).addParam("x","i32"),L.addParam("r","i32"),M=L.getCodeBuilder(),L.addCode(M.call(_+"_fromMontgomery",M.getLocal("x"),M.getLocal("r"))),L.addCode(M.call(aa+"_inverseMod",M.getLocal("r"),M.i32_const(ab),M.getLocal("r"))),L.addCode(M.call(_+"_toMontgomery",M.getLocal("r"),M.getLocal("r"))),(N=a.addFunction(_+"_one")).addParam("pr","i32"),O=N.getCodeBuilder(),N.addCode(O.call(aa+"_copy",O.i32_const(ad),O.getLocal("pr"))),(P=a.addFunction(_+"_load")).addParam("scalar","i32"),P.addParam("scalarLen","i32"),P.addParam("r","i32"),P.addLocal("p","i32"),P.addLocal("l","i32"),P.addLocal("i","i32"),P.addLocal("j","i32"),R=(Q=P.getCodeBuilder()).i32_const(a.alloc($)),S=a.alloc($),T=Q.i32_const(S),P.addCode(Q.call(aa+"_zero",Q.getLocal("r")),Q.setLocal("i",Q.i32_const($)),Q.setLocal("p",Q.getLocal("scalar")),Q.block(Q.loop(Q.br_if(1,Q.i32_gt_u(Q.getLocal("i"),Q.getLocal("scalarLen"))),Q.if(Q.i32_eq(Q.getLocal("i"),Q.i32_const($)),Q.call(_+"_one",R),Q.call(_+"_mul",R,Q.i32_const(ac),R)),Q.call(_+"_mul",Q.getLocal("p"),R,T),Q.call(_+"_add",Q.getLocal("r"),T,Q.getLocal("r")),Q.setLocal("p",Q.i32_add(Q.getLocal("p"),Q.i32_const($))),Q.setLocal("i",Q.i32_add(Q.getLocal("i"),Q.i32_const($))),Q.br(0))),Q.setLocal("l",Q.i32_rem_u(Q.getLocal("scalarLen"),Q.i32_const($))),Q.if(Q.i32_eqz(Q.getLocal("l")),Q.ret([])),Q.call(aa+"_zero",T),Q.setLocal("j",Q.i32_const(0)),Q.block(Q.loop(Q.br_if(1,Q.i32_eq(Q.getLocal("j"),Q.getLocal("l"))),Q.i32_store8(Q.getLocal("j"),S,Q.i32_load8_u(Q.getLocal("p"))),Q.setLocal("p",Q.i32_add(Q.getLocal("p"),Q.i32_const(1))),Q.setLocal("j",Q.i32_add(Q.getLocal("j"),Q.i32_const(1))),Q.br(0))),Q.if(Q.i32_eq(Q.getLocal("i"),Q.i32_const($)),Q.call(_+"_one",R),Q.call(_+"_mul",R,Q.i32_const(ac),R)),Q.call(_+"_mul",T,R,T),Q.call(_+"_add",Q.getLocal("r"),T,Q.getLocal("r"))),(U=a.addFunction(_+"_timesScalar")).addParam("x","i32"),U.addParam("scalar","i32"),U.addParam("scalarLen","i32"),U.addParam("r","i32"),W=(V=U.getCodeBuilder()).i32_const(a.alloc($)),U.addCode(V.call(_+"_load",V.getLocal("scalar"),V.getLocal("scalarLen"),W),V.call(_+"_toMontgomery",W,W),V.call(_+"_mul",V.getLocal("x"),W,V.getLocal("r"))),g(a,_),h(a,_+"_batchToMontgomery",_+"_toMontgomery",$,$),h(a,_+"_batchFromMontgomery",_+"_fromMontgomery",$,$),h(a,_+"_batchNeg",_+"_neg",$,$),i(a,_+"_batchAdd",_+"_add",$,$),i(a,_+"_batchSub",_+"_sub",$,$),i(a,_+"_batchMul",_+"_mul",$,$),a.exportFunction(_+"_add"),a.exportFunction(_+"_sub"),a.exportFunction(_+"_neg"),a.exportFunction(_+"_isNegative"),a.exportFunction(_+"_isOne"),a.exportFunction(_+"_sign"),a.exportFunction(_+"_mReduct"),a.exportFunction(_+"_mul"),a.exportFunction(_+"_square"),a.exportFunction(_+"_squareOld"),a.exportFunction(_+"_fromMontgomery"),a.exportFunction(_+"_toMontgomery"),a.exportFunction(_+"_inverse"),a.exportFunction(_+"_one"),a.exportFunction(_+"_load"),a.exportFunction(_+"_timesScalar"),f(a,_+"_exp",$,_+"_mul",_+"_square",aa+"_copy",_+"_one"),a.exportFunction(_+"_exp"),a.exportFunction(_+"_batchInverse"),m(X)){let b,c,d,e,f,g,h,i,j,k,l,m;(b=a.addFunction(_+"_sqrt")).addParam("n","i32"),b.addParam("r","i32"),b.addLocal("m","i32"),b.addLocal("i","i32"),b.addLocal("j","i32"),d=(c=b.getCodeBuilder()).i32_const(ad),e=c.i32_const(a.alloc($)),f=c.i32_const(a.alloc($)),g=c.i32_const(a.alloc($)),h=c.i32_const(a.alloc($)),i=c.i32_const(a.alloc($)),b.addCode(c.if(c.call(_+"_isZero",c.getLocal("n")),c.ret(c.call(_+"_zero",c.getLocal("r")))),c.setLocal("m",c.i32_const(ak)),c.call(_+"_copy",c.i32_const(ao),e),c.call(_+"_exp",c.getLocal("n"),c.i32_const(am),c.i32_const($),f),c.call(_+"_exp",c.getLocal("n"),c.i32_const(aq),c.i32_const($),g),c.block(c.loop(c.br_if(1,c.call(_+"_eq",f,d)),c.call(_+"_square",f,h),c.setLocal("i",c.i32_const(1)),c.block(c.loop(c.br_if(1,c.call(_+"_eq",h,d)),c.call(_+"_square",h,h),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))),c.call(_+"_copy",e,i),c.setLocal("j",c.i32_sub(c.i32_sub(c.getLocal("m"),c.getLocal("i")),c.i32_const(1))),c.block(c.loop(c.br_if(1,c.i32_eqz(c.getLocal("j"))),c.call(_+"_square",i,i),c.setLocal("j",c.i32_sub(c.getLocal("j"),c.i32_const(1))),c.br(0))),c.setLocal("m",c.getLocal("i")),c.call(_+"_square",i,e),c.call(_+"_mul",f,e,f),c.call(_+"_mul",g,i,g),c.br(0))),c.if(c.call(_+"_isNegative",g),c.call(_+"_neg",g,c.getLocal("r")),c.call(_+"_copy",g,c.getLocal("r")))),(j=a.addFunction(_+"_isSquare")).addParam("n","i32"),j.setReturnType("i32"),l=(k=j.getCodeBuilder()).i32_const(ad),m=k.i32_const(a.alloc($)),j.addCode(k.if(k.call(_+"_isZero",k.getLocal("n")),k.ret(k.i32_const(1))),k.call(_+"_exp",k.getLocal("n"),k.i32_const(ah),k.i32_const($),m),k.call(_+"_eq",m,l)),a.exportFunction(_+"_sqrt"),a.exportFunction(_+"_isSquare")}return a.exportFunction(_+"_batchToMontgomery"),a.exportFunction(_+"_batchFromMontgomery"),_}},8865:(a,b)=>{"use strict";var c=/[|\\{}()[\]^$+*?.]/g,d=Object.prototype.hasOwnProperty,e=function(a,b){return d.apply(a,[b])};b.escapeRegExpChars=function(a){return a?String(a).replace(c,"\\$&"):""};var f={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},g=/[&<>'"]/g;function h(a){return f[a]||a}function i(){return Function.prototype.toString.call(this)+';\nvar _ENCODE_HTML_RULES = {\n      "&": "&amp;"\n    , "<": "&lt;"\n    , ">": "&gt;"\n    , \'"\': "&#34;"\n    , "\'": "&#39;"\n    }\n  , _MATCH_HTML = /[&<>\'"]/g;\nfunction encode_char(c) {\n  return _ENCODE_HTML_RULES[c] || c;\n};\n'}b.escapeXML=function(a){return void 0==a?"":String(a).replace(g,h)};try{"function"==typeof Object.defineProperty?Object.defineProperty(b.escapeXML,"toString",{value:i}):b.escapeXML.toString=i}catch(a){console.warn("Unable to set escapeXML.toString (is the Function prototype frozen?)")}b.shallowCopy=function(a,b){if(b=b||{},null!=a)for(var c in b)e(b,c)&&"__proto__"!==c&&"constructor"!==c&&(a[c]=b[c]);return a},b.shallowCopyFromList=function(a,b,c){if(c=c||[],b=b||{},null!=a)for(var d=0;d<c.length;d++){var f=c[d];if(void 0!==b[f]){if(!e(b,f)||"__proto__"===f||"constructor"===f)continue;a[f]=b[f]}}return a},b.cache={_data:{},set:function(a,b){this._data[a]=b},get:function(a){return this._data[a]},remove:function(a){delete this._data[a]},reset:function(){this._data={}}},b.hyphenToCamel=function(a){return a.replace(/-[a-z]/g,function(a){return a[1].toUpperCase()})},b.createNullProtoObjWherePossible="function"==typeof Object.create?function(){return Object.create(null)}:function(){return{}},b.hasOwnOnlyObject=function(a){var c=b.createNullProtoObjWherePossible();for(var d in a)e(a,d)&&(c[d]=a[d]);return c}},9095:(a,b,c)=>{"use strict";let d,e,f,g,h,i;c.r(b),c.d(b,{curves:()=>n,fflonk:()=>u,groth16:()=>o,plonk:()=>t,powersOfTau:()=>p,r1cs:()=>q,wtns:()=>r,zKey:()=>s});var j,k,l={};c.r(l),c.d(l,{abs:()=>S,add:()=>L,band:()=>_,bitLength:()=>z,bits:()=>I,bor:()=>aa,bxor:()=>ab,div:()=>T,e:()=>x,eq:()=>V,exp:()=>R,fromArray:()=>y,fromRprBE:()=>ai,fromRprLE:()=>ah,fromString:()=>w,geq:()=>$,gt:()=>Y,isNegative:()=>A,isOdd:()=>G,isZero:()=>B,land:()=>ac,leq:()=>Z,lnot:()=>ae,lor:()=>ad,lt:()=>X,mod:()=>U,mul:()=>O,naf:()=>H,neg:()=>N,neq:()=>W,one:()=>am,pow:()=>Q,shiftLeft:()=>C,shiftRight:()=>D,shl:()=>E,shr:()=>F,square:()=>P,sub:()=>M,toArray:()=>K,toLEBuff:()=>ak,toNumber:()=>J,toRprBE:()=>ag,toRprLE:()=>af,toString:()=>aj,zero:()=>al});var m={};c.r(m),c.d(m,{array2buffer:()=>aI,beBuff2int:()=>aA,beInt2Buff:()=>aB,bitReverse:()=>aF,buffReverseBits:()=>aH,buffer2array:()=>aJ,leBuff2int:()=>aC,leInt2Buff:()=>aD,log2:()=>aG,stringifyBigInts:()=>function a(b){if("bigint"==typeof b||void 0!==b.eq)return b.toString(10);if(b instanceof Uint8Array)return ah(b,0);if(Array.isArray(b))return b.map(a);{if("object"!=typeof b)return b;let c={};return Object.keys(b).forEach(d=>{c[d]=a(b[d])}),c}},stringifyFElements:()=>function a(b,c){if("bigint"==typeof c||void 0!==c.eq)return c.toString(10);if(c instanceof Uint8Array)return b.toString(b.e(c));if(Array.isArray(c))return c.map(a.bind(this,b));{if("object"!=typeof c)return c;let d={};return Object.keys(c).forEach(e=>{d[e]=a(b,c[e])}),d}},unstringifyBigInts:()=>function a(b){if("string"==typeof b&&/^[0-9]+$/.test(b)||"string"==typeof b&&/^0x[0-9a-fA-F]+$/.test(b))return BigInt(b);if(Array.isArray(b))return b.map(a);{if("object"!=typeof b)return b;if(null===b)return null;let c={};return Object.keys(b).forEach(d=>{c[d]=a(b[d])}),c}},unstringifyFElements:()=>function a(b,c){if("string"==typeof c&&/^[0-9]+$/.test(c)||"string"==typeof c&&/^0x[0-9a-fA-F]+$/.test(c))return b.e(c);if(Array.isArray(c))return c.map(a.bind(this,b));{if("object"!=typeof c)return c;if(null===c)return null;let d={};return Object.keys(c).forEach(e=>{d[e]=a(b,c[e])}),d}}});var n={};c.r(n),c.d(n,{getCurveFromName:()=>bL,getCurveFromQ:()=>bK,getCurveFromR:()=>bJ});var o={};c.r(o),c.d(o,{exportSolidityCallData:()=>c1,fullProve:()=>cY,prove:()=>cN,verify:()=>c$});var p={};c.r(p),c.d(p,{beacon:()=>dr,challengeContribute:()=>dq,contribute:()=>ds,convert:()=>dv,exportChallenge:()=>dj,exportJson:()=>dw,importResponse:()=>dk,newAccumulator:()=>di,preparePhase2:()=>dt,truncate:()=>du,verify:()=>dm});var q={};c.r(q),c.d(q,{exportJson:()=>eC,info:()=>eB,print:()=>dx});var r={};c.r(r),c.d(r,{calculate:()=>cW,check:()=>eH,debug:()=>eF,exportJson:()=>eG});var s={};c.r(s),c.d(s,{beacon:()=>eR,bellmanContribute:()=>eT,contribute:()=>eQ,exportBellman:()=>eM,exportJson:()=>eS,exportSolidityVerifier:()=>e1,exportVerificationKey:()=>eV,importBellman:()=>eN,newZKey:()=>eL,verifyFromInit:()=>eO,verifyFromR1cs:()=>eP});var t={};c.r(t),c.d(t,{exportSolidityCallData:()=>fz,fullProve:()=>fr,prove:()=>fp,setup:()=>e2,verify:()=>ft});var u={};c.r(u),c.d(u,{exportSolidityCallData:()=>fT,exportSolidityVerifier:()=>e0,fullProve:()=>fJ,prove:()=>fH,setup:()=>fF,verify:()=>fL});let v=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function w(a,b){if(!b||10==b)return BigInt(a);if(16==b)if("0x"==a.slice(0,2))return BigInt(a);else return BigInt("0x"+a)}let x=w;function y(a,b){let c=BigInt(0);b=BigInt(b);for(let d=0;d<a.length;d++)c=c*b+BigInt(a[d]);return c}function z(a){let b=a.toString(16);return(b.length-1)*4+v[parseInt(b[0],16)]}function A(a){return BigInt(a)<BigInt(0)}function B(a){return!a}function C(a,b){return BigInt(a)<<BigInt(b)}function D(a,b){return BigInt(a)>>BigInt(b)}let E=C,F=D;function G(a){return(BigInt(a)&BigInt(1))==BigInt(1)}function H(a){let b=BigInt(a),c=[];for(;b;){if(b&BigInt(1)){let a=2-Number(b%BigInt(4));c.push(a),b-=BigInt(a)}else c.push(0);b>>=BigInt(1)}return c}function I(a){let b=BigInt(a),c=[];for(;b;)b&BigInt(1)?c.push(1):c.push(0),b>>=BigInt(1);return c}function J(a){if(a>BigInt(Number.MAX_SAFE_INTEGER))throw Error("Number too big");return Number(a)}function K(a,b){let c=[],d=BigInt(a);for(b=BigInt(b);d;)c.unshift(Number(d%b)),d/=b;return c}function L(a,b){return BigInt(a)+BigInt(b)}function M(a,b){return BigInt(a)-BigInt(b)}function N(a){return-BigInt(a)}function O(a,b){return BigInt(a)*BigInt(b)}function P(a){return BigInt(a)*BigInt(a)}function Q(a,b){return BigInt(a)**BigInt(b)}function R(a,b){return BigInt(a)**BigInt(b)}function S(a){return BigInt(a)>=0?BigInt(a):-BigInt(a)}function T(a,b){return BigInt(a)/BigInt(b)}function U(a,b){return BigInt(a)%BigInt(b)}function V(a,b){return BigInt(a)==BigInt(b)}function W(a,b){return BigInt(a)!=BigInt(b)}function X(a,b){return BigInt(a)<BigInt(b)}function Y(a,b){return BigInt(a)>BigInt(b)}function Z(a,b){return BigInt(a)<=BigInt(b)}function $(a,b){return BigInt(a)>=BigInt(b)}function _(a,b){return BigInt(a)&BigInt(b)}function aa(a,b){return BigInt(a)|BigInt(b)}function ab(a,b){return BigInt(a)^BigInt(b)}function ac(a,b){return BigInt(a)&&BigInt(b)}function ad(a,b){return BigInt(a)||BigInt(b)}function ae(a){return!BigInt(a)}function af(a,b,c,d){let e="0000000"+c.toString(16),f=new Uint32Array(a.buffer,a.byteOffset+b,d/4),g=((e.length-7)*4-1>>5)+1;for(let a=0;a<g;a++)f[a]=parseInt(e.substring(e.length-8*a-8,e.length-8*a),16);for(let a=g;a<f.length;a++)f[a]=0;for(let b=4*f.length;b<d;b++)a[b]=J(_(D(c,8*b),255))}function ag(a,b,c,d){let e="0000000"+c.toString(16),f=new DataView(a.buffer,a.byteOffset+b,d),g=((e.length-7)*4-1>>5)+1;for(let a=0;a<g;a++)f.setUint32(d-4*a-4,parseInt(e.substring(e.length-8*a-8,e.length-8*a),16),!1);for(let a=0;a<d/4-g;a++)f[a]=0}function ah(a,b,c){c=c||a.byteLength,b=b||0;let d=new Uint32Array(a.buffer,a.byteOffset+b,c/4),e=Array(c/4);return d.forEach((a,b)=>e[e.length-b-1]=a.toString(16).padStart(8,"0")),w(e.join(""),16)}function ai(a,b,c){c=c||a.byteLength,b=b||0;let d=new DataView(a.buffer,a.byteOffset+b,c),e=Array(c/4);for(let a=0;a<c/4;a++)e[a]=d.getUint32(4*a,!1).toString(16).padStart(8,"0");return w(e.join(""),16)}function aj(a,b){return a.toString(b)}function ak(a){let b=new Uint8Array(Math.floor((z(a)-1)/8)+1);return af(b,0,a,b.byteLength),b}let al=x(0),am=x(1),an=[];for(let a=0;a<256;a++)an[a]=function(a,b){let c=0,d=a;for(let a=0;a<8;a++)c<<=1,c|=1&d,d>>=1;return c}(a,8);function ao(a,b,c){if(!c)return a.one;let d=I(c);if(0==d.length)return a.one;let e=b;for(let c=d.length-2;c>=0;c--)e=a.square(e),d[c]&&(e=a.mul(e,b));return e}function ap(a,b,c,d,e){a[b]=a[b]+a[c]>>>0,a[e]=(a[e]^a[b])>>>0,a[e]=(a[e]<<16|a[e]>>>16&65535)>>>0,a[d]=a[d]+a[e]>>>0,a[c]=(a[c]^a[d])>>>0,a[c]=(a[c]<<12|a[c]>>>20&4095)>>>0,a[b]=a[b]+a[c]>>>0,a[e]=(a[e]^a[b])>>>0,a[e]=(a[e]<<8|a[e]>>>24&255)>>>0,a[d]=a[d]+a[e]>>>0,a[c]=(a[c]^a[d])>>>0,a[c]=(a[c]<<7|a[c]>>>25&127)>>>0}class aq{constructor(a){a=a||[0,0,0,0,0,0,0,0],this.state=[0x61707865,0x3320646e,0x79622d32,0x6b206574,a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],0,0,0,0],this.idx=16,this.buff=Array(16)}nextU32(){return 16==this.idx&&this.update(),this.buff[this.idx++]}nextU64(){return L(O(this.nextU32(),0x100000000),this.nextU32())}nextBool(){return(1&this.nextU32())==1}update(){for(let a=0;a<16;a++)this.buff[a]=this.state[a];for(let b=0;b<10;b++){var a;ap(a=this.buff,0,4,8,12),ap(a,1,5,9,13),ap(a,2,6,10,14),ap(a,3,7,11,15),ap(a,0,5,10,15),ap(a,1,6,11,12),ap(a,2,7,8,13),ap(a,3,4,9,14)}for(let a=0;a<16;a++)this.buff[a]=this.buff[a]+this.state[a]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,0!=this.state[12]||(this.state[13]=this.state[13]+1>>>0,0!=this.state[13]||(this.state[14]=this.state[14]+1>>>0,0==this.state[14]&&(this.state[15]=this.state[15]+1>>>0)))}}var ar=c(5511);function as(a){let b=new Uint8Array(a);return ar.randomFillSync(b),b}let at=null;function au(){return at||(at=new aq(function(){let a=new Uint32Array(as(32).buffer),b=[];for(let c=0;c<8;c++)b.push(a[c]);return b}()))}class av{constructor(a,b,c){this.F=b,this.G=a,this.opMulGF=c;let d=b.sqrt_t||b.t,e=b.sqrt_s||b.s,f=b.one;for(;b.eq(b.pow(f,b.half),b.one);)f=b.add(f,b.one);this.w=Array(e+1),this.wi=Array(e+1),this.w[e]=this.F.pow(f,d),this.wi[e]=this.F.inv(this.w[e]);let g=e-1;for(;g>=0;)this.w[g]=this.F.square(this.w[g+1]),this.wi[g]=this.F.square(this.wi[g+1]),g--;this.roots=[],this._setRoots(Math.min(e,15))}_setRoots(a){for(let b=a;b>=0&&!this.roots[b];b--){let a=this.F.one,c=1<<b,d=Array(c);for(let e=0;e<c;e++)d[e]=a,a=this.F.mul(a,this.w[b]);this.roots[b]=d}}fft(a){if(a.length<=1)return a;let b=aw(a.length-1)+1;this._setRoots(b);let c=1<<b;if(a.length!=c)throw Error("Size must be multiple of 2");return ax(this,a,b,0,1)}ifft(a){if(a.length<=1)return a;let b=aw(a.length-1)+1;this._setRoots(b);let c=1<<b;if(a.length!=c)throw Error("Size must be multiple of 2");let d=ax(this,a,b,0,1),e=this.F.inv(this.F.mulScalar(this.F.one,c)),f=Array(c);for(let a=0;a<c;a++)f[a]=this.opMulGF(d[(c-a)%c],e);return f}}function aw(a){return((0xffff0000&a)!=0?(a&=0xffff0000,16):0)|((0xff00ff00&a)!=0?(a&=0xff00ff00,8):0)|((0xf0f0f0f0&a)!=0?(a&=0xf0f0f0f0,4):0)|((0xcccccccc&a)!=0?(a&=0xcccccccc,2):0)|(0xaaaaaaaa&a)!=0}function ax(a,b,c,d,e){let f=1<<c;if(1==f)return[b[d]];if(2==f)return[a.G.add(b[d],b[d+e]),a.G.sub(b[d],b[d+e])];let g=f>>1,h=ax(a,b,c-1,d,2*e),i=ax(a,b,c-1,d+e,2*e),j=Array(f);for(let b=0;b<g;b++)j[b]=a.G.add(h[b],a.opMulGF(i[b],a.roots[c][b])),j[b+g]=a.G.sub(h[b],a.opMulGF(i[b],a.roots[c][b]));return j}class ay{constructor(a){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(a),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=z(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=this.e(this.one<<BigInt(64*this.n64)),this.Ri=this.inv(this.R);const b=this.negone>>this.one;this.nqr=this.two;let c=this.pow(this.nqr,b);for(;!this.eq(c,this.negone);)this.nqr=this.nqr+this.one,c=this.pow(this.nqr,b);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),function(a){if(a.m%2==1)if(V(U(a.p,4),1))if(V(U(a.p,8),1))if(V(U(a.p,16),1)){var b,c,d=a;for(d.sqrt_q=Q(d.p,d.m),d.sqrt_s=0,d.sqrt_t=M(d.sqrt_q,1);!G(d.sqrt_t);)d.sqrt_s=d.sqrt_s+1,d.sqrt_t=T(d.sqrt_t,2);let e=d.one;for(;d.eq(e,d.one);){let a=d.random();d.sqrt_z=d.pow(a,d.sqrt_t),e=d.pow(d.sqrt_z,2**(d.sqrt_s-1))}d.sqrt_tm1d2=T(M(d.sqrt_t,1),2),d.sqrt=function(a){if(this.isZero(a))return this.zero;let b=this.pow(a,this.sqrt_tm1d2),c=this.pow(this.mul(this.square(b),a),2**(this.sqrt_s-1));if(this.eq(c,this.negone))return null;let d=this.sqrt_s,e=this.mul(a,b),f=this.mul(e,b),g=this.sqrt_z;for(;!this.eq(f,this.one);){let a=this.square(f),c=1;for(;!this.eq(a,this.one);)a=this.square(a),c++;b=g;for(let a=0;a<d-c-1;a++)b=this.square(b);g=this.square(b),f=this.mul(f,g),e=this.mul(e,b),d=c}return this.geq(e,this.zero)?e:this.neg(e)}}else if(V(U(a.p,16),9))a.sqrt=function(){throw Error("Sqrt alg 4 not implemented")};else throw Error("Field withot sqrt");else if(V(U(a.p,8),5))a.sqrt=function(){throw Error("Sqrt alg 3 not implemented")};else throw Error("Field withot sqrt");else{V(U(a.p,4),3)&&((b=a).sqrt_q=Q(b.p,b.m),b.sqrt_e1=T(M(b.sqrt_q,3),4),b.sqrt=function(a){if(this.isZero(a))return this.zero;let c=this.pow(a,this.sqrt_e1),d=this.mul(this.square(c),a);if(this.eq(d,this.negone))return null;let e=this.mul(c,a);return b.geq(e,b.zero)?e:b.neg(e)})}else{let b=U(Q(a.p,a.m/2),4);1==b?a.sqrt=function(){throw Error("Sqrt alg 10 not implemented")}:3==b?((c=a).sqrt_q=Q(c.p,c.m/2),c.sqrt_e34=T(M(c.sqrt_q,3),4),c.sqrt_e12=T(M(c.sqrt_q,1),2),c.frobenius=function(a,b){return a%2==1?c.conjugate(b):b},c.sqrt=function(a){let b,c=this.pow(a,this.sqrt_e34),d=this.mul(this.square(c),a),e=this.mul(this.frobenius(1,d),d);if(this.eq(e,this.negone))return null;let f=this.mul(c,a);if(this.eq(d,this.negone))b=this.mul(f,[this.F.zero,this.F.one]);else{let a=this.pow(this.add(this.one,d),this.sqrt_e12);b=this.mul(a,f)}return this.geq(b,this.zero)?b:this.neg(b)}):a.sqrt=function(){throw Error("Sqrt alg 8 not implemented")}}}(this),this.FFT=new av(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(a,b){let c;if(b?16==b&&(c=BigInt("0x"+a)):c=BigInt(a),!(c<0))return c>=this.p?c%this.p:c;{let a=-c;return a>=this.p&&(a%=this.p),this.p-a}}add(a,b){let c=a+b;return c>=this.p?c-this.p:c}sub(a,b){return a>=b?a-b:this.p-b+a}neg(a){return a?this.p-a:a}mul(a,b){return a*b%this.p}mulScalar(a,b){return a*this.e(b)%this.p}square(a){return a*a%this.p}eq(a,b){return a==b}neq(a,b){return a!=b}lt(a,b){return(a>this.half?a-this.p:a)<(b>this.half?b-this.p:b)}gt(a,b){return(a>this.half?a-this.p:a)>(b>this.half?b-this.p:b)}leq(a,b){return(a>this.half?a-this.p:a)<=(b>this.half?b-this.p:b)}geq(a,b){return(a>this.half?a-this.p:a)>=(b>this.half?b-this.p:b)}div(a,b){return this.mul(a,this.inv(b))}idiv(a,b){if(!b)throw Error("Division by zero");return a/b}inv(a){if(!a)throw Error("Division by zero");let b=this.zero,c=this.p,d=this.one,e=a%this.p;for(;e;){let a=c/e;[b,d]=[d,b-a*d],[c,e]=[e,c-a*e]}return b<this.zero&&(b+=this.p),b}mod(a,b){return a%b}pow(a,b){return ao(this,a,b)}exp(a,b){return ao(this,a,b)}band(a,b){let c=a&b&this.mask;return c>=this.p?c-this.p:c}bor(a,b){let c=(a|b)&this.mask;return c>=this.p?c-this.p:c}bxor(a,b){let c=(a^b)&this.mask;return c>=this.p?c-this.p:c}bnot(a){let b=a^this.mask;return b>=this.p?b-this.p:b}shl(a,b){if(Number(b)<this.bitLength){let c=a<<b&this.mask;return c>=this.p?c-this.p:c}{let c=this.p-b;return Number(c)<this.bitLength?a>>c:this.zero}}shr(a,b){if(Number(b)<this.bitLength)return a>>b;{let c=this.p-b;if(!(Number(c)<this.bitLength))return 0;{let b=a<<c&this.mask;return b>=this.p?b-this.p:b}}}land(a,b){return a&&b?this.one:this.zero}lor(a,b){return a||b?this.one:this.zero}lnot(a){return a?this.zero:this.one}sqrt_old(a){if(a==this.zero)return this.zero;if(this.pow(a,this.negone>>this.one)!=this.one)return null;let b=this.s,c=this.nqr_to_t,d=this.pow(a,this.t),e=this.pow(a,this.add(this.t,this.one)>>this.one);for(;d!=this.one;){let a=this.square(d),f=1;for(;a!=this.one;)f++,a=this.square(a);let g=c;for(let a=0;a<b-f-1;a++)g=this.square(g);b=f,c=this.square(g),d=this.mul(d,c),e=this.mul(e,g)}return e>this.p>>this.one&&(e=this.neg(e)),e}normalize(a,b){if(!((a=BigInt(a,b))<0))return a>=this.p?a%this.p:a;{let b=-a;return b>=this.p&&(b%=this.p),this.p-b}}random(){let a=2*this.bitLength/8,b=this.zero;for(let c=0;c<a;c++)b=(b<<BigInt(8))+BigInt(as(1)[0]);return b%this.p}toString(a,b){return b=b||10,a>this.half&&10==b?"-"+(this.p-a).toString(b):a.toString(b)}isZero(a){return a==this.zero}fromRng(a){let b;do{b=this.zero;for(let c=0;c<this.n64;c++)b+=a.nextU64()<<BigInt(64*c);b&=this.mask}while(b>=this.p);return b*this.Ri%this.p}fft(a){return this.FFT.fft(a)}ifft(a){return this.FFT.ifft(a)}toRprLE(a,b,c){af(a,b,c,8*this.n64)}toRprBE(a,b,c){ag(a,b,c,8*this.n64)}toRprBEM(a,b,c){return this.toRprBE(a,b,this.mul(this.R,c))}toRprLEM(a,b,c){return this.toRprLE(a,b,this.mul(this.R,c))}fromRprLE(a,b){return ah(a,b,this.n8)}fromRprBE(a,b){return ai(a,b,this.n8)}fromRprLEM(a,b){return this.mul(this.fromRprLE(a,b),this.Ri)}fromRprBEM(a,b){return this.mul(this.fromRprBE(a,b),this.Ri)}toObject(a){return a}}var az=c(456);function aA(a){let b=BigInt(0),c=a.length,d=0,e=new DataView(a.buffer,a.byteOffset,a.byteLength);for(;c>0;)c>=4?(c-=4,b+=BigInt(e.getUint32(c))<<BigInt(8*d),d+=4):c>=2?(c-=2,b+=BigInt(e.getUint16(c))<<BigInt(8*d),d+=2):(c-=1,b+=BigInt(e.getUint8(c))<<BigInt(8*d),d+=1);return b}function aB(a,b){let c=a,d=new Uint8Array(b),e=new DataView(d.buffer),f=b;for(;f>0;)f-4>=0?(f-=4,e.setUint32(f,Number(c&BigInt(0xffffffff))),c>>=BigInt(32)):f-2>=0?(f-=2,e.setUint16(f,Number(c&BigInt(65535))),c>>=BigInt(16)):(f-=1,e.setUint8(f,Number(c&BigInt(255))),c>>=BigInt(8));if(c)throw Error("Number does not fit in this length");return d}function aC(a){let b=BigInt(0),c=0,d=new DataView(a.buffer,a.byteOffset,a.byteLength);for(;c<a.length;)c+4<=a.length?(b+=BigInt(d.getUint32(c,!0))<<BigInt(8*c),c+=4):c+2<=a.length?(b+=BigInt(d.getUint16(c,!0))<<BigInt(8*c),c+=2):(b+=BigInt(d.getUint8(c,!0))<<BigInt(8*c),c+=1);return b}function aD(a,b){let c=a;void 0===b&&0==(b=Math.floor((z(a)-1)/8)+1)&&(b=1);let d=new Uint8Array(b),e=new DataView(d.buffer),f=0;for(;f<b;)f+4<=b?(e.setUint32(f,Number(c&BigInt(0xffffffff)),!0),f+=4,c>>=BigInt(32)):f+2<=b?(e.setUint16(f,Number(c&BigInt(65535)),!0),f+=2,c>>=BigInt(16)):(e.setUint8(f,Number(c&BigInt(255)),!0),f+=1,c>>=BigInt(8));if(c)throw Error("Number does not fit in this length");return d}let aE=[];for(let a=0;a<256;a++)aE[a]=function(a,b){let c=0,d=a;for(let a=0;a<8;a++)c<<=1,c|=1&d,d>>=1;return c}(a,8);function aF(a,b){return(aE[a>>>24]|aE[a>>>16&255]<<8|aE[a>>>8&255]<<16|aE[255&a]<<24)>>>32-b}function aG(a){return((0xffff0000&a)!=0?(a&=0xffff0000,16):0)|((0xff00ff00&a)!=0?(a&=0xff00ff00,8):0)|((0xf0f0f0f0&a)!=0?(a&=0xf0f0f0f0,4):0)|((0xcccccccc&a)!=0?(a&=0xcccccccc,2):0)|(0xaaaaaaaa&a)!=0}function aH(a,b){let c=a.byteLength/b,d=aG(c);if(c!=1<<d)throw Error("Invalid number of pointers");for(let e=0;e<c;e++){let c=aF(e,d);if(e>c){let d=a.slice(e*b,(e+1)*b);a.set(a.slice(c*b,(c+1)*b),e*b),a.set(d,c*b)}}}function aI(a,b){let c=new Uint8Array(b*a.length);for(let d=0;d<a.length;d++)c.set(a[d],d*b);return c}function aJ(a,b){let c=a.byteLength/b,d=Array(c);for(let e=0;e<c;e++)d[e]=a.slice(e*b,e*b+b);return d}class aK{constructor(a){this.buffers=[],this.byteLength=a;for(let b=0;b<a;b+=0x40000000){const c=Math.min(a-b,0x40000000);this.buffers.push(new Uint8Array(c))}}slice(a,b){let c;void 0===b&&(b=this.byteLength),void 0===a&&(a=0);let d=b-a,e=Math.floor(a/0x40000000);if(e==Math.floor((a+d-1)/0x40000000)||0==d)return this.buffers[e].slice(a%0x40000000,a%0x40000000+d);let f=e,g=a%0x40000000,h=d;for(;h>0;){let a=g+h>0x40000000?0x40000000-g:h,b=new Uint8Array(this.buffers[f].buffer,this.buffers[f].byteOffset+g,a);if(a==d)return b.slice();c||(c=d<=0x40000000?new Uint8Array(d):new aK(d)),c.set(b,d-h),h-=a,f++,g=0}return c}set(a,b){void 0===b&&(b=0);let c=a.byteLength;if(0==c)return;let d=Math.floor(b/0x40000000);if(d==Math.floor((b+c-1)/0x40000000))if(a instanceof aK&&1==a.buffers.length)return this.buffers[d].set(a.buffers[0],b%0x40000000);else return this.buffers[d].set(a,b%0x40000000);let e=d,f=b%0x40000000,g=c;for(;g>0;){let b=f+g>0x40000000?0x40000000-f:g,d=a.slice(c-g,c-g+b);new Uint8Array(this.buffers[e].buffer,this.buffers[e].byteOffset+f,b).set(d),g-=b,e++,f=0}}}function aL(a,b,c,d){return async function(e){let f,g=Math.floor(e.byteLength/c);if(g*c!==e.byteLength)throw Error("Invalid buffer size");let h=Math.floor(g/a.concurrency),i=[];for(let f=0;f<a.concurrency;f++){let j;if(0==(j=f<a.concurrency-1?h:g-f*h))continue;let k=[{cmd:"ALLOCSET",var:0,buff:e.slice(f*h*c,f*h*c+j*c)},{cmd:"ALLOC",var:1,len:d*j},{cmd:"CALL",fnName:b,params:[{var:0},{val:j},{var:1}]},{cmd:"GET",out:0,var:1,len:d*j}];i.push(a.queueAction(k))}let j=await Promise.all(i);f=e instanceof aK?new aK(g*d):new Uint8Array(g*d);let k=0;for(let a=0;a<j.length;a++)f.set(j[a][0],k),k+=j[a][0].byteLength;return f}}class aM{constructor(a,b,c,d){if(this.tm=a,this.prefix=b,this.p=d,this.n8=c,this.type="F1",this.m=1,this.half=D(d,am),this.bitLength=z(d),this.mask=M(C(am,this.bitLength),am),this.pOp1=a.alloc(c),this.pOp2=a.alloc(c),this.pOp3=a.alloc(c),this.tm.instance.exports[b+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[b+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(c/8),this.n32=Math.floor(c/4),8*this.n64!=this.n8)throw Error("n8 must be a multiple of 8");this.half=D(this.p,am),this.nqr=this.two;let e=this.exp(this.nqr,this.half);for(;!this.eq(e,this.negone);)this.nqr=this.add(this.nqr,this.one),e=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let f=M(this.p,am);for(;!G(f);)this.s=this.s+1,f=D(f,am);this.w=[],this.w[this.s]=this.exp(this.nqr,f);for(let a=this.s-1;a>=0;a--)this.w[a]=this.square(this.w[a+1]);if(!this.eq(this.w[0],this.one))throw Error("Error calculating roots of unity");this.batchToMontgomery=aL(a,b+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=aL(a,b+"_batchFromMontgomery",this.n8,this.n8)}op2(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2)}op1(a,b){return this.tm.setBuff(this.pOp1,b),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(a,b){return this.tm.setBuff(this.pOp1,b),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3)}add(a,b){return this.op2("_add",a,b)}eq(a,b){return this.op2Bool("_eq",a,b)}isZero(a){return this.op1Bool("_isZero",a)}sub(a,b){return this.op2("_sub",a,b)}neg(a){return this.op1("_neg",a)}inv(a){return this.op1("_inverse",a)}toMontgomery(a){return this.op1("_toMontgomery",a)}fromMontgomery(a){return this.op1("_fromMontgomery",a)}mul(a,b){return this.op2("_mul",a,b)}div(a,b){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,b),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(a){return this.op1("_square",a)}isSquare(a){return this.op1Bool("_isSquare",a)}sqrt(a){return this.op1("_sqrt",a)}exp(a,b){return b instanceof Uint8Array||(b=ak(x(b))),this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,b),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,b.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(a){return this.op1Bool("_isNegative",a)}e(a,b){if(a instanceof Uint8Array)return a;let c=x(a,b);A(c)?(Y(c=N(c),this.p)&&(c=U(c,this.p)),c=M(this.p,c)):Y(c,this.p)&&(c=U(c,this.p));let d=aD(c,this.n8);return this.toMontgomery(d)}toString(a,b){return aj(ah(this.fromMontgomery(a),0),b)}fromRng(a){let b,c=new Uint8Array(this.n8);do{b=al;for(let c=0;c<this.n64;c++)b=L(b,C(a.nextU64(),64*c));b=_(b,this.mask)}while($(b,this.p));return af(c,0,b,this.n8),c}random(){return this.fromRng(au())}toObject(a){return ah(this.fromMontgomery(a),0)}fromObject(a){let b=new Uint8Array(this.n8);return af(b,0,a,this.n8),this.toMontgomery(b)}toRprLE(a,b,c){a.set(this.fromMontgomery(c),b)}toRprBE(a,b,c){let d=this.fromMontgomery(c);for(let a=0;a<this.n8/2;a++){let b=d[a];d[a]=d[this.n8-1-a],d[this.n8-1-a]=b}a.set(d,b)}fromRprLE(a,b){b=b||0;let c=a.slice(b,b+this.n8);return this.toMontgomery(c)}async batchInverse(a){let b,c=!1,d=this.n8,e=this.n8;Array.isArray(a)?(a=aI(a,d),c=!0):a=a.slice(0,a.byteLength);let f=Math.floor(a.byteLength/d);if(f*d!==a.byteLength)throw Error("Invalid buffer size");let g=Math.floor(f/this.tm.concurrency),h=[];for(let b=0;b<this.tm.concurrency;b++){let c;if(0==(c=b<this.tm.concurrency-1?g:f-b*g))continue;let i=[{cmd:"ALLOCSET",var:0,buff:a.slice(b*g*d,b*g*d+c*d)},{cmd:"ALLOC",var:1,len:e*c},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:d},{val:c},{var:1},{val:e}]},{cmd:"GET",out:0,var:1,len:e*c}];h.push(this.tm.queueAction(i))}let i=await Promise.all(h);b=a instanceof aK?new aK(f*e):new Uint8Array(f*e);let j=0;for(let a=0;a<i.length;a++)b.set(i[a][0],j),j+=i[a][0].byteLength;return c?aJ(b,e):b}}class aN{constructor(a,b,c){this.tm=a,this.prefix=b,this.F=c,this.type="F2",this.m=2*c.m,this.n8=2*this.F.n8,this.n32=2*this.F.n32,this.n64=2*this.F.n64,this.pOp1=a.alloc(2*c.n8),this.pOp2=a.alloc(2*c.n8),this.pOp3=a.alloc(2*c.n8),this.tm.instance.exports[b+"_zero"](this.pOp1),this.zero=a.getBuff(this.pOp1,this.n8),this.tm.instance.exports[b+"_one"](this.pOp1),this.one=a.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2)}op1(a,b){return this.tm.setBuff(this.pOp1,b),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(a,b){return this.tm.setBuff(this.pOp1,b),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3)}add(a,b){return this.op2("_add",a,b)}eq(a,b){return this.op2Bool("_eq",a,b)}isZero(a){return this.op1Bool("_isZero",a)}sub(a,b){return this.op2("_sub",a,b)}neg(a){return this.op1("_neg",a)}inv(a){return this.op1("_inverse",a)}isNegative(a){return this.op1Bool("_isNegative",a)}toMontgomery(a){return this.op1("_toMontgomery",a)}fromMontgomery(a){return this.op1("_fromMontgomery",a)}mul(a,b){return this.op2("_mul",a,b)}mul1(a,b){return this.op2("_mul1",a,b)}div(a,b){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,b),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(a){return this.op1("_square",a)}isSquare(a){return this.op1Bool("_isSquare",a)}sqrt(a){return this.op1("_sqrt",a)}exp(a,b){return b instanceof Uint8Array||(b=ak(x(b))),this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,b),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,b.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(a,b){if(a instanceof Uint8Array)return a;if(Array.isArray(a)&&2==a.length){let c=this.F.e(a[0],b),d=this.F.e(a[1],b),e=new Uint8Array(2*this.F.n8);return e.set(c),e.set(d,2*this.F.n8),e}throw Error("invalid F2")}toString(a,b){let c=this.F.toString(a.slice(0,this.F.n8),b),d=this.F.toString(a.slice(this.F.n8),b);return`[${c}, ${d}]`}fromRng(a){let b=this.F.fromRng(a),c=this.F.fromRng(a),d=new Uint8Array(2*this.F.n8);return d.set(b),d.set(c,this.F.n8),d}random(){return this.fromRng(au())}toObject(a){return[this.F.toObject(a.slice(0,this.F.n8)),this.F.toObject(a.slice(this.F.n8,2*this.F.n8))]}fromObject(a){let b=new Uint8Array(2*this.F.n8),c=this.F.fromObject(a[0]),d=this.F.fromObject(a[1]);return b.set(c),b.set(d,this.F.n8),b}c1(a){return a.slice(0,this.F.n8)}c2(a){return a.slice(this.F.n8)}}class aO{constructor(a,b,c){this.tm=a,this.prefix=b,this.F=c,this.type="F3",this.m=3*c.m,this.n8=3*this.F.n8,this.n32=3*this.F.n32,this.n64=3*this.F.n64,this.pOp1=a.alloc(3*c.n8),this.pOp2=a.alloc(3*c.n8),this.pOp3=a.alloc(3*c.n8),this.tm.instance.exports[b+"_zero"](this.pOp1),this.zero=a.getBuff(this.pOp1,this.n8),this.tm.instance.exports[b+"_one"](this.pOp1),this.one=a.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2)}op1(a,b){return this.tm.setBuff(this.pOp1,b),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(a,b){return this.tm.setBuff(this.pOp1,b),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3)}eq(a,b){return this.op2Bool("_eq",a,b)}isZero(a){return this.op1Bool("_isZero",a)}add(a,b){return this.op2("_add",a,b)}sub(a,b){return this.op2("_sub",a,b)}neg(a){return this.op1("_neg",a)}inv(a){return this.op1("_inverse",a)}isNegative(a){return this.op1Bool("_isNegative",a)}toMontgomery(a){return this.op1("_toMontgomery",a)}fromMontgomery(a){return this.op1("_fromMontgomery",a)}mul(a,b){return this.op2("_mul",a,b)}div(a,b){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,b),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(a){return this.op1("_square",a)}isSquare(a){return this.op1Bool("_isSquare",a)}sqrt(a){return this.op1("_sqrt",a)}exp(a,b){return b instanceof Uint8Array||(b=ak(x(b))),this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,b),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,b.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(a,b){if(a instanceof Uint8Array)return a;if(Array.isArray(a)&&3==a.length){let c=this.F.e(a[0],b),d=this.F.e(a[1],b),e=this.F.e(a[2],b),f=new Uint8Array(3*this.F.n8);return f.set(c),f.set(d,this.F.n8),f.set(e,2*this.F.n8),f}throw Error("invalid F3")}toString(a,b){let c=this.F.toString(a.slice(0,this.F.n8),b),d=this.F.toString(a.slice(this.F.n8,2*this.F.n8),b),e=this.F.toString(a.slice(2*this.F.n8),b);return`[${c}, ${d}, ${e}]`}fromRng(a){let b=this.F.fromRng(a),c=this.F.fromRng(a),d=this.F.fromRng(a),e=new Uint8Array(3*this.F.n8);return e.set(b),e.set(c,this.F.n8),e.set(d,2*this.F.n8),e}random(){return this.fromRng(au())}toObject(a){return[this.F.toObject(a.slice(0,this.F.n8)),this.F.toObject(a.slice(this.F.n8,2*this.F.n8)),this.F.toObject(a.slice(2*this.F.n8,3*this.F.n8))]}fromObject(a){let b=new Uint8Array(3*this.F.n8),c=this.F.fromObject(a[0]),d=this.F.fromObject(a[1]),e=this.F.fromObject(a[2]);return b.set(c),b.set(d,this.F.n8),b.set(e,2*this.F.n8),b}c1(a){return a.slice(0,this.F.n8)}c2(a){return a.slice(this.F.n8,2*this.F.n8)}c3(a){return a.slice(2*this.F.n8)}}class aP{constructor(a,b,c,d,e,f){this.tm=a,this.prefix=b,this.F=c,this.pOp1=a.alloc(3*c.n8),this.pOp2=a.alloc(3*c.n8),this.pOp3=a.alloc(3*c.n8),this.tm.instance.exports[b+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,3*c.n8),this.tm.instance.exports[b+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,2*c.n8),this.one=this.tm.getBuff(d,3*c.n8),this.g=this.one,this.oneAffine=this.tm.getBuff(d,2*c.n8),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(e,c.n8),f&&(this.cofactor=ak(f)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=aL(a,b+"_batchLEMtoC",2*c.n8,c.n8),this.batchLEMtoU=aL(a,b+"_batchLEMtoU",2*c.n8,2*c.n8),this.batchCtoLEM=aL(a,b+"_batchCtoLEM",c.n8,2*c.n8),this.batchUtoLEM=aL(a,b+"_batchUtoLEM",2*c.n8,2*c.n8),this.batchToJacobian=aL(a,b+"_batchToJacobian",2*c.n8,3*c.n8),this.batchToAffine=aL(a,b+"_batchToAffine",3*c.n8,2*c.n8)}op2(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op2bool(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2,this.pOp3)}op1(a,b){return this.tm.setBuff(this.pOp1,b),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op1Affine(a,b){return this.tm.setBuff(this.pOp1,b),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,2*this.F.n8)}op1Bool(a,b){return this.tm.setBuff(this.pOp1,b),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3)}add(a,b){if(a.byteLength==3*this.F.n8)if(b.byteLength==3*this.F.n8)return this.op2("_add",a,b);else if(b.byteLength==2*this.F.n8)return this.op2("_addMixed",a,b);else throw Error("invalid point size");if(a.byteLength==2*this.F.n8){if(b.byteLength==3*this.F.n8)return this.op2("_addMixed",b,a);else if(b.byteLength==2*this.F.n8)return this.op2("_addAffine",a,b)}throw Error("invalid point size")}sub(a,b){if(a.byteLength==3*this.F.n8)if(b.byteLength==3*this.F.n8)return this.op2("_sub",a,b);else if(b.byteLength==2*this.F.n8)return this.op2("_subMixed",a,b);else throw Error("invalid point size");if(a.byteLength==2*this.F.n8){if(b.byteLength==3*this.F.n8)return this.op2("_subMixed",b,a);else if(b.byteLength==2*this.F.n8)return this.op2("_subAffine",a,b)}throw Error("invalid point size")}neg(a){if(a.byteLength==3*this.F.n8)return this.op1("_neg",a);if(a.byteLength==2*this.F.n8)return this.op1Affine("_negAffine",a);throw Error("invalid point size")}double(a){if(a.byteLength==3*this.F.n8)return this.op1("_double",a);if(a.byteLength==2*this.F.n8)return this.op1("_doubleAffine",a);throw Error("invalid point size")}isZero(a){if(a.byteLength==3*this.F.n8)return this.op1Bool("_isZero",a);if(a.byteLength==2*this.F.n8)return this.op1Bool("_isZeroAffine",a);throw Error("invalid point size")}timesScalar(a,b){let c;if(b instanceof Uint8Array||(b=ak(x(b))),a.byteLength==3*this.F.n8)c=this.prefix+"_timesScalar";else if(a.byteLength==2*this.F.n8)c=this.prefix+"_timesScalarAffine";else throw Error("invalid point size");return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,b),this.tm.instance.exports[c](this.pOp1,this.pOp2,b.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}timesFr(a,b){let c;if(a.byteLength==3*this.F.n8)c=this.prefix+"_timesFr";else if(a.byteLength==2*this.F.n8)c=this.prefix+"_timesFrAffine";else throw Error("invalid point size");return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,b),this.tm.instance.exports[c](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}eq(a,b){if(a.byteLength==3*this.F.n8)if(b.byteLength==3*this.F.n8)return this.op2bool("_eq",a,b);else if(b.byteLength==2*this.F.n8)return this.op2bool("_eqMixed",a,b);else throw Error("invalid point size");if(a.byteLength==2*this.F.n8){if(b.byteLength==3*this.F.n8)return this.op2bool("_eqMixed",b,a);else if(b.byteLength==2*this.F.n8)return this.op2bool("_eqAffine",a,b)}throw Error("invalid point size")}toAffine(a){if(a.byteLength==3*this.F.n8)return this.op1Affine("_toAffine",a);if(a.byteLength==2*this.F.n8)return a;throw Error("invalid point size")}toJacobian(a){if(a.byteLength==3*this.F.n8)return a;if(a.byteLength==2*this.F.n8)return this.op1("_toJacobian",a);throw Error("invalid point size")}toRprUncompressed(a,b,c){if(this.tm.setBuff(this.pOp1,c),c.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(c.byteLength!=2*this.F.n8)throw Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);let d=this.tm.getBuff(this.pOp1,2*this.F.n8);a.set(d,b)}fromRprUncompressed(a,b){let c=a.slice(b,b+2*this.F.n8);return this.tm.setBuff(this.pOp1,c),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,2*this.F.n8)}toRprCompressed(a,b,c){if(this.tm.setBuff(this.pOp1,c),c.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(c.byteLength!=2*this.F.n8)throw Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);let d=this.tm.getBuff(this.pOp1,this.F.n8);a.set(d,b)}fromRprCompressed(a,b){let c=a.slice(b,b+this.F.n8);return this.tm.setBuff(this.pOp1,c),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,2*this.F.n8)}toUncompressed(a){let b=new Uint8Array(2*this.F.n8);return this.toRprUncompressed(b,0,a),b}toRprLEM(a,b,c){if(c.byteLength==2*this.F.n8)return void a.set(c,b);if(c.byteLength==3*this.F.n8){this.tm.setBuff(this.pOp1,c),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);let d=this.tm.getBuff(this.pOp1,2*this.F.n8);a.set(d,b)}else throw Error("invalid point size")}fromRprLEM(a,b){return b=b||0,a.slice(b,b+2*this.F.n8)}toString(a,b){if(a.byteLength==3*this.F.n8){let c=this.F.toString(a.slice(0,this.F.n8),b),d=this.F.toString(a.slice(this.F.n8,2*this.F.n8),b),e=this.F.toString(a.slice(2*this.F.n8),b);return`[ ${c}, ${d}, ${e} ]`}if(a.byteLength==2*this.F.n8){let c=this.F.toString(a.slice(0,this.F.n8),b),d=this.F.toString(a.slice(this.F.n8),b);return`[ ${c}, ${d} ]`}throw Error("invalid point size")}isValid(a){if(this.isZero(a))return!0;let b=this.F,c=this.toAffine(a),d=c.slice(0,this.F.n8),e=c.slice(this.F.n8,2*this.F.n8),f=b.add(b.mul(b.square(d),d),this.b),g=b.square(e);return b.eq(f,g)}fromRng(a){let b,c,d=this.F,e=[];do e[0]=d.fromRng(a),b=a.nextBool(),c=d.add(d.mul(d.square(e[0]),e[0]),this.b);while(!d.isSquare(c));e[1]=d.sqrt(c),b^d.isNegative(e[1])&&(e[1]=d.neg(e[1]));let f=new Uint8Array(2*this.F.n8);return f.set(e[0]),f.set(e[1],this.F.n8),this.cofactor&&(f=this.timesScalar(f,this.cofactor)),f}toObject(a){return this.isZero(a)?[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)]:[this.F.toObject(a.slice(0,this.F.n8)),this.F.toObject(a.slice(this.F.n8,2*this.F.n8)),a.byteLength==3*this.F.n8?this.F.toObject(a.slice(2*this.F.n8,3*this.F.n8)):this.F.toObject(this.F.one)]}fromObject(a){let b,c=this.F.fromObject(a[0]),d=this.F.fromObject(a[1]);if(b=3==a.length?this.F.fromObject(a[2]):this.F.one,this.F.isZero(b,this.F.one))return this.zeroAffine;if(this.F.eq(b,this.F.one)){let a=new Uint8Array(2*this.F.n8);return a.set(c),a.set(d,this.F.n8),a}{let a=new Uint8Array(3*this.F.n8);return a.set(c),a.set(d,this.F.n8),a.set(b,2*this.F.n8),a}}e(a){return a instanceof Uint8Array?a:this.fromObject(a)}x(a){return this.toAffine(a).slice(0,this.F.n8)}y(a){return this.toAffine(a).slice(this.F.n8)}}function aQ(a){let b,c;async function d(a){let d=new Uint8Array(a.code),e=await WebAssembly.compile(d);c=new WebAssembly.Memory({initial:a.init,maximum:32767}),b=await WebAssembly.instantiate(e,{env:{memory:c}})}function e(a){let b=new Uint32Array(c.buffer,0,1);for(;3&b[0];)b[0]++;let d=b[0];if(b[0]+=a,b[0]+a>c.buffer.byteLength){let d=c.buffer.byteLength/65536,e=Math.floor((b[0]+a)/65536)+1;e>32767&&(e=32767),c.grow(e-d)}return d}function f(a,b){new Uint8Array(c.buffer).set(new Uint8Array(b),a)}function g(a){if("INIT"==a[0].cmd)return d(a[0]);let g=[],h=[],i=new Uint32Array(c.buffer,0,1)[0];for(let d=0;d<a.length;d++)switch(a[d].cmd){case"ALLOCSET":g[a[d].var]=function(a){let b=e(a.byteLength);return f(b,a),b}(a[d].buff);break;case"ALLOC":g[a[d].var]=e(a[d].len);break;case"SET":f(g[a[d].var],a[d].buff);break;case"CALL":{let c=[];for(let b=0;b<a[d].params.length;b++){let e=a[d].params[b];void 0!==e.var?c.push(g[e.var]+(e.offset||0)):void 0!==e.val&&c.push(e.val)}b.exports[a[d].fnName](...c);break}case"GET":h[a[d].out]=(function(a,b){let d=new Uint8Array(c.buffer);return new Uint8Array(d.buffer,d.byteOffset+a,b)})(g[a[d].var],a[d].len).slice();break;default:throw Error("Invalid cmd")}return new Uint32Array(c.buffer,0,1)[0]=i,h}return a&&(a.onmessage=function(b){let c;if("INIT"==(c=b.data?b.data:b)[0].cmd)d(c[0]).then(function(){a.postMessage(c.result)});else if("TERMINATE"==c[0].cmd)a.close();else{let b=g(c);a.postMessage(b)}}),g}var aR=c(1820),aS=c(1572);class aT{constructor(){this.promise=new Promise((a,b)=>{this.reject=b,this.resolve=a})}}let aU=`(${aQ.toString()})(self)`;async function aV(a,b){let c=new aW;c.memory=new WebAssembly.Memory({initial:25}),c.u8=new Uint8Array(c.memory.buffer),c.u32=new Uint32Array(c.memory.buffer);let e=await WebAssembly.compile(a.code);if(c.instance=await WebAssembly.instantiate(e,{env:{memory:c.memory}}),c.singleThread=b,c.initalPFree=c.u32[0],c.pq=a.pq,c.pr=a.pr,c.pG1gen=a.pG1gen,c.pG1zero=a.pG1zero,c.pG2gen=a.pG2gen,c.pG2zero=a.pG2zero,c.pOneT=a.pOneT,b)c.code=a.code,c.taskManager=aQ(),await c.taskManager([{cmd:"INIT",init:25,code:c.code.slice()}]),c.concurrency=1;else{c.workers=[],c.pendingDeferreds=[],c.working=[];let b=2;0==(b=aR.cpus().length)&&(b=2),b>64&&(b=64),c.concurrency=b;for(let a=0;a<b;a++)c.workers[a]=new aS(d),c.workers[a].addEventListener("message",function(a){return function(b){let d;d=b&&b.data?b.data:b,c.working[a]=!1,c.pendingDeferreds[a].resolve(d),c.processWorks()}}(a)),c.working[a]=!1;let e=[];for(let b=0;b<c.workers.length;b++){let d=a.code.slice();e.push(c.postAction(b,[{cmd:"INIT",init:25,code:d}],[d.buffer]))}await Promise.all(e)}return c}d="data:application/javascript;base64,"+Buffer.from(aU).toString("base64");class aW{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(0!=this.oldPFree)throw Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(0==this.oldPFree)throw Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(a,b,c,d){if(this.working[a])throw Error("Posting a job t a working worker");return this.working[a]=!0,this.pendingDeferreds[a]=d||new aT,this.workers[a].postMessage(b,c),this.pendingDeferreds[a].promise}processWorks(){for(let a=0;a<this.workers.length&&this.actionQueue.length>0;a++)if(!1==this.working[a]){let b=this.actionQueue.shift();this.postAction(a,b.data,b.transfers,b.deferred)}}queueAction(a,b){let c=new aT;if(this.singleThread){let b=this.taskManager(a);c.resolve(b)}else this.actionQueue.push({data:a,transfers:b,deferred:c}),this.processWorks();return c.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(a){let b=this.alloc(a.byteLength);return this.setBuff(b,a),b}getBuff(a,b){return this.u8.slice(a,a+b)}setBuff(a,b){this.u8.set(new Uint8Array(b),a)}alloc(a){for(;3&this.u32[0];)this.u32[0]++;let b=this.u32[0];return this.u32[0]+=a,b}async terminate(){for(let a=0;a<this.workers.length;a++)this.workers[a].postMessage([{cmd:"TERMINATE"}]);await new Promise(a=>setTimeout(a,200))}}function aX(a,b){let c=a[b],d=a.Fr,e=a.tm;a[b].batchApplyKey=async function(a,f,g,h,i){let j,k,l,m,n,o;if(h=h||"affine",i=i||"affine","G1"==b)"jacobian"==h?(l=3*c.F.n8,j="g1m_batchApplyKey"):(l=2*c.F.n8,j="g1m_batchApplyKeyMixed"),m=3*c.F.n8,"jacobian"==i?n=3*c.F.n8:(k="g1m_batchToAffine",n=2*c.F.n8);else if("G2"==b)"jacobian"==h?(l=3*c.F.n8,j="g2m_batchApplyKey"):(l=2*c.F.n8,j="g2m_batchApplyKeyMixed"),m=3*c.F.n8,"jacobian"==i?n=3*c.F.n8:(k="g2m_batchToAffine",n=2*c.F.n8);else if("Fr"==b)j="frm_batchApplyKey",l=c.n8,m=c.n8,n=c.n8;else throw Error("Invalid group: "+b);let p=Math.floor(a.byteLength/l),q=Math.floor(p/e.concurrency),r=[];g=d.e(g);let s=d.e(f);for(let b=0;b<e.concurrency;b++){let c;if(0==(c=b<e.concurrency-1?q:p-b*q))continue;let f=[];f.push({cmd:"ALLOCSET",var:0,buff:a.slice(b*q*l,b*q*l+c*l)}),f.push({cmd:"ALLOCSET",var:1,buff:s}),f.push({cmd:"ALLOCSET",var:2,buff:g}),f.push({cmd:"ALLOC",var:3,len:c*Math.max(m,n)}),f.push({cmd:"CALL",fnName:j,params:[{var:0},{val:c},{var:1},{var:2},{var:3}]}),k&&f.push({cmd:"CALL",fnName:k,params:[{var:3},{val:c},{var:3}]}),f.push({cmd:"GET",out:0,var:3,len:c*n}),r.push(e.queueAction(f)),s=d.mul(s,d.exp(g,c))}let t=await Promise.all(r);o=a instanceof aK?new aK(p*n):new Uint8Array(p*n);let u=0;for(let a=0;a<t.length;a++)o.set(t[a][0],u),u+=t[a][0].byteLength;return o}}let aY=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function aZ(a,b){let c=a[b],d=c.tm;async function e(a,d,e,f,g){let h,i;if(!(a instanceof Uint8Array))throw f&&f.error(`${g} _multiExpChunk buffBases is not Uint8Array`),Error(`${g} _multiExpChunk buffBases is not Uint8Array`);if(!(d instanceof Uint8Array))throw f&&f.error(`${g} _multiExpChunk buffScalars is not Uint8Array`),Error(`${g} _multiExpChunk buffScalars is not Uint8Array`);if(e=e||"affine","G1"==b)"affine"==e?(i="g1m_multiexpAffine_chunk",h=2*c.F.n8):(i="g1m_multiexp_chunk",h=3*c.F.n8);else if("G2"==b)"affine"==e?(i="g2m_multiexpAffine_chunk",h=2*c.F.n8):(i="g2m_multiexp_chunk",h=3*c.F.n8);else throw Error("Invalid group");let j=Math.floor(a.byteLength/h);if(0==j)return c.zero;let k=Math.floor(d.byteLength/j);if(k*j!=d.byteLength)throw Error("Scalar size does not match");let l=aY[aG(j)],m=Math.floor((8*k-1)/l)+1,n=[];for(let b=0;b<m;b++){let e=[{cmd:"ALLOCSET",var:0,buff:a},{cmd:"ALLOCSET",var:1,buff:d},{cmd:"ALLOC",var:2,len:3*c.F.n8},{cmd:"CALL",fnName:i,params:[{var:0},{var:1},{val:k},{val:j},{val:b*l},{val:Math.min(8*k-b*l,l)},{var:2}]},{cmd:"GET",out:0,var:2,len:3*c.F.n8}];n.push(c.tm.queueAction(e))}let o=await Promise.all(n),p=c.zero;for(let a=o.length-1;a>=0;a--){if(!c.isZero(p))for(let a=0;a<l;a++)p=c.double(p);p=c.add(p,o[a][0])}return p}async function f(a,f,g,h,i){let j,k;if("G1"==b)j="affine"==g?2*c.F.n8:3*c.F.n8;else if("G2"==b)j="affine"==g?2*c.F.n8:3*c.F.n8;else throw Error("Invalid group");let l=Math.floor(a.byteLength/j);if(0==l)return c.zero;let m=Math.floor(f.byteLength/l);if(m*l!=f.byteLength)throw Error("Scalar size does not match");let n=Math.floor((8*m-1)/aY[aG(l)])+1;(k=Math.floor(l/(d.concurrency/n)))>4194304&&(k=4194304),k<1024&&(k=1024);let o=[];for(let b=0;b<l;b+=k){h&&h.debug(`Multiexp start: ${i}: ${b}/${l}`);let c=Math.min(l-b,k),d=a.slice(b*j,(b+c)*j),n=f.slice(b*m,(b+c)*m);o.push(e(d,n,g,h,i).then(a=>(h&&h.debug(`Multiexp end: ${i}: ${b}/${l}`),a)))}let p=await Promise.all(o),q=c.zero;for(let a=p.length-1;a>=0;a--)q=c.add(q,p[a]);return q}c.multiExp=async function(a,b,c,d){return await f(a,b,"jacobian",c,d)},c.multiExpAffine=async function(a,b,c,d){return await f(a,b,"affine",c,d)}}function a$(a,b){let c=a[b],d=a.Fr,e=c.tm;async function f(a,f,i,j,k,l){let m,n,o,p,q,r,s,t,u,v,w;i=i||"affine",j=j||"affine","G1"==b?("affine"==i?(m=2*c.F.n8,p="g1m_batchToJacobian"):m=3*c.F.n8,n=3*c.F.n8,f&&(t="g1m_fftFinal"),s="g1m_fftJoin",r="g1m_fftMix","affine"==j?(o=2*c.F.n8,q="g1m_batchToAffine"):o=3*c.F.n8):"G2"==b?("affine"==i?(m=2*c.F.n8,p="g2m_batchToJacobian"):m=3*c.F.n8,n=3*c.F.n8,f&&(t="g2m_fftFinal"),s="g2m_fftJoin",r="g2m_fftMix","affine"==j?(o=2*c.F.n8,q="g2m_batchToAffine"):o=3*c.F.n8):"Fr"==b&&(m=c.n8,n=c.n8,o=c.n8,f&&(t="frm_fftFinal"),r="frm_fftMix",s="frm_fftJoin");let x=!1;Array.isArray(a)?(a=aI(a,m),x=!0):a=a.slice(0,a.byteLength);let y=a.byteLength/m,z=aG(y);if(1<<z!=y)throw Error("fft must be multiple of 2");if(z==d.s+1){let b;return(b=f?await h(a,i,j,k,l):await g(a,i,j,k,l),x)?aJ(b,o):b}f&&(u=d.inv(d.e(y))),aH(a,m);let A=Math.min(16384,y),B=y/A;for(;B<e.concurrency&&A>=16;)B*=2,A/=2;let C=aG(A),D=[];for(let b=0;b<B;b++){k&&k.debug(`${l}: fft ${z} mix start: ${b}/${B}`);let c=[];c.push({cmd:"ALLOC",var:0,len:n*A});let d=a.slice(A*b*m,A*(b+1)*m);c.push({cmd:"SET",var:0,buff:d}),p&&c.push({cmd:"CALL",fnName:p,params:[{var:0},{val:A},{var:0}]});for(let a=1;a<=C;a++)c.push({cmd:"CALL",fnName:r,params:[{var:0},{val:A},{val:a}]});C==z?(t&&(c.push({cmd:"ALLOCSET",var:1,buff:u}),c.push({cmd:"CALL",fnName:t,params:[{var:0},{val:A},{var:1}]})),q&&c.push({cmd:"CALL",fnName:q,params:[{var:0},{val:A},{var:0}]}),c.push({cmd:"GET",out:0,var:0,len:A*o})):c.push({cmd:"GET",out:0,var:0,len:n*A}),D.push(e.queueAction(c).then(a=>(k&&k.debug(`${l}: fft ${z} mix end: ${b}/${B}`),a)))}w=await Promise.all(D);for(let a=0;a<B;a++)w[a]=w[a][0];for(let a=C+1;a<=z;a++){k&&k.debug(`${l}: fft  ${z}  join: ${a}/${z}`);let b=1<<z-a,c=B/b,f=[];for(let g=0;g<b;g++)for(let h=0;h<c/2;h++){let i=d.exp(d.w[a],h*A),j=d.w[a],m=g*c+h,p=g*c+h+c/2,r=[];r.push({cmd:"ALLOCSET",var:0,buff:w[m]}),r.push({cmd:"ALLOCSET",var:1,buff:w[p]}),r.push({cmd:"ALLOCSET",var:2,buff:i}),r.push({cmd:"ALLOCSET",var:3,buff:j}),r.push({cmd:"CALL",fnName:s,params:[{var:0},{var:1},{val:A},{var:2},{var:3}]}),a==z?(t&&(r.push({cmd:"ALLOCSET",var:4,buff:u}),r.push({cmd:"CALL",fnName:t,params:[{var:0},{val:A},{var:4}]}),r.push({cmd:"CALL",fnName:t,params:[{var:1},{val:A},{var:4}]})),q&&(r.push({cmd:"CALL",fnName:q,params:[{var:0},{val:A},{var:0}]}),r.push({cmd:"CALL",fnName:q,params:[{var:1},{val:A},{var:1}]})),r.push({cmd:"GET",out:0,var:0,len:A*o}),r.push({cmd:"GET",out:1,var:1,len:A*o})):(r.push({cmd:"GET",out:0,var:0,len:A*n}),r.push({cmd:"GET",out:1,var:1,len:A*n})),f.push(e.queueAction(r).then(d=>(k&&k.debug(`${l}: fft ${z} join  ${a}/${z}  ${g+1}/${b} ${h}/${c/2}`),d)))}let g=await Promise.all(f);for(let a=0;a<b;a++)for(let b=0;b<c/2;b++){let d=a*c+b,e=a*c+b+c/2,f=g.shift();w[d]=f[0],w[e]=f[1]}}if(v=a instanceof aK?new aK(y*o):new Uint8Array(y*o),f){v.set(w[0].slice((A-1)*o));let a=o;for(let b=B-1;b>0;b--)v.set(w[b],a),a+=A*o,delete w[b];v.set(w[0].slice(0,(A-1)*o),a),delete w[0]}else for(let a=0;a<B;a++)v.set(w[a],A*o*a),delete w[a];return x?aJ(v,o):v}async function g(a,b,c,e,g){let h,j,k;h=a.slice(0,a.byteLength/2),j=a.slice(a.byteLength/2,a.byteLength);let l=[];[h,j]=await i(h,j,"fftJoinExt",d.one,d.shift,b,"jacobian",e,g),l.push(f(h,!1,"jacobian",c,e,g)),l.push(f(j,!1,"jacobian",c,e,g));let m=await Promise.all(l);return(k=m[0].byteLength>0x10000000?new aK(2*m[0].byteLength):new Uint8Array(2*m[0].byteLength)).set(m[0]),k.set(m[1],m[0].byteLength),k}async function h(a,b,c,e,g){let h,j,k;h=a.slice(0,a.byteLength/2),j=a.slice(a.byteLength/2,a.byteLength);let l=[];l.push(f(h,!0,b,"jacobian",e,g)),l.push(f(j,!0,b,"jacobian",e,g)),[h,j]=await Promise.all(l);let m=await i(h,j,"fftJoinExtInv",d.one,d.shiftInv,"jacobian",c,e,g);return(k=m[0].byteLength>0x10000000?new aK(2*m[0].byteLength):new Uint8Array(2*m[0].byteLength)).set(m[0]),k.set(m[1],m[0].byteLength),k}async function i(a,f,g,h,i,j,k,l,m){let n,o,p,q,r,s,t,u;if("G1"==b)"affine"==j?(r=2*c.F.n8,o="g1m_batchToJacobian"):r=3*c.F.n8,s=3*c.F.n8,n="g1m_"+g,"affine"==k?(p="g1m_batchToAffine",q=2*c.F.n8):q=3*c.F.n8;else if("G2"==b)"affine"==j?(r=2*c.F.n8,o="g2m_batchToJacobian"):r=3*c.F.n8,n="g2m_"+g,s=3*c.F.n8,"affine"==k?(p="g2m_batchToAffine",q=2*c.F.n8):q=3*c.F.n8;else if("Fr"==b)r=d.n8,q=d.n8,s=d.n8,n="frm_"+g;else throw Error("Invalid group");if(a.byteLength!=f.byteLength)throw Error("Invalid buffer size");let v=Math.floor(a.byteLength/r);if(v!=1<<aG(v))throw Error("Invalid number of points");let w=Math.floor(v/e.concurrency);w<16&&(w=16),w>65536&&(w=65536);let x=[];for(let b=0;b<v;b+=w){l&&l.debug(`${m}: fftJoinExt Start: ${b}/${v}`);let c=Math.min(v-b,w),g=d.mul(h,d.exp(i,b)),j=[],k=a.slice(b*r,(b+c)*r),t=f.slice(b*r,(b+c)*r);j.push({cmd:"ALLOC",var:0,len:s*c}),j.push({cmd:"SET",var:0,buff:k}),j.push({cmd:"ALLOC",var:1,len:s*c}),j.push({cmd:"SET",var:1,buff:t}),j.push({cmd:"ALLOCSET",var:2,buff:g}),j.push({cmd:"ALLOCSET",var:3,buff:i}),o&&(j.push({cmd:"CALL",fnName:o,params:[{var:0},{val:c},{var:0}]}),j.push({cmd:"CALL",fnName:o,params:[{var:1},{val:c},{var:1}]})),j.push({cmd:"CALL",fnName:n,params:[{var:0},{var:1},{val:c},{var:2},{var:3},{val:d.s}]}),p&&(j.push({cmd:"CALL",fnName:p,params:[{var:0},{val:c},{var:0}]}),j.push({cmd:"CALL",fnName:p,params:[{var:1},{val:c},{var:1}]})),j.push({cmd:"GET",out:0,var:0,len:c*q}),j.push({cmd:"GET",out:1,var:1,len:c*q}),x.push(e.queueAction(j).then(a=>(l&&l.debug(`${m}: fftJoinExt End: ${b}/${v}`),a)))}let y=await Promise.all(x);v*q>0x10000000?(t=new aK(v*q),u=new aK(v*q)):(t=new Uint8Array(v*q),u=new Uint8Array(v*q));let z=0;for(let a=0;a<y.length;a++)t.set(y[a][0],z),u.set(y[a][1],z),z+=y[a][0].byteLength;return[t,u]}c.fft=async function(a,b,c,d,e){return await f(a,!1,b,c,d,e)},c.ifft=async function(a,b,c,d,e){return await f(a,!0,b,c,d,e)},c.lagrangeEvaluations=async function(a,e,g,h,j){let k,l;if(e=e||"affine",g=g||"affine","G1"==b)k="affine"==e?2*c.F.n8:3*c.F.n8;else if("G2"==b)k="affine"==e?2*c.F.n8:3*c.F.n8;else if("Fr"==b)k=d.n8;else throw Error("Invalid group");let m=a.byteLength/k,n=aG(m);if(2**n*k!=a.byteLength)throw h&&h.error("lagrangeEvaluations iinvalid input size"),Error("lagrangeEvaluations invalid Input size");if(n<=d.s)return await c.ifft(a,e,g,h,j);if(n>d.s+1)throw h&&h.error("lagrangeEvaluations input too big"),Error("lagrangeEvaluations input too big");let o=a.slice(0,a.byteLength/2),p=a.slice(a.byteLength/2,a.byteLength),q=d.exp(d.shift,m/2),r=d.inv(d.sub(d.one,q));[o,p]=await i(o,p,"prepareLagrangeEvaluation",r,d.shiftInv,e,"jacobian",h,j+" prep");let s=[];return s.push(f(o,!0,"jacobian",g,h,j+" t0")),s.push(f(p,!0,"jacobian",g,h,j+" t1")),[o,p]=await Promise.all(s),(l=o.byteLength>0x10000000?new aK(2*o.byteLength):new Uint8Array(2*o.byteLength)).set(o),l.set(p,o.byteLength),l},c.fftMix=async function(a){let f,g,h,i=3*c.F.n8;if("G1"==b)f="g1m_fftMix",g="g1m_fftJoin";else if("G2"==b)f="g2m_fftMix",g="g2m_fftJoin";else if("Fr"==b)f="frm_fftMix",g="frm_fftJoin";else throw Error("Invalid group");let j=Math.floor(a.byteLength/i),k=aG(j),l=1<<aG(e.concurrency);j<=2*l&&(l=1);let m=j/l,n=aG(m),o=[];for(let b=0;b<l;b++){let c=[],d=a.slice(b*m*i,(b+1)*m*i);c.push({cmd:"ALLOCSET",var:0,buff:d});for(let a=1;a<=n;a++)c.push({cmd:"CALL",fnName:f,params:[{var:0},{val:m},{val:a}]});c.push({cmd:"GET",out:0,var:0,len:m*i}),o.push(e.queueAction(c))}let p=await Promise.all(o),q=[];for(let a=0;a<p.length;a++)q[a]=p[a][0];for(let a=n+1;a<=k;a++){let b=1<<k-a,c=l/b,f=[];for(let h=0;h<b;h++)for(let b=0;b<c/2;b++){let j=d.exp(d.w[a],b*m),k=d.w[a],l=h*c+b,n=h*c+b+c/2,o=[];o.push({cmd:"ALLOCSET",var:0,buff:q[l]}),o.push({cmd:"ALLOCSET",var:1,buff:q[n]}),o.push({cmd:"ALLOCSET",var:2,buff:j}),o.push({cmd:"ALLOCSET",var:3,buff:k}),o.push({cmd:"CALL",fnName:g,params:[{var:0},{var:1},{val:m},{var:2},{var:3}]}),o.push({cmd:"GET",out:0,var:0,len:m*i}),o.push({cmd:"GET",out:1,var:1,len:m*i}),f.push(e.queueAction(o))}let h=await Promise.all(f);for(let a=0;a<b;a++)for(let b=0;b<c/2;b++){let d=a*c+b,e=a*c+b+c/2,f=h.shift();q[d]=f[0],q[e]=f[1]}}h=a instanceof aK?new aK(j*i):new Uint8Array(j*i);let r=0;for(let a=0;a<l;a++)h.set(q[a],r),r+=q[a].byteLength;return h},c.fftJoin=async function(a,f,g,h){let i,j,k,l=3*c.F.n8;if("G1"==b)i="g1m_fftJoin";else if("G2"==b)i="g2m_fftJoin";else if("Fr"==b)i="frm_fftJoin";else throw Error("Invalid group");if(a.byteLength!=f.byteLength)throw Error("Invalid buffer size");let m=Math.floor(a.byteLength/l);if(m!=1<<aG(m))throw Error("Invalid number of points");let n=1<<aG(e.concurrency);m<=2*n&&(n=1);let o=m/n,p=[];for(let b=0;b<n;b++){let c=[],j=d.mul(g,d.exp(h,b*o)),k=a.slice(b*o*l,(b+1)*o*l),m=f.slice(b*o*l,(b+1)*o*l);c.push({cmd:"ALLOCSET",var:0,buff:k}),c.push({cmd:"ALLOCSET",var:1,buff:m}),c.push({cmd:"ALLOCSET",var:2,buff:j}),c.push({cmd:"ALLOCSET",var:3,buff:h}),c.push({cmd:"CALL",fnName:i,params:[{var:0},{var:1},{val:o},{var:2},{var:3}]}),c.push({cmd:"GET",out:0,var:0,len:o*l}),c.push({cmd:"GET",out:1,var:1,len:o*l}),p.push(e.queueAction(c))}let q=await Promise.all(p);a instanceof aK?(j=new aK(m*l),k=new aK(m*l)):(j=new Uint8Array(m*l),k=new Uint8Array(m*l));let r=0;for(let a=0;a<q.length;a++)j.set(q[a][0],r),k.set(q[a][1],r),r+=q[a][0].byteLength;return[j,k]},c.fftFinal=async function(a,d){let f,g,h,i=3*c.F.n8,j=2*c.F.n8;if("G1"==b)f="g1m_fftFinal",g="g1m_batchToAffine";else if("G2"==b)f="g2m_fftFinal",g="g2m_batchToAffine";else throw Error("Invalid group");let k=Math.floor(a.byteLength/i);if(k!=1<<aG(k))throw Error("Invalid number of points");let l=Math.floor(k/e.concurrency),m=[];for(let b=0;b<e.concurrency;b++){let c;if(0==(c=b<e.concurrency-1?l:k-b*l))continue;let h=[],n=a.slice(b*l*i,(b*l+c)*i);h.push({cmd:"ALLOCSET",var:0,buff:n}),h.push({cmd:"ALLOCSET",var:1,buff:d}),h.push({cmd:"CALL",fnName:f,params:[{var:0},{val:c},{var:1}]}),h.push({cmd:"CALL",fnName:g,params:[{var:0},{val:c},{var:0}]}),h.push({cmd:"GET",out:0,var:0,len:c*j}),m.push(e.queueAction(h))}let n=await Promise.all(m);h=a instanceof aK?new aK(k*j):new Uint8Array(k*j);let o=0;for(let a=n.length-1;a>=0;a--)h.set(n[a][0],o),o+=n[a][0].byteLength;return h}}async function a_(a){let b,c=await aV(a.wasm,a.singleThread),d={};return d.q=x(a.wasm.q.toString()),d.r=x(a.wasm.r.toString()),d.name=a.name,d.tm=c,d.prePSize=a.wasm.prePSize,d.preQSize=a.wasm.preQSize,d.Fr=new aM(c,"frm",a.n8r,a.r),d.F1=new aM(c,"f1m",a.n8q,a.q),d.F2=new aN(c,"f2m",d.F1),d.G1=new aP(c,"g1m",d.F1,a.wasm.pG1gen,a.wasm.pG1b,a.cofactorG1),d.G2=new aP(c,"g2m",d.F2,a.wasm.pG2gen,a.wasm.pG2b,a.cofactorG2),d.F6=new aO(c,"f6m",d.F2),d.F12=new aN(c,"ftm",d.F6),d.Gt=d.F12,aX(d,"G1"),aX(d,"G2"),aX(d,"Fr"),aZ(d,"G1"),aZ(d,"G2"),a$(d,"G1"),a$(d,"G2"),a$(d,"Fr"),b=d.tm,d.pairing=function(a,c){b.startSyncOp();let e=b.allocBuff(d.G1.toJacobian(a)),f=b.allocBuff(d.G2.toJacobian(c)),g=b.alloc(d.Gt.n8);b.instance.exports[d.name+"_pairing"](e,f,g);let h=b.getBuff(g,d.Gt.n8);return b.endSyncOp(),h},d.pairingEq=async function(){let a,c;arguments.length%2==1?(a=arguments[arguments.length-1],c=(arguments.length-1)/2):(a=d.Gt.one,c=arguments.length/2);let e=[];for(let a=0;a<c;a++){let c=[],f=d.G1.toJacobian(arguments[2*a]);c.push({cmd:"ALLOCSET",var:0,buff:f}),c.push({cmd:"ALLOC",var:1,len:d.prePSize});let g=d.G2.toJacobian(arguments[2*a+1]);c.push({cmd:"ALLOCSET",var:2,buff:g}),c.push({cmd:"ALLOC",var:3,len:d.preQSize}),c.push({cmd:"ALLOC",var:4,len:d.Gt.n8}),c.push({cmd:"CALL",fnName:d.name+"_prepareG1",params:[{var:0},{var:1}]}),c.push({cmd:"CALL",fnName:d.name+"_prepareG2",params:[{var:2},{var:3}]}),c.push({cmd:"CALL",fnName:d.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),c.push({cmd:"GET",out:0,var:4,len:d.Gt.n8}),e.push(b.queueAction(c))}let f=await Promise.all(e);b.startSyncOp();let g=b.alloc(d.Gt.n8);b.instance.exports.ftm_one(g);for(let a=0;a<f.length;a++){let c=b.allocBuff(f[a][0]);b.instance.exports.ftm_mul(g,c,g)}b.instance.exports[d.name+"_finalExponentiation"](g,g);let h=b.allocBuff(a),i=!!b.instance.exports.ftm_eq(g,h);return b.endSyncOp(),i},d.prepareG1=function(a){this.tm.startSyncOp();let b=this.tm.allocBuff(a),c=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](b,c);let d=this.tm.getBuff(c,this.prePSize);return this.tm.endSyncOp(),d},d.prepareG2=function(a){this.tm.startSyncOp();let b=this.tm.allocBuff(a),c=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](b,c);let d=this.tm.getBuff(c,this.preQSize);return this.tm.endSyncOp(),d},d.millerLoop=function(a,b){this.tm.startSyncOp();let c=this.tm.allocBuff(a),d=this.tm.allocBuff(b),e=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](c,d,e);let f=this.tm.getBuff(e,this.Gt.n8);return this.tm.endSyncOp(),f},d.finalExponentiation=function(a){this.tm.startSyncOp();let b=this.tm.allocBuff(a),c=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](b,c);let d=this.tm.getBuff(c,this.Gt.n8);return this.tm.endSyncOp(),d},d.array2buffer=function(a,b){let c=new Uint8Array(b*a.length);for(let d=0;d<a.length;d++)c.set(a[d],d*b);return c},d.buffer2array=function(a,b){let c=a.byteLength/b,d=Array(c);for(let e=0;e<c;e++)d[e]=a.slice(e*b,e*b+b);return d},d}function a0(a){return BigInt(a)}function a1(a){let b=[],c=a0(a);return b.push(Number(255n&c)),b.push(Number(c>>8n&255n)),b.push(Number(c>>16n&255n)),b.push(Number(c>>24n&255n)),b}function a2(a){let b=function(a){for(var b=[],c=0;c<a.length;c++){var d=a.charCodeAt(c);d<128?b.push(d):d<2048?b.push(192|d>>6,128|63&d):d<55296||d>=57344?b.push(224|d>>12,128|d>>6&63,128|63&d):(c++,d=65536+((1023&d)<<10|1023&a.charCodeAt(c)),b.push(240|d>>18,128|d>>12&63,128|d>>6&63,128|63&d))}return b}(a);return[...a6(b.length),...b]}function a3(a){let b=[],c=a0(a);if(c<0n)throw Error("Number cannot be negative");for(;0n!==c;)b.push(Number(127n&c)),c>>=7n;0==b.length&&b.push(0);for(let a=0;a<b.length-1;a++)b[a]=128|b[a];return b}function a4(a){var b;let c,d,e=(b=a)<0n?b.toString(2).length-1:b.toString(2).length;a<0?(d=!0,c=(1n<<BigInt(e))+a):(d=!1,c=a0(a));let f=7-e%7,g=a3(c+((1n<<BigInt(f))-1n<<BigInt(e)));return d||(g[g.length-1]=g[g.length-1]&((1<<7-f)-1|128)),g}function a5(a){let b=a0(a);if(b>4294967295n)throw Error("Number too big");if(b>2147483647n&&(b-=4294967296n),b<-2147483648n)throw Error("Number too small");return a4(b)}function a6(a){let b=a0(a);if(b>4294967295n)throw Error("Number too big");return a3(b)}function a7(a){return Array.from(a,function(a){return("0"+(255&a).toString(16)).slice(-2)}).join("")}class a8{constructor(a){this.func=a,this.functionName=a.functionName,this.module=a.module}setLocal(a,b){let c=this.func.localIdxByName[a];if(void 0===c)throw Error(`Local Variable not defined: Function: ${this.functionName} local: ${a} `);return[...b,33,...a6(c)]}teeLocal(a,b){let c=this.func.localIdxByName[a];if(void 0===c)throw Error(`Local Variable not defined: Function: ${this.functionName} local: ${a} `);return[...b,34,...a6(c)]}getLocal(a){let b=this.func.localIdxByName[a];if(void 0===b)throw Error(`Local Variable not defined: Function: ${this.functionName} local: ${a} `);return[32,...a6(b)]}i64_load8_s(a,b,c){return[...a,48,void 0===c?0:c,...a6(b||0)]}i64_load8_u(a,b,c){return[...a,49,void 0===c?0:c,...a6(b||0)]}i64_load16_s(a,b,c){return[...a,50,void 0===c?1:c,...a6(b||0)]}i64_load16_u(a,b,c){return[...a,51,void 0===c?1:c,...a6(b||0)]}i64_load32_s(a,b,c){return[...a,52,void 0===c?2:c,...a6(b||0)]}i64_load32_u(a,b,c){return[...a,53,void 0===c?2:c,...a6(b||0)]}i64_load(a,b,c){return[...a,41,void 0===c?3:c,...a6(b||0)]}i64_store(a,b,c,d){let e,f,g;return Array.isArray(b)?(e=0,f=3,g=b):Array.isArray(c)?(e=b,f=3,g=c):Array.isArray(d)&&(e=b,f=c,g=d),[...a,...g,55,f,...a6(e)]}i64_store32(a,b,c,d){let e,f,g;return Array.isArray(b)?(e=0,f=2,g=b):Array.isArray(c)?(e=b,f=2,g=c):Array.isArray(d)&&(e=b,f=c,g=d),[...a,...g,62,f,...a6(e)]}i64_store16(a,b,c,d){let e,f,g;return Array.isArray(b)?(e=0,f=1,g=b):Array.isArray(c)?(e=b,f=1,g=c):Array.isArray(d)&&(e=b,f=c,g=d),[...a,...g,61,f,...a6(e)]}i64_store8(a,b,c,d){let e,f,g;return Array.isArray(b)?(e=0,f=0,g=b):Array.isArray(c)?(e=b,f=0,g=c):Array.isArray(d)&&(e=b,f=c,g=d),[...a,...g,60,f,...a6(e)]}i32_load8_s(a,b,c){return[...a,44,void 0===c?0:c,...a6(b||0)]}i32_load8_u(a,b,c){return[...a,45,void 0===c?0:c,...a6(b||0)]}i32_load16_s(a,b,c){return[...a,46,void 0===c?1:c,...a6(b||0)]}i32_load16_u(a,b,c){return[...a,47,void 0===c?1:c,...a6(b||0)]}i32_load(a,b,c){return[...a,40,void 0===c?2:c,...a6(b||0)]}i32_store(a,b,c,d){let e,f,g;return Array.isArray(b)?(e=0,f=2,g=b):Array.isArray(c)?(e=b,f=2,g=c):Array.isArray(d)&&(e=b,f=c,g=d),[...a,...g,54,f,...a6(e)]}i32_store16(a,b,c,d){let e,f,g;return Array.isArray(b)?(e=0,f=1,g=b):Array.isArray(c)?(e=b,f=1,g=c):Array.isArray(d)&&(e=b,f=c,g=d),[...a,...g,59,f,...a6(e)]}i32_store8(a,b,c,d){let e,f,g;return Array.isArray(b)?(e=0,f=0,g=b):Array.isArray(c)?(e=b,f=0,g=c):Array.isArray(d)&&(e=b,f=c,g=d),[...a,...g,58,f,...a6(e)]}call(a,...b){let c=this.module.functionIdxByName[a];if(void 0===c)throw Error(`Function not defined: Function: ${a}`);return[...[].concat(...b),16,...a6(c)]}call_indirect(a,...b){return[...[].concat(...b),...a,17,0,0]}if(a,b,c){return c?[...a,4,64,...b,5,...c,11]:[...a,4,64,...b,11]}block(a){return[2,64,...a,11]}loop(...a){return[3,64,...[].concat(...a),11]}br_if(a,b){return[...b,13,...a6(a)]}br(a){return[12,...a6(a)]}ret(a){return[...a,15]}drop(a){return[...a,26]}i64_const(a){return[66,...function(a){let b=a0(a);if(b>0xffffffffffffffffn)throw Error("Number too big");if(b>0x7fffffffffffffffn&&(b-=0x10000000000000000n),b<-0x8000000000000000n)throw Error("Number too small");return a4(b)}(a)]}i32_const(a){return[65,...a5(a)]}i64_eqz(a){return[...a,80]}i64_eq(a,b){return[...a,...b,81]}i64_ne(a,b){return[...a,...b,82]}i64_lt_s(a,b){return[...a,...b,83]}i64_lt_u(a,b){return[...a,...b,84]}i64_gt_s(a,b){return[...a,...b,85]}i64_gt_u(a,b){return[...a,...b,86]}i64_le_s(a,b){return[...a,...b,87]}i64_le_u(a,b){return[...a,...b,88]}i64_ge_s(a,b){return[...a,...b,89]}i64_ge_u(a,b){return[...a,...b,90]}i64_add(a,b){return[...a,...b,124]}i64_sub(a,b){return[...a,...b,125]}i64_mul(a,b){return[...a,...b,126]}i64_div_s(a,b){return[...a,...b,127]}i64_div_u(a,b){return[...a,...b,128]}i64_rem_s(a,b){return[...a,...b,129]}i64_rem_u(a,b){return[...a,...b,130]}i64_and(a,b){return[...a,...b,131]}i64_or(a,b){return[...a,...b,132]}i64_xor(a,b){return[...a,...b,133]}i64_shl(a,b){return[...a,...b,134]}i64_shr_s(a,b){return[...a,...b,135]}i64_shr_u(a,b){return[...a,...b,136]}i64_extend_i32_s(a){return[...a,172]}i64_extend_i32_u(a){return[...a,173]}i64_clz(a){return[...a,121]}i64_ctz(a){return[...a,122]}i32_eqz(a){return[...a,69]}i32_eq(a,b){return[...a,...b,70]}i32_ne(a,b){return[...a,...b,71]}i32_lt_s(a,b){return[...a,...b,72]}i32_lt_u(a,b){return[...a,...b,73]}i32_gt_s(a,b){return[...a,...b,74]}i32_gt_u(a,b){return[...a,...b,75]}i32_le_s(a,b){return[...a,...b,76]}i32_le_u(a,b){return[...a,...b,77]}i32_ge_s(a,b){return[...a,...b,78]}i32_ge_u(a,b){return[...a,...b,79]}i32_add(a,b){return[...a,...b,106]}i32_sub(a,b){return[...a,...b,107]}i32_mul(a,b){return[...a,...b,108]}i32_div_s(a,b){return[...a,...b,109]}i32_div_u(a,b){return[...a,...b,110]}i32_rem_s(a,b){return[...a,...b,111]}i32_rem_u(a,b){return[...a,...b,112]}i32_and(a,b){return[...a,...b,113]}i32_or(a,b){return[...a,...b,114]}i32_xor(a,b){return[...a,...b,115]}i32_shl(a,b){return[...a,...b,116]}i32_shr_s(a,b){return[...a,...b,117]}i32_shr_u(a,b){return[...a,...b,118]}i32_rotl(a,b){return[...a,...b,119]}i32_rotr(a,b){return[...a,...b,120]}i32_wrap_i64(a){return[...a,167]}i32_clz(a){return[...a,103]}i32_ctz(a){return[...a,104]}unreachable(){return[0]}current_memory(){return[63,0]}comment(){return[]}}let a9={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,emptyblock:64};class ba{constructor(a,b,c,d,e){if("import"==c)this.fnType="import",this.moduleName=d,this.fieldName=e;else if("internal"==c)this.fnType="internal";else throw Error("Invalid function fnType: "+c);this.module=a,this.fnName=b,this.params=[],this.locals=[],this.localIdxByName={},this.code=[],this.returnType=null,this.nextLocal=0}addParam(a,b){if(this.localIdxByName[a])throw Error(`param already exists. Function: ${this.fnName}, Param: ${a} `);let c=this.nextLocal++;this.localIdxByName[a]=c,this.params.push({type:b})}addLocal(a,b,c){if(this.localIdxByName[a])throw Error(`local already exists. Function: ${this.fnName}, Param: ${a} `);let d=this.nextLocal++;this.localIdxByName[a]=d,this.locals.push({type:b,length:c||1})}setReturnType(a){if(this.returnType)throw Error(`returnType already defined. Function: ${this.fnName}`);this.returnType=a}getSignature(){return[96,...a6(this.params.length),...this.params.map(a=>a9[a.type]),...this.returnType?[1,a9[this.returnType]]:[0]]}getBody(){let a=this.locals.map(a=>[...a6(a.length),a9[a.type]]),b=[...a6(this.locals.length),...[].concat(...a),...this.code,11];return[...a6(b.length),...b]}addCode(...a){this.code.push(...[].concat(...a))}getCodeBuilder(){return new a8(this)}}class bb{constructor(){this.functions=[],this.functionIdxByName={},this.nImportFunctions=0,this.nInternalFunctions=0,this.memory={pagesSize:1,moduleName:"env",fieldName:"memory"},this.free=8,this.datas=[],this.modules={},this.exports=[],this.functionsTable=[]}build(){return this._setSignatures(),new Uint8Array([...a1(0x6d736100),...a1(1),...this._buildType(),...this._buildImport(),...this._buildFunctionDeclarations(),...this._buildFunctionsTable(),...this._buildExports(),...this._buildElements(),...this._buildCode(),...this._buildData()])}addFunction(a){if(void 0!==this.functionIdxByName[a])throw Error(`Function already defined: ${a}`);let b=this.functions.length;return this.functionIdxByName[a]=b,this.functions.push(new ba(this,a,"internal")),this.nInternalFunctions++,this.functions[b]}addIimportFunction(a,b,c){if(void 0!==this.functionIdxByName[a])throw Error(`Function already defined: ${a}`);if(this.functions.length>0&&"internal"==this.functions[this.functions.length-1].type)throw Error(`Import functions must be declared before internal: ${a}`);let d=c||a,e=this.functions.length;return this.functionIdxByName[a]=e,this.functions.push(new ba(this,a,"import",b,d)),this.nImportFunctions++,this.functions[e]}setMemory(a,b,c){this.memory={pagesSize:a,moduleName:b||"env",fieldName:c||"memory"}}exportFunction(a,b){let c=b||a;if(void 0===this.functionIdxByName[a])throw Error(`Function not defined: ${a}`);let d=this.functionIdxByName[a];c!=a&&(this.functionIdxByName[c]=d),this.exports.push({exportName:c,idx:d})}addFunctionToTable(a){let b=this.functionIdxByName[a];this.functionsTable.push(b)}addData(a,b){this.datas.push({offset:a,bytes:b})}alloc(a,b){let c,d;(Array.isArray(a)||ArrayBuffer.isView(a))&&void 0===b?(c=a.length,d=a):(c=a,d=b),c=(c-1>>3)+1<<3;let e=this.free;return this.free+=c,d&&this.addData(e,d),e}allocString(a){let b=new globalThis.TextEncoder().encode(a);return this.alloc([...b,0])}_setSignatures(){this.signatures=[];let a={};if(this.functionsTable.length>0){let b=this.functions[this.functionsTable[0]].getSignature();a["s_"+a7(b)]=0,this.signatures.push(b)}for(let b=0;b<this.functions.length;b++){let c=this.functions[b].getSignature(),d="s_"+a7(c);void 0===a[d]&&(a[d]=this.signatures.length,this.signatures.push(c)),this.functions[b].signatureIdx=a[d]}}_buildSection(a,b){return[a,...a6(b.length),...b]}_buildType(){return this._buildSection(1,[...a6(this.signatures.length),...[].concat(...this.signatures)])}_buildImport(){let a=[];a.push([...a2(this.memory.moduleName),...a2(this.memory.fieldName),2,0,...a6(this.memory.pagesSize)]);for(let b=0;b<this.nImportFunctions;b++)a.push([...a2(this.functions[b].moduleName),...a2(this.functions[b].fieldName),0,...a6(this.functions[b].signatureIdx)]);return this._buildSection(2,a6(a.length).concat(...a))}_buildFunctionDeclarations(){let a=[];for(let b=this.nImportFunctions;b<this.nImportFunctions+this.nInternalFunctions;b++)a.push(...a6(this.functions[b].signatureIdx));return this._buildSection(3,[...a6(a.length),...a])}_buildFunctionsTable(){return 0==this.functionsTable.length?[]:this._buildSection(4,[...a6(1),112,0,...a6(this.functionsTable.length)])}_buildElements(){if(0==this.functionsTable.length)return[];let a=[];for(let b=0;b<this.functionsTable.length;b++)a.push(...a6(this.functionsTable[b]));return this._buildSection(9,[...a6(1),...a6(0),65,...a5(0),11,...a6(this.functionsTable.length),...a])}_buildExports(){let a=[];for(let b=0;b<this.exports.length;b++)a.push([...a2(this.exports[b].exportName),0,...a6(this.exports[b].idx)]);return this._buildSection(7,a6(a.length).concat(...a))}_buildCode(){let a=[];for(let b=this.nImportFunctions;b<this.nImportFunctions+this.nInternalFunctions;b++)a.push(this.functions[b].getBody());return this._buildSection(10,a6(a.length).concat(...a))}_buildData(){let a=[];a.push([0,65,0,11,4,...a1(this.free)]);for(let b=0;b<this.datas.length;b++)a.push([0,65,...a5(this.datas[b].offset),11,...a6(this.datas[b].bytes.length),...this.datas[b].bytes]);return this._buildSection(11,a6(a.length).concat(...a))}}async function bc(a,b){if(!a&&globalThis.curve_bn128)return globalThis.curve_bn128;let c=new bb;c.setMemory(25),(0,az.buildBn128)(c),b&&b(c);let d={};d.code=c.build(),d.pq=c.modules.f1m.pq,d.pr=c.modules.frm.pq,d.pG1gen=c.modules.bn128.pG1gen,d.pG1zero=c.modules.bn128.pG1zero,d.pG1b=c.modules.bn128.pG1b,d.pG2gen=c.modules.bn128.pG2gen,d.pG2zero=c.modules.bn128.pG2zero,d.pG2b=c.modules.bn128.pG2b,d.pOneT=c.modules.bn128.pOneT,d.prePSize=c.modules.bn128.prePSize,d.preQSize=c.modules.bn128.preQSize,d.n8q=32,d.n8r=32,d.q=c.modules.bn128.q,d.r=c.modules.bn128.r;let e={name:"bn128",wasm:d,q:x("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:x("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:x("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!a},f=await a_(e);return f.terminate=async function(){e.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},a||(globalThis.curve_bn128=f),f}async function bd(a,b){if(!a&&globalThis.curve_bls12381)return globalThis.curve_bls12381;let c=new bb;c.setMemory(25),(0,az.buildBls12381)(c),b&&b(c);let d={};d.code=c.build(),d.pq=c.modules.f1m.pq,d.pr=c.modules.frm.pq,d.pG1gen=c.modules.bls12381.pG1gen,d.pG1zero=c.modules.bls12381.pG1zero,d.pG1b=c.modules.bls12381.pG1b,d.pG2gen=c.modules.bls12381.pG2gen,d.pG2zero=c.modules.bls12381.pG2zero,d.pG2b=c.modules.bls12381.pG2b,d.pOneT=c.modules.bls12381.pOneT,d.prePSize=c.modules.bls12381.prePSize,d.preQSize=c.modules.bls12381.preQSize,d.n8q=48,d.n8r=32,d.q=c.modules.bls12381.q,d.r=c.modules.bls12381.r;let e={name:"bls12381",wasm:d,q:x("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:x("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:x("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:x("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!a},f=await a_(e);return f.terminate=async function(){e.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},a||(globalThis.curve_bls12381=f),f}globalThis.curve_bn128=null,globalThis.curve_bls12381=null,x("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),x("21888242871839275222246405745257275088548364400416034343698204186575808495617"),x("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),x("21888242871839275222246405745257275088696311157297823662689037894645226208583");var be=c(9021);async function bf(a,b,c,d){if(c=c||262144,"number"!=typeof b&&0>["w+","wx+","r","ax+","a+"].indexOf(b))throw Error("Invalid open option");let e=await be.promises.open(a,b),f=await e.stat();return new bg(e,f,c,d,a)}class bg{constructor(a,b,c,d,e){for(this.fileName=e,this.fd=a,this.pos=0,this.pageSize=d||256;this.pageSize<b.blksize;)this.pageSize*=2;this.totalSize=b.size,this.totalPages=Math.floor((b.size-1)/this.pageSize)+1,this.maxPagesLoaded=Math.floor(c/this.pageSize)+1,this.pages={},this.pendingLoads=[],this.writing=!1,this.reading=!1,this.avBuffs=[],this.history={}}_loadPage(a){let b=this,c=new Promise((c,d)=>{b.pendingLoads.push({page:a,resolve:c,reject:d})});return b.__statusPage("After Load request: ",a),c}__statusPage(a,b){let c=[];if(!this.logHistory)return;c.push("=="+a+" "+b);let d="";for(let a=0;a<this.pendingLoads.length;a++)this.pendingLoads[a].page==b&&(d=d+" "+a);if(d&&c.push("Pending loads:"+d),void 0!==this.pages[b]){let a=this.pages[b];c.push("Loaded"),c.push("pendingOps: "+a.pendingOps),a.loading&&c.push("loading: "+a.loading),a.writing&&c.push("writing"),a.dirty&&c.push("dirty")}c.push("=="),this.history[b]||(this.history[b]=[]),this.history[b].push(c)}__printHistory(a){this.history[a]||console.log("Empty History ",a),console.log("History "+a);for(let b=0;b<this.history[a].length;b++)for(let c=0;c<this.history[a][b].length;c++)console.log("-> "+this.history[a][b][c])}_triggerLoad(){let a=this;if(a.reading||0==a.pendingLoads.length)return;let b=Object.keys(a.pages),c=[];for(let d=0;d<b.length;d++){let e=a.pages[parseInt(b[d])];!1!=e.dirty||0!=e.pendingOps||e.writing||e.loading||c.push(parseInt(b[d]))}let d=a.maxPagesLoaded-b.length,e=[];for(;a.pendingLoads.length>0&&(void 0!==a.pages[a.pendingLoads[0].page]||d>0||c.length>0);){let b=a.pendingLoads.shift();if(void 0!==a.pages[b.page]){a.pages[b.page].pendingOps++;let d=c.indexOf(b.page);d>=0&&c.splice(d,1),a.pages[b.page].loading?a.pages[b.page].loading.push(b):b.resolve(),a.__statusPage("After Load (cached): ",b.page)}else{if(d)d--;else{let b=c.shift();a.__statusPage("Before Unload: ",b),a.avBuffs.unshift(a.pages[b]),delete a.pages[b],a.__statusPage("After Unload: ",b)}b.page>=a.totalPages?(a.pages[b.page]=f(),b.resolve(),a.__statusPage("After Load (new): ",b.page)):(a.reading=!0,a.pages[b.page]=f(),a.pages[b.page].loading=[b],e.push(a.fd.read(a.pages[b.page].buff,0,a.pageSize,b.page*a.pageSize).then(c=>{a.pages[b.page].size=c.bytesRead;let d=a.pages[b.page].loading;delete a.pages[b.page].loading;for(let a=0;a<d.length;a++)d[a].resolve();return a.__statusPage("After Load (loaded): ",b.page),c},a=>{b.reject(a)})),a.__statusPage("After Load (loading): ",b.page))}}function f(){if(!(a.avBuffs.length>0))return{dirty:!1,buff:new Uint8Array(a.pageSize),pendingOps:1,size:0};{let b=a.avBuffs.shift();return b.dirty=!1,b.pendingOps=1,b.size=0,b}}Promise.all(e).then(()=>{a.reading=!1,a.pendingLoads.length>0&&setImmediate(a._triggerLoad.bind(a)),a._tryClose()})}_triggerWrite(){let a=this;if(a.writing)return;let b=Object.keys(a.pages),c=[];for(let d=0;d<b.length;d++){let e=a.pages[parseInt(b[d])];e.dirty&&(e.dirty=!1,e.writing=!0,a.writing=!0,c.push(a.fd.write(e.buff,0,e.size,parseInt(b[d])*a.pageSize).then(()=>{e.writing=!1},b=>{console.log("ERROR Writing: "+b),a.error=b,a._tryClose()})))}a.writing&&Promise.all(c).then(()=>{a.writing=!1,setImmediate(a._triggerWrite.bind(a)),a._tryClose(),a.pendingLoads.length>0&&setImmediate(a._triggerLoad.bind(a))})}_getDirtyPage(){for(let a in this.pages)if(this.pages[a].dirty)return a;return -1}async write(a,b){if(0==a.byteLength)return;if(void 0===b&&(b=this.pos),this.pos=b+a.byteLength,this.totalSize<b+a.byteLength&&(this.totalSize=b+a.byteLength),this.pendingClose)throw Error("Writing a closing file");let c=Math.floor(b/this.pageSize),d=Math.floor((b+a.byteLength-1)/this.pageSize),e=[];for(let a=c;a<=d;a++)e.push(this._loadPage(a));this._triggerLoad();let f=c,g=b%this.pageSize,h=a.byteLength;for(;h>0;){await e[f-c];let b=g+h>this.pageSize?this.pageSize-g:h,d=a.slice(a.byteLength-h,a.byteLength-h+b);new Uint8Array(this.pages[f].buff.buffer,g,b).set(d),this.pages[f].dirty=!0,this.pages[f].pendingOps--,this.pages[f].size=Math.max(g+b,this.pages[f].size),f>=this.totalPages&&(this.totalPages=f+1),h-=b,f++,g=0,this.writing||setImmediate(this._triggerWrite.bind(this))}}async read(a,b){let c=new Uint8Array(a);return await this.readToBuffer(c,0,a,b),c}async readToBuffer(a,b,c,d){if(0==c)return;if(c>this.pageSize*this.maxPagesLoaded*.8){let a=Math.floor(1.1*c);this.maxPagesLoaded=Math.floor(a/this.pageSize)+1}if(void 0===d&&(d=this.pos),this.pos=d+c,this.pendingClose)throw Error("Reading a closing file");let e=Math.floor(d/this.pageSize),f=Math.floor((d+c-1)/this.pageSize),g=[];for(let a=e;a<=f;a++)g.push(this._loadPage(a));this._triggerLoad();let h=e,i=d%this.pageSize,j=d+c>this.totalSize?c-(d+c-this.totalSize):c;for(;j>0;){await g[h-e],this.__statusPage("After Await (read): ",h);let d=i+j>this.pageSize?this.pageSize-i:j,f=new Uint8Array(this.pages[h].buff.buffer,this.pages[h].buff.byteOffset+i,d);a.set(f,b+c-j),this.pages[h].pendingOps--,this.__statusPage("After Op done: ",h),j-=d,h++,i=0,this.pendingLoads.length>0&&setImmediate(this._triggerLoad.bind(this))}this.pos=d+c}_tryClose(){!this.pendingClose||(this.error&&this.pendingCloseReject(this.error),this._getDirtyPage()>=0||this.writing||this.reading||this.pendingLoads.length>0||this.pendingClose())}close(){let a=this;if(a.pendingClose)throw Error("Closing the file twice");return new Promise((b,c)=>{a.pendingClose=b,a.pendingCloseReject=c,a._tryClose()}).then(()=>{a.fd.close()},b=>{throw a.fd.close(),b})}async discard(){await this.close(),await be.promises.unlink(this.fileName)}async writeULE32(a,b){let c=new Uint8Array(4);new DataView(c.buffer).setUint32(0,a,!0),await this.write(c,b)}async writeUBE32(a,b){let c=new Uint8Array(4);new DataView(c.buffer).setUint32(0,a,!1),await this.write(c,b)}async writeULE64(a,b){let c=new Uint8Array(8),d=new DataView(c.buffer);d.setUint32(0,0|a,!0),d.setUint32(4,Math.floor(a/0x100000000),!0),await this.write(c,b)}async readULE32(a){return new Uint32Array((await this.read(4,a)).buffer)[0]}async readUBE32(a){return new DataView((await this.read(4,a)).buffer).getUint32(0,!1)}async readULE64(a){let b=new Uint32Array((await this.read(8,a)).buffer);return 0x100000000*b[1]+b[0]}async readString(a){if(this.pendingClose)throw Error("Reading a closing file");let b=void 0===a?this.pos:a,c=Math.floor(b/this.pageSize),d=!1,e="";for(;!d;){let a=this._loadPage(c);this._triggerLoad(),await a,this.__statusPage("After Await (read): ",c);let f=b%this.pageSize,g=new Uint8Array(this.pages[c].buff.buffer,this.pages[c].buff.byteOffset+f,this.pageSize-f),h=g.findIndex(a=>0===a);(d=-1!==h)?(e+=new TextDecoder().decode(g.slice(0,h)),this.pos=c*this.pageSize+f+h+1):(e+=new TextDecoder().decode(g),this.pos=c*this.pageSize+f+g.length),this.pages[c].pendingOps--,this.__statusPage("After Op done: ",c),b=this.pos,c++,this.pendingLoads.length>0&&setImmediate(this._triggerLoad.bind(this))}return e}}let bh=new Uint8Array(4),bi=new DataView(bh.buffer),bj=new Uint8Array(8),bk=new DataView(bj.buffer);class bl{constructor(){this.pageSize=16384}_resizeIfNeeded(a){if(a>this.allocSize){let b=Math.max(this.allocSize+1048576,Math.floor(1.1*this.allocSize),a),c=new Uint8Array(b);c.set(this.o.data),this.o.data=c,this.allocSize=b}}async write(a,b){if(void 0===b&&(b=this.pos),this.readOnly)throw Error("Writing a read only file");this._resizeIfNeeded(b+a.byteLength),this.o.data.set(a.slice(),b),b+a.byteLength>this.totalSize&&(this.totalSize=b+a.byteLength),this.pos=b+a.byteLength}async readToBuffer(a,b,c,d){if(void 0===d&&(d=this.pos),this.readOnly&&d+c>this.totalSize)throw Error("Reading out of bounds");this._resizeIfNeeded(d+c);let e=new Uint8Array(this.o.data.buffer,this.o.data.byteOffset+d,c);a.set(e,b),this.pos=d+c}async read(a,b){let c=new Uint8Array(a);return await this.readToBuffer(c,0,a,b),c}close(){this.o.data.byteLength!=this.totalSize&&(this.o.data=this.o.data.slice(0,this.totalSize))}async discard(){}async writeULE32(a,b){bi.setUint32(0,a,!0),await this.write(bh,b)}async writeUBE32(a,b){bi.setUint32(0,a,!1),await this.write(bh,b)}async writeULE64(a,b){bk.setUint32(0,0|a,!0),bk.setUint32(4,Math.floor(a/0x100000000),!0),await this.write(bj,b)}async readULE32(a){return new Uint32Array((await this.read(4,a)).buffer)[0]}async readUBE32(a){return new DataView((await this.read(4,a)).buffer).getUint32(0,!1)}async readULE64(a){let b=new Uint32Array((await this.read(8,a)).buffer);return 0x100000000*b[1]+b[0]}async readString(a){let b=void 0===a?this.pos:a;if(b>this.totalSize){if(this.readOnly)throw Error("Reading out of bounds");this._resizeIfNeeded(a)}let c=new Uint8Array(this.o.data.buffer,b,this.totalSize-b),d=c.findIndex(a=>0===a),e="";return -1!==d?(e=new TextDecoder().decode(c.slice(0,d)),this.pos=b+d+1):this.pos=b,e}}let bm=new Uint8Array(4),bn=new DataView(bm.buffer),bo=new Uint8Array(8),bp=new DataView(bo.buffer);class bq{constructor(){this.pageSize=16384}_resizeIfNeeded(a){if(a<=this.totalSize)return;if(this.readOnly)throw Error("Reading out of file bounds");let b=Math.floor((a-1)/4194304)+1;for(let c=Math.max(this.o.data.length-1,0);c<b;c++){let d=new Uint8Array(c<b-1?4194304:a-(b-1)*4194304);c==this.o.data.length-1&&d.set(this.o.data[c]),this.o.data[c]=d}this.totalSize=a}async write(a,b){if(void 0===b&&(b=this.pos),this.readOnly)throw Error("Writing a read only file");this._resizeIfNeeded(b+a.byteLength);let c=Math.floor(b/4194304),d=b%4194304,e=a.byteLength;for(;e>0;){let b=d+e>4194304?4194304-d:e,f=a.slice(a.byteLength-e,a.byteLength-e+b);new Uint8Array(this.o.data[c].buffer,d,b).set(f),e-=b,c++,d=0}this.pos=b+a.byteLength}async readToBuffer(a,b,c,d){if(void 0===d&&(d=this.pos),this.readOnly&&d+c>this.totalSize)throw Error("Reading out of bounds");this._resizeIfNeeded(d+c);let e=Math.floor(d/4194304),f=d%4194304,g=c;for(;g>0;){let d=f+g>4194304?4194304-f:g,h=new Uint8Array(this.o.data[e].buffer,f,d);a.set(h,b+c-g),g-=d,e++,f=0}this.pos=d+c}async read(a,b){let c=new Uint8Array(a);return await this.readToBuffer(c,0,a,b),c}close(){}async discard(){}async writeULE32(a,b){bn.setUint32(0,a,!0),await this.write(bm,b)}async writeUBE32(a,b){bn.setUint32(0,a,!1),await this.write(bm,b)}async writeULE64(a,b){bp.setUint32(0,0|a,!0),bp.setUint32(4,Math.floor(a/0x100000000),!0),await this.write(bo,b)}async readULE32(a){return new Uint32Array((await this.read(4,a)).buffer)[0]}async readUBE32(a){return new DataView((await this.read(4,a)).buffer).getUint32(0,!1)}async readULE64(a){let b=new Uint32Array((await this.read(8,a)).buffer);return 0x100000000*b[1]+b[0]}async readString(a){let b=void 0===a?this.pos:a;if(b>this.totalSize){if(this.readOnly)throw Error("Reading out of bounds");this._resizeIfNeeded(a)}let c=!1,d="";for(;!c;){let a=Math.floor(b/4194304),e=b%4194304;if(void 0===this.o.data[a])throw Error("ERROR");let f=Math.min(2048,this.o.data[a].length-e),g=new Uint8Array(this.o.data[a].buffer,e,f),h=g.findIndex(a=>0===a);(c=-1!==h)?(d+=new TextDecoder().decode(g.slice(0,h)),this.pos=4194304*a+e+h+1):(d+=new TextDecoder().decode(g),this.pos=4194304*a+e+g.length),b=this.pos}return d}}var br=c(1115);async function bs(a,b,c){if("string"==typeof a&&(a={type:"file",fileName:a,cacheSize:b||65536,pageSize:c||8192}),"file"==a.type)return await bf(a.fileName,br.O_TRUNC|br.O_CREAT|br.O_RDWR,a.cacheSize,a.pageSize);if("mem"==a.type){var d;let b,c;return b=(d=a).initialSize||1048576,(c=new bl).o=d,c.o.data=new Uint8Array(b),c.allocSize=b,c.totalSize=0,c.readOnly=!1,c.pos=0,c}if("bigMem"==a.type){var e=a;let b=e.initialSize||0,c=new bq;c.o=e;let d=b?Math.floor((b-1)/4194304)+1:0;c.o.data=[];for(let a=0;a<d-1;a++)c.o.data.push(new Uint8Array(4194304));return d&&c.o.data.push(new Uint8Array(b-4194304*(d-1))),c.totalSize=0,c.readOnly=!1,c.pos=0,c}throw Error("Invalid FastFile type: "+a.type)}async function bt(a,b,c){var d,e;if(a instanceof Uint8Array&&(a={type:"mem",data:a}),"string"==typeof a&&(a={type:"file",fileName:a,cacheSize:b||65536,pageSize:c||8192}),"file"==a.type)return await bf(a.fileName,br.O_RDONLY,a.cacheSize,a.pageSize);if("mem"==a.type){let b;return await (d=a,(b=new bl).o=d,b.allocSize=d.data.byteLength,b.totalSize=d.data.byteLength,b.readOnly=!0,b.pos=0,b)}if("bigMem"==a.type){let b;return await (e=a,(b=new bq).o=e,b.totalSize=(e.data.length-1)*4194304+e.data[e.data.length-1].byteLength,b.readOnly=!0,b.pos=0,b)}throw Error("Invalid FastFile type: "+a.type)}async function bu(a,b,c,d,e){let f=await bt(a,d,e),g=await f.read(4),h="";for(let a=0;a<4;a++)h+=String.fromCharCode(g[a]);if(h!=b)throw Error(a+": Invalid File format");if(await f.readULE32()>c)throw Error("Version not supported");let i=await f.readULE32(),j=[];for(let a=0;a<i;a++){let a=await f.readULE32(),b=await f.readULE64();void 0===j[a]&&(j[a]=[]),j[a].push({p:f.pos,size:b}),f.pos+=b}return{fd:f,sections:j}}async function bv(a,b,c,d,e,f){let g=await bs(a,e,f),h=new Uint8Array(4);for(let a=0;a<4;a++)h[a]=b.charCodeAt(a);return await g.write(h,0),await g.writeULE32(c),await g.writeULE32(d),g}async function bw(a,b){if(void 0!==a.writingSection)throw Error("Already writing a section");await a.writeULE32(b),a.writingSection={pSectionSize:a.pos},await a.writeULE64(0)}async function bx(a){if(void 0===a.writingSection)throw Error("Not writing a section");let b=a.pos-a.writingSection.pSectionSize-8,c=a.pos;a.pos=a.writingSection.pSectionSize,await a.writeULE64(b),a.pos=c,delete a.writingSection}async function by(a,b,c){if(void 0!==a.readingSection)throw Error("Already reading a section");if(!b[c])throw Error(a.fileName+": Missing section "+c);if(b[c].length>1)throw Error(a.fileName+": Section Duplicated "+c);a.pos=b[c][0].p,a.readingSection=b[c][0]}async function bz(a,b){if(void 0===a.readingSection)throw Error("Not reading a section");if(!b&&a.pos-a.readingSection.p!=a.readingSection.size)throw Error("Invalid section size reading");delete a.readingSection}async function bA(a,b,c,d){let e=new Uint8Array(c);l.toRprLE(e,0,b,c),await a.write(e,d)}async function bB(a,b,c){let d=await a.read(b,c);return l.fromRprLE(d,0,b)}async function bC(a,b,c,d,e){void 0===e&&(e=b[d][0].size);let f=a.pageSize;await by(a,b,d),await bw(c,d);for(let b=0;b<e;b+=f){let d=Math.min(e-b,f),g=await a.read(d);await c.write(g)}await bx(c),await bz(a,e!=b[d][0].size)}async function bD(a,b,c,d,e){let f;if(d=void 0===d?0:d,e=void 0===e?b[c][0].size-d:e,d+e>b[c][0].size)throw Error("Reading out of the range of the section");return f=e<0x40000000?new Uint8Array(e):new aK(e),await a.readToBuffer(f,0,e,b[c][0].p+d),f}async function bE(a,b,c,d,e){let f=16*a.pageSize;if(await by(a,b,e),await by(c,d,e),b[e][0].size!=d[e][0].size)return!1;let g=b[e][0].size;for(let b=0;b<g;b+=f){let d=Math.min(g-b,f),e=await a.read(d),h=await c.read(d);for(let a=0;a<d;a++)if(e[a]!=h[a])return!1}return await bz(a),await bz(c),!0}let bF=l.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),bG=l.e("21888242871839275222246405745257275088548364400416034343698204186575808495617"),bH=l.e("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),bI=l.e("21888242871839275222246405745257275088696311157297823662689037894645226208583");async function bJ(a,b){let c,d=b&&b.singleThread;if(l.eq(a,bG))c=await bc(d);else if(l.eq(a,bF))c=await bd(d);else throw Error(`Curve not supported: ${l.toString(a)}`);return c}async function bK(a,b){let c,d=b&&b.singleThread;if(l.eq(a,bI))c=await bc(d);else if(l.eq(a,bH))c=await bd(d);else throw Error(`Curve not supported: ${l.toString(a)}`);return c}async function bL(a,b){let c,d=b&&b.singleThread,e=a.toUpperCase().match(/[A-Za-z0-9]+/g).join("");if(["BN128","BN254","ALTBN128"].indexOf(e)>=0)c=await bc(d);else if(["BLS12381"].indexOf(e)>=0)c=await bd(d);else throw Error(`Curve not supported: ${a}`);return c}function bM(a){if(!Number.isSafeInteger(a)||a<0)throw Error("positive integer expected, got "+a)}function bN(a,...b){if(!(a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error("Uint8Array expected of length "+b+", got length="+a.length)}function bO(a,b=!0){if(a.destroyed)throw Error("Hash instance has been destroyed");if(b&&a.finished)throw Error("Hash#digest() has already been called")}function bP(a,b){bN(a);let c=b.outputLen;if(a.length<c)throw Error("digestInto() expects output buffer of length at least "+c)}function bQ(a){return new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4))}function bR(...a){for(let b=0;b<a.length;b++)a[b].fill(0)}let bS=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function bT(a){return a<<24&0xff000000|a<<8&0xff0000|a>>>8&65280|a>>>24&255}let bU=bS?a=>a:a=>bT(a),bV=bS?a=>a:function(a){for(let b=0;b<a.length;b++)a[b]=bT(a[b]);return a};function bW(a){return"string"==typeof a&&(a=function(a){if("string"!=typeof a)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(a))}(a)),bN(a),a}class bX{}let bY=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),bZ=BigInt(0x100000000-1),b$=BigInt(32);function b_(a,b=!1){return b?{h:Number(a&bZ),l:Number(a>>b$&bZ)}:{h:0|Number(a>>b$&bZ),l:0|Number(a&bZ)}}let b0=(a,b,c)=>a>>>c|b<<32-c,b1=(a,b,c)=>a<<32-c|b>>>c;function b2(a,b,c,d){let e=(b>>>0)+(d>>>0);return{h:a+c+(e/0x100000000|0)|0,l:0|e}}let b3=(a,b,c)=>(a>>>0)+(b>>>0)+(c>>>0),b4=(a,b,c,d)=>b+c+d+(a/0x100000000|0)|0,b5=Uint32Array.from([0xf3bcc908,0x6a09e667,0x84caa73b,0xbb67ae85,0xfe94f82b,0x3c6ef372,0x5f1d36f1,0xa54ff53a,0xade682d1,0x510e527f,0x2b3e6c1f,0x9b05688c,0xfb41bd6b,0x1f83d9ab,0x137e2179,0x5be0cd19]),b6=new Uint32Array(32);function b7(a,b,c,d,e,f){let g=e[f],h=e[f+1],i=b6[2*a],j=b6[2*a+1],k=b6[2*b],l=b6[2*b+1],m=b6[2*c],n=b6[2*c+1],o=b6[2*d],p=b6[2*d+1],q=b3(i,k,g);j=b4(q,j,l,h),i=0|q,({Dh:p,Dl:o}={Dh:p^j,Dl:o^i}),({Dh:p,Dl:o}={Dh:o,Dl:p}),({h:n,l:m}=b2(n,m,p,o)),({Bh:l,Bl:k}={Bh:l^n,Bl:k^m}),({Bh:l,Bl:k}={Bh:b0(l,k,24),Bl:b1(l,k,24)}),b6[2*a]=i,b6[2*a+1]=j,b6[2*b]=k,b6[2*b+1]=l,b6[2*c]=m,b6[2*c+1]=n,b6[2*d]=o,b6[2*d+1]=p}function b8(a,b,c,d,e,f){let g=e[f],h=e[f+1],i=b6[2*a],j=b6[2*a+1],k=b6[2*b],l=b6[2*b+1],m=b6[2*c],n=b6[2*c+1],o=b6[2*d],p=b6[2*d+1],q=b3(i,k,g);j=b4(q,j,l,h),i=0|q,({Dh:p,Dl:o}={Dh:p^j,Dl:o^i}),({Dh:p,Dl:o}={Dh:b0(p,o,16),Dl:b1(p,o,16)}),({h:n,l:m}=b2(n,m,p,o)),({Bh:l,Bl:k}={Bh:l^n,Bl:k^m}),({Bh:l,Bl:k}={Bh:l<<1|k>>>31,Bl:l>>>31|k<<1}),b6[2*a]=i,b6[2*a+1]=j,b6[2*b]=k,b6[2*b+1]=l,b6[2*c]=m,b6[2*c+1]=n,b6[2*d]=o,b6[2*d+1]=p}class b9 extends bX{constructor(a,b){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,bM(a),bM(b),this.blockLen=a,this.outputLen=b,this.buffer=new Uint8Array(a),this.buffer32=bQ(this.buffer)}update(a){bO(this),bN(a=bW(a));let{blockLen:b,buffer:c,buffer32:d}=this,e=a.length,f=a.byteOffset,g=a.buffer;for(let h=0;h<e;){this.pos===b&&(bV(d),this.compress(d,0,!1),bV(d),this.pos=0);let i=Math.min(b-this.pos,e-h),j=f+h;if(i===b&&!(j%4)&&h+i<e){let a=new Uint32Array(g,j,Math.floor((e-h)/4));bV(a);for(let c=0;h+b<e;c+=d.length,h+=b)this.length+=b,this.compress(a,c,!1);bV(a);continue}c.set(a.subarray(h,h+i),this.pos),this.pos+=i,this.length+=i,h+=i}return this}digestInto(a){bO(this),bP(a,this);let{pos:b,buffer32:c}=this;this.finished=!0,bR(this.buffer.subarray(b)),bV(c),this.compress(c,0,!0),bV(c);let d=bQ(a);this.get().forEach((a,b)=>d[b]=bU(a))}digest(){let{buffer:a,outputLen:b}=this;this.digestInto(a);let c=a.slice(0,b);return this.destroy(),c}_cloneInto(a){let{buffer:b,length:c,finished:d,destroyed:e,outputLen:f,pos:g}=this;return a||(a=new this.constructor({dkLen:f})),a.set(...this.get()),a.buffer.set(b),a.destroyed=e,a.finished=d,a.length=c,a.pos=g,a.outputLen=f,a}clone(){return this._cloneInto()}}class ca extends b9{constructor(a={}){const b=void 0===a.dkLen?64:a.dkLen;super(128,b),this.v0l=0|b5[0],this.v0h=0|b5[1],this.v1l=0|b5[2],this.v1h=0|b5[3],this.v2l=0|b5[4],this.v2h=0|b5[5],this.v3l=0|b5[6],this.v3h=0|b5[7],this.v4l=0|b5[8],this.v4h=0|b5[9],this.v5l=0|b5[10],this.v5h=0|b5[11],this.v6l=0|b5[12],this.v6h=0|b5[13],this.v7l=0|b5[14],this.v7h=0|b5[15],function(a,b={},c,d,e){if(bM(64),a<0||a>64)throw Error("outputLen bigger than keyLen");let{key:f,salt:g,personalization:h}=b;if(void 0!==f&&(f.length<1||f.length>64))throw Error("key length must be undefined or 1..64");if(void 0!==g&&16!==g.length)throw Error("salt must be undefined or 16");if(void 0!==h&&16!==h.length)throw Error("personalization must be undefined or 16")}(b,a,0,0,0);let{key:c,personalization:d,salt:e}=a,f=0;if(void 0!==c&&(f=(c=bW(c)).length),this.v0l^=this.outputLen|f<<8|0x1010000,void 0!==e){const a=bQ(e=bW(e));this.v4l^=bU(a[0]),this.v4h^=bU(a[1]),this.v5l^=bU(a[2]),this.v5h^=bU(a[3])}if(void 0!==d){const a=bQ(d=bW(d));this.v6l^=bU(a[0]),this.v6h^=bU(a[1]),this.v7l^=bU(a[2]),this.v7h^=bU(a[3])}if(void 0!==c){const a=new Uint8Array(this.blockLen);a.set(c),this.update(a)}}get(){let{v0l:a,v0h:b,v1l:c,v1h:d,v2l:e,v2h:f,v3l:g,v3h:h,v4l:i,v4h:j,v5l:k,v5h:l,v6l:m,v6h:n,v7l:o,v7h:p}=this;return[a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p]}set(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){this.v0l=0|a,this.v0h=0|b,this.v1l=0|c,this.v1h=0|d,this.v2l=0|e,this.v2h=0|f,this.v3l=0|g,this.v3h=0|h,this.v4l=0|i,this.v4h=0|j,this.v5l=0|k,this.v5h=0|l,this.v6l=0|m,this.v6h=0|n,this.v7l=0|o,this.v7h=0|p}compress(a,b,c){this.get().forEach((a,b)=>b6[b]=a),b6.set(b5,16);let{h:d,l:e}=b_(BigInt(this.length));b6[24]=b5[8]^e,b6[25]=b5[9]^d,c&&(b6[28]=~b6[28],b6[29]=~b6[29]);let f=0;for(let c=0;c<12;c++)b7(0,4,8,12,a,b+2*bY[f++]),b8(0,4,8,12,a,b+2*bY[f++]),b7(1,5,9,13,a,b+2*bY[f++]),b8(1,5,9,13,a,b+2*bY[f++]),b7(2,6,10,14,a,b+2*bY[f++]),b8(2,6,10,14,a,b+2*bY[f++]),b7(3,7,11,15,a,b+2*bY[f++]),b8(3,7,11,15,a,b+2*bY[f++]),b7(0,5,10,15,a,b+2*bY[f++]),b8(0,5,10,15,a,b+2*bY[f++]),b7(1,6,11,12,a,b+2*bY[f++]),b8(1,6,11,12,a,b+2*bY[f++]),b7(2,7,8,13,a,b+2*bY[f++]),b8(2,7,8,13,a,b+2*bY[f++]),b7(3,4,9,14,a,b+2*bY[f++]),b8(3,4,9,14,a,b+2*bY[f++]);this.v0l^=b6[0]^b6[16],this.v0h^=b6[1]^b6[17],this.v1l^=b6[2]^b6[18],this.v1h^=b6[3]^b6[19],this.v2l^=b6[4]^b6[20],this.v2h^=b6[5]^b6[21],this.v3l^=b6[6]^b6[22],this.v3h^=b6[7]^b6[23],this.v4l^=b6[8]^b6[24],this.v4h^=b6[9]^b6[25],this.v5l^=b6[10]^b6[26],this.v5h^=b6[11]^b6[27],this.v6l^=b6[12]^b6[28],this.v6h^=b6[13]^b6[29],this.v7l^=b6[14]^b6[30],this.v7h^=b6[15]^b6[31],bR(b6)}destroy(){this.destroyed=!0,bR(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}let cb=(j=a=>new ca(a),(f=(a,b)=>j(b).update(bW(a)).digest()).outputLen=(g=j({})).outputLen,f.blockLen=g.blockLen,f.create=a=>j(a),f);var cc=c(4984);let cd=[];for(let a=0;a<256;a++)cd[a]=function(a,b){let c=0,d=a;for(let a=0;a<8;a++)c<<=1,c|=1&d,d>>=1;return c}(a,8);function ce(a){return((0xffff0000&a)!=0?(a&=0xffff0000,16):0)|((0xff00ff00&a)!=0?(a&=0xff00ff00,8):0)|((0xf0f0f0f0&a)!=0?(a&=0xf0f0f0f0,4):0)|((0xcccccccc&a)!=0?(a&=0xcccccccc,2):0)|(0xaaaaaaaa&a)!=0}function cf(a,b){let c=new DataView(a.buffer,a.byteOffset,a.byteLength),d="";for(let a=0;a<4;a++){a>0&&(d+="\n"),d+="		";for(let b=0;b<4;b++)b>0&&(d+=" "),d+=c.getUint32(16*a+4*b).toString(16).padStart(8,"0")}return b&&(d=b+"\n"+d),d}function cg(a,b){if(a.byteLength!=b.byteLength)return!1;for(var c=new Int8Array(a),d=new Int8Array(b),e=0;e!=a.byteLength;e++)if(c[e]!=d[e])return!1;return!0}function ch(a){let b=a.subarray(0,128),c=bQ(a.subarray(128)),d=cb.create({dkLen:64});d.buffer.set(b),d.v0l=0|c[0],d.v0h=0|c[1],d.v1l=0|c[2],d.v1h=0|c[3],d.v2l=0|c[4],d.v2h=0|c[5],d.v3l=0|c[6],d.v3h=0|c[7],d.v4l=0|c[8],d.v4h=0|c[9],d.v5l=0|c[10],d.v5h=0|c[11],d.v6l=0|c[12],d.v6h=0|c[13],d.v7l=0|c[14],d.v7h=0|c[15];let e=c[16]+0x100000000*c[17],f=c[18]+0x100000000*c[19];return d.length=e+f,d.pos=f,d}function ci(a){let b=new Uint8Array(216),c=bQ(b.subarray(128));return b.set(a.buffer),c[0]=a.v0l,c[1]=a.v0h,c[2]=a.v1l,c[3]=a.v1h,c[4]=a.v2l,c[5]=a.v2h,c[6]=a.v3l,c[7]=a.v3h,c[8]=a.v4l,c[9]=a.v4h,c[10]=a.v5l,c[11]=a.v5h,c[12]=a.v6l,c[13]=a.v6h,c[14]=a.v7l,c[15]=a.v7h,c[18]=a.pos,c[16]=a.length-a.pos,b}async function cj(a,b,c,d,e){return!(a.G1.isZero(b)||a.G1.isZero(c)||a.G2.isZero(d)||a.G2.isZero(e))&&await a.pairingEq(b,e,a.G1.neg(c),d)}function ck(a){let b=new Uint8Array(a);return ar.randomFillSync(b),b}async function cl(a){return ar.createHash("sha256").update(a).digest()}function cm(a,b){return new DataView(a.buffer).getUint32(b,!1)}async function cn(a){for(;!a;)a=await function(){{let a=cc.createInterface({input:process.stdin,output:process.stdout});return new Promise(b=>{a.question("Enter a random text. (Entropy): ",a=>b(a))})}}();let b=cb.create(64);b.update(ck(64));let c=new TextEncoder;b.update(c.encode(a));let d=b.digest(),e=[];for(let a=0;a<8;a++)e[a]=cm(d,4*a);return new aq(e)}async function co(a,b){let c,d;b<32?(c=1<<b>>>0,d=1):(c=0x100000000,d=1<<b-32>>>0);let e=a;for(let a=0;a<d;a++)for(let a=0;a<c;a++)e=await cl(e);let f=new DataView(e.buffer,e.byteOffset,e.byteLength),g=[];for(let a=0;a<8;a++)g[a]=f.getUint32(4*a,!1);return new aq(g)}function cp(a){return a instanceof Uint8Array?a:("0x"==a.slice(0,2)&&(a=a.slice(2)),new Uint8Array(a.match(/[\da-f]{2}/gi).map(function(a){return parseInt(a,16)})))}function cq(a){return Array.prototype.map.call(a,function(a){return("0"+(255&a).toString(16)).slice(-2)}).join("")}function cr(a,b){if(b instanceof Uint8Array)return a.toString(b);if(Array.isArray(b))return b.map(cr.bind(null,a));if("object"==typeof b){let c={};return Object.keys(b).forEach(d=>{c[d]=cr(a,b[d])}),c}if("bigint"==typeof b||void 0!==b.eq)return b.toString(10);return b}async function cs(a,b){await bw(a,1),await a.writeULE32(1),await bx(a);let c=await bK(b.q);await bw(a,2);let d=c.q,e=(Math.floor((l.bitLength(d)-1)/64)+1)*8,f=c.r,g=(Math.floor((l.bitLength(f)-1)/64)+1)*8;await a.writeULE32(e),await bA(a,d,e),await a.writeULE32(g),await bA(a,f,g),await a.writeULE32(b.nVars),await a.writeULE32(b.nPublic),await a.writeULE32(b.domainSize),await ct(a,c,b.vk_alpha_1),await ct(a,c,b.vk_beta_1),await cu(a,c,b.vk_beta_2),await cu(a,c,b.vk_gamma_2),await ct(a,c,b.vk_delta_1),await cu(a,c,b.vk_delta_2),await bx(a)}async function ct(a,b,c){let d=new Uint8Array(2*b.G1.F.n8);b.G1.toRprLEM(d,0,c),await a.write(d)}async function cu(a,b,c){let d=new Uint8Array(2*b.G2.F.n8);b.G2.toRprLEM(d,0,c),await a.write(d)}async function cv(a,b,c){let d=await a.read(2*b.G1.F.n8),e=b.G1.fromRprLEM(d,0);return c?b.G1.toObject(e):e}async function cw(a,b,c){let d=await a.read(2*b.G2.F.n8),e=b.G2.fromRprLEM(d,0);return c?b.G2.toObject(e):e}async function cx(a,b,c,d){await by(a,b,1);let e=await a.readULE32();if(await bz(a),1===e)return await cy(a,b,c,d);if(2===e)return await cz(a,b,c,d);if(10===e)return await cA(a,b,c,d);throw Error("Protocol not supported: ")}async function cy(a,b,c,d){let e={};e.protocol="groth16",await by(a,b,2);let f=await a.readULE32();e.n8q=f,e.q=await bB(a,f);let g=await a.readULE32();return e.n8r=g,e.r=await bB(a,g),e.curve=await bK(e.q,d),e.nVars=await a.readULE32(),e.nPublic=await a.readULE32(),e.domainSize=await a.readULE32(),e.power=ce(e.domainSize),e.vk_alpha_1=await cv(a,e.curve,c),e.vk_beta_1=await cv(a,e.curve,c),e.vk_beta_2=await cw(a,e.curve,c),e.vk_gamma_2=await cw(a,e.curve,c),e.vk_delta_1=await cv(a,e.curve,c),e.vk_delta_2=await cw(a,e.curve,c),await bz(a),e}async function cz(a,b,c,d){let e={};e.protocol="plonk",await by(a,b,2);let f=await a.readULE32();e.n8q=f,e.q=await bB(a,f);let g=await a.readULE32();return e.n8r=g,e.r=await bB(a,g),e.curve=await bK(e.q,d),e.nVars=await a.readULE32(),e.nPublic=await a.readULE32(),e.domainSize=await a.readULE32(),e.power=ce(e.domainSize),e.nAdditions=await a.readULE32(),e.nConstraints=await a.readULE32(),e.k1=await a.read(g),e.k2=await a.read(g),e.Qm=await cv(a,e.curve,c),e.Ql=await cv(a,e.curve,c),e.Qr=await cv(a,e.curve,c),e.Qo=await cv(a,e.curve,c),e.Qc=await cv(a,e.curve,c),e.S1=await cv(a,e.curve,c),e.S2=await cv(a,e.curve,c),e.S3=await cv(a,e.curve,c),e.X_2=await cw(a,e.curve,c),await bz(a),e}async function cA(a,b,c,d){let e={};e.protocol="fflonk",e.protocolId=10,await by(a,b,2);let f=await a.readULE32();e.n8q=f,e.q=await bB(a,f),e.curve=await bK(e.q,d);let g=await a.readULE32();return e.n8r=g,e.r=await bB(a,g),e.nVars=await a.readULE32(),e.nPublic=await a.readULE32(),e.domainSize=await a.readULE32(),e.power=ce(e.domainSize),e.nAdditions=await a.readULE32(),e.nConstraints=await a.readULE32(),e.k1=await a.read(g),e.k2=await a.read(g),e.w3=await a.read(g),e.w4=await a.read(g),e.w8=await a.read(g),e.wr=await a.read(g),e.X_2=await cw(a,e.curve,c),e.C0=await cv(a,e.curve,c),await bz(a),e}async function cB(a,b){let{fd:c,sections:d}=await bu(a,"zkey",1),e=await cx(c,d,b),f=new ay(e.r),g=l.mod(l.shl(1,8*e.n8r),e.r),h=f.inv(g),i=f.mul(h,h),j=await bK(e.q);await by(c,d,3),e.IC=[];for(let a=0;a<=e.nPublic;a++){let a=await cv(c,j,b);e.IC.push(a)}await bz(c),await by(c,d,4);let k=await c.readULE32();e.ccoefs=[];for(let a=0;a<k;a++){let a=await c.readULE32(),d=await c.readULE32(),f=await c.readULE32(),g=await m(b);e.ccoefs.push({matrix:a,constraint:d,signal:f,value:g})}await bz(c),await by(c,d,5),e.A=[];for(let a=0;a<e.nVars;a++){let d=await cv(c,j,b);e.A[a]=d}await bz(c),await by(c,d,6),e.B1=[];for(let a=0;a<e.nVars;a++){let d=await cv(c,j,b);e.B1[a]=d}await bz(c),await by(c,d,7),e.B2=[];for(let a=0;a<e.nVars;a++){let d=await cw(c,j,b);e.B2[a]=d}await bz(c),await by(c,d,8),e.C=[];for(let a=e.nPublic+1;a<e.nVars;a++){let d=await cv(c,j,b);e.C[a]=d}await bz(c),await by(c,d,9),e.hExps=[];for(let a=0;a<e.domainSize;a++){let a=await cv(c,j,b);e.hExps.push(a)}return await bz(c),await c.close(),e;async function m(){let a=await bB(c,e.n8r);return f.mul(a,i)}}async function cC(a,b,c){let d={delta:{}};d.deltaAfter=await cv(a,b,c),d.delta.g1_s=await cv(a,b,c),d.delta.g1_sx=await cv(a,b,c),d.delta.g2_spx=await cw(a,b,c),d.transcript=await a.read(64),d.type=await a.readULE32();let e=await a.readULE32(),f=a.pos,g=0;for(;a.pos-f<e;){let b=await a.read(1);if(b[0]<=g)throw Error("Parameters in the contribution must be sorted");if(g=b[0],1==b[0]){let b=await a.read(1),c=await a.read(b[0]);d.name=new TextDecoder().decode(c)}else if(2==b[0])d.numIterationsExp=(await a.read(1))[0];else if(3==b[0]){let b=await a.read(1);d.beaconHash=await a.read(b[0])}else throw Error("Parameter not recognized")}if(a.pos!=f+e)throw Error("Parameters do not match");return d}async function cD(a,b,c){await by(a,c,10);let d={contributions:[]};d.csHash=await a.read(64);let e=await a.readULE32();for(let c=0;c<e;c++){let c=await cC(a,b);d.contributions.push(c)}return await bz(a),d}async function cE(a,b,c){await ct(a,b,c.deltaAfter),await ct(a,b,c.delta.g1_s),await ct(a,b,c.delta.g1_sx),await cu(a,b,c.delta.g2_spx),await a.write(c.transcript),await a.writeULE32(c.type||0);let d=[];if(c.name){d.push(1);let a=new TextEncoder("utf-8").encode(c.name.substring(0,64));d.push(a.byteLength);for(let b=0;b<a.byteLength;b++)d.push(a[b])}if(1==c.type){d.push(2),d.push(c.numIterationsExp),d.push(3),d.push(c.beaconHash.byteLength);for(let a=0;a<c.beaconHash.byteLength;a++)d.push(c.beaconHash[a])}if(d.length>0){let b=new Uint8Array(d);await a.writeULE32(b.byteLength),await a.write(b)}else await a.writeULE32(0)}async function cF(a,b,c){await bw(a,10),await a.write(c.csHash),await a.writeULE32(c.contributions.length);for(let d=0;d<c.contributions.length;d++)await cE(a,b,c.contributions[d]);await bx(a)}function cG(a,b,c){let d=new Uint8Array(2*b.G1.F.n8);b.G1.toRprUncompressed(d,0,c),a.update(d)}function cH(a,b,c){var d;let e;cG(a,b,c.deltaAfter),cG(a,b,c.delta.g1_s),cG(a,b,c.delta.g1_sx),d=c.delta.g2_spx,e=new Uint8Array(2*b.G2.F.n8),b.G2.toRprUncompressed(e,0,d),a.update(e),a.update(c.transcript)}async function cI(a,b,c){await bw(a,1);let d=(Math.floor((l.bitLength(c)-1)/64)+1)*8;await a.writeULE32(d),await bA(a,c,d),await a.writeULE32(b.length),await bx(a),await bw(a,2);for(let c=0;c<b.length;c++)await bA(a,b[c],d);await bx(a,2)}async function cJ(a,b,c){await bw(a,1);let d=(Math.floor((l.bitLength(c)-1)/64)+1)*8;if(await a.writeULE32(d),await bA(a,c,d),b.byteLength%d!=0)throw Error("Invalid witness length");await a.writeULE32(b.byteLength/d),await bx(a),await bw(a,2),await a.write(b),await bx(a)}async function cK(a,b){await by(a,b,1);let c=await a.readULE32(),d=await bB(a,c),e=await a.readULE32();return await bz(a),{n8:c,q:d,nWitness:e}}async function cL(a){let{fd:b,sections:c}=await bu(a,"wtns",2),{n8:d,nWitness:e}=await cK(b,c);await by(b,c,2);let f=[];for(let a=0;a<e;a++){let a=await bB(b,d);f.push(a)}return await bz(b),await b.close(),f}let{stringifyBigInts:cM}=m;async function cN(a,b,c,d){let{fd:e,sections:f}=await bu(b,"wtns",2,0x2000000,8388608),g=await cK(e,f),{fd:h,sections:i}=await bu(a,"zkey",2,0x2000000,8388608),j=await cx(h,i,void 0,d);if("groth16"!=j.protocol)throw Error("zkey file is not groth16");if(!l.eq(j.r,g.q))throw Error("Curve of the witness does not match the curve of the proving key");if(g.nWitness!=j.nVars)throw Error(`Invalid witness length. Circuit: ${j.nVars}, witness: ${g.nWitness}`);let k=j.curve,m=k.Fr,n=k.G1,o=k.G2,p=ce(j.domainSize);c&&c.debug("Reading Wtns");let q=await bD(e,f,2);c&&c.debug("Reading Coeffs");let r=await bD(h,i,4);c&&c.debug("Building ABC");let[s,t,u]=await cO(k,j,q,r,c),v=p==m.s?k.Fr.shift:k.Fr.w[p+1],w=await m.ifft(s,"","",c,"IFFT_A"),x=await m.batchApplyKey(w,m.e(1),v),y=await m.fft(x,"","",c,"FFT_A"),z=await m.ifft(t,"","",c,"IFFT_B"),A=await m.batchApplyKey(z,m.e(1),v),B=await m.fft(A,"","",c,"FFT_B"),C=await m.ifft(u,"","",c,"IFFT_C"),D=await m.batchApplyKey(C,m.e(1),v),E=await m.fft(D,"","",c,"FFT_C");c&&c.debug("Join ABC");let F=await cP(k,j,y,B,E,c),G={};c&&c.debug("Reading A Points");let H=await bD(h,i,5);G.pi_a=await k.G1.multiExpAffine(H,q,c,"multiexp A"),c&&c.debug("Reading B1 Points");let I=await bD(h,i,6),J=await k.G1.multiExpAffine(I,q,c,"multiexp B1");c&&c.debug("Reading B2 Points");let K=await bD(h,i,7);G.pi_b=await k.G2.multiExpAffine(K,q,c,"multiexp B2"),c&&c.debug("Reading C Points");let L=await bD(h,i,8);G.pi_c=await k.G1.multiExpAffine(L,q.slice((j.nPublic+1)*k.Fr.n8),c,"multiexp C"),c&&c.debug("Reading H Points");let M=await bD(h,i,9),N=await k.G1.multiExpAffine(M,F,c,"multiexp H"),O=k.Fr.random(),P=k.Fr.random();G.pi_a=n.add(G.pi_a,j.vk_alpha_1),G.pi_a=n.add(G.pi_a,n.timesFr(j.vk_delta_1,O)),G.pi_b=o.add(G.pi_b,j.vk_beta_2),G.pi_b=o.add(G.pi_b,o.timesFr(j.vk_delta_2,P)),J=n.add(J,j.vk_beta_1),J=n.add(J,n.timesFr(j.vk_delta_1,P)),G.pi_c=n.add(G.pi_c,N),G.pi_c=n.add(G.pi_c,n.timesFr(G.pi_a,P)),G.pi_c=n.add(G.pi_c,n.timesFr(J,O)),G.pi_c=n.add(G.pi_c,n.timesFr(j.vk_delta_1,m.neg(m.mul(O,P))));let Q=[];for(let a=1;a<=j.nPublic;a++){let b=q.slice(a*m.n8,a*m.n8+m.n8);Q.push(l.fromRprLE(b))}return G.pi_a=n.toObject(n.toAffine(G.pi_a)),G.pi_b=o.toObject(o.toAffine(G.pi_b)),G.pi_c=n.toObject(n.toAffine(G.pi_c)),G.protocol="groth16",G.curve=k.name,await h.close(),await e.close(),{proof:G=cM(G),publicSignals:Q=cM(Q)}}async function cO(a,b,c,d,e){let f=a.Fr.n8,g=12+b.n8r,h=(d.byteLength-4)/g,i=new aK(b.domainSize*f),j=new aK(b.domainSize*f),k=new aK(b.domainSize*f),l=[i,j];for(let b=0;b<h;b++){e&&b%1e6==0&&e.debug(`QAP AB: ${b}/${h}`);let i=d.slice(4+b*g,4+b*g+g),j=new DataView(i.buffer),k=j.getUint32(0,!0),m=j.getUint32(4,!0),n=j.getUint32(8,!0),o=i.slice(12,12+f);l[k].set(a.Fr.add(l[k].slice(m*f,m*f+f),a.Fr.mul(o,c.slice(n*f,n*f+f))),m*f)}for(let c=0;c<b.domainSize;c++)e&&c%1e6==0&&e.debug(`QAP C: ${c}/${b.domainSize}`),k.set(a.Fr.mul(i.slice(c*f,c*f+f),j.slice(c*f,c*f+f)),c*f);return[i,j,k]}async function cP(a,b,c,d,e,f){let g,h=a.Fr.n8,i=Math.floor(c.byteLength/a.Fr.n8),j=[];for(let b=0;b<i;b+=4194304){f&&f.debug(`JoinABC: ${b}/${i}`);let g=Math.min(i-b,4194304),k=[],l=c.slice(b*h,(b+g)*h),m=d.slice(b*h,(b+g)*h),n=e.slice(b*h,(b+g)*h);k.push({cmd:"ALLOCSET",var:0,buff:l}),k.push({cmd:"ALLOCSET",var:1,buff:m}),k.push({cmd:"ALLOCSET",var:2,buff:n}),k.push({cmd:"ALLOC",var:3,len:g*h}),k.push({cmd:"CALL",fnName:"qap_joinABC",params:[{var:0},{var:1},{var:2},{val:g},{var:3}]}),k.push({cmd:"CALL",fnName:"frm_batchFromMontgomery",params:[{var:3},{val:g},{var:3}]}),k.push({cmd:"GET",out:0,var:3,len:g*h}),j.push(a.tm.queueAction(k))}let k=await Promise.all(j);g=c instanceof aK?new aK(c.byteLength):new Uint8Array(c.byteLength);let l=0;for(let a=0;a<k.length;a++)g.set(k[a][0],l),l+=k[a][0].byteLength;return g}function cQ(a){let b=[];return function a(b,c){if(Array.isArray(c))for(let d=0;d<c.length;d++)a(b,c[d]);else b.push(c)}(b,a),b}function cR(a){let b=BigInt(2)**BigInt(64),c=BigInt("0xCBF29CE484222325");for(let d=0;d<a.length;d++)c^=BigInt(a[d].charCodeAt(0)),c*=BigInt(0x100000001b3),c%=b;let d=c.toString(16),e=16-d.length;return"0".repeat(e).concat(d)}async function cS(a,b){let c,d,e;b=b||{};let f=1,g=0,h=0,i=!1;if(a instanceof WebAssembly.Instance)c=a,i=!0;else{let i=32767;if(b.memorySize&&(i=parseInt(b.memorySize))<0)throw Error("Invalid memory size");let j=!1;for(;!j;)try{e=new WebAssembly.Memory({initial:i}),j=!0}catch(a){if(i<=1)throw a;console.warn("Could not allocate "+1024*i*64+" bytes. This may cause severe instability. Trying with "+1024*i*64/2+" bytes"),i=Math.floor(i/2)}let n=await WebAssembly.compile(a),o="",p="";c=await WebAssembly.instantiate(n,{env:{memory:e},runtime:{printDebug:function(a){console.log("printDebug:",a)},exceptionHandler:function(a){let b;throw b=1===a?"Signal not found. ":2===a?"Too many signals set. ":3===a?"Signal already set. ":4===a?"Assert Failed. ":5===a?"Not enough memory. ":6===a?"Input signal array access exceeds the size. ":"Unknown error. ",console.error("ERROR: ",a,o),Error(b+o)},printErrorMessage:function(){o+=k()+"\n"},writeBufferMessage:function(){let a=k();"\n"===a?(console.log(p),p=""):(""!==p&&(p+=" "),p+=a)},showSharedRWMemory:function(){let a=c.exports.getFieldNumLen32(),b=new Uint32Array(a);for(let d=0;d<a;d++)b[a-1-d]=c.exports.readSharedRWMemory(d);if(f>=2&&(g>=1||h>=7)){""!==p&&(p+=" ");let a=l.fromArray(b,0x100000000).toString();p+=a}else console.log(l.fromArray(b,0x100000000))},error:function(a,c,e,f,g,h){let i;throw i=7===a?m(c)+" "+d.getFr(f).toString()+" != "+d.getFr(g).toString()+" "+m(h):9===a?m(c)+" "+d.getFr(f).toString()+" "+m(g):5===a&&b.sym?m(c)+" "+b.sym.labelIdx2Name[g]:m(c)+" "+e+" "+f+" "+g+" "+h,console.log("ERROR: ",a,i),Error(i)},log:function(a){console.log(d.getFr(a).toString())},logGetSignal:function(a,c){b.logGetSignal&&b.logGetSignal(a,d.getFr(c))},logSetSignal:function(a,c){b.logSetSignal&&b.logSetSignal(a,d.getFr(c))},logStartComponent:function(a){b.logStartComponent&&b.logStartComponent(a)},logFinishComponent:function(a){b.logFinishComponent&&b.logFinishComponent(a)}}})}"function"==typeof c.exports.getVersion&&(f=c.exports.getVersion()),"function"==typeof c.exports.getMinorVersion&&(g=c.exports.getMinorVersion()),"function"==typeof c.exports.getPatchVersion&&(h=c.exports.getPatchVersion());let j=b&&(b.sanityCheck||b.logGetSignal||b.logSetSignal||b.logStartComponent||b.logFinishComponent);if(2===f)d=new cU(c,j);else if(1===f){if(i)throw Error("Loading code from WebAssembly instance is not supported for circom version 1");d=new cT(e,c,j)}else throw Error(`Unsupported circom version: ${f}`);return d;function k(){let a="",b=c.exports.getMessageChar();for(;0!==b;)a+=String.fromCharCode(b),b=c.exports.getMessageChar();return a}function m(a){let b=new Uint8Array(e.buffer),c=[];for(let d=0;b[a+d]>0;d++)c.push(b[a+d]);return String.fromCharCode.apply(null,c)}}class cT{constructor(a,b,c){this.memory=a,this.i32=new Uint32Array(a.buffer),this.instance=b,this.n32=(this.instance.exports.getFrLen()>>2)-2;const d=this.instance.exports.getPRawPrime(),e=Array(this.n32);for(let a=0;a<this.n32;a++)e[this.n32-1-a]=this.i32[(d>>2)+a];this.prime=l.fromArray(e,0x100000000),this.Fr=new ay(this.prime),this.mask32=l.fromString("FFFFFFFF",16),this.NVars=this.instance.exports.getNVars(),this.n64=Math.floor((this.Fr.bitLength-1)/64)+1,this.R=this.Fr.e(l.shiftLeft(1,64*this.n64)),this.RInv=this.Fr.inv(this.R),this.sanityCheck=c}circom_version(){return 1}async _doCalculateWitness(a,b){this.instance.exports.init(this.sanityCheck||b?1:0);let c=this.allocInt(),d=this.allocFr();Object.keys(a).forEach(b=>{let e=cR(b),f=parseInt(e.slice(0,8),16),g=parseInt(e.slice(8,16),16);try{this.instance.exports.getSignalOffset32(c,0,f,g)}catch(a){throw Error(`Signal ${b} is not an input of the circuit.`)}let h=this.getInt(c),i=cQ(a[b]);for(let a=0;a<i.length;a++)this.setFr(d,i[a]),this.instance.exports.setSignal(0,0,h+a,d)})}async calculateWitness(a,b){let c=this.i32[0],d=[];await this._doCalculateWitness(a,b);for(let a=0;a<this.NVars;a++){let b=this.instance.exports.getPWitness(a);d.push(this.getFr(b))}return this.i32[0]=c,d}async calculateBinWitness(a,b){let c=this.i32[0];await this._doCalculateWitness(a,b);let d=this.instance.exports.getWitnessBuffer();return this.i32[0]=c,new Uint8Array(this.memory.buffer.slice(d,d+this.NVars*this.n64*8))}allocInt(){let a=this.i32[0];return this.i32[0]=a+8,a}allocFr(){let a=this.i32[0];return this.i32[0]=a+4*this.n32+8,a}getInt(a){return this.i32[a>>2]}setInt(a,b){this.i32[a>>2]=b}getFr(a){let b=this,c=a>>2;if(0x80000000&b.i32[c+1]){var d;let a=Array(b.n32);for(let d=0;d<b.n32;d++)a[b.n32-1-d]=b.i32[c+2+d];let e=b.Fr.e(l.fromArray(a,0x100000000));return 0x40000000&b.i32[c+1]?(d=e,b.Fr.mul(b.RInv,d)):e}return 0x80000000&b.i32[c]?b.Fr.e(b.i32[c]-0x100000000):b.Fr.e(b.i32[c])}setFr(a,b){b=this.Fr.e(b);let c=this.Fr.neg(this.Fr.e("80000000",16)),d=this.Fr.e("7FFFFFFF",16);if(this.Fr.geq(b,c)&&this.Fr.leq(b,d)){let d;d=this.Fr.geq(b,this.Fr.zero)?l.toNumber(b):0x100000000+(d=l.toNumber(this.Fr.sub(b,c))-0x80000000),this.i32[a>>2]=d,this.i32[(a>>2)+1]=0;return}this.i32[a>>2]=0,this.i32[(a>>2)+1]=0x80000000;let e=l.toArray(b,0x100000000);for(let b=0;b<this.n32;b++){let c=e.length-1-b;c>=0?this.i32[(a>>2)+2+b]=e[c]:this.i32[(a>>2)+2+b]=0}}}class cU{constructor(a,b){this.instance=a,this.version=this.instance.exports.getVersion(),this.n32=this.instance.exports.getFieldNumLen32(),this.instance.exports.getRawPrime();const c=new Uint32Array(this.n32);for(let a=0;a<this.n32;a++)c[this.n32-1-a]=this.instance.exports.readSharedRWMemory(a);this.prime=l.fromArray(c,0x100000000),this.witnessSize=this.instance.exports.getWitnessSize(),this.sanityCheck=b}circom_version(){return this.instance.exports.getVersion()}async _doCalculateWitness(a,b){this.instance.exports.init(this.sanityCheck||b?1:0);let c=Object.keys(a),d=0;if(c.forEach(b=>{let c=cR(b),e=parseInt(c.slice(0,8),16),f=parseInt(c.slice(8,16),16),g=cQ(a[b]);if("function"==typeof this.instance.exports.getInputSignalSize){let a=this.instance.exports.getInputSignalSize(e,f);if(a<0)throw Error(`Signal ${b} not found
`);if(g.length<a)throw Error(`Not enough values for input signal ${b}
`);if(g.length>a)throw Error(`Too many values for input signal ${b}
`)}for(let a=0;a<g.length;a++){let b=function(a,b){let c=[],d=BigInt(a),e=BigInt(0x100000000);for(;d;)c.unshift(Number(d%e)),d/=e;if(b){let a=b-c.length;for(;a>0;)c.unshift(0),a--}return c}(function(a,b){let c=BigInt(a)%b;return c<0&&(c+=b),c}(g[a],this.prime),this.n32);for(let a=0;a<this.n32;a++)this.instance.exports.writeSharedRWMemory(a,b[this.n32-1-a]);try{this.instance.exports.setInputSignal(e,f,a),d++}catch(a){throw Error(a)}}}),d<this.instance.exports.getInputSize())throw Error(`Not all inputs have been set. Only ${d} out of ${this.instance.exports.getInputSize()}`)}async calculateWitness(a,b){let c=[];await this._doCalculateWitness(a,b);for(let a=0;a<this.witnessSize;a++){this.instance.exports.getWitness(a);let b=new Uint32Array(this.n32);for(let a=0;a<this.n32;a++)b[this.n32-1-a]=this.instance.exports.readSharedRWMemory(a);c.push(l.fromArray(b,0x100000000))}return c}async calculateWTNSBin(a,b){let c=new Uint32Array(this.witnessSize*this.n32+this.n32+11),d=new Uint8Array(c.buffer);await this._doCalculateWitness(a,b),d[0]=119,d[1]=116,d[2]=110,d[3]=115,c[1]=2,c[2]=2,c[3]=1;let e=4*this.n32,f=(8+e).toString(16);c[4]=parseInt(f.slice(0,8),16),c[5]=parseInt(f.slice(8,16),16),c[6]=e,this.instance.exports.getRawPrime();let g=7;for(let a=0;a<this.n32;a++)c[g+a]=this.instance.exports.readSharedRWMemory(a);c[g+=this.n32]=this.witnessSize,c[++g]=2,g++;let h=(e*this.witnessSize).toString(16);c[g]=parseInt(h.slice(0,8),16),c[g+1]=parseInt(h.slice(8,16),16),g+=2;for(let a=0;a<this.witnessSize;a++){this.instance.exports.getWitness(a);for(let a=0;a<this.n32;a++)c[g+a]=this.instance.exports.readSharedRWMemory(a);g+=this.n32}return d}}let{unstringifyBigInts:cV}=m;async function cW(a,b,c,d){let e=cV(a),f=await bt(b),g=await f.read(f.totalSize);await f.close();let h=await cS(g,d);if(1===h.circom_version()){let a=await h.calculateBinWitness(e),b=await bv(c,"wtns",2,2);await cJ(b,a,h.prime),await b.close()}else{let a=await bs(c),b=await h.calculateWTNSBin(e);await a.write(b),await a.close()}}let{unstringifyBigInts:cX}=m;async function cY(a,b,c,d,e,f){let g=cX(a),h={type:"mem"};return await cW(g,b,h,e),await cN(c,h,d,f)}let{unstringifyBigInts:cZ}=m;async function c$(a,b,c,d){var e,f;let g,h,i=cZ(a),j=cZ(c),k=cZ(b),m=await bL(i.curve),n=m.G1.fromObject(i.IC[0]),o=new Uint8Array(2*m.G1.F.n8*k.length),p=new Uint8Array(m.Fr.n8*k.length);if(!function(a,b){for(let d=0;d<b.length;d++){var c;if(c=b[d],!(l.geq(c,0)&&l.lt(c,a.r)))return!1}return!0}(m,k))return d&&d.error("Public inputs are not valid."),!1;for(let a=0;a<k.length;a++){let b=m.G1.fromObject(i.IC[a+1]);o.set(b,a*m.G1.F.n8*2),l.toRprLE(p,m.Fr.n8*a,k[a],m.Fr.n8)}let q=await m.G1.multiExpAffine(o,p);q=m.G1.add(q,n);let r=m.G1.fromObject(j.pi_a),s=m.G2.fromObject(j.pi_b),t=m.G1.fromObject(j.pi_c);if(e=m,f={pi_a:r,pi_b:s,pi_c:t},g=e.G1,h=e.G2,!(g.isValid(f.pi_a)&&h.isValid(f.pi_b)&&g.isValid(f.pi_c)))return d&&d.error("Proof commitments are not valid."),!1;let u=m.G2.fromObject(i.vk_gamma_2),v=m.G2.fromObject(i.vk_delta_2),w=m.G1.fromObject(i.vk_alpha_1),x=m.G2.fromObject(i.vk_beta_2);return await m.pairingEq(m.G1.neg(r),s,q,u,t,v,w,x)?(d&&d.info("OK!"),!0):(d&&d.error("Invalid proof"),!1)}let{unstringifyBigInts:c_}=m;function c0(a){let b=a.toString(16);for(;b.length<64;)b="0"+b;return`"0x${b}"`}async function c1(a,b){let c=c_(a),d=c_(b),e="";for(let a=0;a<d.length;a++)""!=e&&(e+=","),e+=c0(d[a]);return`[${c0(c.pi_a[0])}, ${c0(c.pi_a[1])}],[[${c0(c.pi_b[0][1])}, ${c0(c.pi_b[0][0])}],[${c0(c.pi_b[1][1])}, ${c0(c.pi_b[1][0])}]],[${c0(c.pi_c[0])}, ${c0(c.pi_c[1])}],[${e}]`}function c2(a,b){let c=new DataView(b.buffer,b.byteOffset,b.byteLength),d=[];for(let a=0;a<8;a++)d[a]=c.getUint32(4*a);let e=new aq(d);return a.G2.fromRng(e)}function c3(a,b,c,d,e){let f=cb.create({dkLen:64}),g=new Uint8Array([b]);f.update(g),f.update(c);let h=a.G1.toUncompressed(d);f.update(h);let i=a.G1.toUncompressed(e);return f.update(i),c2(a,f.digest())}function c4(a,b,c,d,e){return a.g1_s=b.G1.toAffine(b.G1.fromRng(e)),a.g1_sx=b.G1.toAffine(b.G1.timesFr(a.g1_s,a.prvKey)),a.g2_sp=b.G2.toAffine(c3(b,c,d,a.g1_s,a.g1_sx)),a.g2_spx=b.G2.toAffine(b.G2.timesFr(a.g2_sp,a.prvKey)),a}function c5(a,b,c){let d={tau:{},alpha:{},beta:{}};return d.tau.prvKey=a.Fr.fromRng(c),d.alpha.prvKey=a.Fr.fromRng(c),d.beta.prvKey=a.Fr.fromRng(c),c4(d.tau,a,0,b,c),c4(d.alpha,a,1,b,c),c4(d.beta,a,2,b,c),d}async function c6(a,b,c,d){d||(d=c),await a.writeULE32(1);let e=a.pos;await a.writeULE64(0),await a.writeULE32(8*b.F1.n64);let f=new Uint8Array(b.F1.n8);l.toRprLE(f,0,b.q,b.F1.n8),await a.write(f),await a.writeULE32(c),await a.writeULE32(d);let g=a.pos-e-8,h=a.pos;await a.writeULE64(g,e),a.pos=h}async function c7(a,b){if(!b[1])throw Error(a.fileName+": File has no  header");if(b[1].length>1)throw Error(a.fileName+": File has more than one header");a.pos=b[1][0].p;let c=await a.readULE32(),d=await a.read(c),e=l.fromRprLE(d),f=await bK(e);if(8*f.F1.n64!=c)throw Error(a.fileName+": Invalid size");let g=await a.readULE32(),h=await a.readULE32();if(a.pos-b[1][0].p!=b[1][0].size)throw Error("Invalid PTau header size");return{curve:f,power:g,ceremonyPower:h}}async function c8(a,b,c){return c9(await a.read(2*b.F1.n8*6+2*b.F2.n8*3),0,b,c)}function c9(a,b,c,d){let e={tau:{},alpha:{},beta:{}};return e.tau.g1_s=f(),e.tau.g1_sx=f(),e.alpha.g1_s=f(),e.alpha.g1_sx=f(),e.beta.g1_s=f(),e.beta.g1_sx=f(),e.tau.g2_spx=g(),e.alpha.g2_spx=g(),e.beta.g2_spx=g(),e;function f(){let e;return e=d?c.G1.fromRprLEM(a,b):c.G1.fromRprUncompressed(a,b),b+=2*c.G1.F.n8,e}function g(){let e;return e=d?c.G2.fromRprLEM(a,b):c.G2.fromRprUncompressed(a,b),b+=2*c.G2.F.n8,e}}function da(a,b,c,d,e){async function f(d){e?c.G1.toRprLEM(a,b,d):c.G1.toRprUncompressed(a,b,d),b+=2*c.F1.n8}async function g(d){e?c.G2.toRprLEM(a,b,d):c.G2.toRprUncompressed(a,b,d),b+=2*c.F2.n8}return f(d.tau.g1_s),f(d.tau.g1_sx),f(d.alpha.g1_s),f(d.alpha.g1_sx),f(d.beta.g1_s),f(d.beta.g1_sx),g(d.tau.g2_spx),g(d.alpha.g2_spx),g(d.beta.g2_spx),a}async function db(a,b,c,d){let e=new Uint8Array(2*b.F1.n8*6+2*b.F2.n8*3);da(e,0,b,c,d),await a.write(e)}async function dc(a,b){let c={};c.tauG1=await i(),c.tauG2=await j(),c.alphaG1=await i(),c.betaG1=await i(),c.betaG2=await j(),c.key=await c8(a,b,!0),c.partialHash=await a.read(216),c.nextChallenge=await a.read(64),c.type=await a.readULE32();let d=new Uint8Array(2*b.G1.F.n8*6+2*b.G2.F.n8*3);da(d,0,b,c.key,!1);let e=ch(c.partialHash);e.update(d),c.responseHash=e.digest();let f=await a.readULE32(),g=a.pos,h=0;for(;a.pos-g<f;){let a=await k(1);if(a[0]<=h)throw Error("Parameters in the contribution must be sorted");if(h=a[0],1==a[0]){let a=await k(1),b=await k(a[0]);c.name=new TextDecoder().decode(b)}else if(2==a[0])c.numIterationsExp=(await k(1))[0];else if(3==a[0]){let a=await k(1);c.beaconHash=await k(a[0])}else throw Error("Parameter not recognized")}if(a.pos!=g+f)throw Error("Parameters do not match");return c;async function i(){let c=await a.read(2*b.G1.F.n8);return b.G1.fromRprLEM(c)}async function j(){let c=await a.read(2*b.G2.F.n8);return b.G2.fromRprLEM(c)}async function k(b){return new Uint8Array(await a.read(b))}}async function dd(a,b,c){if(!c[7])throw Error(a.fileName+": File has no  contributions");if(c[7][0].length>1)throw Error(a.fileName+": File has more than one contributions section");a.pos=c[7][0].p;let d=await a.readULE32(),e=[];for(let c=0;c<d;c++){let d=await dc(a,b);d.id=c+1,e.push(d)}if(a.pos-c[7][0].p!=c[7][0].size)throw Error("Invalid contribution section size");return e}async function de(a,b,c){let d=new Uint8Array(2*b.F1.n8),e=new Uint8Array(2*b.F2.n8);await g(c.tauG1),await h(c.tauG2),await g(c.alphaG1),await g(c.betaG1),await h(c.betaG2),await db(a,b,c.key,!0),await a.write(c.partialHash),await a.write(c.nextChallenge),await a.writeULE32(c.type||0);let f=[];if(c.name){f.push(1);let a=new TextEncoder("utf-8").encode(c.name.substring(0,64));f.push(a.byteLength);for(let b=0;b<a.byteLength;b++)f.push(a[b])}if(1==c.type){f.push(2),f.push(c.numIterationsExp),f.push(3),f.push(c.beaconHash.byteLength);for(let a=0;a<c.beaconHash.byteLength;a++)f.push(c.beaconHash[a])}if(f.length>0){let b=new Uint8Array(f);await a.writeULE32(b.byteLength),await a.write(b)}else await a.writeULE32(0);async function g(c){b.G1.toRprLEM(d,0,c),await a.write(d)}async function h(c){b.G2.toRprLEM(e,0,c),await a.write(e)}}async function df(a,b,c){await a.writeULE32(7);let d=a.pos;await a.writeULE64(0),await a.writeULE32(c.length);for(let d=0;d<c.length;d++)await de(a,b,c[d]);let e=a.pos-d-8,f=a.pos;await a.writeULE64(e,d),a.pos=f}function dg(a,b,c){let d;c&&c.debug("Calculating First Challenge Hash");let e=cb.create({dkLen:64}),f=new Uint8Array(2*a.G1.F.n8),g=new Uint8Array(2*a.G2.F.n8);return a.G1.toRprUncompressed(f,0,a.G1.g),a.G2.toRprUncompressed(g,0,a.G2.g),e.update(cb.create({dkLen:64}).digest()),d=2**b*2-1,c&&c.debug("Calculate Initial Hash: tauG1"),h(f,d),d=2**b,c&&c.debug("Calculate Initial Hash: tauG2"),h(g,d),c&&c.debug("Calculate Initial Hash: alphaTauG1"),h(f,d),c&&c.debug("Calculate Initial Hash: betaTauG1"),h(f,d),e.update(g),e.digest();function h(a,b){let d=Math.floor(b/341e3),f=b%341e3,g=new Uint8Array(341e3*a.byteLength);for(let b=0;b<341e3;b++)g.set(a,b*a.byteLength);for(let a=0;a<d;a++)e.update(g),c&&c.debug("Initial hash: "+341e3*a);for(let b=0;b<f;b++)e.update(a)}}async function dh(a,b,c,d){return c5(a,b,await co(c,d))}async function di(a,b,c,d){let e=await bv(c,"ptau",1,7);await c6(e,a,b,0);let f=a.G1.oneAffine,g=a.G2.oneAffine;await bw(e,2);let h=2**b*2-1;for(let a=0;a<h;a++)await e.write(f),d&&a%1e5==0&&a&&d.log("tauG1: "+a);await bx(e),await bw(e,3);let i=2**b;for(let a=0;a<i;a++)await e.write(g),d&&a%1e5==0&&a&&d.log("tauG2: "+a);await bx(e),await bw(e,4);let j=2**b;for(let a=0;a<j;a++)await e.write(f),d&&a%1e5==0&&a&&d.log("alphaTauG1: "+a);await bx(e),await bw(e,5);let k=2**b;for(let a=0;a<k;a++)await e.write(f),d&&a%1e5==0&&a&&d.log("betaTauG1: "+a);await bx(e),await bw(e,6),await e.write(g),await bx(e),await bw(e,7),await e.writeULE32(0),await bx(e),await e.close();let l=dg(a,b,d);return d&&d.debug(cf(cb.create({dkLen:64}).digest(),"Blank Contribution Hash:")),d&&d.info(cf(l,"First Contribution Hash:")),l}async function dj(a,b,c){let d,e,{fd:f,sections:g}=await bu(a,"ptau",1),{curve:h,power:i}=await c7(f,g),j=await dd(f,h,g);0==j.length?(d=cb.create({dkLen:64}).digest(),e=dg(h,i)):(d=j[j.length-1].responseHash,e=j[j.length-1].nextChallenge),c&&c.info(cf(d,"Last Response Hash: ")),c&&c.info(cf(e,"New Challenge Hash: "));let k=await bs(b),l=cb.create({dkLen:64});await k.write(d),l.update(d),await n(2,"G1",2**i*2-1,"tauG1"),await n(3,"G2",2**i,"tauG2"),await n(4,"G1",2**i,"alphaTauG1"),await n(5,"G1",2**i,"betaTauG1"),await n(6,"G2",1,"betaG2"),await f.close(),await k.close();let m=l.digest();if(!cg(e,m))throw c&&c.info(cf(m,"Calc Curret Challenge Hash: ")),c&&c.error("PTau file is corrupted. Calculated new challenge hash does not match with the eclared one"),Error("PTau file is corrupted. Calculated new challenge hash does not match with the eclared one");return e;async function n(a,b,d,e){let i=h[b],j=2*i.F.n8,m=Math.floor(0x1000000/j);await by(f,g,a);for(let a=0;a<d;a+=m){let b;c&&c.debug(`Exporting ${e}: ${a}/${d}`);let g=Math.min(d-a,m);b=await f.read(g*j),b=await i.batchLEMtoU(b),await k.write(b),l.update(b)}await bz(f)}}async function dk(a,b,c,d,e,f){let g,h=new Uint8Array(64);for(let a=0;a<64;a++)h[a]=255;let{fd:i,sections:j}=await bu(a,"ptau",1),{curve:k,power:l}=await c7(i,j),m=await dd(i,k,j),n={};d&&(n.name=d);let o=2*k.F1.n8,p=k.F1.n8,q=2*k.F2.n8,r=k.F2.n8,s=await bt(b);if(s.totalSize!=64+(2**l*2-1)*p+2**l*r+2**l*p+2**l*p+r+6*o+3*q)throw Error("Size of the contribution is invalid");g=m.length>0?m[m.length-1].nextChallenge:dg(k,l,f);let t=await bv(c,"ptau",1,e?7:2);await c6(t,k,l);let u=await s.read(64);if(cg(h,g)&&(g=u,m[m.length-1].nextChallenge=g),!cg(u,g))throw Error("Wrong contribution. This contribution is not based on the previous hash");let v=cb.create({dkLen:64});v.update(u);let w=[];n.tauG1=(await z(s,t,"G1",2,2**l*2-1,[1],"tauG1"))[0],n.tauG2=(await z(s,t,"G2",3,2**l,[1],"tauG2"))[0],n.alphaG1=(await z(s,t,"G1",4,2**l,[0],"alphaG1"))[0],n.betaG1=(await z(s,t,"G1",5,2**l,[0],"betaG1"))[0],n.betaG2=(await z(s,t,"G2",6,1,[0],"betaG2"))[0],n.partialHash=ci(v);let x=await s.read(2*k.F1.n8*6+2*k.F2.n8*3);n.key=c9(x,0,k,!1),v.update(new Uint8Array(x));let y=v.digest();if(f&&f.info(cf(y,"Contribution Response Hash imported: ")),e){let a=cb.create({dkLen:64});a.update(y),await C(a,t,"G1",2,2**l*2-1,"tauG1",f),await C(a,t,"G2",3,2**l,"tauG2",f),await C(a,t,"G1",4,2**l,"alphaTauG1",f),await C(a,t,"G1",5,2**l,"betaTauG1",f),await C(a,t,"G2",6,1,"betaG2",f),n.nextChallenge=a.digest(),f&&f.info(cf(n.nextChallenge,"Next Challenge Hash: "))}else n.nextChallenge=h;return m.push(n),await df(t,k,m),await s.close(),await t.close(),await i.close(),n.nextChallenge;async function z(a,b,c,d,f,g,h){return e?await A(a,b,c,d,f,g,h):await B(a,b,c,d,f,g,h)}async function A(a,b,c,d,e,g,h){let i=k[c],j=i.F.n8,l=2*i.F.n8,m=[];await bw(b,d);let n=Math.floor(0x1000000/l);w[d]=b.pos;for(let c=0;c<e;c+=n){f&&f.debug(`Importing ${h}: ${c}/${e}`);let d=Math.min(e-c,n),k=await a.read(d*j);v.update(k);let o=await i.batchCtoLEM(k);await b.write(o);for(let a=0;a<g.length;a++){let b=g[a];if(b>=c&&b<c+d){let a=i.fromRprLEM(o,(b-c)*l);m.push(a)}}}return await bx(b),m}async function B(a,b,c,d,e,g,h){let i=k[c],j=i.F.n8,l=[],m=Math.floor(0x1000000/j);for(let b=0;b<e;b+=m){f&&f.debug(`Importing ${h}: ${b}/${e}`);let c=Math.min(e-b,m),d=await a.read(c*j);v.update(d);for(let a=0;a<g.length;a++){let e=g[a];if(e>=b&&e<b+c){let a=i.fromRprCompressed(d,(e-b)*j);l.push(a)}}}return l}async function C(a,b,c,d,e,f,g){let h=k[c],i=2*h.F.n8,j=Math.floor(0x1000000/i),l=b.pos;b.pos=w[d];for(let c=0;c<e;c+=j){g&&g.debug(`Hashing ${f}: ${c}/${e}`);let d=Math.min(e-c,j),k=await b.read(d*i),l=await h.batchLEMtoU(k);a.update(l)}b.pos=l}}async function dl(a,b,c,d){if(1==b.type){let e=await dh(a,c.nextChallenge,b.beaconHash,b.numIterationsExp);if(!a.G1.eq(b.key.tau.g1_s,e.tau.g1_s))return d&&d.error(`BEACON key (tauG1_s) is not generated correctly in challenge #${b.id}  ${b.name||""}`),!1;if(!a.G1.eq(b.key.tau.g1_sx,e.tau.g1_sx))return d&&d.error(`BEACON key (tauG1_sx) is not generated correctly in challenge #${b.id}  ${b.name||""}`),!1;if(!a.G2.eq(b.key.tau.g2_spx,e.tau.g2_spx))return d&&d.error(`BEACON key (tauG2_spx) is not generated correctly in challenge #${b.id}  ${b.name||""}`),!1;if(!a.G1.eq(b.key.alpha.g1_s,e.alpha.g1_s))return d&&d.error(`BEACON key (alphaG1_s) is not generated correctly in challenge #${b.id}  ${b.name||""}`),!1;if(!a.G1.eq(b.key.alpha.g1_sx,e.alpha.g1_sx))return d&&d.error(`BEACON key (alphaG1_sx) is not generated correctly in challenge #${b.id}  ${b.name||""}`),!1;if(!a.G2.eq(b.key.alpha.g2_spx,e.alpha.g2_spx))return d&&d.error(`BEACON key (alphaG2_spx) is not generated correctly in challenge #${b.id}  ${b.name||""}`),!1;if(!a.G1.eq(b.key.beta.g1_s,e.beta.g1_s))return d&&d.error(`BEACON key (betaG1_s) is not generated correctly in challenge #${b.id}  ${b.name||""}`),!1;if(!a.G1.eq(b.key.beta.g1_sx,e.beta.g1_sx))return d&&d.error(`BEACON key (betaG1_sx) is not generated correctly in challenge #${b.id}  ${b.name||""}`),!1;if(!a.G2.eq(b.key.beta.g2_spx,e.beta.g2_spx))return d&&d.error(`BEACON key (betaG2_spx) is not generated correctly in challenge #${b.id}  ${b.name||""}`),!1}return(b.key.tau.g2_sp=a.G2.toAffine(c3(a,0,c.nextChallenge,b.key.tau.g1_s,b.key.tau.g1_sx)),b.key.alpha.g2_sp=a.G2.toAffine(c3(a,1,c.nextChallenge,b.key.alpha.g1_s,b.key.alpha.g1_sx)),b.key.beta.g2_sp=a.G2.toAffine(c3(a,2,c.nextChallenge,b.key.beta.g1_s,b.key.beta.g1_sx)),!0!==await cj(a,b.key.tau.g1_s,b.key.tau.g1_sx,b.key.tau.g2_sp,b.key.tau.g2_spx))?(d&&d.error("INVALID key (tau) in challenge #"+b.id),!1):!0!==await cj(a,b.key.alpha.g1_s,b.key.alpha.g1_sx,b.key.alpha.g2_sp,b.key.alpha.g2_spx)?(d&&d.error("INVALID key (alpha) in challenge #"+b.id),!1):!0!==await cj(a,b.key.beta.g1_s,b.key.beta.g1_sx,b.key.beta.g2_sp,b.key.beta.g2_spx)?(d&&d.error("INVALID key (beta) in challenge #"+b.id),!1):!0!==await cj(a,c.tauG1,b.tauG1,b.key.tau.g2_sp,b.key.tau.g2_spx)?(d&&d.error("INVALID tau*G1. challenge #"+b.id+" It does not follow the previous contribution"),!1):!0!==await cj(a,b.key.tau.g1_s,b.key.tau.g1_sx,c.tauG2,b.tauG2)?(d&&d.error("INVALID tau*G2. challenge #"+b.id+" It does not follow the previous contribution"),!1):!0!==await cj(a,c.alphaG1,b.alphaG1,b.key.alpha.g2_sp,b.key.alpha.g2_spx)?(d&&d.error("INVALID alpha*G1. challenge #"+b.id+" It does not follow the previous contribution"),!1):!0!==await cj(a,c.betaG1,b.betaG1,b.key.beta.g2_sp,b.key.beta.g2_spx)?(d&&d.error("INVALID beta*G1. challenge #"+b.id+" It does not follow the previous contribution"),!1):!0!==await cj(a,b.key.beta.g1_s,b.key.beta.g1_sx,c.betaG2,b.betaG2)?(d&&d.error("INVALID beta*G2. challenge #"+b.id+"It does not follow the previous contribution"),!1):(d&&d.info("Powers Of tau file OK!"),!0)}async function dm(a,b){let c,{fd:d,sections:e}=await bu(a,"ptau",1),{curve:f,power:g,ceremonyPower:h}=await c7(d,e),i=await dd(d,f,e);b&&b.debug("power: 2**"+g),b&&b.debug("Computing initial contribution hash");let j={tauG1:f.G1.g,tauG2:f.G2.g,alphaG1:f.G1.g,betaG1:f.G1.g,betaG2:f.G2.g,nextChallenge:dg(f,h,b),responseHash:cb.create({dkLen:64}).digest()};if(0==i.length)return b&&b.error("This file has no contribution! It cannot be used in production"),!1;c=i.length>1?i[i.length-2]:j;let k=i[i.length-1];if(b&&b.debug("Validating contribution #"+i[i.length-1].id),!await dl(f,k,c,b))return!1;let l=cb.create({dkLen:64});l.update(k.responseHash),b&&b.debug("Verifying powers in tau*G1 section");let m=await u(2,"G1","tauG1",2**g*2-1,[0,1],b);if(!0!==await cj(f,m.R1,m.R2,f.G2.g,k.tauG2))return b&&b.error("tauG1 section. Powers do not match"),!1;if(!f.G1.eq(f.G1.g,m.singularPoints[0]))return b&&b.error("First element of tau*G1 section must be the generator"),!1;if(!f.G1.eq(k.tauG1,m.singularPoints[1]))return b&&b.error("Second element of tau*G1 section does not match the one in the contribution section"),!1;b&&b.debug("Verifying powers in tau*G2 section");let n=await u(3,"G2","tauG2",2**g,[0,1],b);if(!0!==await cj(f,f.G1.g,k.tauG1,n.R1,n.R2))return b&&b.error("tauG2 section. Powers do not match"),!1;if(!f.G2.eq(f.G2.g,n.singularPoints[0]))return b&&b.error("First element of tau*G2 section must be the generator"),!1;if(!f.G2.eq(k.tauG2,n.singularPoints[1]))return b&&b.error("Second element of tau*G2 section does not match the one in the contribution section"),!1;b&&b.debug("Verifying powers in alpha*tau*G1 section");let o=await u(4,"G1","alphatauG1",2**g,[0],b);if(!0!==await cj(f,o.R1,o.R2,f.G2.g,k.tauG2))return b&&b.error("alphaTauG1 section. Powers do not match"),!1;if(!f.G1.eq(k.alphaG1,o.singularPoints[0]))return b&&b.error("First element of alpha*tau*G1 section (alpha*G1) does not match the one in the contribution section"),!1;b&&b.debug("Verifying powers in beta*tau*G1 section");let p=await u(5,"G1","betatauG1",2**g,[0],b);if(!0!==await cj(f,p.R1,p.R2,f.G2.g,k.tauG2))return b&&b.error("betaTauG1 section. Powers do not match"),!1;if(!f.G1.eq(k.betaG1,p.singularPoints[0]))return b&&b.error("First element of beta*tau*G1 section (beta*G1) does not match the one in the contribution section"),!1;let q=await t(b);if(!f.G2.eq(k.betaG2,q))return b&&b.error("betaG2 element in betaG2 section does not match the one in the contribution section"),!1;let r=l.digest();if(g==h&&!cg(r,k.nextChallenge))return b&&b.error("Hash of the values does not match the next challenge of the last contributor in the contributions section"),!1;b&&b.info(cf(r,"Next challenge hash: ")),s(k,c);for(let a=i.length-2;a>=0;a--){let c=i[a],d=a>0?i[a-1]:j;if(!await dl(f,c,d,b))return!1;s(c,d,b)}if(b&&b.info("-----------------------------------------------------"),e[12]&&e[13]&&e[14]&&e[15]){if(!await v("G1",2,12,"tauG1",b)||!await v("G2",3,13,"tauG2",b)||!await v("G1",4,14,"alphaTauG1",b)||!await v("G1",5,15,"betaTauG1",b))return!1}else b&&b.warn('this file does not contain phase2 precalculated values. Please run: \n   snarkjs "powersoftau preparephase2" to prepare this file to be used in the phase2 ceremony.');return await d.close(),b&&b.info("Powers of Tau Ok!"),!0;function s(a,c){if(!b)return;b.info("-----------------------------------------------------"),b.info(`Contribution #${a.id}: ${a.name||""}`),b.info(cf(a.nextChallenge,"Next Challenge: "));let d=new Uint8Array(2*f.G1.F.n8*6+2*f.G2.F.n8*3);da(d,0,f,a.key,!1);let e=ch(a.partialHash);e.update(d);let g=e.digest();b.info(cf(g,"Response Hash:")),b.info(cf(c.nextChallenge,"Response Hash:")),1==a.type&&(b.info(`Beacon generator: ${cq(a.beaconHash)}`),b.info(`Beacon iterations Exp: ${a.numIterationsExp}`))}async function t(a){let b=f.G2,c=2*b.F.n8,g=new Uint8Array(c);if(!e[6])throw a.error("File has no BetaG2 section"),Error("File has no BetaG2 section");if(e[6].length>1)throw a.error("File has no BetaG2 section"),Error("File has more than one GetaG2 section");d.pos=e[6][0].p;let h=await d.read(c),i=b.fromRprLEM(h);return b.toRprUncompressed(g,0,i),l.update(g),i}async function u(a,b,c,g,h,i){let j=f[b],k=2*j.F.n8;await by(d,e,a);let m=[],n=j.zero,o=j.zero,p=j.zero;for(let a=0;a<g;a+=65536){i&&i.debug(`points relations: ${c}: ${a}/${g} `);let b=Math.min(g-a,65536),e=await d.read(b*k),f=await j.batchLEMtoU(e);l.update(f);let q=ck(4*(b-1));if(a>0){let a=j.fromRprLEM(e,0),b=cm(ck(4),0);n=j.add(n,j.timesScalar(p,b)),o=j.add(o,j.timesScalar(a,b))}let r=await j.multiExpAffine(e.slice(0,(b-1)*k),q),s=await j.multiExpAffine(e.slice(k),q);n=j.add(n,r),o=j.add(o,s),p=j.fromRprLEM(e,(b-1)*k);for(let c=0;c<h.length;c++){let d=h[c];if(d>=a&&d<a+b){let b=j.fromRprLEM(e,(d-a)*k);m.push(b)}}}return await bz(d),{R1:n,R2:o,singularPoints:m}}async function v(a,b,c,h,i){i&&i.debug(`Verifying phase2 calculated values ${h}...`);let j=f[a],k=2*j.F.n8,l=Array(8);for(let a=0;a<8;a++)l[a]=cm(ck(4),0);for(let a=0;a<=g;a++)if(!await m(a))return!1;if(2==b&&!await m(g+1))return!1;return!0;async function m(a){let m;i&&i.debug(`Power ${a}...`);let n=f.Fr.n8,o=2**a,p=new Uint32Array(o),q=new aq(l);i&&i.debug(`Creating random numbers Powers${a}...`);for(let b=0;b<o;b++)a==g+1&&b==o-1?p[b]=0:p[b]=q.nextU32();p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength),i&&i.debug(`reading points Powers${a}...`),await by(d,e,b),m=new aK(o*k),a==g+1?(await d.readToBuffer(m,0,(o-1)*k),m.set(f.G1.zeroAffine,(o-1)*k)):await d.readToBuffer(m,0,o*k),await bz(d,!0);let r=await j.multiExpAffine(m,p,i,h+"_"+a);p=new aK(o*n),q=new aq(l);let s=new Uint8Array(4),t=new DataView(s.buffer);i&&i.debug(`Creating random numbers Powers${a}...`);for(let b=0;b<o;b++)(b!=o-1||a!=g+1)&&(t.setUint32(0,q.nextU32(),!0),p.set(s,b*n));i&&i.debug(`batchToMontgomery ${a}...`),p=await f.Fr.batchToMontgomery(p),i&&i.debug(`fft ${a}...`),p=await f.Fr.fft(p),i&&i.debug(`batchFromMontgomery ${a}...`),p=await f.Fr.batchFromMontgomery(p),i&&i.debug(`reading points Lagrange${a}...`),await by(d,e,c),d.pos+=k*(2**a-1),await d.readToBuffer(m,0,o*k),await bz(d,!0);let u=await j.multiExpAffine(m,p,i,h+"_"+a+"_transformed");return!!j.eq(r,u)||(i&&i.error("Phase2 caclutation does not match with powers of tau"),!1)}}}async function dn(a,b,c,d,e,f,g,h,i,j){let k=e[f],l=2*k.F.n8,m=b[d][0].size/l;await by(a,b,d),await bw(c,d);let n=g;for(let b=0;b<m;b+=65536){let d;j&&j.debug(`Applying key: ${i}: ${b}/${m}`);let f=Math.min(m-b,65536);d=await a.read(f*l),d=await k.batchApplyKey(d,n,h),await c.write(d),n=e.Fr.mul(n,e.Fr.exp(h,f))}await bx(c),await bz(a)}async function dp(a,b,c,d,e,f,g,h,i,j,k){let l=d[e],m=2*l.F.n8,n=Math.floor(1048576/m),o=g;for(let e=0;e<f;e+=n){let g;k&&k.debug(`Applying key ${j}: ${e}/${f}`);let p=Math.min(f-e,n),q=await a.read(p*m),r=await l.batchUtoLEM(q),s=await l.batchApplyKey(r,o,h);g="COMPRESSED"==i?await l.batchLEMtoC(s):await l.batchLEMtoU(s),c&&c.update(g),await b.write(g),o=d.Fr.mul(o,d.Fr.exp(h,p))}}async function dq(a,b,c,d,e){let f=await bt(b),g=8*a.F1.n64*2,h=8*a.F2.n64*2,i=(f.totalSize+g-64-h)/(4*g+h),j=i,k=0;for(;j>1;)j/=2,k+=1;if(2**k!=i)throw Error("Invalid file size");e&&e.debug("Power to tau size: "+k);let l=await cn(d),m=await bs(c),n=cb.create({dkLen:64});for(let a=0;a<f.totalSize;a+=f.pageSize){e&&e.debug(`Hashing challenge ${a}/${f.totalSize}`);let b=Math.min(f.totalSize-a,f.pageSize),c=await f.read(b);n.update(c)}let o=await f.read(64,0);e&&e.info(cf(o,"Claimed Previous Response Hash: "));let p=n.digest();e&&e.info(cf(p,"Current Challenge Hash: "));let q=c5(a,p,l);e&&["tau","alpha","beta"].forEach(b=>{e.debug(b+".g1_s: "+a.G1.toString(q[b].g1_s,16)),e.debug(b+".g1_sx: "+a.G1.toString(q[b].g1_sx,16)),e.debug(b+".g2_sp: "+a.G2.toString(q[b].g2_sp,16)),e.debug(b+".g2_spx: "+a.G2.toString(q[b].g2_spx,16)),e.debug("")});let r=cb.create({dkLen:64});await m.write(p),r.update(p),await dp(f,m,r,a,"G1",2**k*2-1,a.Fr.one,q.tau.prvKey,"COMPRESSED","tauG1",e),await dp(f,m,r,a,"G2",2**k,a.Fr.one,q.tau.prvKey,"COMPRESSED","tauG2",e),await dp(f,m,r,a,"G1",2**k,q.alpha.prvKey,q.tau.prvKey,"COMPRESSED","alphaTauG1",e),await dp(f,m,r,a,"G1",2**k,q.beta.prvKey,q.tau.prvKey,"COMPRESSED","betaTauG1",e),await dp(f,m,r,a,"G2",1,q.beta.prvKey,q.tau.prvKey,"COMPRESSED","betaTauG2",e);let s=new Uint8Array(2*a.F1.n8*6+2*a.F2.n8*3);da(s,0,a,q,!1),await m.write(s),r.update(s);let t=r.digest();e&&e.info(cf(t,"Contribution Response Hash: ")),await m.close(),await f.close()}async function dr(a,b,c,d,e,f){let g,h,i=cp(d);if(0==i.byteLength||2*i.byteLength!=d.length)return f&&f.error("Invalid Beacon Hash. (It must be a valid hexadecimal sequence)"),!1;if(i.length>=256)return f&&f.error("Maximum length of beacon hash is 255 bytes"),!1;if((e=parseInt(e))<10||e>63)return f&&f.error("Invalid numIterationsExp. (Must be between 10 and 63)"),!1;let{fd:j,sections:k}=await bu(a,"ptau",1),{curve:l,power:m,ceremonyPower:n}=await c7(j,k);if(m!=n)return f&&f.error("This file has been reduced. You cannot contribute into a reduced file."),!1;k[12]&&f&&f.warn("Contributing into a file that has phase2 calculated. You will have to prepare phase2 again.");let o=await dd(j,l,k),p={name:c,type:1,numIterationsExp:e,beaconHash:i};g=o.length>0?o[o.length-1].nextChallenge:dg(l,m,f),p.key=await dh(l,g,i,e);let q=cb.create({dkLen:64});q.update(g);let r=await bv(b,"ptau",1,7);await c6(r,l,m);let s=[];h=await w(2,"G1",2**m*2-1,l.Fr.e(1),p.key.tau.prvKey,"tauG1",f),p.tauG1=h[1],h=await w(3,"G2",2**m,l.Fr.e(1),p.key.tau.prvKey,"tauG2",f),p.tauG2=h[1],h=await w(4,"G1",2**m,p.key.alpha.prvKey,p.key.tau.prvKey,"alphaTauG1",f),p.alphaG1=h[0],h=await w(5,"G1",2**m,p.key.beta.prvKey,p.key.tau.prvKey,"betaTauG1",f),p.betaG1=h[0],h=await w(6,"G2",1,p.key.beta.prvKey,p.key.tau.prvKey,"betaTauG2",f),p.betaG2=h[0],p.partialHash=ci(q);let t=new Uint8Array(2*l.F1.n8*6+2*l.F2.n8*3);da(t,0,l,p.key,!1),q.update(new Uint8Array(t));let u=q.digest();f&&f.info(cf(u,"Contribution Response Hash imported: "));let v=cb.create({dkLen:64});return v.update(u),await x(r,"G1",2,2**m*2-1,"tauG1",f),await x(r,"G2",3,2**m,"tauG2",f),await x(r,"G1",4,2**m,"alphaTauG1",f),await x(r,"G1",5,2**m,"betaTauG1",f),await x(r,"G2",6,1,"betaG2",f),p.nextChallenge=v.digest(),f&&f.info(cf(p.nextChallenge,"Next Challenge Hash: ")),o.push(p),await df(r,l,o),await j.close(),await r.close(),u;async function w(a,b,c,d,e,f,g){let h=[];j.pos=k[a][0].p,await bw(r,a),s[a]=r.pos;let i=l[b],m=2*i.F.n8,n=Math.floor(1048576/m),o=d;for(let a=0;a<c;a+=n){g&&g.debug(`applying key${f}: ${a}/${c}`);let b=Math.min(c-a,n),d=await j.read(b*m),k=await i.batchApplyKey(d,o,e),p=r.write(k),s=await i.batchLEMtoC(k);if(q.update(s),await p,0==a)for(let a=0;a<Math.min(2,c);a++)h.push(i.fromRprLEM(k,a*m));o=l.Fr.mul(o,l.Fr.exp(e,b))}return await bx(r),h}async function x(a,b,c,d,e,f){let g=l[b],h=2*g.F.n8,i=Math.floor(0x1000000/h),j=a.pos;a.pos=s[c];for(let b=0;b<d;b+=i){f&&f.debug(`Hashing ${e}: ${b}/${d}`);let c=Math.min(d-b,i),j=await a.read(c*h),k=await g.batchLEMtoU(j);v.update(k)}a.pos=j}}async function ds(a,b,c,d,e){let f,g,{fd:h,sections:i}=await bu(a,"ptau",1),{curve:j,power:k,ceremonyPower:l}=await c7(h,i);if(k!=l)throw e&&e.error("This file has been reduced. You cannot contribute into a reduced file."),Error("This file has been reduced. You cannot contribute into a reduced file.");i[12]&&e&&e.warn("WARNING: Contributing into a file that has phase2 calculated. You will have to prepare phase2 again.");let m=await dd(h,j,i),n={name:c,type:0},o=await cn(d);f=m.length>0?m[m.length-1].nextChallenge:dg(j,k,e),n.key=c5(j,f,o);let p=cb.create({dkLen:64});p.update(f);let q=await bv(b,"ptau",1,7);await c6(q,j,k);let r=[];g=await v(2,"G1",2**k*2-1,j.Fr.e(1),n.key.tau.prvKey,"tauG1"),n.tauG1=g[1],g=await v(3,"G2",2**k,j.Fr.e(1),n.key.tau.prvKey,"tauG2"),n.tauG2=g[1],g=await v(4,"G1",2**k,n.key.alpha.prvKey,n.key.tau.prvKey,"alphaTauG1"),n.alphaG1=g[0],g=await v(5,"G1",2**k,n.key.beta.prvKey,n.key.tau.prvKey,"betaTauG1"),n.betaG1=g[0],g=await v(6,"G2",1,n.key.beta.prvKey,n.key.tau.prvKey,"betaTauG2"),n.betaG2=g[0],n.partialHash=ci(p);let s=new Uint8Array(2*j.F1.n8*6+2*j.F2.n8*3);da(s,0,j,n.key,!1),p.update(new Uint8Array(s));let t=p.digest();e&&e.info(cf(t,"Contribution Response Hash imported: "));let u=cb.create({dkLen:64});return u.update(t),await w(q,"G1",2,2**k*2-1,"tauG1"),await w(q,"G2",3,2**k,"tauG2"),await w(q,"G1",4,2**k,"alphaTauG1"),await w(q,"G1",5,2**k,"betaTauG1"),await w(q,"G2",6,1,"betaG2"),n.nextChallenge=u.digest(),e&&e.info(cf(n.nextChallenge,"Next Challenge Hash: ")),m.push(n),await df(q,j,m),await h.close(),await q.close(),t;async function v(a,b,c,d,f,g){let k=[];h.pos=i[a][0].p,await bw(q,a),r[a]=q.pos;let l=j[b],m=2*l.F.n8,n=Math.floor(1048576/m),o=d;for(let a=0;a<c;a+=n){e&&e.debug(`processing: ${g}: ${a}/${c}`);let b=Math.min(c-a,n),d=await h.read(b*m),i=await l.batchApplyKey(d,o,f),r=q.write(i),s=await l.batchLEMtoC(i);if(p.update(s),await r,0==a)for(let a=0;a<Math.min(2,c);a++)k.push(l.fromRprLEM(i,a*m));o=j.Fr.mul(o,j.Fr.exp(f,b))}return await bx(q),k}async function w(a,b,c,d,f){let g=j[b],h=2*g.F.n8,i=Math.floor(0x1000000/h),k=a.pos;a.pos=r[c];for(let b=0;b<d;b+=i){e&&b&&e.debug(`Hashing ${f}: `+b);let c=Math.min(d-b,i),j=await a.read(c*h),k=await g.batchLEMtoU(j);u.update(k)}a.pos=k}}async function dt(a,b,c){let{fd:d,sections:e}=await bu(a,"ptau",1),{curve:f,power:g}=await c7(d,e),h=await bv(b,"ptau",1,11);async function i(a,b,i,j){c&&c.debug("Starting section: "+j),await bw(h,b);for(let a=0;a<=g;a++)await k(a);async function k(b){let k,l=2**b,m=f[i];f.Fr;let n=2*m.F.n8;m.F.n8,k=new aK(l*n),await by(d,e,a),2==a&&b==g+1?(await d.readToBuffer(k,0,(l-1)*n),k.set(f.G1.zeroAffine,(l-1)*n)):await d.readToBuffer(k,0,l*n),await bz(d,!0),k=await m.lagrangeEvaluations(k,"affine","affine",c,j),await h.write(k)}2==a&&await k(g+1),await bx(h)}await c6(h,f,g),await bC(d,e,h,2),await bC(d,e,h,3),await bC(d,e,h,4),await bC(d,e,h,5),await bC(d,e,h,6),await bC(d,e,h,7),await i(2,12,"G1","tauG1"),await i(3,13,"G2","tauG2"),await i(4,14,"G1","alphaTauG1"),await i(5,15,"G1","betaTauG1"),await d.close(),await h.close()}async function du(a,b,c){let{fd:d,sections:e}=await bu(a,"ptau",1),{curve:f,power:g,ceremonyPower:h}=await c7(d,e),i=2*f.G1.F.n8,j=2*f.G2.F.n8;for(let a=1;a<g;a++)await k(a);return await d.close(),!0;async function k(a){let g=a.toString();for(;g.length<2;)g="0"+g;c&&c.debug("Writing Power: "+g);let k=await bv(b+g+".ptau","ptau",1,11);await c6(k,f,a,h),await bC(d,e,k,2,(2**a*2-1)*i),await bC(d,e,k,3,2**a*j),await bC(d,e,k,4,2**a*i),await bC(d,e,k,5,2**a*i),await bC(d,e,k,6,j),await bC(d,e,k,7),await bC(d,e,k,12,(2**(a+1)*2-1)*i),await bC(d,e,k,13,(2**a*2-1)*j),await bC(d,e,k,14,(2**a*2-1)*i),await bC(d,e,k,15,(2**a*2-1)*i),await k.close()}}async function dv(a,b,c){let{fd:d,sections:e}=await bu(a,"ptau",1),{curve:f,power:g}=await c7(d,e),h=await bv(b,"ptau",1,11);async function i(a,b,i,j){c&&c.debug("Starting section: "+j),await bw(h,b);let k=e[b][0].size,l=d.pageSize;await by(d,e,b);for(let a=0;a<k;a+=l){let b=Math.min(k-a,l),c=await d.read(b);await h.write(c)}async function m(b){let k,l=2**b,m=f[i],n=2*m.F.n8;k=new aK(l*n),await by(d,e,a),2==a&&b==g+1?(await d.readToBuffer(k,0,(l-1)*n),k.set(f.G1.zeroAffine,(l-1)*n)):await d.readToBuffer(k,0,l*n),await bz(d,!0),k=await m.lagrangeEvaluations(k,"affine","affine",c,j),await h.write(k)}await bz(d),2==a&&await m(g+1),await bx(h)}await c6(h,f,g),await bC(d,e,h,2),await bC(d,e,h,3),await bC(d,e,h,4),await bC(d,e,h,5),await bC(d,e,h,6),await bC(d,e,h,7),await i(2,12,"G1","tauG1"),await bC(d,e,h,13),await bC(d,e,h,14),await bC(d,e,h,15),await d.close(),await h.close()}async function dw(a,b){let{fd:c,sections:d}=await bu(a,"ptau",1),{curve:e,power:f}=await c7(c,d),g={};return g.q=e.q,g.power=f,g.contributions=await dd(c,e,d),g.tauG1=await h(2,"G1",2**f*2-1,"tauG1"),g.tauG2=await h(3,"G2",2**f,"tauG2"),g.alphaTauG1=await h(4,"G1",2**f,"alphaTauG1"),g.betaTauG1=await h(5,"G1",2**f,"betaTauG1"),g.betaG2=await h(6,"G2",1,"betaG2"),g.lTauG1=await i(12,"G1","lTauG1"),g.lTauG2=await i(13,"G2","lTauG2"),g.lAlphaTauG1=await i(14,"G1","lAlphaTauG2"),g.lBetaTauG1=await i(15,"G1","lBetaTauG2"),await c.close(),cr(e.Fr,g);async function h(a,f,g,h){let i=e[f],j=2*i.F.n8,k=[];await by(c,d,a);for(let a=0;a<g;a++){b&&a&&a%1e4==0&&console.log(`${h}: `+a);let d=await c.read(j);k.push(i.fromRprLEM(d,0))}return await bz(c),k}async function i(a,g,h){let i=e[g],j=2*i.F.n8,k=[];await by(c,d,a);for(let a=0;a<=f;a++){b&&console.log(`${h}: Power: ${a}`),k[a]=[];let d=2**a;for(let e=0;e<d;e++){b&&e&&e%1e4==0&&console.log(`${h}: ${e}/${d}`);let f=await c.read(j);k[a].push(i.fromRprLEM(f,0))}}return await bz(c,!0),k}}function dx(a,b,c){for(let d=0;d<a.constraints.length;d++)!function(d){let e=c=>{let d="";return Object.keys(c).forEach(e=>{let f=b.varIdx2Name[e];"one"==f&&(f="1");let g=a.curve.Fr.toString(c[e]);"1"==g&&(g=""),"-1"==g&&(g="-"),""!=d&&"-"!=g[0]&&(g="+"+g),""!=d&&(g=" "+g),d=d+g+f}),d},f=`[ ${e(d[0])} ] * [ ${e(d[1])} ] - [ ${e(d[2])} ] = 0`;c&&c.info(f)}(a.constraints[d])}let dy=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function dz(a,b){if(!b||10==b)return BigInt(a);if(16==b)if("0x"==a.slice(0,2))return BigInt(a);else return BigInt("0x"+a)}function dA(a){let b=a.toString(16);return(b.length-1)*4+dy[parseInt(b[0],16)]}function dB(a,b){return BigInt(a)<<BigInt(b)}function dC(a,b){return BigInt(a)>>BigInt(b)}function dD(a){return(BigInt(a)&BigInt(1))==BigInt(1)}function dE(a,b){return BigInt(a)+BigInt(b)}function dF(a,b){return BigInt(a)-BigInt(b)}function dG(a,b){return BigInt(a)**BigInt(b)}function dH(a,b){return BigInt(a)/BigInt(b)}function dI(a,b){return BigInt(a)%BigInt(b)}function dJ(a,b){return BigInt(a)==BigInt(b)}function dK(a,b){return BigInt(a)>BigInt(b)}function dL(a,b){return BigInt(a)&BigInt(b)}function dM(a,b,c,d){let e="0000000"+c.toString(16),f=new Uint32Array(a.buffer,a.byteOffset+b,d/4),g=((e.length-7)*4-1>>5)+1;for(let a=0;a<g;a++)f[a]=parseInt(e.substring(e.length-8*a-8,e.length-8*a),16);for(let a=g;a<f.length;a++)f[a]=0;for(let b=4*f.length;b<d;b++)a[b]=function(a){if(a>BigInt(Number.MAX_SAFE_INTEGER))throw Error("Number too big");return Number(a)}(dL(dC(c,8*b),255))}function dN(a,b,c){c=c||a.byteLength,b=b||0;let d=new Uint32Array(a.buffer,a.byteOffset+b,c/4),e=Array(c/4);return d.forEach((a,b)=>e[e.length-b-1]=a.toString(16).padStart(8,"0")),dz(e.join(""),16)}function dO(a){let b=new Uint8Array(Math.floor((dA(a)-1)/8)+1);return dM(b,0,a,b.byteLength),b}let dP=dz(0),dQ=dz(1),dR=[];for(let a=0;a<256;a++)dR[a]=function(a,b){let c=0,d=a;for(let a=0;a<8;a++)c<<=1,c|=1&d,d>>=1;return c}(a,8);function dS(a,b,c){if(!c)return a.one;let d=function(a){let b=BigInt(a),c=[];for(;b;)b&BigInt(1)?c.push(1):c.push(0),b>>=BigInt(1);return c}(c);if(0==d.length)return a.one;let e=b;for(let c=d.length-2;c>=0;c--)e=a.square(e),d[c]&&(e=a.mul(e,b));return e}function dT(a,b,c,d,e){a[b]=a[b]+a[c]>>>0,a[e]=(a[e]^a[b])>>>0,a[e]=(a[e]<<16|a[e]>>>16&65535)>>>0,a[d]=a[d]+a[e]>>>0,a[c]=(a[c]^a[d])>>>0,a[c]=(a[c]<<12|a[c]>>>20&4095)>>>0,a[b]=a[b]+a[c]>>>0,a[e]=(a[e]^a[b])>>>0,a[e]=(a[e]<<8|a[e]>>>24&255)>>>0,a[d]=a[d]+a[e]>>>0,a[c]=(a[c]^a[d])>>>0,a[c]=(a[c]<<7|a[c]>>>25&127)>>>0}class dU{constructor(a){a=a||[0,0,0,0,0,0,0,0],this.state=[0x61707865,0x3320646e,0x79622d32,0x6b206574,a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],0,0,0,0],this.idx=16,this.buff=Array(16)}nextU32(){return 16==this.idx&&this.update(),this.buff[this.idx++]}nextU64(){return dE(BigInt(this.nextU32())*BigInt(0x100000000),this.nextU32())}nextBool(){return(1&this.nextU32())==1}update(){for(let a=0;a<16;a++)this.buff[a]=this.state[a];for(let b=0;b<10;b++){var a;dT(a=this.buff,0,4,8,12),dT(a,1,5,9,13),dT(a,2,6,10,14),dT(a,3,7,11,15),dT(a,0,5,10,15),dT(a,1,6,11,12),dT(a,2,7,8,13),dT(a,3,4,9,14)}for(let a=0;a<16;a++)this.buff[a]=this.buff[a]+this.state[a]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,0!=this.state[12]||(this.state[13]=this.state[13]+1>>>0,0!=this.state[13]||(this.state[14]=this.state[14]+1>>>0,0==this.state[14]&&(this.state[15]=this.state[15]+1>>>0)))}}function dV(a){let b=new Uint8Array(a);return ar.randomFillSync(b),b}let dW=null;function dX(){return dW||(dW=new dU(function(){let a=new Uint32Array(dV(32).buffer),b=[];for(let c=0;c<8;c++)b.push(a[c]);return b}()))}class dY{constructor(a,b,c){this.F=b,this.G=a,this.opMulGF=c;let d=b.sqrt_t||b.t,e=b.sqrt_s||b.s,f=b.one;for(;b.eq(b.pow(f,b.half),b.one);)f=b.add(f,b.one);this.w=Array(e+1),this.wi=Array(e+1),this.w[e]=this.F.pow(f,d),this.wi[e]=this.F.inv(this.w[e]);let g=e-1;for(;g>=0;)this.w[g]=this.F.square(this.w[g+1]),this.wi[g]=this.F.square(this.wi[g+1]),g--;this.roots=[],this._setRoots(Math.min(e,15))}_setRoots(a){for(let b=a;b>=0&&!this.roots[b];b--){let a=this.F.one,c=1<<b,d=Array(c);for(let e=0;e<c;e++)d[e]=a,a=this.F.mul(a,this.w[b]);this.roots[b]=d}}fft(a){if(a.length<=1)return a;let b=dZ(a.length-1)+1;this._setRoots(b);let c=1<<b;if(a.length!=c)throw Error("Size must be multiple of 2");return d$(this,a,b,0,1)}ifft(a){if(a.length<=1)return a;let b=dZ(a.length-1)+1;this._setRoots(b);let c=1<<b;if(a.length!=c)throw Error("Size must be multiple of 2");let d=d$(this,a,b,0,1),e=this.F.inv(this.F.mulScalar(this.F.one,c)),f=Array(c);for(let a=0;a<c;a++)f[a]=this.opMulGF(d[(c-a)%c],e);return f}}function dZ(a){return((0xffff0000&a)!=0?(a&=0xffff0000,16):0)|((0xff00ff00&a)!=0?(a&=0xff00ff00,8):0)|((0xf0f0f0f0&a)!=0?(a&=0xf0f0f0f0,4):0)|((0xcccccccc&a)!=0?(a&=0xcccccccc,2):0)|(0xaaaaaaaa&a)!=0}function d$(a,b,c,d,e){let f=1<<c;if(1==f)return[b[d]];if(2==f)return[a.G.add(b[d],b[d+e]),a.G.sub(b[d],b[d+e])];let g=f>>1,h=d$(a,b,c-1,d,2*e),i=d$(a,b,c-1,d+e,2*e),j=Array(f);for(let b=0;b<g;b++)j[b]=a.G.add(h[b],a.opMulGF(i[b],a.roots[c][b])),j[b+g]=a.G.sub(h[b],a.opMulGF(i[b],a.roots[c][b]));return j}class d_{constructor(a){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(a),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=dA(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=this.e(this.one<<BigInt(64*this.n64)),this.Ri=this.inv(this.R);const b=this.negone>>this.one;this.nqr=this.two;let c=this.pow(this.nqr,b);for(;!this.eq(c,this.negone);)this.nqr=this.nqr+this.one,c=this.pow(this.nqr,b);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),function(a){if(a.m%2==1)if(dJ(dI(a.p,4),1))if(dJ(dI(a.p,8),1))if(dJ(dI(a.p,16),1)){var b,c,d=a;for(d.sqrt_q=dG(d.p,d.m),d.sqrt_s=0,d.sqrt_t=dF(d.sqrt_q,1);!dD(d.sqrt_t);)d.sqrt_s=d.sqrt_s+1,d.sqrt_t=dH(d.sqrt_t,2);let e=d.one;for(;d.eq(e,d.one);){let a=d.random();d.sqrt_z=d.pow(a,d.sqrt_t),e=d.pow(d.sqrt_z,2**(d.sqrt_s-1))}d.sqrt_tm1d2=dH(dF(d.sqrt_t,1),2),d.sqrt=function(a){if(this.isZero(a))return this.zero;let b=this.pow(a,this.sqrt_tm1d2),c=this.pow(this.mul(this.square(b),a),2**(this.sqrt_s-1));if(this.eq(c,this.negone))return null;let d=this.sqrt_s,e=this.mul(a,b),f=this.mul(e,b),g=this.sqrt_z;for(;!this.eq(f,this.one);){let a=this.square(f),c=1;for(;!this.eq(a,this.one);)a=this.square(a),c++;b=g;for(let a=0;a<d-c-1;a++)b=this.square(b);g=this.square(b),f=this.mul(f,g),e=this.mul(e,b),d=c}return this.geq(e,this.zero)?e:this.neg(e)}}else if(dJ(dI(a.p,16),9))a.sqrt=function(){throw Error("Sqrt alg 4 not implemented")};else throw Error("Field withot sqrt");else if(dJ(dI(a.p,8),5))a.sqrt=function(){throw Error("Sqrt alg 3 not implemented")};else throw Error("Field withot sqrt");else{dJ(dI(a.p,4),3)&&((b=a).sqrt_q=dG(b.p,b.m),b.sqrt_e1=dH(dF(b.sqrt_q,3),4),b.sqrt=function(a){if(this.isZero(a))return this.zero;let c=this.pow(a,this.sqrt_e1),d=this.mul(this.square(c),a);if(this.eq(d,this.negone))return null;let e=this.mul(c,a);return b.geq(e,b.zero)?e:b.neg(e)})}else{let b=dI(dG(a.p,a.m/2),4);1==b?a.sqrt=function(){throw Error("Sqrt alg 10 not implemented")}:3==b?((c=a).sqrt_q=dG(c.p,c.m/2),c.sqrt_e34=dH(dF(c.sqrt_q,3),4),c.sqrt_e12=dH(dF(c.sqrt_q,1),2),c.frobenius=function(a,b){return a%2==1?c.conjugate(b):b},c.sqrt=function(a){let b,c=this.pow(a,this.sqrt_e34),d=this.mul(this.square(c),a),e=this.mul(this.frobenius(1,d),d);if(this.eq(e,this.negone))return null;let f=this.mul(c,a);if(this.eq(d,this.negone))b=this.mul(f,[this.F.zero,this.F.one]);else{let a=this.pow(this.add(this.one,d),this.sqrt_e12);b=this.mul(a,f)}return this.geq(b,this.zero)?b:this.neg(b)}):a.sqrt=function(){throw Error("Sqrt alg 8 not implemented")}}}(this),this.FFT=new dY(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(a,b){let c;if(b?16==b&&(c=BigInt("0x"+a)):c=BigInt(a),!(c<0))return c>=this.p?c%this.p:c;{let a=-c;return a>=this.p&&(a%=this.p),this.p-a}}add(a,b){let c=a+b;return c>=this.p?c-this.p:c}sub(a,b){return a>=b?a-b:this.p-b+a}neg(a){return a?this.p-a:a}mul(a,b){return a*b%this.p}mulScalar(a,b){return a*this.e(b)%this.p}square(a){return a*a%this.p}eq(a,b){return a==b}neq(a,b){return a!=b}lt(a,b){return(a>this.half?a-this.p:a)<(b>this.half?b-this.p:b)}gt(a,b){return(a>this.half?a-this.p:a)>(b>this.half?b-this.p:b)}leq(a,b){return(a>this.half?a-this.p:a)<=(b>this.half?b-this.p:b)}geq(a,b){return(a>this.half?a-this.p:a)>=(b>this.half?b-this.p:b)}div(a,b){return this.mul(a,this.inv(b))}idiv(a,b){if(!b)throw Error("Division by zero");return a/b}inv(a){if(!a)throw Error("Division by zero");let b=this.zero,c=this.p,d=this.one,e=a%this.p;for(;e;){let a=c/e;[b,d]=[d,b-a*d],[c,e]=[e,c-a*e]}return b<this.zero&&(b+=this.p),b}mod(a,b){return a%b}pow(a,b){return dS(this,a,b)}exp(a,b){return dS(this,a,b)}band(a,b){let c=a&b&this.mask;return c>=this.p?c-this.p:c}bor(a,b){let c=(a|b)&this.mask;return c>=this.p?c-this.p:c}bxor(a,b){let c=(a^b)&this.mask;return c>=this.p?c-this.p:c}bnot(a){let b=a^this.mask;return b>=this.p?b-this.p:b}shl(a,b){if(Number(b)<this.bitLength){let c=a<<b&this.mask;return c>=this.p?c-this.p:c}{let c=this.p-b;return Number(c)<this.bitLength?a>>c:this.zero}}shr(a,b){if(Number(b)<this.bitLength)return a>>b;{let c=this.p-b;if(!(Number(c)<this.bitLength))return 0;{let b=a<<c&this.mask;return b>=this.p?b-this.p:b}}}land(a,b){return a&&b?this.one:this.zero}lor(a,b){return a||b?this.one:this.zero}lnot(a){return a?this.zero:this.one}sqrt_old(a){if(a==this.zero)return this.zero;if(this.pow(a,this.negone>>this.one)!=this.one)return null;let b=this.s,c=this.nqr_to_t,d=this.pow(a,this.t),e=this.pow(a,this.add(this.t,this.one)>>this.one);for(;d!=this.one;){let a=this.square(d),f=1;for(;a!=this.one;)f++,a=this.square(a);let g=c;for(let a=0;a<b-f-1;a++)g=this.square(g);b=f,c=this.square(g),d=this.mul(d,c),e=this.mul(e,g)}return e>this.p>>this.one&&(e=this.neg(e)),e}normalize(a,b){if(!((a=BigInt(a,b))<0))return a>=this.p?a%this.p:a;{let b=-a;return b>=this.p&&(b%=this.p),this.p-b}}random(){let a=2*this.bitLength/8,b=this.zero;for(let c=0;c<a;c++)b=(b<<BigInt(8))+BigInt(dV(1)[0]);return b%this.p}toString(a,b){return b=b||10,a>this.half&&10==b?"-"+(this.p-a).toString(b):a.toString(b)}isZero(a){return a==this.zero}fromRng(a){let b;do{b=this.zero;for(let c=0;c<this.n64;c++)b+=a.nextU64()<<BigInt(64*c);b&=this.mask}while(b>=this.p);return b*this.Ri%this.p}fft(a){return this.FFT.fft(a)}ifft(a){return this.FFT.ifft(a)}toRprLE(a,b,c){dM(a,b,c,8*this.n64)}toRprBE(a,b,c){!function(a,b,c,d){let e="0000000"+c.toString(16),f=new DataView(a.buffer,a.byteOffset+b,d),g=((e.length-7)*4-1>>5)+1;for(let a=0;a<g;a++)f.setUint32(d-4*a-4,parseInt(e.substring(e.length-8*a-8,e.length-8*a),16),!1);for(let a=0;a<d/4-g;a++)f[a]=0}(a,b,c,8*this.n64)}toRprBEM(a,b,c){return this.toRprBE(a,b,this.mul(this.R,c))}toRprLEM(a,b,c){return this.toRprLE(a,b,this.mul(this.R,c))}fromRprLE(a,b){return dN(a,b,this.n8)}fromRprBE(a,b){return function(a,b,c){c=c||a.byteLength,b=b||0;let d=new DataView(a.buffer,a.byteOffset+b,c),e=Array(c/4);for(let a=0;a<c/4;a++)e[a]=d.getUint32(4*a,!1).toString(16).padStart(8,"0");return dz(e.join(""),16)}(a,b,this.n8)}fromRprLEM(a,b){return this.mul(this.fromRprLE(a,b),this.Ri)}fromRprBEM(a,b){return this.mul(this.fromRprBE(a,b),this.Ri)}toObject(a){return a}}let d0=[];for(let a=0;a<256;a++)d0[a]=function(a,b){let c=0,d=a;for(let a=0;a<8;a++)c<<=1,c|=1&d,d>>=1;return c}(a,8);function d1(a){return((0xffff0000&a)!=0?(a&=0xffff0000,16):0)|((0xff00ff00&a)!=0?(a&=0xff00ff00,8):0)|((0xf0f0f0f0&a)!=0?(a&=0xf0f0f0f0,4):0)|((0xcccccccc&a)!=0?(a&=0xcccccccc,2):0)|(0xaaaaaaaa&a)!=0}function d2(a,b){let c=new Uint8Array(b*a.length);for(let d=0;d<a.length;d++)c.set(a[d],d*b);return c}function d3(a,b){let c=a.byteLength/b,d=Array(c);for(let e=0;e<c;e++)d[e]=a.slice(e*b,e*b+b);return d}class d4{constructor(a){this.buffers=[],this.byteLength=a;for(let b=0;b<a;b+=0x40000000){const c=Math.min(a-b,0x40000000);this.buffers.push(new Uint8Array(c))}}slice(a,b){let c;void 0===b&&(b=this.byteLength),void 0===a&&(a=0);let d=b-a,e=Math.floor(a/0x40000000);if(e==Math.floor((a+d-1)/0x40000000)||0==d)return this.buffers[e].slice(a%0x40000000,a%0x40000000+d);let f=e,g=a%0x40000000,h=d;for(;h>0;){let a=g+h>0x40000000?0x40000000-g:h,b=new Uint8Array(this.buffers[f].buffer,this.buffers[f].byteOffset+g,a);if(a==d)return b.slice();c||(c=d<=0x40000000?new Uint8Array(d):new d4(d)),c.set(b,d-h),h-=a,f++,g=0}return c}set(a,b){void 0===b&&(b=0);let c=a.byteLength;if(0==c)return;let d=Math.floor(b/0x40000000);if(d==Math.floor((b+c-1)/0x40000000))if(a instanceof d4&&1==a.buffers.length)return this.buffers[d].set(a.buffers[0],b%0x40000000);else return this.buffers[d].set(a,b%0x40000000);let e=d,f=b%0x40000000,g=c;for(;g>0;){let b=f+g>0x40000000?0x40000000-f:g,d=a.slice(c-g,c-g+b);new Uint8Array(this.buffers[e].buffer,this.buffers[e].byteOffset+f,b).set(d),g-=b,e++,f=0}}}function d5(a,b,c,d){return async function(e){let f,g=Math.floor(e.byteLength/c);if(g*c!==e.byteLength)throw Error("Invalid buffer size");let h=Math.floor(g/a.concurrency),i=[];for(let f=0;f<a.concurrency;f++){let j;if(0==(j=f<a.concurrency-1?h:g-f*h))continue;let k=[{cmd:"ALLOCSET",var:0,buff:e.slice(f*h*c,f*h*c+j*c)},{cmd:"ALLOC",var:1,len:d*j},{cmd:"CALL",fnName:b,params:[{var:0},{val:j},{var:1}]},{cmd:"GET",out:0,var:1,len:d*j}];i.push(a.queueAction(k))}let j=await Promise.all(i);f=e instanceof d4?new d4(g*d):new Uint8Array(g*d);let k=0;for(let a=0;a<j.length;a++)f.set(j[a][0],k),k+=j[a][0].byteLength;return f}}class d6{constructor(a,b,c,d){if(this.tm=a,this.prefix=b,this.p=d,this.n8=c,this.type="F1",this.m=1,this.half=dC(d,dQ),this.bitLength=dA(d),this.mask=dF(dB(dQ,this.bitLength),dQ),this.pOp1=a.alloc(c),this.pOp2=a.alloc(c),this.pOp3=a.alloc(c),this.tm.instance.exports[b+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[b+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(c/8),this.n32=Math.floor(c/4),8*this.n64!=this.n8)throw Error("n8 must be a multiple of 8");this.half=dC(this.p,dQ),this.nqr=this.two;let e=this.exp(this.nqr,this.half);for(;!this.eq(e,this.negone);)this.nqr=this.add(this.nqr,this.one),e=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let f=dF(this.p,dQ);for(;!dD(f);)this.s=this.s+1,f=dC(f,dQ);this.w=[],this.w[this.s]=this.exp(this.nqr,f);for(let a=this.s-1;a>=0;a--)this.w[a]=this.square(this.w[a+1]);if(!this.eq(this.w[0],this.one))throw Error("Error calculating roots of unity");this.batchToMontgomery=d5(a,b+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=d5(a,b+"_batchFromMontgomery",this.n8,this.n8)}op2(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2)}op1(a,b){return this.tm.setBuff(this.pOp1,b),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(a,b){return this.tm.setBuff(this.pOp1,b),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3)}add(a,b){return this.op2("_add",a,b)}eq(a,b){return this.op2Bool("_eq",a,b)}isZero(a){return this.op1Bool("_isZero",a)}sub(a,b){return this.op2("_sub",a,b)}neg(a){return this.op1("_neg",a)}inv(a){return this.op1("_inverse",a)}toMontgomery(a){return this.op1("_toMontgomery",a)}fromMontgomery(a){return this.op1("_fromMontgomery",a)}mul(a,b){return this.op2("_mul",a,b)}div(a,b){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,b),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(a){return this.op1("_square",a)}isSquare(a){return this.op1Bool("_isSquare",a)}sqrt(a){return this.op1("_sqrt",a)}exp(a,b){return b instanceof Uint8Array||(b=dO(dz(b))),this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,b),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,b.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(a){return this.op1Bool("_isNegative",a)}e(a,b){if(a instanceof Uint8Array)return a;let c=dz(a,b);BigInt(c)<BigInt(0)?(dK(c=-BigInt(c),this.p)&&(c=dI(c,this.p)),c=dF(this.p,c)):dK(c,this.p)&&(c=dI(c,this.p));let d=function(a,b){let c=a;void 0===b&&0==(b=Math.floor((dA(a)-1)/8)+1)&&(b=1);let d=new Uint8Array(b),e=new DataView(d.buffer),f=0;for(;f<b;)f+4<=b?(e.setUint32(f,Number(c&BigInt(0xffffffff)),!0),f+=4,c>>=BigInt(32)):f+2<=b?(e.setUint16(f,Number(c&BigInt(65535)),!0),f+=2,c>>=BigInt(16)):(e.setUint8(f,Number(c&BigInt(255)),!0),f+=1,c>>=BigInt(8));if(c)throw Error("Number does not fit in this length");return d}(c,this.n8);return this.toMontgomery(d)}toString(a,b){var c;return c=dN(this.fromMontgomery(a),0),c.toString(b)}fromRng(a){var b,c;let d,e=new Uint8Array(this.n8);do{d=dP;for(let b=0;b<this.n64;b++)d=dE(d,dB(a.nextU64(),64*b));d=dL(d,this.mask)}while(b=d,c=this.p,BigInt(b)>=BigInt(c));return dM(e,0,d,this.n8),e}random(){return this.fromRng(dX())}toObject(a){return dN(this.fromMontgomery(a),0)}fromObject(a){let b=new Uint8Array(this.n8);return dM(b,0,a,this.n8),this.toMontgomery(b)}toRprLE(a,b,c){a.set(this.fromMontgomery(c),b)}toRprBE(a,b,c){let d=this.fromMontgomery(c);for(let a=0;a<this.n8/2;a++){let b=d[a];d[a]=d[this.n8-1-a],d[this.n8-1-a]=b}a.set(d,b)}fromRprLE(a,b){b=b||0;let c=a.slice(b,b+this.n8);return this.toMontgomery(c)}async batchInverse(a){let b,c=!1,d=this.n8,e=this.n8;Array.isArray(a)?(a=d2(a,d),c=!0):a=a.slice(0,a.byteLength);let f=Math.floor(a.byteLength/d);if(f*d!==a.byteLength)throw Error("Invalid buffer size");let g=Math.floor(f/this.tm.concurrency),h=[];for(let b=0;b<this.tm.concurrency;b++){let c;if(0==(c=b<this.tm.concurrency-1?g:f-b*g))continue;let i=[{cmd:"ALLOCSET",var:0,buff:a.slice(b*g*d,b*g*d+c*d)},{cmd:"ALLOC",var:1,len:e*c},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:d},{val:c},{var:1},{val:e}]},{cmd:"GET",out:0,var:1,len:e*c}];h.push(this.tm.queueAction(i))}let i=await Promise.all(h);b=a instanceof d4?new d4(f*e):new Uint8Array(f*e);let j=0;for(let a=0;a<i.length;a++)b.set(i[a][0],j),j+=i[a][0].byteLength;return c?d3(b,e):b}}class d7{constructor(a,b,c){this.tm=a,this.prefix=b,this.F=c,this.type="F2",this.m=2*c.m,this.n8=2*this.F.n8,this.n32=2*this.F.n32,this.n64=2*this.F.n64,this.pOp1=a.alloc(2*c.n8),this.pOp2=a.alloc(2*c.n8),this.pOp3=a.alloc(2*c.n8),this.tm.instance.exports[b+"_zero"](this.pOp1),this.zero=a.getBuff(this.pOp1,this.n8),this.tm.instance.exports[b+"_one"](this.pOp1),this.one=a.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2)}op1(a,b){return this.tm.setBuff(this.pOp1,b),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(a,b){return this.tm.setBuff(this.pOp1,b),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3)}add(a,b){return this.op2("_add",a,b)}eq(a,b){return this.op2Bool("_eq",a,b)}isZero(a){return this.op1Bool("_isZero",a)}sub(a,b){return this.op2("_sub",a,b)}neg(a){return this.op1("_neg",a)}inv(a){return this.op1("_inverse",a)}isNegative(a){return this.op1Bool("_isNegative",a)}toMontgomery(a){return this.op1("_toMontgomery",a)}fromMontgomery(a){return this.op1("_fromMontgomery",a)}mul(a,b){return this.op2("_mul",a,b)}mul1(a,b){return this.op2("_mul1",a,b)}div(a,b){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,b),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(a){return this.op1("_square",a)}isSquare(a){return this.op1Bool("_isSquare",a)}sqrt(a){return this.op1("_sqrt",a)}exp(a,b){return b instanceof Uint8Array||(b=dO(dz(b))),this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,b),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,b.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(a,b){if(a instanceof Uint8Array)return a;if(Array.isArray(a)&&2==a.length){let c=this.F.e(a[0],b),d=this.F.e(a[1],b),e=new Uint8Array(2*this.F.n8);return e.set(c),e.set(d,2*this.F.n8),e}throw Error("invalid F2")}toString(a,b){let c=this.F.toString(a.slice(0,this.F.n8),b),d=this.F.toString(a.slice(this.F.n8),b);return`[${c}, ${d}]`}fromRng(a){let b=this.F.fromRng(a),c=this.F.fromRng(a),d=new Uint8Array(2*this.F.n8);return d.set(b),d.set(c,this.F.n8),d}random(){return this.fromRng(dX())}toObject(a){return[this.F.toObject(a.slice(0,this.F.n8)),this.F.toObject(a.slice(this.F.n8,2*this.F.n8))]}fromObject(a){let b=new Uint8Array(2*this.F.n8),c=this.F.fromObject(a[0]),d=this.F.fromObject(a[1]);return b.set(c),b.set(d,this.F.n8),b}c1(a){return a.slice(0,this.F.n8)}c2(a){return a.slice(this.F.n8)}}class d8{constructor(a,b,c){this.tm=a,this.prefix=b,this.F=c,this.type="F3",this.m=3*c.m,this.n8=3*this.F.n8,this.n32=3*this.F.n32,this.n64=3*this.F.n64,this.pOp1=a.alloc(3*c.n8),this.pOp2=a.alloc(3*c.n8),this.pOp3=a.alloc(3*c.n8),this.tm.instance.exports[b+"_zero"](this.pOp1),this.zero=a.getBuff(this.pOp1,this.n8),this.tm.instance.exports[b+"_one"](this.pOp1),this.one=a.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2)}op1(a,b){return this.tm.setBuff(this.pOp1,b),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(a,b){return this.tm.setBuff(this.pOp1,b),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3)}eq(a,b){return this.op2Bool("_eq",a,b)}isZero(a){return this.op1Bool("_isZero",a)}add(a,b){return this.op2("_add",a,b)}sub(a,b){return this.op2("_sub",a,b)}neg(a){return this.op1("_neg",a)}inv(a){return this.op1("_inverse",a)}isNegative(a){return this.op1Bool("_isNegative",a)}toMontgomery(a){return this.op1("_toMontgomery",a)}fromMontgomery(a){return this.op1("_fromMontgomery",a)}mul(a,b){return this.op2("_mul",a,b)}div(a,b){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,b),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(a){return this.op1("_square",a)}isSquare(a){return this.op1Bool("_isSquare",a)}sqrt(a){return this.op1("_sqrt",a)}exp(a,b){return b instanceof Uint8Array||(b=dO(dz(b))),this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,b),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,b.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(a,b){if(a instanceof Uint8Array)return a;if(Array.isArray(a)&&3==a.length){let c=this.F.e(a[0],b),d=this.F.e(a[1],b),e=this.F.e(a[2],b),f=new Uint8Array(3*this.F.n8);return f.set(c),f.set(d,this.F.n8),f.set(e,2*this.F.n8),f}throw Error("invalid F3")}toString(a,b){let c=this.F.toString(a.slice(0,this.F.n8),b),d=this.F.toString(a.slice(this.F.n8,2*this.F.n8),b),e=this.F.toString(a.slice(2*this.F.n8),b);return`[${c}, ${d}, ${e}]`}fromRng(a){let b=this.F.fromRng(a),c=this.F.fromRng(a),d=this.F.fromRng(a),e=new Uint8Array(3*this.F.n8);return e.set(b),e.set(c,this.F.n8),e.set(d,2*this.F.n8),e}random(){return this.fromRng(dX())}toObject(a){return[this.F.toObject(a.slice(0,this.F.n8)),this.F.toObject(a.slice(this.F.n8,2*this.F.n8)),this.F.toObject(a.slice(2*this.F.n8,3*this.F.n8))]}fromObject(a){let b=new Uint8Array(3*this.F.n8),c=this.F.fromObject(a[0]),d=this.F.fromObject(a[1]),e=this.F.fromObject(a[2]);return b.set(c),b.set(d,this.F.n8),b.set(e,2*this.F.n8),b}c1(a){return a.slice(0,this.F.n8)}c2(a){return a.slice(this.F.n8,2*this.F.n8)}c3(a){return a.slice(2*this.F.n8)}}class d9{constructor(a,b,c,d,e,f){this.tm=a,this.prefix=b,this.F=c,this.pOp1=a.alloc(3*c.n8),this.pOp2=a.alloc(3*c.n8),this.pOp3=a.alloc(3*c.n8),this.tm.instance.exports[b+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,3*c.n8),this.tm.instance.exports[b+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,2*c.n8),this.one=this.tm.getBuff(d,3*c.n8),this.g=this.one,this.oneAffine=this.tm.getBuff(d,2*c.n8),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(e,c.n8),f&&(this.cofactor=dO(f)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=d5(a,b+"_batchLEMtoC",2*c.n8,c.n8),this.batchLEMtoU=d5(a,b+"_batchLEMtoU",2*c.n8,2*c.n8),this.batchCtoLEM=d5(a,b+"_batchCtoLEM",c.n8,2*c.n8),this.batchUtoLEM=d5(a,b+"_batchUtoLEM",2*c.n8,2*c.n8),this.batchToJacobian=d5(a,b+"_batchToJacobian",2*c.n8,3*c.n8),this.batchToAffine=d5(a,b+"_batchToAffine",3*c.n8,2*c.n8)}op2(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op2bool(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2,this.pOp3)}op1(a,b){return this.tm.setBuff(this.pOp1,b),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op1Affine(a,b){return this.tm.setBuff(this.pOp1,b),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,2*this.F.n8)}op1Bool(a,b){return this.tm.setBuff(this.pOp1,b),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3)}add(a,b){if(a.byteLength==3*this.F.n8)if(b.byteLength==3*this.F.n8)return this.op2("_add",a,b);else if(b.byteLength==2*this.F.n8)return this.op2("_addMixed",a,b);else throw Error("invalid point size");if(a.byteLength==2*this.F.n8){if(b.byteLength==3*this.F.n8)return this.op2("_addMixed",b,a);else if(b.byteLength==2*this.F.n8)return this.op2("_addAffine",a,b)}throw Error("invalid point size")}sub(a,b){if(a.byteLength==3*this.F.n8)if(b.byteLength==3*this.F.n8)return this.op2("_sub",a,b);else if(b.byteLength==2*this.F.n8)return this.op2("_subMixed",a,b);else throw Error("invalid point size");if(a.byteLength==2*this.F.n8){if(b.byteLength==3*this.F.n8)return this.op2("_subMixed",b,a);else if(b.byteLength==2*this.F.n8)return this.op2("_subAffine",a,b)}throw Error("invalid point size")}neg(a){if(a.byteLength==3*this.F.n8)return this.op1("_neg",a);if(a.byteLength==2*this.F.n8)return this.op1Affine("_negAffine",a);throw Error("invalid point size")}double(a){if(a.byteLength==3*this.F.n8)return this.op1("_double",a);if(a.byteLength==2*this.F.n8)return this.op1("_doubleAffine",a);throw Error("invalid point size")}isZero(a){if(a.byteLength==3*this.F.n8)return this.op1Bool("_isZero",a);if(a.byteLength==2*this.F.n8)return this.op1Bool("_isZeroAffine",a);throw Error("invalid point size")}timesScalar(a,b){let c;if(b instanceof Uint8Array||(b=dO(dz(b))),a.byteLength==3*this.F.n8)c=this.prefix+"_timesScalar";else if(a.byteLength==2*this.F.n8)c=this.prefix+"_timesScalarAffine";else throw Error("invalid point size");return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,b),this.tm.instance.exports[c](this.pOp1,this.pOp2,b.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}timesFr(a,b){let c;if(a.byteLength==3*this.F.n8)c=this.prefix+"_timesFr";else if(a.byteLength==2*this.F.n8)c=this.prefix+"_timesFrAffine";else throw Error("invalid point size");return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,b),this.tm.instance.exports[c](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}eq(a,b){if(a.byteLength==3*this.F.n8)if(b.byteLength==3*this.F.n8)return this.op2bool("_eq",a,b);else if(b.byteLength==2*this.F.n8)return this.op2bool("_eqMixed",a,b);else throw Error("invalid point size");if(a.byteLength==2*this.F.n8){if(b.byteLength==3*this.F.n8)return this.op2bool("_eqMixed",b,a);else if(b.byteLength==2*this.F.n8)return this.op2bool("_eqAffine",a,b)}throw Error("invalid point size")}toAffine(a){if(a.byteLength==3*this.F.n8)return this.op1Affine("_toAffine",a);if(a.byteLength==2*this.F.n8)return a;throw Error("invalid point size")}toJacobian(a){if(a.byteLength==3*this.F.n8)return a;if(a.byteLength==2*this.F.n8)return this.op1("_toJacobian",a);throw Error("invalid point size")}toRprUncompressed(a,b,c){if(this.tm.setBuff(this.pOp1,c),c.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(c.byteLength!=2*this.F.n8)throw Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);let d=this.tm.getBuff(this.pOp1,2*this.F.n8);a.set(d,b)}fromRprUncompressed(a,b){let c=a.slice(b,b+2*this.F.n8);return this.tm.setBuff(this.pOp1,c),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,2*this.F.n8)}toRprCompressed(a,b,c){if(this.tm.setBuff(this.pOp1,c),c.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(c.byteLength!=2*this.F.n8)throw Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);let d=this.tm.getBuff(this.pOp1,this.F.n8);a.set(d,b)}fromRprCompressed(a,b){let c=a.slice(b,b+this.F.n8);return this.tm.setBuff(this.pOp1,c),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,2*this.F.n8)}toUncompressed(a){let b=new Uint8Array(2*this.F.n8);return this.toRprUncompressed(b,0,a),b}toRprLEM(a,b,c){if(c.byteLength==2*this.F.n8)return void a.set(c,b);if(c.byteLength==3*this.F.n8){this.tm.setBuff(this.pOp1,c),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);let d=this.tm.getBuff(this.pOp1,2*this.F.n8);a.set(d,b)}else throw Error("invalid point size")}fromRprLEM(a,b){return b=b||0,a.slice(b,b+2*this.F.n8)}toString(a,b){if(a.byteLength==3*this.F.n8){let c=this.F.toString(a.slice(0,this.F.n8),b),d=this.F.toString(a.slice(this.F.n8,2*this.F.n8),b),e=this.F.toString(a.slice(2*this.F.n8),b);return`[ ${c}, ${d}, ${e} ]`}if(a.byteLength==2*this.F.n8){let c=this.F.toString(a.slice(0,this.F.n8),b),d=this.F.toString(a.slice(this.F.n8),b);return`[ ${c}, ${d} ]`}throw Error("invalid point size")}isValid(a){if(this.isZero(a))return!0;let b=this.F,c=this.toAffine(a),d=c.slice(0,this.F.n8),e=c.slice(this.F.n8,2*this.F.n8),f=b.add(b.mul(b.square(d),d),this.b),g=b.square(e);return b.eq(f,g)}fromRng(a){let b,c,d=this.F,e=[];do e[0]=d.fromRng(a),b=a.nextBool(),c=d.add(d.mul(d.square(e[0]),e[0]),this.b);while(!d.isSquare(c));e[1]=d.sqrt(c),b^d.isNegative(e[1])&&(e[1]=d.neg(e[1]));let f=new Uint8Array(2*this.F.n8);return f.set(e[0]),f.set(e[1],this.F.n8),this.cofactor&&(f=this.timesScalar(f,this.cofactor)),f}toObject(a){return this.isZero(a)?[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)]:[this.F.toObject(a.slice(0,this.F.n8)),this.F.toObject(a.slice(this.F.n8,2*this.F.n8)),a.byteLength==3*this.F.n8?this.F.toObject(a.slice(2*this.F.n8,3*this.F.n8)):this.F.toObject(this.F.one)]}fromObject(a){let b,c=this.F.fromObject(a[0]),d=this.F.fromObject(a[1]);if(b=3==a.length?this.F.fromObject(a[2]):this.F.one,this.F.isZero(b,this.F.one))return this.zeroAffine;if(this.F.eq(b,this.F.one)){let a=new Uint8Array(2*this.F.n8);return a.set(c),a.set(d,this.F.n8),a}{let a=new Uint8Array(3*this.F.n8);return a.set(c),a.set(d,this.F.n8),a.set(b,2*this.F.n8),a}}e(a){return a instanceof Uint8Array?a:this.fromObject(a)}x(a){return this.toAffine(a).slice(0,this.F.n8)}y(a){return this.toAffine(a).slice(this.F.n8)}}function ea(a){let b,c;async function d(a){let d=new Uint8Array(a.code),e=await WebAssembly.compile(d);c=new WebAssembly.Memory({initial:a.init,maximum:32767}),b=await WebAssembly.instantiate(e,{env:{memory:c}})}function e(a){let b=new Uint32Array(c.buffer,0,1);for(;3&b[0];)b[0]++;let d=b[0];if(b[0]+=a,b[0]+a>c.buffer.byteLength){let d=c.buffer.byteLength/65536,e=Math.floor((b[0]+a)/65536)+1;e>32767&&(e=32767),c.grow(e-d)}return d}function f(a,b){new Uint8Array(c.buffer).set(new Uint8Array(b),a)}function g(a){if("INIT"==a[0].cmd)return d(a[0]);let g=[],h=[],i=new Uint32Array(c.buffer,0,1)[0];for(let d=0;d<a.length;d++)switch(a[d].cmd){case"ALLOCSET":g[a[d].var]=function(a){let b=e(a.byteLength);return f(b,a),b}(a[d].buff);break;case"ALLOC":g[a[d].var]=e(a[d].len);break;case"SET":f(g[a[d].var],a[d].buff);break;case"CALL":{let c=[];for(let b=0;b<a[d].params.length;b++){let e=a[d].params[b];void 0!==e.var?c.push(g[e.var]+(e.offset||0)):void 0!==e.val&&c.push(e.val)}b.exports[a[d].fnName](...c);break}case"GET":h[a[d].out]=(function(a,b){let d=new Uint8Array(c.buffer);return new Uint8Array(d.buffer,d.byteOffset+a,b)})(g[a[d].var],a[d].len).slice();break;default:throw Error("Invalid cmd")}return new Uint32Array(c.buffer,0,1)[0]=i,h}return a&&(a.onmessage=function(b){let c;if("INIT"==(c=b.data?b.data:b)[0].cmd)d(c[0]).then(function(){a.postMessage(c.result)});else if("TERMINATE"==c[0].cmd)a.close();else{let b=g(c);a.postMessage(b)}}),g}class eb{constructor(){this.promise=new Promise((a,b)=>{this.reject=b,this.resolve=a})}}let ec=`(${ea.toString()})(self)`;async function ed(a,b){let c=new ee;c.memory=new WebAssembly.Memory({initial:25}),c.u8=new Uint8Array(c.memory.buffer),c.u32=new Uint32Array(c.memory.buffer);let d=await WebAssembly.compile(a.code);if(c.instance=await WebAssembly.instantiate(d,{env:{memory:c.memory}}),c.singleThread=b,c.initalPFree=c.u32[0],c.pq=a.pq,c.pr=a.pr,c.pG1gen=a.pG1gen,c.pG1zero=a.pG1zero,c.pG2gen=a.pG2gen,c.pG2zero=a.pG2zero,c.pOneT=a.pOneT,b)c.code=a.code,c.taskManager=ea(),await c.taskManager([{cmd:"INIT",init:25,code:c.code.slice()}]),c.concurrency=1;else{c.workers=[],c.pendingDeferreds=[],c.working=[];let b=2;0==(b=aR.cpus().length)&&(b=2),b>64&&(b=64),c.concurrency=b;for(let a=0;a<b;a++)c.workers[a]=new aS(e),c.workers[a].addEventListener("message",function(a){return function(b){let d;d=b&&b.data?b.data:b,c.working[a]=!1,c.pendingDeferreds[a].resolve(d),c.processWorks()}}(a)),c.working[a]=!1;let d=[];for(let b=0;b<c.workers.length;b++){let e=a.code.slice();d.push(c.postAction(b,[{cmd:"INIT",init:25,code:e}],[e.buffer]))}await Promise.all(d)}return c}e="data:application/javascript;base64,"+Buffer.from(ec).toString("base64");class ee{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(0!=this.oldPFree)throw Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(0==this.oldPFree)throw Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(a,b,c,d){if(this.working[a])throw Error("Posting a job t a working worker");return this.working[a]=!0,this.pendingDeferreds[a]=d||new eb,this.workers[a].postMessage(b,c),this.pendingDeferreds[a].promise}processWorks(){for(let a=0;a<this.workers.length&&this.actionQueue.length>0;a++)if(!1==this.working[a]){let b=this.actionQueue.shift();this.postAction(a,b.data,b.transfers,b.deferred)}}queueAction(a,b){let c=new eb;if(this.singleThread){let b=this.taskManager(a);c.resolve(b)}else this.actionQueue.push({data:a,transfers:b,deferred:c}),this.processWorks();return c.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(a){let b=this.alloc(a.byteLength);return this.setBuff(b,a),b}getBuff(a,b){return this.u8.slice(a,a+b)}setBuff(a,b){this.u8.set(new Uint8Array(b),a)}alloc(a){for(;3&this.u32[0];)this.u32[0]++;let b=this.u32[0];return this.u32[0]+=a,b}async terminate(){for(let a=0;a<this.workers.length;a++)this.workers[a].postMessage([{cmd:"TERMINATE"}]);await new Promise(a=>setTimeout(a,200))}}function ef(a,b){let c=a[b],d=a.Fr,e=a.tm;a[b].batchApplyKey=async function(a,f,g,h,i){let j,k,l,m,n,o;if(h=h||"affine",i=i||"affine","G1"==b)"jacobian"==h?(l=3*c.F.n8,j="g1m_batchApplyKey"):(l=2*c.F.n8,j="g1m_batchApplyKeyMixed"),m=3*c.F.n8,"jacobian"==i?n=3*c.F.n8:(k="g1m_batchToAffine",n=2*c.F.n8);else if("G2"==b)"jacobian"==h?(l=3*c.F.n8,j="g2m_batchApplyKey"):(l=2*c.F.n8,j="g2m_batchApplyKeyMixed"),m=3*c.F.n8,"jacobian"==i?n=3*c.F.n8:(k="g2m_batchToAffine",n=2*c.F.n8);else if("Fr"==b)j="frm_batchApplyKey",l=c.n8,m=c.n8,n=c.n8;else throw Error("Invalid group: "+b);let p=Math.floor(a.byteLength/l),q=Math.floor(p/e.concurrency),r=[];g=d.e(g);let s=d.e(f);for(let b=0;b<e.concurrency;b++){let c;if(0==(c=b<e.concurrency-1?q:p-b*q))continue;let f=[];f.push({cmd:"ALLOCSET",var:0,buff:a.slice(b*q*l,b*q*l+c*l)}),f.push({cmd:"ALLOCSET",var:1,buff:s}),f.push({cmd:"ALLOCSET",var:2,buff:g}),f.push({cmd:"ALLOC",var:3,len:c*Math.max(m,n)}),f.push({cmd:"CALL",fnName:j,params:[{var:0},{val:c},{var:1},{var:2},{var:3}]}),k&&f.push({cmd:"CALL",fnName:k,params:[{var:3},{val:c},{var:3}]}),f.push({cmd:"GET",out:0,var:3,len:c*n}),r.push(e.queueAction(f)),s=d.mul(s,d.exp(g,c))}let t=await Promise.all(r);o=a instanceof d4?new d4(p*n):new Uint8Array(p*n);let u=0;for(let a=0;a<t.length;a++)o.set(t[a][0],u),u+=t[a][0].byteLength;return o}}let eg=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function eh(a,b){let c=a[b],d=c.tm;async function e(a,d,e,f,g){let h,i;if(!(a instanceof Uint8Array))throw f&&f.error(`${g} _multiExpChunk buffBases is not Uint8Array`),Error(`${g} _multiExpChunk buffBases is not Uint8Array`);if(!(d instanceof Uint8Array))throw f&&f.error(`${g} _multiExpChunk buffScalars is not Uint8Array`),Error(`${g} _multiExpChunk buffScalars is not Uint8Array`);if(e=e||"affine","G1"==b)"affine"==e?(i="g1m_multiexpAffine_chunk",h=2*c.F.n8):(i="g1m_multiexp_chunk",h=3*c.F.n8);else if("G2"==b)"affine"==e?(i="g2m_multiexpAffine_chunk",h=2*c.F.n8):(i="g2m_multiexp_chunk",h=3*c.F.n8);else throw Error("Invalid group");let j=Math.floor(a.byteLength/h);if(0==j)return c.zero;let k=Math.floor(d.byteLength/j);if(k*j!=d.byteLength)throw Error("Scalar size does not match");let l=eg[d1(j)],m=Math.floor((8*k-1)/l)+1,n=[];for(let b=0;b<m;b++){let e=[{cmd:"ALLOCSET",var:0,buff:a},{cmd:"ALLOCSET",var:1,buff:d},{cmd:"ALLOC",var:2,len:3*c.F.n8},{cmd:"CALL",fnName:i,params:[{var:0},{var:1},{val:k},{val:j},{val:b*l},{val:Math.min(8*k-b*l,l)},{var:2}]},{cmd:"GET",out:0,var:2,len:3*c.F.n8}];n.push(c.tm.queueAction(e))}let o=await Promise.all(n),p=c.zero;for(let a=o.length-1;a>=0;a--){if(!c.isZero(p))for(let a=0;a<l;a++)p=c.double(p);p=c.add(p,o[a][0])}return p}async function f(a,f,g,h,i){let j,k;if("G1"==b)j="affine"==g?2*c.F.n8:3*c.F.n8;else if("G2"==b)j="affine"==g?2*c.F.n8:3*c.F.n8;else throw Error("Invalid group");let l=Math.floor(a.byteLength/j),m=Math.floor(f.byteLength/l);if(m*l!=f.byteLength)throw Error("Scalar size does not match");let n=Math.floor((8*m-1)/eg[d1(l)])+1;(k=Math.floor(l/(d.concurrency/n)))>4194304&&(k=4194304),k<1024&&(k=1024);let o=[];for(let b=0;b<l;b+=k){h&&h.debug(`Multiexp start: ${i}: ${b}/${l}`);let c=Math.min(l-b,k),d=a.slice(b*j,(b+c)*j),n=f.slice(b*m,(b+c)*m);o.push(e(d,n,g,h,i).then(a=>(h&&h.debug(`Multiexp end: ${i}: ${b}/${l}`),a)))}let p=await Promise.all(o),q=c.zero;for(let a=p.length-1;a>=0;a--)q=c.add(q,p[a]);return q}c.multiExp=async function(a,b,c,d){return await f(a,b,"jacobian",c,d)},c.multiExpAffine=async function(a,b,c,d){return await f(a,b,"affine",c,d)}}function ei(a,b){let c=a[b],d=a.Fr,e=c.tm;async function f(a,f,i,j,k,l){let m,n,o,p,q,r,s,t,u,v,w;i=i||"affine",j=j||"affine","G1"==b?("affine"==i?(m=2*c.F.n8,p="g1m_batchToJacobian"):m=3*c.F.n8,n=3*c.F.n8,f&&(t="g1m_fftFinal"),s="g1m_fftJoin",r="g1m_fftMix","affine"==j?(o=2*c.F.n8,q="g1m_batchToAffine"):o=3*c.F.n8):"G2"==b?("affine"==i?(m=2*c.F.n8,p="g2m_batchToJacobian"):m=3*c.F.n8,n=3*c.F.n8,f&&(t="g2m_fftFinal"),s="g2m_fftJoin",r="g2m_fftMix","affine"==j?(o=2*c.F.n8,q="g2m_batchToAffine"):o=3*c.F.n8):"Fr"==b&&(m=c.n8,n=c.n8,o=c.n8,f&&(t="frm_fftFinal"),r="frm_fftMix",s="frm_fftJoin");let x=!1;Array.isArray(a)?(a=d2(a,m),x=!0):a=a.slice(0,a.byteLength);let y=a.byteLength/m,z=d1(y);if(1<<z!=y)throw Error("fft must be multiple of 2");if(z==d.s+1){let b;return(b=f?await h(a,i,j,k,l):await g(a,i,j,k,l),x)?d3(b,o):b}f&&(u=d.inv(d.e(y))),function(a,b){let c=a.byteLength/b,d=d1(c);if(c!=1<<d)throw Error("Invalid number of pointers");for(let f=0;f<c;f++){var e;let c=(d0[(e=f)>>>24]|d0[e>>>16&255]<<8|d0[e>>>8&255]<<16|d0[255&e]<<24)>>>32-d;if(f>c){let d=a.slice(f*b,(f+1)*b);a.set(a.slice(c*b,(c+1)*b),f*b),a.set(d,c*b)}}}(a,m);let A=Math.min(16384,y),B=y/A;for(;B<e.concurrency&&A>=16;)B*=2,A/=2;let C=d1(A),D=[];for(let b=0;b<B;b++){k&&k.debug(`${l}: fft ${z} mix start: ${b}/${B}`);let c=[];c.push({cmd:"ALLOC",var:0,len:n*A});let d=a.slice(A*b*m,A*(b+1)*m);c.push({cmd:"SET",var:0,buff:d}),p&&c.push({cmd:"CALL",fnName:p,params:[{var:0},{val:A},{var:0}]});for(let a=1;a<=C;a++)c.push({cmd:"CALL",fnName:r,params:[{var:0},{val:A},{val:a}]});C==z?(t&&(c.push({cmd:"ALLOCSET",var:1,buff:u}),c.push({cmd:"CALL",fnName:t,params:[{var:0},{val:A},{var:1}]})),q&&c.push({cmd:"CALL",fnName:q,params:[{var:0},{val:A},{var:0}]}),c.push({cmd:"GET",out:0,var:0,len:A*o})):c.push({cmd:"GET",out:0,var:0,len:n*A}),D.push(e.queueAction(c).then(a=>(k&&k.debug(`${l}: fft ${z} mix end: ${b}/${B}`),a)))}w=await Promise.all(D);for(let a=0;a<B;a++)w[a]=w[a][0];for(let a=C+1;a<=z;a++){k&&k.debug(`${l}: fft  ${z}  join: ${a}/${z}`);let b=1<<z-a,c=B/b,f=[];for(let g=0;g<b;g++)for(let h=0;h<c/2;h++){let i=d.exp(d.w[a],h*A),j=d.w[a],m=g*c+h,p=g*c+h+c/2,r=[];r.push({cmd:"ALLOCSET",var:0,buff:w[m]}),r.push({cmd:"ALLOCSET",var:1,buff:w[p]}),r.push({cmd:"ALLOCSET",var:2,buff:i}),r.push({cmd:"ALLOCSET",var:3,buff:j}),r.push({cmd:"CALL",fnName:s,params:[{var:0},{var:1},{val:A},{var:2},{var:3}]}),a==z?(t&&(r.push({cmd:"ALLOCSET",var:4,buff:u}),r.push({cmd:"CALL",fnName:t,params:[{var:0},{val:A},{var:4}]}),r.push({cmd:"CALL",fnName:t,params:[{var:1},{val:A},{var:4}]})),q&&(r.push({cmd:"CALL",fnName:q,params:[{var:0},{val:A},{var:0}]}),r.push({cmd:"CALL",fnName:q,params:[{var:1},{val:A},{var:1}]})),r.push({cmd:"GET",out:0,var:0,len:A*o}),r.push({cmd:"GET",out:1,var:1,len:A*o})):(r.push({cmd:"GET",out:0,var:0,len:A*n}),r.push({cmd:"GET",out:1,var:1,len:A*n})),f.push(e.queueAction(r).then(d=>(k&&k.debug(`${l}: fft ${z} join  ${a}/${z}  ${g+1}/${b} ${h}/${c/2}`),d)))}let g=await Promise.all(f);for(let a=0;a<b;a++)for(let b=0;b<c/2;b++){let d=a*c+b,e=a*c+b+c/2,f=g.shift();w[d]=f[0],w[e]=f[1]}}if(v=a instanceof d4?new d4(y*o):new Uint8Array(y*o),f){v.set(w[0].slice((A-1)*o));let a=o;for(let b=B-1;b>0;b--)v.set(w[b],a),a+=A*o,delete w[b];v.set(w[0].slice(0,(A-1)*o),a),delete w[0]}else for(let a=0;a<B;a++)v.set(w[a],A*o*a),delete w[a];return x?d3(v,o):v}async function g(a,b,c,e,g){let h,j,k;h=a.slice(0,a.byteLength/2),j=a.slice(a.byteLength/2,a.byteLength);let l=[];[h,j]=await i(h,j,"fftJoinExt",d.one,d.shift,b,"jacobian",e,g),l.push(f(h,!1,"jacobian",c,e,g)),l.push(f(j,!1,"jacobian",c,e,g));let m=await Promise.all(l);return(k=m[0].byteLength>0x10000000?new d4(2*m[0].byteLength):new Uint8Array(2*m[0].byteLength)).set(m[0]),k.set(m[1],m[0].byteLength),k}async function h(a,b,c,e,g){let h,j,k;h=a.slice(0,a.byteLength/2),j=a.slice(a.byteLength/2,a.byteLength);let l=[];l.push(f(h,!0,b,"jacobian",e,g)),l.push(f(j,!0,b,"jacobian",e,g)),[h,j]=await Promise.all(l);let m=await i(h,j,"fftJoinExtInv",d.one,d.shiftInv,"jacobian",c,e,g);return(k=m[0].byteLength>0x10000000?new d4(2*m[0].byteLength):new Uint8Array(2*m[0].byteLength)).set(m[0]),k.set(m[1],m[0].byteLength),k}async function i(a,f,g,h,i,j,k,l,m){let n,o,p,q,r,s,t,u;if("G1"==b)"affine"==j?(r=2*c.F.n8,o="g1m_batchToJacobian"):r=3*c.F.n8,s=3*c.F.n8,n="g1m_"+g,"affine"==k?(p="g1m_batchToAffine",q=2*c.F.n8):q=3*c.F.n8;else if("G2"==b)"affine"==j?(r=2*c.F.n8,o="g2m_batchToJacobian"):r=3*c.F.n8,n="g2m_"+g,s=3*c.F.n8,"affine"==k?(p="g2m_batchToAffine",q=2*c.F.n8):q=3*c.F.n8;else if("Fr"==b)r=d.n8,q=d.n8,s=d.n8,n="frm_"+g;else throw Error("Invalid group");if(a.byteLength!=f.byteLength)throw Error("Invalid buffer size");let v=Math.floor(a.byteLength/r);if(v!=1<<d1(v))throw Error("Invalid number of points");let w=Math.floor(v/e.concurrency);w<16&&(w=16),w>65536&&(w=65536);let x=[];for(let b=0;b<v;b+=w){l&&l.debug(`${m}: fftJoinExt Start: ${b}/${v}`);let c=Math.min(v-b,w),g=d.mul(h,d.exp(i,b)),j=[],k=a.slice(b*r,(b+c)*r),t=f.slice(b*r,(b+c)*r);j.push({cmd:"ALLOC",var:0,len:s*c}),j.push({cmd:"SET",var:0,buff:k}),j.push({cmd:"ALLOC",var:1,len:s*c}),j.push({cmd:"SET",var:1,buff:t}),j.push({cmd:"ALLOCSET",var:2,buff:g}),j.push({cmd:"ALLOCSET",var:3,buff:i}),o&&(j.push({cmd:"CALL",fnName:o,params:[{var:0},{val:c},{var:0}]}),j.push({cmd:"CALL",fnName:o,params:[{var:1},{val:c},{var:1}]})),j.push({cmd:"CALL",fnName:n,params:[{var:0},{var:1},{val:c},{var:2},{var:3},{val:d.s}]}),p&&(j.push({cmd:"CALL",fnName:p,params:[{var:0},{val:c},{var:0}]}),j.push({cmd:"CALL",fnName:p,params:[{var:1},{val:c},{var:1}]})),j.push({cmd:"GET",out:0,var:0,len:c*q}),j.push({cmd:"GET",out:1,var:1,len:c*q}),x.push(e.queueAction(j).then(a=>(l&&l.debug(`${m}: fftJoinExt End: ${b}/${v}`),a)))}let y=await Promise.all(x);v*q>0x10000000?(t=new d4(v*q),u=new d4(v*q)):(t=new Uint8Array(v*q),u=new Uint8Array(v*q));let z=0;for(let a=0;a<y.length;a++)t.set(y[a][0],z),u.set(y[a][1],z),z+=y[a][0].byteLength;return[t,u]}c.fft=async function(a,b,c,d,e){return await f(a,!1,b,c,d,e)},c.ifft=async function(a,b,c,d,e){return await f(a,!0,b,c,d,e)},c.lagrangeEvaluations=async function(a,e,g,h,j){let k,l;if(e=e||"affine",g=g||"affine","G1"==b)k="affine"==e?2*c.F.n8:3*c.F.n8;else if("G2"==b)k="affine"==e?2*c.F.n8:3*c.F.n8;else if("Fr"==b)k=d.n8;else throw Error("Invalid group");let m=a.byteLength/k,n=d1(m);if(2**n*k!=a.byteLength)throw h&&h.error("lagrangeEvaluations iinvalid input size"),Error("lagrangeEvaluations invalid Input size");if(n<=d.s)return await c.ifft(a,e,g,h,j);if(n>d.s+1)throw h&&h.error("lagrangeEvaluations input too big"),Error("lagrangeEvaluations input too big");let o=a.slice(0,a.byteLength/2),p=a.slice(a.byteLength/2,a.byteLength),q=d.exp(d.shift,m/2),r=d.inv(d.sub(d.one,q));[o,p]=await i(o,p,"prepareLagrangeEvaluation",r,d.shiftInv,e,"jacobian",h,j+" prep");let s=[];return s.push(f(o,!0,"jacobian",g,h,j+" t0")),s.push(f(p,!0,"jacobian",g,h,j+" t1")),[o,p]=await Promise.all(s),(l=o.byteLength>0x10000000?new d4(2*o.byteLength):new Uint8Array(2*o.byteLength)).set(o),l.set(p,o.byteLength),l},c.fftMix=async function(a){let f,g,h,i=3*c.F.n8;if("G1"==b)f="g1m_fftMix",g="g1m_fftJoin";else if("G2"==b)f="g2m_fftMix",g="g2m_fftJoin";else if("Fr"==b)f="frm_fftMix",g="frm_fftJoin";else throw Error("Invalid group");let j=Math.floor(a.byteLength/i),k=d1(j),l=1<<d1(e.concurrency);j<=2*l&&(l=1);let m=j/l,n=d1(m),o=[];for(let b=0;b<l;b++){let c=[],d=a.slice(b*m*i,(b+1)*m*i);c.push({cmd:"ALLOCSET",var:0,buff:d});for(let a=1;a<=n;a++)c.push({cmd:"CALL",fnName:f,params:[{var:0},{val:m},{val:a}]});c.push({cmd:"GET",out:0,var:0,len:m*i}),o.push(e.queueAction(c))}let p=await Promise.all(o),q=[];for(let a=0;a<p.length;a++)q[a]=p[a][0];for(let a=n+1;a<=k;a++){let b=1<<k-a,c=l/b,f=[];for(let h=0;h<b;h++)for(let b=0;b<c/2;b++){let j=d.exp(d.w[a],b*m),k=d.w[a],l=h*c+b,n=h*c+b+c/2,o=[];o.push({cmd:"ALLOCSET",var:0,buff:q[l]}),o.push({cmd:"ALLOCSET",var:1,buff:q[n]}),o.push({cmd:"ALLOCSET",var:2,buff:j}),o.push({cmd:"ALLOCSET",var:3,buff:k}),o.push({cmd:"CALL",fnName:g,params:[{var:0},{var:1},{val:m},{var:2},{var:3}]}),o.push({cmd:"GET",out:0,var:0,len:m*i}),o.push({cmd:"GET",out:1,var:1,len:m*i}),f.push(e.queueAction(o))}let h=await Promise.all(f);for(let a=0;a<b;a++)for(let b=0;b<c/2;b++){let d=a*c+b,e=a*c+b+c/2,f=h.shift();q[d]=f[0],q[e]=f[1]}}h=a instanceof d4?new d4(j*i):new Uint8Array(j*i);let r=0;for(let a=0;a<l;a++)h.set(q[a],r),r+=q[a].byteLength;return h},c.fftJoin=async function(a,f,g,h){let i,j,k,l=3*c.F.n8;if("G1"==b)i="g1m_fftJoin";else if("G2"==b)i="g2m_fftJoin";else if("Fr"==b)i="frm_fftJoin";else throw Error("Invalid group");if(a.byteLength!=f.byteLength)throw Error("Invalid buffer size");let m=Math.floor(a.byteLength/l);if(m!=1<<d1(m))throw Error("Invalid number of points");let n=1<<d1(e.concurrency);m<=2*n&&(n=1);let o=m/n,p=[];for(let b=0;b<n;b++){let c=[],j=d.mul(g,d.exp(h,b*o)),k=a.slice(b*o*l,(b+1)*o*l),m=f.slice(b*o*l,(b+1)*o*l);c.push({cmd:"ALLOCSET",var:0,buff:k}),c.push({cmd:"ALLOCSET",var:1,buff:m}),c.push({cmd:"ALLOCSET",var:2,buff:j}),c.push({cmd:"ALLOCSET",var:3,buff:h}),c.push({cmd:"CALL",fnName:i,params:[{var:0},{var:1},{val:o},{var:2},{var:3}]}),c.push({cmd:"GET",out:0,var:0,len:o*l}),c.push({cmd:"GET",out:1,var:1,len:o*l}),p.push(e.queueAction(c))}let q=await Promise.all(p);a instanceof d4?(j=new d4(m*l),k=new d4(m*l)):(j=new Uint8Array(m*l),k=new Uint8Array(m*l));let r=0;for(let a=0;a<q.length;a++)j.set(q[a][0],r),k.set(q[a][1],r),r+=q[a][0].byteLength;return[j,k]},c.fftFinal=async function(a,d){let f,g,h,i=3*c.F.n8,j=2*c.F.n8;if("G1"==b)f="g1m_fftFinal",g="g1m_batchToAffine";else if("G2"==b)f="g2m_fftFinal",g="g2m_batchToAffine";else throw Error("Invalid group");let k=Math.floor(a.byteLength/i);if(k!=1<<d1(k))throw Error("Invalid number of points");let l=Math.floor(k/e.concurrency),m=[];for(let b=0;b<e.concurrency;b++){let c;if(0==(c=b<e.concurrency-1?l:k-b*l))continue;let h=[],n=a.slice(b*l*i,(b*l+c)*i);h.push({cmd:"ALLOCSET",var:0,buff:n}),h.push({cmd:"ALLOCSET",var:1,buff:d}),h.push({cmd:"CALL",fnName:f,params:[{var:0},{val:c},{var:1}]}),h.push({cmd:"CALL",fnName:g,params:[{var:0},{val:c},{var:0}]}),h.push({cmd:"GET",out:0,var:0,len:c*j}),m.push(e.queueAction(h))}let n=await Promise.all(m);h=a instanceof d4?new d4(k*j):new Uint8Array(k*j);let o=0;for(let a=n.length-1;a>=0;a--)h.set(n[a][0],o),o+=n[a][0].byteLength;return h}}async function ej(a){let b,c=await ed(a.wasm,a.singleThread),d={};return d.q=dz(a.wasm.q.toString()),d.r=dz(a.wasm.r.toString()),d.name=a.name,d.tm=c,d.prePSize=a.wasm.prePSize,d.preQSize=a.wasm.preQSize,d.Fr=new d6(c,"frm",a.n8r,a.r),d.F1=new d6(c,"f1m",a.n8q,a.q),d.F2=new d7(c,"f2m",d.F1),d.G1=new d9(c,"g1m",d.F1,a.wasm.pG1gen,a.wasm.pG1b,a.cofactorG1),d.G2=new d9(c,"g2m",d.F2,a.wasm.pG2gen,a.wasm.pG2b,a.cofactorG2),d.F6=new d8(c,"f6m",d.F2),d.F12=new d7(c,"ftm",d.F6),d.Gt=d.F12,ef(d,"G1"),ef(d,"G2"),ef(d,"Fr"),eh(d,"G1"),eh(d,"G2"),ei(d,"G1"),ei(d,"G2"),ei(d,"Fr"),b=d.tm,d.pairing=function(a,c){b.startSyncOp();let e=b.allocBuff(d.G1.toJacobian(a)),f=b.allocBuff(d.G2.toJacobian(c)),g=b.alloc(d.Gt.n8);b.instance.exports[d.name+"_pairing"](e,f,g);let h=b.getBuff(g,d.Gt.n8);return b.endSyncOp(),h},d.pairingEq=async function(){let a,c;arguments.length%2==1?(a=arguments[arguments.length-1],c=(arguments.length-1)/2):(a=d.Gt.one,c=arguments.length/2);let e=[];for(let a=0;a<c;a++){let c=[],f=d.G1.toJacobian(arguments[2*a]);c.push({cmd:"ALLOCSET",var:0,buff:f}),c.push({cmd:"ALLOC",var:1,len:d.prePSize});let g=d.G2.toJacobian(arguments[2*a+1]);c.push({cmd:"ALLOCSET",var:2,buff:g}),c.push({cmd:"ALLOC",var:3,len:d.preQSize}),c.push({cmd:"ALLOC",var:4,len:d.Gt.n8}),c.push({cmd:"CALL",fnName:d.name+"_prepareG1",params:[{var:0},{var:1}]}),c.push({cmd:"CALL",fnName:d.name+"_prepareG2",params:[{var:2},{var:3}]}),c.push({cmd:"CALL",fnName:d.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),c.push({cmd:"GET",out:0,var:4,len:d.Gt.n8}),e.push(b.queueAction(c))}let f=await Promise.all(e);b.startSyncOp();let g=b.alloc(d.Gt.n8);b.instance.exports.ftm_one(g);for(let a=0;a<f.length;a++){let c=b.allocBuff(f[a][0]);b.instance.exports.ftm_mul(g,c,g)}b.instance.exports[d.name+"_finalExponentiation"](g,g);let h=b.allocBuff(a),i=!!b.instance.exports.ftm_eq(g,h);return b.endSyncOp(),i},d.prepareG1=function(a){this.tm.startSyncOp();let b=this.tm.allocBuff(a),c=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](b,c);let d=this.tm.getBuff(c,this.prePSize);return this.tm.endSyncOp(),d},d.prepareG2=function(a){this.tm.startSyncOp();let b=this.tm.allocBuff(a),c=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](b,c);let d=this.tm.getBuff(c,this.preQSize);return this.tm.endSyncOp(),d},d.millerLoop=function(a,b){this.tm.startSyncOp();let c=this.tm.allocBuff(a),d=this.tm.allocBuff(b),e=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](c,d,e);let f=this.tm.getBuff(e,this.Gt.n8);return this.tm.endSyncOp(),f},d.finalExponentiation=function(a){this.tm.startSyncOp();let b=this.tm.allocBuff(a),c=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](b,c);let d=this.tm.getBuff(c,this.Gt.n8);return this.tm.endSyncOp(),d},d.array2buffer=function(a,b){let c=new Uint8Array(b*a.length);for(let d=0;d<a.length;d++)c.set(a[d],d*b);return c},d.buffer2array=function(a,b){let c=a.byteLength/b,d=Array(c);for(let e=0;e<c;e++)d[e]=a.slice(e*b,e*b+b);return d},d}async function ek(a,b){if(!a&&globalThis.curve_bn128)return globalThis.curve_bn128;let c=new bb;c.setMemory(25),(0,az.buildBn128)(c),b&&b(c);let d={};d.code=c.build(),d.pq=c.modules.f1m.pq,d.pr=c.modules.frm.pq,d.pG1gen=c.modules.bn128.pG1gen,d.pG1zero=c.modules.bn128.pG1zero,d.pG1b=c.modules.bn128.pG1b,d.pG2gen=c.modules.bn128.pG2gen,d.pG2zero=c.modules.bn128.pG2zero,d.pG2b=c.modules.bn128.pG2b,d.pOneT=c.modules.bn128.pOneT,d.prePSize=c.modules.bn128.prePSize,d.preQSize=c.modules.bn128.preQSize,d.n8q=32,d.n8r=32,d.q=c.modules.bn128.q,d.r=c.modules.bn128.r;let e={name:"bn128",wasm:d,q:dz("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:dz("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:dz("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!a},f=await ej(e);return f.terminate=async function(){e.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},a||(globalThis.curve_bn128=f),f}async function el(a,b){if(!a&&globalThis.curve_bls12381)return globalThis.curve_bls12381;let c=new bb;c.setMemory(25),(0,az.buildBls12381)(c),b&&b(c);let d={};d.code=c.build(),d.pq=c.modules.f1m.pq,d.pr=c.modules.frm.pq,d.pG1gen=c.modules.bls12381.pG1gen,d.pG1zero=c.modules.bls12381.pG1zero,d.pG1b=c.modules.bls12381.pG1b,d.pG2gen=c.modules.bls12381.pG2gen,d.pG2zero=c.modules.bls12381.pG2zero,d.pG2b=c.modules.bls12381.pG2b,d.pOneT=c.modules.bls12381.pOneT,d.prePSize=c.modules.bls12381.prePSize,d.preQSize=c.modules.bls12381.preQSize,d.n8q=48,d.n8r=32,d.q=c.modules.bls12381.q,d.r=c.modules.bls12381.r;let e={name:"bls12381",wasm:d,q:dz("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:dz("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:dz("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:dz("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!a},f=await ej(e);return f.terminate=async function(){e.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},a||(globalThis.curve_bls12381=f),f}globalThis.curve_bn128=null,globalThis.curve_bls12381=null;let em=dz("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),en=dz("21888242871839275222246405745257275088548364400416034343698204186575808495617");async function eo(a,b,c){let d;if(dJ(a,en))d=await ek(b,c);else if(dJ(a,em))d=await el(b,c);else throw Error(`Curve not supported: ${a.toString(void 0)}`);return d}dz("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),dz("21888242871839275222246405745257275088696311157297823662689037894645226208583");let ep={get:function(a,b){return isNaN(b)?a[b]:a.getElement(b)},set:function(a,b,c){return isNaN(b)?(a[b]=c,!0):a.setElement(b,c)}};class eq{constructor(a){this.length=a||0,this.arr=Array(262144);for(let b=0;b<a;b+=262144)this.arr[b/262144]=Array(Math.min(262144,a-b));return this}push(){for(let a=0;a<arguments.length;a++)this.setElement(this.length,arguments[a])}slice(a,b){let c=Array(b-a);for(let d=a;d<b;d++)c[d-a]=this.getElement(d);return c}getElement(a){let b=Math.floor((a=parseInt(a))/262144),c=a%262144;return this.arr[b]?this.arr[b][c]:void 0}setElement(a,b){let c=Math.floor((a=parseInt(a))/262144);this.arr[c]||(this.arr[c]=Array(262144));let d=a%262144;return this.arr[c][d]=b,a>=this.length&&(this.length=a+1),!0}getKeys(){let a=new er;for(let b=0;b<this.arr.length;b++)if(this.arr[b])for(let c=0;c<this.arr[b].length;c++)void 0!==this.arr[b][c]&&a.push(262144*b+c);return a}}class er{constructor(a){return new Proxy(new eq(a),ep)}}async function es(a,b,c){let d;d="object"==typeof c?c:void 0===c?{singleThread:!1}:{singleThread:c};let e={};if(await by(a,b,1),e.n8=await a.readULE32(),e.prime=await bB(a,e.n8),d.F){if(d.F.p!=e.prime)throw Error("Different Prime");e.F=d.F}else if(d.getFieldFromPrime)e.F=await d.getFieldFromPrime(e.prime,d.singleThread);else if(d.getCurveFromPrime)e.curve=await d.getCurveFromPrime(e.prime,d.singleThread),e.F=e.curve.Fr;else try{e.curve=await eo(e.prime,d.singleThread),e.F=e.curve.Fr}catch(a){e.F=new d_(e.prime)}return e.nVars=await a.readULE32(),e.nOutputs=await a.readULE32(),e.nPubInputs=await a.readULE32(),e.nPrvInputs=await a.readULE32(),e.nLabels=await a.readULE64(),e.nConstraints=await a.readULE32(),e.useCustomGates=void 0!==b[4]&&null!==b[4]&&void 0!==b[5]&&null!==b[5],await bz(a),e}async function et(a,b,c,d,e){let f,g;f="object"==typeof d?d:void 0===d?{}:{logger:d,loggerCtx:e};let h=await bD(a,b,2),i=0;g=c.nConstraints>1048576?new er:[];for(let a=0;a<c.nConstraints;a++){f.logger&&a%1e5==0&&f.logger.info(`${f.loggerCtx}: Loading constraints: ${a}/${c.nConstraints}`);let b=function(){let a=[];return a[0]=j(),a[1]=j(),a[2]=j(),a}();g.push(b)}return g;function j(){let a={},b=h.slice(i,i+4);i+=4;let d=new DataView(b.buffer).getUint32(0,!0),e=h.slice(i,i+(4+c.n8)*d);i+=(4+c.n8)*d;let f=new DataView(e.buffer);for(let b=0;b<d;b++){let d=f.getUint32(b*(4+c.n8),!0),g=c.F.fromRprLE(e,b*(4+c.n8)+4);a[d]=g}return a}}async function eu(a,b,c,d,e){let f,g;f="object"==typeof d?d:void 0===d?{}:{logger:d,loggerCtx:e};let h=await bD(a,b,3),i=0;g=c.nVars>1048576?new er:[];for(let a=0;a<c.nVars;a++){f.logger&&a%1e4==0&&f.logger.info(`${f.loggerCtx}: Loading map: ${a}/${c.nVars}`);let b=function(){let a=h.slice(i,i+8);i+=8;let b=new DataView(a.buffer),c=b.getUint32(0,!0);return 0x100000000*b.getUint32(4,!0)+c}();g.push(b)}return g}async function ev(a,b,c){if("object"!=typeof c)throw Error("readR1csFd: options must be an object");c.loadConstraints=!("loadConstraints"in c)||c.loadConstraints,c.loadMap="loadMap"in c&&c.loadMap,c.loadCustomGates=!("loadCustomGates"in c)||c.loadCustomGates;let d=await es(a,b,c);return c.loadConstraints&&(d.constraints=await et(a,b,d,c)),c.loadMap&&(d.map=await eu(a,b,d,c)),c.loadCustomGates&&(d.useCustomGates?(d.customGates=await ex(a,b,d),d.customGatesUses=await ey(a,b,c)):(d.customGates=[],d.customGatesUses=[])),d}async function ew(a,b,c,d,e,f){let{fd:g,sections:h}=await bu(a,"r1cs",1,0x2000000,4194304),i=await ev(g,h,"object"==typeof b?b:void 0===b?{loadConstraints:!0,loadMap:!1,loadCustomGates:!0}:{loadConstraints:b,loadMap:c,singleThread:d,logger:e,loggerCtx:f});return await g.close(),i}async function ex(a,b,c){await by(a,b,4);let d=await a.readULE32(),e=[];for(let b=0;b<d;b++){let b={};b.templateName=await a.readString();let d=await a.readULE32();b.parameters=Array(d);let f=await a.read(c.n8*d);for(let a=0;a<d;a++)b.parameters[a]=c.F.fromRprLE(f,a*c.n8,c.n8);e.push(b)}return await bz(a),e}async function ey(a,b,c){let d,e=await bD(a,b,5),f=new Uint32Array(e.buffer,e.byteOffset,e.byteLength/4),g=f[0],h=1;d=g>1048576?new er:[];for(let a=0;a<g;a++){c.logger&&a%1e5==0&&c.logger.info(`${c.loggerCtx}: Loading custom gate uses: ${a}/${g}`);let b={};b.id=f[h++];let e=f[h++];b.signals=[];for(let a=0;a<e;a++){let a=f[h++],c=f[h++];b.signals.push(0x100000000*c+a)}d.push(b)}return d}let ez=l.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),eA=l.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");async function eB(a,b){let c=await ew(a);return l.eq(c.prime,eA)?b&&b.info("Curve: bn-128"):l.eq(c.prime,ez)?b&&b.info("Curve: bls12-381"):b&&b.info(`Unknown Curve. Prime: ${l.toString(c.prime)}`),b&&b.info(`# of Wires: ${c.nVars}`),b&&b.info(`# of Constraints: ${c.nConstraints}`),b&&b.info(`# of Private Inputs: ${c.nPrvInputs}`),b&&b.info(`# of Public Inputs: ${c.nPubInputs}`),b&&b.info(`# of Labels: ${c.nLabels}`),b&&b.info(`# of Outputs: ${c.nOutputs}`),c}async function eC(a,b){let c=await ew(a,!0,!0,!0,b),d=c.curve.Fr;return delete c.curve,delete c.F,cr(d,c)}async function eD(a){let b={labelIdx2Name:["one"],varIdx2Name:["one"],componentIdx2Name:[]},c=await bt(a),d=await c.read(c.totalSize),e=new TextDecoder("utf-8").decode(d).split("\n");for(let a=0;a<e.length;a++){let c=e[a].split(",");4==c.length&&(b.varIdx2Name[c[1]]?b.varIdx2Name[c[1]]+="|"+c[3]:b.varIdx2Name[c[1]]=c[3],b.labelIdx2Name[c[0]]=c[3],b.componentIdx2Name[c[2]]||(b.componentIdx2Name[c[2]]=function(a){let b=a.split(".");return b.pop(),b.join(".")}(c[3])))}return await c.close(),b}let{unstringifyBigInts:eE}=m;async function eF(a,b,c,d,e,f){let g=eE(a),h=await bt(b),i=await h.read(h.totalSize);await h.close();let j={...e,sanityCheck:!0},k=await eD(d);e.set&&(k||(k=await eD(d)),j.logSetSignal=function(a,b){f&&f.info("SET "+k.labelIdx2Name[a]+" <-- "+b.toString())}),e.get&&(k||(k=await eD(d)),j.logGetSignal=function(a,b){f&&f.info("GET "+k.labelIdx2Name[a]+" --\x3e "+b.toString())}),e.trigger&&(k||(k=await eD(d)),j.logStartComponent=function(a){f&&f.info("START: "+k.componentIdx2Name[a])},j.logFinishComponent=function(a){f&&f.info("FINISH: "+k.componentIdx2Name[a])}),j.sym=k;let l=await cS(i,j),m=await l.calculateWitness(g,!0),n=await bv(c,"wtns",2,2);await cI(n,m,l.prime),await n.close()}async function eG(a){return await cL(a)}async function eH(a,b,c){c&&c.info("WITNESS CHECKING STARTED"),c&&c.info("> Reading r1cs file");let{fd:d,sections:e}=await bu(a,"r1cs",1,4194304,0x1000000),f=await ev(d,e,{loadConstraints:!1,loadCustomGates:!1});c&&c.info("> Reading witness file");let{fd:g,sections:h}=await bu(b,"wtns",2,4194304,0x1000000),i=await cK(g,h);if(!l.eq(f.prime,i.q))throw Error("Curve of the witness does not match the curve of the proving key");let j=await bD(g,h,2);await g.close();let k=(await bJ(f.prime)).Fr,m=k.n8,n=await bD(d,e,2);c&&(c.info("----------------------------"),c.info("  WITNESS CHECK"),c.info(`  Curve:          ${f.curve.name}`),c.info(`  Vars (wires):   ${f.nVars}`),c.info(`  Outputs:        ${f.nOutputs}`),c.info(`  Public Inputs:  ${f.nPubInputs}`),c.info(`  Private Inputs: ${f.nPrvInputs}`),c.info(`  Labels:         ${f.nLabels}`),c.info(`  Constraints:    ${f.nConstraints}`),c.info(`  Custom Gates:   ${f.useCustomGates}`),c.info("----------------------------")),c&&c.info("> Checking witness correctness");let o=0,p=!0;for(let a=0;a<f.nConstraints;a++){c&&0!==a&&a%5e5==0&&c.info(`\xb7\xb7\xb7 processing r1cs constraints ${a}/${f.nConstraints}`);let b=r(),d=r(),e=r(),g=q(b),h=q(d),i=q(e);if(!k.eq(k.sub(k.mul(g,h),i),k.zero)){c.warn("\xb7\xb7\xb7 aborting checking process at constraint "+a),p=!1;break}}return d.close(),c&&(p?(c.info("WITNESS IS CORRECT"),c.info("WITNESS CHECKING FINISHED SUCCESSFULLY")):(c.warn("WITNESS IS NOT CORRECT"),c.warn("WITNESS CHECKING FINISHED UNSUCCESSFULLY"))),p;function q(a){let b=k.zero;return Object.keys(a).forEach(c=>{var d;let e=(d=c,k.fromRprLE(j.slice(d*m,d*m+m))),f=a[c];b=k.add(b,k.mul(e,f))}),b}function r(){let a={},b=n.slice(o,o+4);o+=4;let c=new DataView(b.buffer).getUint32(0,!0),d=n.slice(o,o+(4+f.n8)*c);o+=(4+f.n8)*c;let e=new DataView(d.buffer);for(let b=0;b<c;b++){let c=e.getUint32(b*(4+f.n8),!0),g=f.F.fromRprLE(d,b*(4+f.n8)+4);a[c]=g}return a}}let eI={get:function(a,b){return isNaN(b)?a[b]:a.getElement(b)},set:function(a,b,c){return isNaN(b)?(a[b]=c,!0):a.setElement(b,c)}};class eJ{constructor(a){this.length=a||0,this.arr=Array(262144);for(let b=0;b<a;b+=262144)this.arr[b/262144]=Array(Math.min(262144,a-b));return this}push(){for(let a=0;a<arguments.length;a++)this.setElement(this.length,arguments[a])}slice(a,b){let c=Array(b-a);for(let d=a;d<b;d++)c[d-a]=this.getElement(d);return c}getElement(a){let b=Math.floor((a=parseInt(a))/262144),c=a%262144;return this.arr[b]?this.arr[b][c]:void 0}setElement(a,b){let c=Math.floor((a=parseInt(a))/262144);this.arr[c]||(this.arr[c]=Array(262144));let d=a%262144;return this.arr[c][d]=b,a>=this.length&&(this.length=a+1),!0}getKeys(){let a=new eK;for(let b=0;b<this.arr.length;b++)if(this.arr[b])for(let c=0;c<this.arr[b].length;c++)void 0!==this.arr[b][c]&&a.push(262144*b+c);return a}}class eK{constructor(a){return new Proxy(new eJ(a),eI)}}async function eL(a,b,c,d){let e,f,g,h=cb.create({dkLen:64}),{fd:i,sections:j}=await bu(b,"ptau",1,4194304,0x1000000),{curve:k,power:m}=await c7(i,j),{fd:n,sections:o}=await bu(a,"r1cs",1,4194304,0x1000000),p=await es(n,o,!1),q=await bv(c,"zkey",1,10,4194304,0x1000000),r=2*k.G1.F.n8,s=2*k.G2.F.n8;if(p.prime!=k.r)return d&&d.error("r1cs curve does not match powers of tau ceremony curve"),-1;let t=ce(p.nConstraints+p.nPubInputs+p.nOutputs+1-1)+1;if(t>m)return d&&d.error(`circuit too big for this power of tau ceremony. ${p.nConstraints}*2 > 2**${m}`),-1;if(!j[12])return d&&d.error("Powers of tau is not prepared."),-1;let u=p.nOutputs+p.nPubInputs,v=2**t;await bw(q,1),await q.writeULE32(1),await bx(q),await bw(q,2);let w=k.q,x=(Math.floor((l.bitLength(w)-1)/64)+1)*8,y=k.r,z=(Math.floor((l.bitLength(y)-1)/64)+1)*8,A=l.mod(l.shl(1,8*z),y),B=k.Fr.e(l.mod(l.mul(A,A),y));await q.writeULE32(x),await bA(q,w,x),await q.writeULE32(z),await bA(q,y,z),await q.writeULE32(p.nVars),await q.writeULE32(u),await q.writeULE32(v),e=await i.read(r,j[4][0].p),await q.write(e),e=await k.G1.batchLEMtoU(e),h.update(e),f=await i.read(r,j[5][0].p),await q.write(f),f=await k.G1.batchLEMtoU(f),h.update(f),g=await i.read(s,j[6][0].p),await q.write(g),g=await k.G2.batchLEMtoU(g),h.update(g);let C=new Uint8Array(r);k.G1.toRprLEM(C,0,k.G1.g);let D=new Uint8Array(s);k.G2.toRprLEM(D,0,k.G2.g);let E=new Uint8Array(r);k.G1.toRprUncompressed(E,0,k.G1.g);let F=new Uint8Array(s);k.G2.toRprUncompressed(F,0,k.G2.g),await q.write(D),await q.write(C),await q.write(D),h.update(F),h.update(E),h.update(F),await bx(q),d&&d.info("Reading r1cs");let G=await bD(n,o,2),H=new eK(p.nVars),I=new eK(p.nVars),J=new eK(p.nVars),K=new eK(p.nVars-u-1),L=Array(u+1);d&&d.info("Reading tauG1");let M=await bD(i,j,12,(v-1)*r,v*r);d&&d.info("Reading tauG2");let N=await bD(i,j,13,(v-1)*s,v*s);d&&d.info("Reading alphatauG1");let O=await bD(i,j,14,(v-1)*r,v*r);d&&d.info("Reading betatauG1");let P=await bD(i,j,15,(v-1)*r,v*r);await S(),await T(3,"G1",L,"IC"),await R(),await V(),await T(8,"G1",K,"C"),await T(5,"G1",H,"A"),await T(6,"G1",I,"B1"),await T(7,"G2",J,"B2");let Q=h.digest();return await bw(q,10),await q.write(Q),await q.writeULE32(0),await bx(q),d&&d.info(cf(Q,"Circuit hash: ")),await q.close(),await n.close(),await i.close(),Q;async function R(){await bw(q,9);let a=new aK(v*r);if(t<k.Fr.s){let b=await bD(i,j,12,(2*v-1)*r,2*v*r);for(let c=0;c<v;c++){d&&c%1e4==0&&d.debug(`splitting buffer: ${c}/${v}`);let e=b.slice((2*c+1)*r,(2*c+1)*r+r);a.set(e,c*r)}}else if(t==k.Fr.s){let b=j[12][0].p+(2**(t+1)-1)*r;await i.readToBuffer(a,0,v*r,b+v*r)}else throw d&&d.error("Circuit too big"),Error("Circuit too big for this curve");await q.write(a),await bx(q)}async function S(){let a=new Uint8Array(12+k.Fr.n8),b=new DataView(a.buffer),c=new Uint8Array(k.Fr.n8);k.Fr.toRprLE(c,0,k.Fr.e(1));let e=0;function f(){let a=G.slice(e,e+4);return e+=4,new DataView(a.buffer).getUint32(0,!0)}let g=new eK;for(let a=0;a<p.nConstraints;a++){d&&a%1e4==0&&d.debug(`processing constraints: ${a}/${p.nConstraints}`);let b=f();for(let c=0;c<b;c++){let b=f(),c=e;e+=k.Fr.n8;let d=r*a,h=r*a;void 0===H[b]&&(H[b]=[]),H[b].push([0,d,c]),b<=u?(void 0===L[b]&&(L[b]=[]),L[b].push([3,h,c])):(void 0===K[b-u-1]&&(K[b-u-1]=[]),K[b-u-1].push([3,h,c])),g.push([0,a,b,c])}let c=f();for(let b=0;b<c;b++){let b=f(),c=e;e+=k.Fr.n8;let d=r*a,h=s*a,i=r*a;void 0===I[b]&&(I[b]=[]),I[b].push([0,d,c]),void 0===J[b]&&(J[b]=[]),J[b].push([1,h,c]),b<=u?(void 0===L[b]&&(L[b]=[]),L[b].push([2,i,c])):(void 0===K[b-u-1]&&(K[b-u-1]=[]),K[b-u-1].push([2,i,c])),g.push([1,a,b,c])}let h=f();for(let b=0;b<h;b++){let b=f(),c=e;e+=k.Fr.n8;let d=r*a;b<=u?(void 0===L[b]&&(L[b]=[]),L[b].push([0,d,c])):(void 0===K[b-u-1]&&(K[b-u-1]=[]),K[b-u-1].push([0,d,c]))}}for(let a=0;a<=u;a++){let b=r*(p.nConstraints+a),c=r*(p.nConstraints+a);void 0===H[a]&&(H[a]=[]),H[a].push([0,b,-1]),void 0===L[a]&&(L[a]=[]),L[a].push([3,c,-1]),g.push([0,p.nConstraints+a,a,-1])}await bw(q,4);let h=new aK(g.length*(12+k.Fr.n8)+4),i=new Uint8Array(4);new DataView(i.buffer).setUint32(0,g.length,!0),h.set(i);let j=4;for(let e=0;e<g.length;e++)d&&e%1e5==0&&d.debug(`writing coeffs: ${e}/${g.length}`),function(d){let e;b.setUint32(0,d[0],!0),b.setUint32(4,d[1],!0),b.setUint32(8,d[2],!0),e=d[3]>=0?k.Fr.fromRprLE(G.slice(d[3],d[3]+k.Fr.n8),0):k.Fr.fromRprLE(c,0);let f=k.Fr.mul(e,B);k.Fr.toRprLE(a,12,f),h.set(a,j),j+=a.length}(g[e]);await q.write(h),await bx(q)}async function T(a,b,c,e){let f=k[b];Y(c.length),await bw(q,a);let g=[],i=0;for(;i<c.length;){let a=0;for(;i<c.length&&a<k.tm.concurrency;){d&&d.debug(`Writing points start ${e}: ${i}/${c.length}`);let f=1,h=c[i]?c[i].length:0;for(;i+f<c.length&&h+(c[i+f]?c[i+f].length:0)<32768&&f<32768;)h+=c[i+f]?c[i+f].length:0,f++;let j=c.slice(i,i+f),k=i;g.push(U(b,j,d,e).then(a=>(d&&d.debug(`Writing points end ${e}: ${k}/${c.length}`),a))),i+=f,a++}let j=await Promise.all(g);for(let a=0;a<j.length;a++){await q.write(j[a][0]);let b=await f.batchLEMtoU(j[a][0]);h.update(b)}g=[]}await bx(q)}async function U(a,b,c,d){let e,f,g,h,i,j,l=k[a],m=2*l.F.n8,n=3*l.F.n8,o=2*l.F.n8;if("G1"==a)e="g1m_timesScalarAffine",f="g1m_multiexpAffine",g="g1m_batchToAffine",h="g1m_zero";else if("G2"==a)e="g2m_timesScalarAffine",f="g2m_multiexpAffine",g="g2m_batchToAffine",h="g2m_zero";else throw Error("Invalid group");let p=0;for(let a=0;a<b.length;a++)p+=b[a]?b[a].length:0;p>32768?(i=new aK(p*m),j=new aK(p*k.Fr.n8)):(i=new Uint8Array(p*m),j=new Uint8Array(p*k.Fr.n8));let q=0,r=0,s=[M,N,O,P],t=new Uint8Array(k.Fr.n8);k.Fr.toRprLE(t,0,k.Fr.e(1));let u=0;for(let a=0;a<b.length;a++)if(b[a])for(let e=0;e<b[a].length;e++)c&&e&&e%1e4==0&&c.debug(`Configuring big array ${d}: ${e}/${b[a].length}`),i.set(s[b[a][e][0]].slice(b[a][e][1],b[a][e][1]+m),u*m),b[a][e][2]>=0?j.set(G.slice(b[a][e][2],b[a][e][2]+k.Fr.n8),u*k.Fr.n8):j.set(t,u*k.Fr.n8),u++;if(b.length>1){let a=[];a.push({cmd:"ALLOCSET",var:0,buff:i}),a.push({cmd:"ALLOCSET",var:1,buff:j}),a.push({cmd:"ALLOC",var:2,len:b.length*n}),q=0,r=0;let c=0;for(let d=0;d<b.length;d++){if(!b[d]){a.push({cmd:"CALL",fnName:h,params:[{var:2,offset:c}]}),c+=n;continue}1==b[d].length?a.push({cmd:"CALL",fnName:e,params:[{var:0,offset:q},{var:1,offset:r},{val:k.Fr.n8},{var:2,offset:c}]}):a.push({cmd:"CALL",fnName:f,params:[{var:0,offset:q},{var:1,offset:r},{val:k.Fr.n8},{val:b[d].length},{var:2,offset:c}]}),q+=m*b[d].length,r+=k.Fr.n8*b[d].length,c+=n}return a.push({cmd:"CALL",fnName:g,params:[{var:2},{val:b.length},{var:2}]}),a.push({cmd:"GET",out:0,var:2,len:b.length*o}),await k.tm.queueAction(a)}{let a=await l.multiExpAffine(i,j,c,d);return[l.toAffine(a)]}}async function V(){Y(v-1);for(let a=0;a<v-1;a+=16384){d&&d.debug(`HashingHPoints: ${a}/${v}`);let b=Math.min(v-1,16384);await W(a,b)}}async function W(a,b){let c=await i.read(b*r,j[2][0].p+(a+v)*r),d=await i.read(b*r,j[2][0].p+a*r),e=k.tm.concurrency,f=Math.floor(b/e),g=[];for(let a=0;a<e;a++){let h;if(0==(h=a<e-1?f:b-a*f))continue;let i=c.slice(a*f*r,(a*f+h)*r),j=d.slice(a*f*r,(a*f+h)*r);g.push(X(i,j))}let l=await Promise.all(g);for(let a=0;a<l.length;a++)h.update(l[a][0])}async function X(a,b){let c=a.byteLength/r,d=3*k.G1.F.n8,e=[];e.push({cmd:"ALLOCSET",var:0,buff:a}),e.push({cmd:"ALLOCSET",var:1,buff:b}),e.push({cmd:"ALLOC",var:2,len:c*d});for(let a=0;a<c;a++)e.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:a*r},{var:1,offset:a*r},{var:2,offset:a*d}]});return e.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:c},{var:2}]}),e.push({cmd:"CALL",fnName:"g1m_batchLEMtoU",params:[{var:2},{val:c},{var:2}]}),e.push({cmd:"GET",out:0,var:2,len:c*r}),await k.tm.queueAction(e)}function Y(a){let b=new Uint8Array(4);new DataView(b.buffer,b.byteOffset,b.byteLength).setUint32(0,a,!1),h.update(b)}}async function eM(a,b,c){let d,e,f,g,h,i,{fd:j,sections:k}=await bu(a,"zkey",2),l=await cx(j,k);if("groth16"!=l.protocol)throw Error("zkey file is not groth16");let m=await bK(l.q),n=2*m.G1.F.n8,o=2*m.G2.F.n8,p=await cD(j,m,k),q=await bs(b);await s(l.vk_alpha_1),await s(l.vk_beta_1),await t(l.vk_beta_2),await t(l.vk_gamma_2),await s(l.vk_delta_1),await t(l.vk_delta_2),d=await bD(j,k,3),d=await m.G1.batchLEMtoU(d),await u("G1",d);let r=await bD(j,k,9);e=await m.G1.fft(r,"affine","jacobian",c),e=(e=await m.G1.batchApplyKey(e,m.Fr.neg(m.Fr.e(2)),m.Fr.w[l.power+1],"jacobian","affine",c)).slice(0,e.byteLength-n),e=await m.G1.batchLEMtoU(e),await u("G1",e),f=await bD(j,k,8),f=await m.G1.batchLEMtoU(f),await u("G1",f),g=await bD(j,k,5),g=await m.G1.batchLEMtoU(g),await u("G1",g),h=await bD(j,k,6),h=await m.G1.batchLEMtoU(h),await u("G1",h),i=await bD(j,k,7),i=await m.G2.batchLEMtoU(i),await u("G2",i),await q.write(p.csHash),await v(p.contributions.length);for(let a=0;a<p.contributions.length;a++){let b=p.contributions[a];await s(b.deltaAfter),await s(b.delta.g1_s),await s(b.delta.g1_sx),await t(b.delta.g2_spx),await q.write(b.transcript)}async function s(a){let b=new Uint8Array(n);m.G1.toRprUncompressed(b,0,a),await q.write(b)}async function t(a){let b=new Uint8Array(o);m.G2.toRprUncompressed(b,0,a),await q.write(b)}async function u(a,b){let c;c="G1"==a?n:o;let d=new Uint8Array(4);new DataView(d.buffer,d.byteOffset,d.byteLength).setUint32(0,b.byteLength/c,!1),await q.write(d),await q.write(b)}async function v(a){let b=new Uint8Array(4);new DataView(b.buffer,b.byteOffset,b.byteLength).setUint32(0,a,!1),await q.write(b)}await j.close(),await q.close()}async function eN(a,b,c,d,e){let f,g,{fd:h,sections:i}=await bu(a,"zkey",2),j=await cx(h,i,!1);if("groth16"!=j.protocol)throw Error("zkey file is not groth16");let k=await bK(j.q),l=2*k.G1.F.n8,m=2*k.G2.F.n8,n=await cD(h,k,i),o={},p=await bt(b);p.pos=3*l+3*m+8+l*j.nVars+4+l*(j.domainSize-1)+4+l*j.nVars+4+l*j.nVars+4+m*j.nVars,o.csHash=await p.read(64);let q=await p.readUBE32();o.contributions=[];for(let a=0;a<q;a++){let b={delta:{}};b.deltaAfter=await y(p),b.delta.g1_s=await y(p),b.delta.g1_sx=await y(p),b.delta.g2_spx=await z(p),b.transcript=await p.read(64),a<n.contributions.length&&(b.type=n.contributions[a].type,1==b.type&&(b.beaconHash=n.contributions[a].beaconHash,b.numIterationsExp=n.contributions[a].numIterationsExp),n.contributions[a].name&&(b.name=n.contributions[a].name)),o.contributions.push(b)}if(!cg(o.csHash,n.csHash))return e&&e.error("Hash of the original circuit does not match with the MPC one"),!1;if(n.contributions.length>o.contributions.length)return e&&e.error("The impoerted file does not include new contributions"),!1;for(let a=0;a<n.contributions.length;a++){var r,s;if(r=n.contributions[a],s=o.contributions[a],!(k.G1.eq(r.deltaAfter,s.deltaAfter)&&k.G1.eq(r.delta.g1_s,s.delta.g1_s)&&k.G1.eq(r.delta.g1_sx,s.delta.g1_sx)&&k.G2.eq(r.delta.g2_spx,s.delta.g2_spx)&&cg(r.transcript,s.transcript)))return e&&e.error(`Previous contribution ${a} does not match`),!1}if(d)for(let a=n.contributions.length;a<o.contributions.length;a++)o.contributions[a].name=d;let t=await bv(c,"zkey",1,10);if(p.pos=0,p.pos+=l,p.pos+=l,p.pos+=m,p.pos+=m,j.vk_delta_1=await y(p),j.vk_delta_2=await z(p),await cs(t,j),await p.readUBE32()!=j.nPublic+1)return e&&e.error("Invalid number of points in IC"),await t.discard(),!1;if(p.pos+=l*(j.nPublic+1),await bC(h,i,t,3),await bC(h,i,t,4),await p.readUBE32()!=j.domainSize-1)return e&&e.error("Invalid number of points in H"),await t.discard(),!1;let u=await p.read(l*(j.domainSize-1)),v=await k.G1.batchUtoLEM(u);(f=new Uint8Array(j.domainSize*l)).set(v),k.G1.toRprLEM(f,l*(j.domainSize-1),k.G1.zeroAffine);let w=k.Fr.neg(k.Fr.inv(k.Fr.e(2))),x=k.Fr.inv(k.Fr.w[j.power+1]);if(f=await k.G1.batchApplyKey(f,w,x,"affine","jacobian",e),f=await k.G1.ifft(f,"jacobian","affine",e),await bw(t,9),await t.write(f),await bx(t),await p.readUBE32()!=j.nVars-j.nPublic-1)return e&&e.error("Invalid number of points in L"),await t.discard(),!1;if(g=await p.read(l*(j.nVars-j.nPublic-1)),g=await k.G1.batchUtoLEM(g),await bw(t,8),await t.write(g),await bx(t),await p.readUBE32()!=j.nVars)return e&&e.error("Invalid number of points in A"),await t.discard(),!1;if(p.pos+=l*j.nVars,await bC(h,i,t,5),await p.readUBE32()!=j.nVars)return e&&e.error("Invalid number of points in B1"),await t.discard(),!1;if(p.pos+=l*j.nVars,await bC(h,i,t,6),await p.readUBE32()!=j.nVars)return e&&e.error("Invalid number of points in B2"),await t.discard(),!1;return p.pos+=m*j.nVars,await bC(h,i,t,7),await cF(t,k,o),await p.close(),await t.close(),await h.close(),!0;async function y(a){let b=await a.read(2*k.G1.F.n8);return k.G1.fromRprUncompressed(b,0)}async function z(a){let b=await a.read(2*k.G2.F.n8);return k.G2.fromRprUncompressed(b,0)}}async function eO(a,b,c,d){let{fd:e,sections:f}=await bu(c,"zkey",2),g=await cx(e,f,!1);if("groth16"!=g.protocol)throw Error("zkey file is not groth16");let h=await bK(g.q),i=2*h.G1.F.n8,j=await cD(e,h,f),k=cb.create({dkLen:64});k.update(j.csHash);let m=h.G1.g;for(let a=0;a<j.contributions.length;a++){let b=j.contributions[a],c=k.clone();if(cG(c,h,b.delta.g1_s),cG(c,h,b.delta.g1_sx),!cg(c.digest(),b.transcript))return console.log(`INVALID(${a}): Inconsistent transcript `),!1;let d=c2(h,b.transcript);if(!0!==await cj(h,b.delta.g1_s,b.delta.g1_sx,d,b.delta.g2_spx))return console.log(`INVALID(${a}): public key G1 and G2 do not have the same ration `),!1;if(!0!==await cj(h,m,b.deltaAfter,d,b.delta.g2_spx))return console.log(`INVALID(${a}): deltaAfter does not fillow the public key `),!1;if(1==b.type){let c=await co(b.beaconHash,b.numIterationsExp),d=h.Fr.fromRng(c),e=h.G1.toAffine(h.G1.fromRng(c)),f=h.G1.toAffine(h.G1.timesFr(e,d));if(!0!==h.G1.eq(e,b.delta.g1_s))return console.log(`INVALID(${a}): Key of the beacon does not match. g1_s `),!1;if(!0!==h.G1.eq(f,b.delta.g1_sx))return console.log(`INVALID(${a}): Key of the beacon does not match. g1_sx `),!1}cH(k,h,b);let e=cb.create({dkLen:64});cH(e,h,b),b.contributionHash=e.digest(),m=b.deltaAfter}let{fd:n,sections:o}=await bu(a,"zkey",2),p=await cx(n,o,!1);if("groth16"!=p.protocol)throw Error("zkeyinit file is not groth16");if(!l.eq(p.q,g.q)||!l.eq(p.r,g.r)||p.n8q!=g.n8q||p.n8r!=g.n8r)return d&&d.error("INVALID:  Different curves"),!1;if(p.nVars!=g.nVars||p.nPublic!=g.nPublic||p.domainSize!=g.domainSize)return d&&d.error("INVALID:  Different circuit parameters"),!1;if(!h.G1.eq(g.vk_alpha_1,p.vk_alpha_1))return d&&d.error("INVALID:  Invalid alpha1"),!1;if(!h.G1.eq(g.vk_beta_1,p.vk_beta_1))return d&&d.error("INVALID:  Invalid beta1"),!1;if(!h.G2.eq(g.vk_beta_2,p.vk_beta_2))return d&&d.error("INVALID:  Invalid beta2"),!1;if(!h.G2.eq(g.vk_gamma_2,p.vk_gamma_2))return d&&d.error("INVALID:  Invalid gamma2"),!1;if(!h.G1.eq(g.vk_delta_1,m))return d&&d.error("INVALID:  Invalid delta1"),!1;if(!0!==await cj(h,h.G1.g,m,h.G2.g,g.vk_delta_2))return d&&d.error("INVALID:  Invalid delta2"),!1;let q=await cD(n,h,o);if(!cg(j.csHash,q.csHash))return d&&d.error("INVALID:  Circuit does not match"),!1;if(f[8][0].size!=i*(g.nVars-g.nPublic-1))return d&&d.error("INVALID:  Invalid L section size"),!1;if(f[9][0].size!=i*g.domainSize)return d&&d.error("INVALID:  Invalid H section size"),!1;if(!await bE(e,f,n,o,3))return d&&d.error("INVALID:  IC section is not identical"),!1;if(!await bE(e,f,n,o,4))return d&&d.error("Coeffs section is not identical"),!1;if(!await bE(e,f,n,o,5))return d&&d.error("A section is not identical"),!1;if(!await bE(e,f,n,o,6))return d&&d.error("B1 section is not identical"),!1;if(!await bE(e,f,n,o,7))return d&&d.error("B2 section is not identical"),!1;if(!0!==await r("G1",n,o,e,f,8,g.vk_delta_2,p.vk_delta_2,"L section"))return d&&d.error("L section does not match"),!1;if(!0!==await s())return d&&d.error("H section does not match"),!1;d&&d.info(cf(j.csHash,"Circuit Hash: ")),await e.close(),await n.close();for(let a=j.contributions.length-1;a>=0;a--){let b=j.contributions[a];d&&d.info("-------------------------"),d&&d.info(cf(b.contributionHash,`contribution #${a+1} ${b.name?b.name:""}:`)),1==b.type&&(d&&d.info(`Beacon generator: ${cq(b.beaconHash)}`),d&&d.info(`Beacon iterations Exp: ${b.numIterationsExp}`))}return d&&d.info("-------------------------"),d&&d.info("ZKey Ok!"),!0;async function r(a,b,c,e,f,g,i,j,k){let l=h[a],m=2*l.F.n8;await by(b,c,g),await by(e,f,g);let n=l.zero,o=l.zero,p=c[g][0].size/m;for(let a=0;a<p;a+=1048576){d&&d.debug(`Same ratio check ${k}:  ${a}/${p}`);let c=Math.min(p-a,1048576),f=await b.read(c*m),g=await e.read(c*m),h=ck(4*c),i=await l.multiExpAffine(f,h),j=await l.multiExpAffine(g,h);n=l.add(n,i),o=l.add(o,j)}return await bz(b),await bz(e),0==p||!0===await cj(h,n,o,i,j)}async function s(){let a,c=h.G1,i=h.Fr,j=2*c.F.n8,{fd:k,sections:l}=await bu(b,"ptau",1),m=new aK(g.domainSize*g.n8r),n=Array(8);for(let a=0;a<8;a++)n[a]=cm(ck(4),0);let o=new aq(n);for(let a=0;a<g.domainSize-1;a++){let b=i.fromRng(o);i.toRprLE(m,a*g.n8r,b)}i.toRprLE(m,(g.domainSize-1)*g.n8r,i.zero);let q=c.zero;for(let a=0;a<g.domainSize;a+=1048576){d&&d.debug(`H Verification(tau):  ${a}/${g.domainSize}`);let b=Math.min(g.domainSize-a,1048576),e=await k.read(j*b,l[2][0].p+g.domainSize*j+a*j),f=await k.read(j*b,l[2][0].p+a*j),h=await t(e,f),i=m.slice(a*g.n8r,(a+b)*g.n8r),n=await c.multiExpAffine(h,i);q=c.add(q,n)}if(m=await i.batchToMontgomery(m),g.power<i.s)a=i.neg(i.e(2));else{let b=2**i.s,c=i.exp(i.shift,b);a=i.sub(c,i.one)}let r=g.power<i.s?i.w[g.power+1]:i.shift;m=await i.batchApplyKey(m,a,r),m=await i.fft(m),m=await i.batchFromMontgomery(m),await by(e,f,9);let s=c.zero;for(let a=0;a<g.domainSize;a+=1048576){d&&d.debug(`H Verification(lagrange):  ${a}/${g.domainSize}`);let b=Math.min(g.domainSize-a,1048576),f=await e.read(j*b),h=m.slice(a*g.n8r,(a+b)*g.n8r),i=await c.multiExpAffine(f,h);s=c.add(s,i)}return await bz(e),!0===await cj(h,q,s,g.vk_delta_2,p.vk_delta_2)}async function t(a,b){let c=2*h.G1.F.n8,d=a.byteLength/c,e=h.tm.concurrency,f=Math.floor(d/e),g=[];for(let c=0;c<e;c++){let h;if(0==(h=c<e-1?f:d-c*f))continue;let j=a.slice(c*f*i,(c*f+h)*i),k=b.slice(c*f*i,(c*f+h)*i);g.push(u(j,k))}let j=await Promise.all(g),k=new Uint8Array(d*c),l=0;for(let a=0;a<j.length;a++)k.set(j[a][0],l),l+=j[a][0].byteLength;return k}async function u(a,b){let c=2*h.G1.F.n8,d=3*h.G1.F.n8,e=a.byteLength/c,f=[];f.push({cmd:"ALLOCSET",var:0,buff:a}),f.push({cmd:"ALLOCSET",var:1,buff:b}),f.push({cmd:"ALLOC",var:2,len:e*d});for(let a=0;a<e;a++)f.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:a*c},{var:1,offset:a*c},{var:2,offset:a*d}]});return f.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:e},{var:2}]}),f.push({cmd:"GET",out:0,var:2,len:e*c}),await h.tm.queueAction(f)}}async function eP(a,b,c,d){let e={type:"bigMem"};return await eL(a,b,e,d),await eO(e,b,c,d)}async function eQ(a,b,c,d,e){let{fd:f,sections:g}=await bu(a,"zkey",2),h=await cx(f,g);if("groth16"!=h.protocol)throw Error("zkey file is not groth16");let i=await bK(h.q),j=await cD(f,i,g),k=await bv(b,"zkey",1,10),l=await cn(d),m=cb.create({dkLen:64});m.update(j.csHash);for(let a=0;a<j.contributions.length;a++)cH(m,i,j.contributions[a]);let n={};n.delta={},n.delta.prvKey=i.Fr.fromRng(l),n.delta.g1_s=i.G1.toAffine(i.G1.fromRng(l)),n.delta.g1_sx=i.G1.toAffine(i.G1.timesFr(n.delta.g1_s,n.delta.prvKey)),cG(m,i,n.delta.g1_s),cG(m,i,n.delta.g1_sx),n.transcript=m.digest(),n.delta.g2_sp=c2(i,n.transcript),n.delta.g2_spx=i.G2.toAffine(i.G2.timesFr(n.delta.g2_sp,n.delta.prvKey)),h.vk_delta_1=i.G1.timesFr(h.vk_delta_1,n.delta.prvKey),h.vk_delta_2=i.G2.timesFr(h.vk_delta_2,n.delta.prvKey),n.deltaAfter=h.vk_delta_1,n.type=0,c&&(n.name=c),j.contributions.push(n),await cs(k,h),await bC(f,g,k,3),await bC(f,g,k,4),await bC(f,g,k,5),await bC(f,g,k,6),await bC(f,g,k,7);let o=i.Fr.inv(n.delta.prvKey);await dn(f,g,k,8,i,"G1",o,i.Fr.e(1),"L Section",e),await dn(f,g,k,9,i,"G1",o,i.Fr.e(1),"H Section",e),await cF(k,i,j),await f.close(),await k.close();let p=cb.create({dkLen:64});cH(p,i,n);let q=p.digest();return e&&e.info(cf(j.csHash,"Circuit Hash: ")),e&&e.info(cf(q,"Contribution Hash: ")),q}async function eR(a,b,c,d,e,f){let g=cp(d);if(0==g.byteLength||2*g.byteLength!=d.length)return f&&f.error("Invalid Beacon Hash. (It must be a valid hexadecimal sequence)"),!1;if(g.length>=256)return f&&f.error("Maximum length of beacon hash is 255 bytes"),!1;if((e=parseInt(e))<10||e>63)return f&&f.error("Invalid numIterationsExp. (Must be between 10 and 63)"),!1;let{fd:h,sections:i}=await bu(a,"zkey",2),j=await cx(h,i);if("groth16"!=j.protocol)throw Error("zkey file is not groth16");let k=await bK(j.q),l=await cD(h,k,i),m=await bv(b,"zkey",1,10),n=await co(g,e),o=cb.create({dkLen:64});o.update(l.csHash);for(let a=0;a<l.contributions.length;a++)cH(o,k,l.contributions[a]);let p={};p.delta={},p.delta.prvKey=k.Fr.fromRng(n),p.delta.g1_s=k.G1.toAffine(k.G1.fromRng(n)),p.delta.g1_sx=k.G1.toAffine(k.G1.timesFr(p.delta.g1_s,p.delta.prvKey)),cG(o,k,p.delta.g1_s),cG(o,k,p.delta.g1_sx),p.transcript=o.digest(),p.delta.g2_sp=c2(k,p.transcript),p.delta.g2_spx=k.G2.toAffine(k.G2.timesFr(p.delta.g2_sp,p.delta.prvKey)),j.vk_delta_1=k.G1.timesFr(j.vk_delta_1,p.delta.prvKey),j.vk_delta_2=k.G2.timesFr(j.vk_delta_2,p.delta.prvKey),p.deltaAfter=j.vk_delta_1,p.type=1,p.numIterationsExp=e,p.beaconHash=g,c&&(p.name=c),l.contributions.push(p),await cs(m,j),await bC(h,i,m,3),await bC(h,i,m,4),await bC(h,i,m,5),await bC(h,i,m,6),await bC(h,i,m,7);let q=k.Fr.inv(p.delta.prvKey);await dn(h,i,m,8,k,"G1",q,k.Fr.e(1),"L Section",f),await dn(h,i,m,9,k,"G1",q,k.Fr.e(1),"H Section",f),await cF(m,k,l),await h.close(),await m.close();let r=cb.create({dkLen:64});cH(r,k,p);let s=r.digest();return f&&f.info(cf(s,"Contribution Hash: ")),s}async function eS(a){let b=await cB(a,!0);return delete b.curve,delete b.F,m.stringifyBigInts(b)}async function eT(a,b,c,d,e){let f=await cn(d),g=a.Fr.fromRng(f),h=a.Fr.inv(g),i=2*a.G1.F.n8,j=2*a.G2.F.n8,k=await bt(b),l=await bs(c);await C(i),await C(i),await C(j),await C(j);let m=await D(),n=a.G1.timesFr(m,g);await F(n);let o=await E(),p=a.G2.timesFr(o,g);await G(p);let q=await k.readUBE32();await l.writeUBE32(q),await C(q*i);let r=await k.readUBE32();await l.writeUBE32(r),await dp(k,l,null,a,"G1",r,h,a.Fr.e(1),"UNCOMPRESSED","H",e);let s=await k.readUBE32();await l.writeUBE32(s),await dp(k,l,null,a,"G1",s,h,a.Fr.e(1),"UNCOMPRESSED","L",e);let t=await k.readUBE32();await l.writeUBE32(t),await C(t*i);let u=await k.readUBE32();await l.writeUBE32(u),await C(u*i);let v=await k.readUBE32();await l.writeUBE32(v),await C(v*j);let w=cb.create({dkLen:64}),x={};x.csHash=await k.read(64),w.update(x.csHash);let y=await k.readUBE32();x.contributions=[];for(let b=0;b<y;b++){let b={delta:{}};b.deltaAfter=await D(),b.delta.g1_s=await D(),b.delta.g1_sx=await D(),b.delta.g2_spx=await E(),b.transcript=await k.read(64),x.contributions.push(b),cH(w,a,b)}let z={};z.delta={},z.delta.prvKey=g,z.delta.g1_s=a.G1.toAffine(a.G1.fromRng(f)),z.delta.g1_sx=a.G1.toAffine(a.G1.timesFr(z.delta.g1_s,g)),cG(w,a,z.delta.g1_s),cG(w,a,z.delta.g1_sx),z.transcript=w.digest(),z.delta.g2_sp=c2(a,z.transcript),z.delta.g2_spx=a.G2.toAffine(a.G2.timesFr(z.delta.g2_sp,g)),z.deltaAfter=n,z.type=0,x.contributions.push(z),await l.write(x.csHash),await l.writeUBE32(x.contributions.length);for(let a=0;a<x.contributions.length;a++){let b=x.contributions[a];await F(b.deltaAfter),await F(b.delta.g1_s),await F(b.delta.g1_sx),await G(b.delta.g2_spx),await l.write(b.transcript)}let A=cb.create({dkLen:64});cH(A,a,z);let B=A.digest();return e&&e.info(cf(B,"Contribution Hash: ")),await l.close(),await k.close(),B;async function C(a){let b=2*k.pageSize;for(let c=0;c<a;c+=b){let d=Math.min(a-c,b),e=await k.read(d);await l.write(e)}}async function D(){let b=await k.read(2*a.G1.F.n8);return a.G1.fromRprUncompressed(b,0)}async function E(){let b=await k.read(2*a.G2.F.n8);return a.G2.fromRprUncompressed(b,0)}async function F(b){let c=new Uint8Array(i);a.G1.toRprUncompressed(c,0,b),await l.write(c)}async function G(b){let c=new Uint8Array(j);a.G2.toRprUncompressed(c,0,b),await l.write(c)}}let{stringifyBigInts:eU}=m;async function eV(a,b){let c;b&&b.info("EXPORT VERIFICATION KEY STARTED");let{fd:d,sections:e}=await bu(a,"zkey",2),f=await cx(d,e);if(b&&b.info("> Detected protocol: "+f.protocol),"groth16"===f.protocol)c=await eW(f,d,e);else if("plonk"===f.protocol)c=await eX(f);else if(f.protocolId&&10===f.protocolId)c=await eY(f,b);else throw Error("zkey file protocol unrecognized");return await d.close(),b&&b.info("EXPORT VERIFICATION KEY FINISHED"),c}async function eW(a,b,c){let d=await bK(a.q),e=2*d.G1.F.n8,f=await d.pairing(a.vk_alpha_1,a.vk_beta_2),g={protocol:a.protocol,curve:d.name,nPublic:a.nPublic,vk_alpha_1:d.G1.toObject(a.vk_alpha_1),vk_beta_2:d.G2.toObject(a.vk_beta_2),vk_gamma_2:d.G2.toObject(a.vk_gamma_2),vk_delta_2:d.G2.toObject(a.vk_delta_2),vk_alphabeta_12:d.Gt.toObject(f)};await by(b,c,3),g.IC=[];for(let c=0;c<=a.nPublic;c++){let a=await b.read(e),c=d.G1.toObject(a);g.IC.push(c)}return await bz(b),g=eU(g)}async function eX(a){let b=await bK(a.q),c={protocol:a.protocol,curve:b.name,nPublic:a.nPublic,power:a.power,k1:b.Fr.toObject(a.k1),k2:b.Fr.toObject(a.k2),Qm:b.G1.toObject(a.Qm),Ql:b.G1.toObject(a.Ql),Qr:b.G1.toObject(a.Qr),Qo:b.G1.toObject(a.Qo),Qc:b.G1.toObject(a.Qc),S1:b.G1.toObject(a.S1),S2:b.G1.toObject(a.S2),S3:b.G1.toObject(a.S3),X_2:b.G2.toObject(a.X_2),w:b.Fr.toObject(b.Fr.w[a.power])};return eU(c)}async function eY(a,b){let c=await bK(a.q);return eU({protocol:a.protocol,curve:c.name,nPublic:a.nPublic,power:a.power,k1:c.Fr.toObject(a.k1),k2:c.Fr.toObject(a.k2),w:c.Fr.toObject(c.Fr.w[a.power]),w3:c.Fr.toObject(a.w3),w4:c.Fr.toObject(a.w4),w8:c.Fr.toObject(a.w8),wr:c.Fr.toObject(a.wr),X_2:c.G2.toObject(a.X_2),C0:c.G1.toObject(a.C0)})}var eZ=c(2572);let{unstringifyBigInts:e$,stringifyBigInts:e_}=m;async function e0(a,b,c){c&&c.info("FFLONK EXPORT SOLIDITY VERIFIER STARTED");let d=await bL(a.curve),e=j(a.w3);a.w3_2=k(d.Fr.square(e));let f=j(a.w4);a.w4_2=k(d.Fr.square(f)),a.w4_3=k(d.Fr.mul(d.Fr.square(f),f));let g=j(a.w8),h=d.Fr.one;for(let b=1;b<8;b++)h=d.Fr.mul(h,g),a["w8_"+b]=k(h);let i=b[a.protocol];return c&&c.info("FFLONK EXPORT SOLIDITY VERIFIER FINISHED"),eZ.render(i,a);function j(a){let b=e$(a);return d.Fr.fromObject(b)}function k(a){return e_(d.Fr.toObject(a))}}async function e1(a,b,c){let d=await eV(a,c);if("fflonk"===d.protocol)return e0(d,b,c);let e=b[d.protocol];return eZ.render(e,d)}async function e2(a,b,c,d){globalThis.gc&&globalThis.gc();let{fd:e,sections:f}=await bu(b,"ptau",1,4194304,0x1000000),{curve:g,power:h}=await c7(e,f),{fd:i,sections:j}=await bu(a,"r1cs",1,4194304,0x1000000),k=await ev(i,j,{loadConstraints:!0,loadCustomGates:!0}),m=2*g.G1.F.n8,n=g.G1,o=2*g.G2.F.n8,p=g.Fr,q=g.Fr.n8;d&&d.info("Reading r1cs"),await bD(i,j,2);let r=new eK,s=new eK,t=k.nVars,u=k.nOutputs+k.nPubInputs;await E(g.Fr,k,d),globalThis.gc&&globalThis.gc();let v=await bv(c,"zkey",1,14,4194304,0x1000000);if(k.prime!=g.r)return d&&d.error("r1cs curve does not match powers of tau ceremony curve"),-1;let w=ce(r.length-1)+1;w<3&&(w=3);let x=2**w;if(d&&d.info("Plonk constraints: "+r.length),w>h)return d&&d.error(`circuit too big for this power of tau ceremony. ${r.length} > 2**${h}`),-1;if(!f[12])return d&&d.error("Powers of tau is not prepared."),-1;let y=new aK(x*m),z=f[12][0].p+(2**w-1)*m;await e.readToBuffer(y,0,x*m,z);let[A,B]=function(){let a=p.two;for(;c(a,[],w);)p.add(a,p.one);let b=p.add(a,p.one);for(;c(b,[a],w);)p.add(b,p.one);return[a,b];function c(a,b,c){let d=2**c,e=p.one;for(let f=0;f<d;f++){if(p.eq(a,e))return!0;for(let c=0;c<b.length;c++)if(p.eq(a,p.mul(b[c],e)))return!0;e=p.mul(e,p.w[c])}return!1}}(),C={};await I(3,"Additions"),globalThis.gc&&globalThis.gc(),await F(4,0,"Amap"),globalThis.gc&&globalThis.gc(),await F(5,1,"Bmap"),globalThis.gc&&globalThis.gc(),await F(6,2,"Cmap"),globalThis.gc&&globalThis.gc(),await G(7,3,"Qm"),globalThis.gc&&globalThis.gc(),await G(8,4,"Ql"),globalThis.gc&&globalThis.gc(),await G(9,5,"Qr"),globalThis.gc&&globalThis.gc(),await G(10,6,"Qo"),globalThis.gc&&globalThis.gc(),await G(11,7,"Qc"),globalThis.gc&&globalThis.gc(),await J(12,"sigma"),globalThis.gc&&globalThis.gc(),await K(13,"lagrange polynomials"),globalThis.gc&&globalThis.gc(),await bw(v,14);let D=new aK((x+6)*m);async function E(a,b,c){function d(a){let b=Object.keys(a);for(let c=0;c<b.length;c++)0n==a[b[c]]&&delete a[b[c]]}function e(b,c,e){let f={};for(let d in b)void 0===f[d]?f[d]=a.mul(c,b[d]):f[d]=a.add(f[d],a.mul(c,b[d]));for(let b in e){let c=a.neg(e[b]);void 0===f[b]?f[b]=c:f[b]=a.add(f[b],c)}return d(f),f}function f(b,c){let d={k:a.zero,s:[],coefs:[]},e=[];for(let c in b)0==c?d.k=a.add(d.k,b[c]):0n!=b[c]&&e.push([Number(c),b[c]]);for(;e.length>c;){let b=e.shift(),c=e.shift(),d=b[0],f=c[0],g=t++,h=a.zero,i=a.neg(b[1]),j=a.neg(c[1]),k=a.one,l=a.zero;r.push([d,f,g,h,i,j,k,l]),s.push([d,f,b[1],c[1]]),e.push([g,a.one])}for(let a=0;a<e.length;a++)d.s[a]=e[a][0],d.coefs[a]=e[a][1];for(;d.coefs.length<c;)d.s.push(0),d.coefs.push(a.zero);return d}function g(b){let c=f(b,3),d=c.s[0],e=c.s[1],g=c.s[2],h=a.zero,i=c.coefs[0],j=c.coefs[1],k=c.coefs[2],l=c.k;r.push([d,e,g,h,i,j,k,l])}function h(b){let c=a.zero,d=0,e=Object.keys(b);for(let f=0;f<e.length;f++)0n==b[e[f]]?delete b[e[f]]:0==e[f]?c=a.add(c,b[e[f]]):d++;return d>0?d.toString():c!=a.zero?"k":"0"}for(let b=1;b<=u;b++){let c=b,d=a.zero,e=a.one,f=a.zero,g=a.zero,h=a.zero;r.push([c,0,0,d,e,f,g,h])}for(let i=0;i<b.constraints.length;i++)c&&i%1e4==0&&c.debug(`processing constraints: ${i}/${b.nConstraints}`),function(b,c,i){let j=h(b),k=h(c);if("0"===j||"0"===k)d(i),g(i);else if("k"===j)g(e(c,b[0],i));else if("k"===k)g(e(b,c[0],i));else{let d,e,g,h,j,k,l,m,n,o,p;d=f(b,1),e=f(c,1),g=f(i,1),h=d.s[0],j=e.s[0],k=g.s[0],l=a.mul(d.coefs[0],e.coefs[0]),m=a.mul(d.coefs[0],e.k),n=a.mul(d.k,e.coefs[0]),o=a.neg(g.coefs[0]),p=a.sub(a.mul(d.k,e.k),g.k),r.push([h,j,k,l,m,n,o,p])}}(...b.constraints[i])}async function F(a,b,c){await bw(v,a);for(let a=0;a<r.length;a++)await v.writeULE32(r[a][b]),d&&a%1e6==0&&d.debug(`writing ${c}: ${a}/${r.length}`);await bx(v)}async function G(a,b,c){let e=new aK(x*q);for(let a=0;a<r.length;a++)e.set(r[a][b],a*q),d&&a%1e6==0&&d.debug(`writing ${c}: ${a}/${r.length}`);await bw(v,a),await H(e),await bx(v),e=await p.batchFromMontgomery(e),C[c]=await g.G1.multiExpAffine(y,e,d,"multiexp "+c)}async function H(a){let b=await p.ifft(a),c=new aK(x*q*4);c.set(b,0);let d=await p.fft(c);await v.write(b),await v.write(d)}async function I(a,b){await bw(v,a);let c=new Uint8Array(8+2*q),e=new DataView(c.buffer);for(let a=0;a<s.length;a++){let f=s[a],g=0;e.setUint32(g,f[0],!0),g+=4,e.setUint32(g,f[1],!0),g+=4,c.set(f[2],g),g+=q,c.set(f[3],g),g+=q,await v.write(c),d&&a%1e6==0&&d.debug(`writing ${b}: ${a}/${s.length}`)}await bx(v)}async function J(a,b){let c=new aK(q*x*3),e=new eK(t),f=new eK(t),h=p.one;for(let a=0;a<x;a++)a<r.length?(l(r[a][0],a),l(r[a][1],x+a),l(r[a][2],2*x+a)):(l(0,a),l(0,x+a),l(0,2*x+a)),h=p.mul(h,p.w[w]),d&&a%1e6==0&&d.debug(`writing ${b} phase1: ${a}/${r.length}`);for(let a=0;a<t;a++)void 0!==f[a]?c.set(e[a],f[a]*q):console.log("Variable not used"),d&&a%1e6==0&&d.debug(`writing ${b} phase2: ${a}/${t}`);globalThis.gc&&globalThis.gc(),await bw(v,a);let i=c.slice(0,x*q);await H(i),globalThis.gc&&globalThis.gc();let j=c.slice(x*q,x*q*2);await H(j),globalThis.gc&&globalThis.gc();let k=c.slice(x*q*2,x*q*3);function l(a,b){let d;void 0===e[a]?f[a]=b:c.set(e[a],b*q),d=b<x?h:b<2*x?p.mul(h,A):p.mul(h,B),e[a]=d}await H(k),globalThis.gc&&globalThis.gc(),await bx(v),i=await p.batchFromMontgomery(i),j=await p.batchFromMontgomery(j),k=await p.batchFromMontgomery(k),C.S1=await g.G1.multiExpAffine(y,i,d,"multiexp S1"),globalThis.gc&&globalThis.gc(),C.S2=await g.G1.multiExpAffine(y,j,d,"multiexp S2"),globalThis.gc&&globalThis.gc(),C.S3=await g.G1.multiExpAffine(y,k,d,"multiexp S3"),globalThis.gc&&globalThis.gc()}async function K(a,b){await bw(v,a);let c=Math.max(u,1);for(let a=0;a<c;a++){let e=new aK(x*q);e.set(p.one,a*q),await H(e),d&&d.debug(`writing ${b} ${a}/${c}`)}await bx(v)}async function L(){let a;await bw(v,1),await v.writeULE32(2),await bx(v),await bw(v,2);let b=g.q,c=(Math.floor((l.bitLength(b)-1)/64)+1)*8,d=g.r,h=(Math.floor((l.bitLength(d)-1)/64)+1)*8;await v.writeULE32(c),await bA(v,b,c),await v.writeULE32(h),await bA(v,d,h),await v.writeULE32(t),await v.writeULE32(u),await v.writeULE32(x),await v.writeULE32(s.length),await v.writeULE32(r.length),await v.write(A),await v.write(B),await v.write(n.toAffine(C.Qm)),await v.write(n.toAffine(C.Ql)),await v.write(n.toAffine(C.Qr)),await v.write(n.toAffine(C.Qo)),await v.write(n.toAffine(C.Qc)),await v.write(n.toAffine(C.S1)),await v.write(n.toAffine(C.S2)),await v.write(n.toAffine(C.S3)),a=await e.read(o,f[3][0].p+o),await v.write(a),await bx(v)}await e.readToBuffer(D,0,(x+6)*m,f[2][0].p),await v.write(D),await bx(v),globalThis.gc&&globalThis.gc(),await L(),await v.close(),await i.close(),await e.close(),d&&d.info("Setup Finished")}class e3{constructor(a,b){this.curve=a,this.logger=b,this.resetProof()}resetProof(){this.polynomials={},this.evaluations={}}addPolynomial(a,b){a in this.polynomials&&this.logger.warn(`proof: polynomial.${a} already exist in proof`),this.polynomials[a]=b}getPolynomial(a){return a in this.polynomials||this.logger.warn(`proof: polynomial ${a} does not exist in proof`),this.polynomials[a]}addEvaluation(a,b){a in this.evaluations&&this.logger.warn(`proof: evaluations.${a} already exist in proof`),this.evaluations[a]=b}getEvaluation(a){return a in this.evaluations||this.logger.warn(`proof: evaluation ${a} does not exist in proof`),this.evaluations[a]}toObjectProof(a=!0){let b=a?{polynomials:{},evaluations:{}}:{};return Object.keys(this.polynomials).forEach(c=>{let d=this.curve.G1.toObject(this.polynomials[c]);a?b.polynomials[c]=d:b[c]=d}),Object.keys(this.evaluations).forEach(c=>{let d=this.curve.Fr.toObject(this.evaluations[c]);a?b.evaluations[c]=d:b[c]=d}),b}fromObjectProof(a){this.resetProof(),Object.keys(a.polynomials).forEach(b=>{this.polynomials[b]=this.curve.G1.fromObject(a.polynomials[b])}),Object.keys(a.evaluations).forEach(b=>{this.evaluations[b]=this.curve.Fr.fromObject(a.evaluations[b])})}}let e4=BigInt(0),e5=BigInt(1),e6=BigInt(2),e7=BigInt(7),e8=BigInt(256),e9=BigInt(113),fa=[],fb=[],fc=[];for(let a=0,b=e5,c=1,d=0;a<24;a++){[c,d]=[d,(2*c+3*d)%5],fa.push(2*(5*d+c)),fb.push((a+1)*(a+2)/2%64);let e=e4;for(let a=0;a<7;a++)(b=(b<<e5^(b>>e7)*e9)%e8)&e6&&(e^=e5<<(e5<<BigInt(a))-e5);fc.push(e)}let fd=function(a,b=!1){let c=a.length,d=new Uint32Array(c),e=new Uint32Array(c);for(let f=0;f<c;f++){let{h:c,l:g}=b_(a[f],b);[d[f],e[f]]=[c,g]}return[d,e]}(fc,!0),fe=fd[0],ff=fd[1],fg=(a,b,c)=>c>32?b<<c-32|a>>>64-c:a<<c|b>>>32-c,fh=(a,b,c)=>c>32?a<<c-32|b>>>64-c:b<<c|a>>>32-c;class fi extends bX{constructor(a,b,c,d=!1,e=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=a,this.suffix=b,this.outputLen=c,this.enableXOF=d,this.rounds=e,bM(c),!(0<a&&a<200))throw Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=bQ(this.state)}clone(){return this._cloneInto()}keccak(){bV(this.state32),function(a,b=24){let c=new Uint32Array(10);for(let d=24-b;d<24;d++){for(let b=0;b<10;b++)c[b]=a[b]^a[b+10]^a[b+20]^a[b+30]^a[b+40];for(let b=0;b<10;b+=2){let d=(b+8)%10,e=(b+2)%10,f=c[e],g=c[e+1],h=fg(f,g,1)^c[d],i=fh(f,g,1)^c[d+1];for(let c=0;c<50;c+=10)a[b+c]^=h,a[b+c+1]^=i}let b=a[2],e=a[3];for(let c=0;c<24;c++){let d=fb[c],f=fg(b,e,d),g=fh(b,e,d),h=fa[c];b=a[h],e=a[h+1],a[h]=f,a[h+1]=g}for(let b=0;b<50;b+=10){for(let d=0;d<10;d++)c[d]=a[b+d];for(let d=0;d<10;d++)a[b+d]^=~c[(d+2)%10]&c[(d+4)%10]}a[0]^=fe[d],a[1]^=ff[d]}bR(c)}(this.state32,this.rounds),bV(this.state32),this.posOut=0,this.pos=0}update(a){bO(this),bN(a=bW(a));let{blockLen:b,state:c}=this,d=a.length;for(let e=0;e<d;){let f=Math.min(b-this.pos,d-e);for(let b=0;b<f;b++)c[this.pos++]^=a[e++];this.pos===b&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:a,suffix:b,pos:c,blockLen:d}=this;a[c]^=b,(128&b)!=0&&c===d-1&&this.keccak(),a[d-1]^=128,this.keccak()}writeInto(a){bO(this,!1),bN(a),this.finish();let b=this.state,{blockLen:c}=this;for(let d=0,e=a.length;d<e;){this.posOut>=c&&this.keccak();let f=Math.min(c-this.posOut,e-d);a.set(b.subarray(this.posOut,this.posOut+f),d),this.posOut+=f,d+=f}return a}xofInto(a){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(a)}xof(a){return bM(a),this.xofInto(new Uint8Array(a))}digestInto(a){if(bP(a,this),this.finished)throw Error("digest() was already called");return this.writeInto(a),this.destroy(),a}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,bR(this.state)}_cloneInto(a){let{blockLen:b,suffix:c,outputLen:d,rounds:e,enableXOF:f}=this;return a||(a=new fi(b,c,d,f,e)),a.state32.set(this.state32),a.pos=this.pos,a.posOut=this.posOut,a.finished=this.finished,a.rounds=e,a.suffix=c,a.outputLen=d,a.enableXOF=f,a.destroyed=this.destroyed,a}}let fj=(k=()=>new fi(136,1,32),(h=a=>k().update(bW(a)).digest()).outputLen=(i=k()).outputLen,h.blockLen=i.blockLen,h.create=()=>k(),h);class fk{constructor(a){this.G1=a.G1,this.Fr=a.Fr,this.reset()}reset(){this.data=[]}addPolCommitment(a){this.data.push({type:0,data:a})}addScalar(a){this.data.push({type:1,data:a})}getChallenge(){if(0===this.data.length)throw Error("Keccak256Transcript: No data to generate a transcript");let a=0,b=0;this.data.forEach(c=>0===c.type?a++:b++);let c=new Uint8Array(b*this.Fr.n8+a*this.G1.F.n8*2),d=0;for(let a=0;a<this.data.length;a++)0===this.data[a].type?(this.G1.toRprUncompressed(c,d,this.data[a].data),d+=2*this.G1.F.n8):(this.Fr.toRprBE(c,d,this.data[a].data),d+=this.Fr.n8);let e=l.fromRprBE(fj(c));return this.Fr.e(e)}}class fl{static getZ1(a){return[a.zero,a.add(a.e(-1),a.w[2]),a.e(-2),a.sub(a.e(-1),a.w[2])]}static getZ2(a){return[a.zero,a.add(a.zero,a.mul(a.e(-2),a.w[2])),a.e(4),a.sub(a.zero,a.mul(a.e(-2),a.w[2]))]}static getZ3(a){return[a.zero,a.add(a.e(2),a.mul(a.e(2),a.w[2])),a.e(-8),a.sub(a.e(2),a.mul(a.e(2),a.w[2]))]}static mul2(a,b,c,d,e,f){let g,h=this.getZ1(f),i=f.mul(a,b),j=f.mul(a,d),k=f.mul(c,b),l=f.mul(c,d);return g=f.add(j,k),e&&(g=f.add(g,f.mul(h[e],l))),[i,g]}static mul3(a,b,c,d,e,f,g,h){let i,j,k=this.getZ1(h),l=this.getZ2(h),m=h.mul(a,b),n=h.mul(a,e),o=h.mul(d,b),p=h.mul(d,e);i=h.mul(m,c);let q=h.mul(o,c);q=h.add(q,h.mul(n,c)),q=h.add(q,h.mul(m,f));let r=h.mul(p,c);if(r=h.add(r,h.mul(n,f)),r=h.add(r,h.mul(o,f)),j=q,g){let a=h.mul(p,f);j=h.add(j,h.mul(k[g],r)),j=h.add(j,h.mul(l[g],a))}return[i,j]}static mul4(a,b,c,d,e,f,g,h,i,j){let k,l,m=this.getZ1(j),n=this.getZ2(j),o=this.getZ3(j),p=j.mul(a,b),q=j.mul(a,f),r=j.mul(e,b),s=j.mul(e,f),t=j.mul(c,d),u=j.mul(c,h),v=j.mul(g,d),w=j.mul(g,h);k=j.mul(p,t);let x=j.mul(r,t);x=j.add(x,j.mul(q,t)),x=j.add(x,j.mul(p,v)),x=j.add(x,j.mul(p,u));let y=j.mul(s,t);y=j.add(y,j.mul(r,v)),y=j.add(y,j.mul(r,u)),y=j.add(y,j.mul(q,v)),y=j.add(y,j.mul(q,u)),y=j.add(y,j.mul(p,w));let z=j.mul(q,w);z=j.add(z,j.mul(r,w)),z=j.add(z,j.mul(s,u)),z=j.add(z,j.mul(s,v));let A=j.mul(s,w);return l=x,i&&(l=j.add(l,j.mul(m[i],y)),l=j.add(l,j.mul(n[i],z)),l=j.add(l,j.mul(o[i],A))),[k,l]}}class fm{constructor(a,b,c){this.coef=a,this.curve=b,this.Fr=b.Fr,this.G1=b.G1,this.logger=c}static async fromEvaluations(a,b,c){return new fm(await b.Fr.ifft(a),b,c)}static fromCoefficientsArray(a,b,c){let d=b.Fr,e=a.length>32768?new aK(a.length*d.n8):new Uint8Array(a.length*d.n8);for(let b=0;b<a.length;b++)e.set(a[b],b*d.n8);return new fm(e,b,c)}static fromPolynomial(a,b,c){let d=a.length(),e=b.Fr,f=d>32768?new aK(d*e.n8):new Uint8Array(d*e.n8);return f.set(a.coef.slice(),0),new fm(f,b,c)}isEqual(a){let b=this.degree();if(b!==a.degree())return!1;for(let c=0;c<b+1;c++)if(!this.Fr.eq(this.getCoef(c),a.getCoef(c)))return!1;return!0}blindCoefficients(a){a=a||[];let b=this.length()+a.length>32768?new aK((this.length()+a.length)*this.Fr.n8):new Uint8Array((this.length()+a.length)*this.Fr.n8);b.set(this.coef,0);for(let c=0;c<a.length;c++)b.set(this.Fr.add(b.slice((this.length()+c)*this.Fr.n8,(this.length()+c+1)*this.Fr.n8),a[c]),(this.length()+c)*this.Fr.n8),b.set(this.Fr.sub(b.slice(c*this.Fr.n8,(c+1)*this.Fr.n8),a[c]),c*this.Fr.n8);this.coef=b}getCoef(a){let b=a*this.Fr.n8;return b+this.Fr.n8>this.coef.byteLength?this.Fr.zero:this.coef.slice(b,b+this.Fr.n8)}setCoef(a,b){if(a>this.length()-1)throw Error("Coef index is not available");this.coef.set(b,a*this.Fr.n8)}static async to4T(a,b,c,d){c=c||[];let e=await d.ifft(a),f=4*b>32768?new aK(4*b*d.n8):new Uint8Array(4*b*d.n8);f.set(e,0);let g=await d.fft(f);if(0===c.length)return[e,g];let h=b+c.length>32768?new aK((b+c.length)*d.n8):new Uint8Array((b+c.length)*d.n8);h.set(e,0);for(let a=0;a<c.length;a++)h.set(d.add(h.slice((b+a)*d.n8,(b+a+1)*d.n8),c[a]),(b+a)*d.n8),h.set(d.sub(h.slice(a*d.n8,(a+1)*d.n8),c[a]),a*d.n8);return[h,g]}length(){let a=this.coef.byteLength/this.Fr.n8;if(a!==Math.floor(this.coef.byteLength/this.Fr.n8))throw Error("Polynomial coefficients buffer has incorrect size");return 0===a&&this.logger&&this.logger.warn("Polynomial has length zero"),a}degree(){for(let a=this.length()-1;a>0;a--){let b=a*this.Fr.n8;if(!this.Fr.eq(this.Fr.zero,this.coef.slice(b,b+this.Fr.n8)))return a}return 0}evaluate(a){let b=this.Fr.zero;for(let c=this.degree()+1;c>0;c--){let d=c*this.Fr.n8,e=this.coef.slice(d-this.Fr.n8,d);b=this.Fr.add(e,this.Fr.mul(b,a))}return b}fastEvaluate(a){let b=this.Fr,c=this.degree()+1,d=parseInt(c/3),e=c-3*d,f=[],g=[];g[0]=b.one;for(let c=0;c<3;c++){f[c]=b.zero;let h=2===c?d+e:d;for(let e=h;e>0;e--)f[c]=b.add(this.getCoef(c*d+e-1),b.mul(f[c],a)),0===c&&(g[0]=b.mul(g[0],a))}for(let a=1;a<3;a++)f[0]=b.add(f[0],b.mul(g[a-1],f[a])),g[a]=b.mul(g[a-1],g[0]);return f[0]}add(a,b){let c=!1;a.length()>this.length()&&(c=!0);let d=this.length(),e=a.length();for(let f=0;f<Math.max(d,e);f++){let g=f*this.Fr.n8,h=f<d?this.coef.slice(g,g+this.Fr.n8):this.Fr.zero,i=f<e?a.coef.slice(g,g+this.Fr.n8):this.Fr.zero;void 0!==b&&(i=this.Fr.mul(i,b)),c?a.coef.set(this.Fr.add(h,i),g):this.coef.set(this.Fr.add(h,i),g)}c&&(delete this.coef,this.coef=a.coef)}sub(a,b){let c=!1;a.length()>this.length()&&(c=!0);let d=this.length(),e=a.length();for(let f=0;f<Math.max(d,e);f++){let g=f*this.Fr.n8,h=f<d?this.coef.slice(g,g+this.Fr.n8):this.Fr.zero,i=f<e?a.coef.slice(g,g+this.Fr.n8):this.Fr.zero;void 0!==b&&(i=this.Fr.mul(i,b)),c?a.coef.set(this.Fr.sub(h,i),g):this.coef.set(this.Fr.sub(h,i),g)}c&&(delete this.coef,this.coef=a.coef)}mulScalar(a){for(let b=0;b<this.length();b++){let c=b*this.Fr.n8;this.coef.set(this.Fr.mul(this.coef.slice(c,c+this.Fr.n8),a),c)}}addScalar(a){let b=0===this.length()?this.Fr.zero:this.coef.slice(0,this.Fr.n8);this.coef.set(this.Fr.add(b,a),0)}subScalar(a){let b=0===this.length()?this.Fr.zero:this.coef.slice(0,this.Fr.n8);this.coef.set(this.Fr.sub(b,a),0)}byXSubValue(a){let b=this.Fr,c=b.eq(b.zero,this.getCoef(this.length()-1))?this.length():this.length()+1,d=new fm(c>32768?new aK(c*b.n8):new Uint8Array(c*b.n8),this.curve,this.logger);d.coef.set(this.coef.slice(0,(c-1)*b.n8),32),this.mulScalar(b.neg(a)),d.add(this),this.coef=d.coef}byXNSubValue(a,b){let c=this.Fr,d=this.length()-a-1>=this.degree()?this.length():this.length()+a,e=new fm(d>32768?new aK(d*c.n8):new Uint8Array(d*c.n8),this.curve,this.logger);e.coef.set(this.coef.slice(0,(this.degree()+1)*32),32*a),this.mulScalar(b),e.add(this),this.coef=e.coef}divBy(a){let b=this.Fr,c=this.degree(),d=a.degree(),e=new fm(this.coef,this.curve,this.logger);this.coef=this.length()>32768?new aK(this.length()*b.n8):new Uint8Array(this.length()*b.n8);for(let f=c-d;f>=0;f--){this.setCoef(f,b.div(e.getCoef(f+d),a.getCoef(d)));for(let c=0;c<=d;c++)e.setCoef(f+c,b.sub(e.getCoef(f+c),b.mul(this.getCoef(f),a.getCoef(c))))}return e}divByMonic(a,b){let c=this.Fr,d=this.degree(),e=new fm(this.length()>32768?new aK(this.length()*c.n8):new Uint8Array(this.length()*c.n8),this.curve,this.logger),f=[];for(let b=0;b<a;b++)e.setCoef(d-b-a,this.getCoef(d-b)),f[b]=this.getCoef(d-b);let g=0;for(let h=0;h<a;h++)for(let i=d-2*a-h;i>=0&&!(i<0);i-=a){let d=h;f[d]=c.add(this.getCoef(i+a),c.mul(f[d],b)),e.setCoef(i,f[d]),g=(g+1)%a}this.coef=e.coef}divByVanishing(a,b){if(this.degree()<a)throw Error("divByVanishing polynomial divisor must be of degree lower than the dividend polynomial");let c=this.Fr,d=new fm(this.coef,this.curve,this.logger);this.coef=this.length()>32768?new aK(this.length()*c.n8):new Uint8Array(this.length()*c.n8);for(let e=this.length()-1;e>=a;e--){let f=d.getCoef(e);c.eq(c.zero,f)||(d.setCoef(e,c.zero),d.setCoef(e-a,c.add(d.getCoef(e-a),c.mul(b,f))),this.setCoef(e-a,c.add(this.getCoef(e-a),f)))}return d}divByVanishing2(a,b){if(this.degree()<a)throw Error("divByVanishing polynomial divisor must be of degree lower than the dividend polynomial");let c=this.Fr,d=new fm(this.coef,this.curve,this.logger);this.coef=this.length()>32768?new aK(this.length()*c.n8):new Uint8Array(this.length()*c.n8);let e=this.length()-a,f=Math.floor(e/3),g=e-2*f;console.log(e),console.log(f+"  "+g);for(let e=0;e<3;e++){console.log("> Thread "+e);for(let h=0===e?g:f;h>0;h--){let i=h-1;0!==e&&(i+=(e-1)*f+g);let j=i+a,k=d.getCoef(j);c.eq(c.zero,k)||(d.setCoef(j,c.zero),d.setCoef(i,c.add(d.getCoef(i),c.mul(b,k))),this.setCoef(i,c.add(this.getCoef(i),k)),console.log(i+" <-- "+j))}}return this.print(),d}fastDivByVanishing(a){let b=this.Fr;for(let c=0;c<a.length;c++){let d=a[c][0],e=a[c][1];if(this.degree()<d)throw Error("divByVanishing polynomial divisor must be of degree lower than the dividend polynomial");let f=this.length()-d,g=Math.floor(f/5/d),h=g*d,i=f-5*h,j=new fm(this.length()>32768?new aK(this.length()*b.n8):new Uint8Array(this.length()*b.n8),this.curve,this.logger),k=this.coef;this.coef=j.coef,j.coef=k;for(let a=0;a<5;a++){let c=(a+1)*h+i;for(let a=0;a<d;a++)this.setCoef(c+a-d,j.getCoef(c+a));for(let a=0;a<h-d;a++){let f=c-a-1,g=b.add(j.getCoef(f),b.mul(e,this.getCoef(f)));this.setCoef(f-d,g)}}let l=i;for(let a=0;a<d&&l;a++)this.setCoef(i-a-1,j.getCoef(i+d-a-1)),l--;for(let a=0;a<l;a++){let c=i-a-1,f=b.add(j.getCoef(c),b.mul(e,this.getCoef(c)));this.setCoef(c-d,f)}let m=[],n=b.one;for(let a=0;a<g;a++)n=b.mul(n,e);let o=b.one;for(let a=5;a>0;a--){let c=a-1,e=c*h+i;m[c]=[];for(let f=0;f<d;f++)m[c][f]=this.getCoef(e+f),5!==a&&(m[c][f]=b.add(m[c][f],b.mul(n,m[c+1][f])));o=b.mul(o,n)}for(let a=0;a<5;a++){let c=a*h+i,f=e,g=d-1,j=0===a?i:h;for(let h=0;h<j;h++){let i=c-h-1,j=b.add(this.getCoef(i),b.mul(f,m[a][g]));this.setCoef(i,j),0===g?(g=d-1,f=b.mul(f,e)):g--}}}}divByXSubValue(a){let b=this.length()>32768?new aK(this.length()*this.Fr.n8):new Uint8Array(this.length()*this.Fr.n8);b.set(this.Fr.zero,(this.length()-1)*this.Fr.n8),b.set(this.coef.slice((this.length()-1)*this.Fr.n8,this.length()*this.Fr.n8),(this.length()-2)*this.Fr.n8);for(let c=this.length()-3;c>=0;c--){let d=c*this.Fr.n8;b.set(this.Fr.add(this.coef.slice(d+this.Fr.n8,d+2*this.Fr.n8),this.Fr.mul(a,b.slice(d+this.Fr.n8,d+2*this.Fr.n8))),c*this.Fr.n8)}if(!this.Fr.eq(this.coef.slice(0,this.Fr.n8),this.Fr.mul(this.Fr.neg(a),b.slice(0,this.Fr.n8))))throw Error("Polynomial does not divide");this.coef=b}divZh(a,b=4){for(let b=0;b<a;b++){let a=b*this.Fr.n8;this.coef.set(this.Fr.neg(this.coef.slice(a,a+this.Fr.n8)),a)}let c=this.coef.byteLength/this.Fr.n8;for(let d=a;d<c;d++){let c=d*this.Fr.n8,e=this.Fr.sub(this.coef.slice((d-a)*this.Fr.n8,(d-a)*this.Fr.n8+this.Fr.n8),this.coef.slice(c,c+this.Fr.n8));if(this.coef.set(e,c),d>a*(b-1)-b&&!this.Fr.isZero(e))throw Error("Polynomial is not divisible")}return this}divByZerofier(a,b){let c=this.Fr,d=c.inv(b),e=c.neg(d),f=c.eq(c.one,e),g=c.eq(c.negone,e);if(!f)for(let b=0;b<a;b++){let a,d=b*this.Fr.n8;a=g?c.neg(this.coef.slice(d,d+this.Fr.n8)):c.mul(e,this.coef.slice(d,d+this.Fr.n8)),this.coef.set(a,d)}f=c.eq(c.one,d),g=c.eq(c.negone,d);for(let b=a;b<this.length();b++){let e=b*this.Fr.n8,h=(b-a)*this.Fr.n8,i=this.Fr.sub(this.coef.slice(h,h+this.Fr.n8),this.coef.slice(e,e+this.Fr.n8));if(f||(i=g?c.neg(i):c.mul(d,i)),this.coef.set(i,e),b>this.length()-a-1&&!this.Fr.isZero(i))throw Error("Polynomial is not divisible")}return this}byX(){let a=this.length()+1>32768?new aK(this.coef.byteLength+this.Fr.n8):new Uint8Array(this.coef.byteLength+this.Fr.n8);a.set(this.Fr.zero,0),a.set(this.coef,this.Fr.n8),this.coef=a}static async expX(a,b,c=!1){let d=a.Fr;if(b<1)throw Error("Compute a new polynomial to a zero or negative number is not allowed");if(1===b)return await fm.fromEvaluations(a.coef,curve,a.logger);let e=c?a.degree():a.length()-1,f=e*b+1>32768?new aK((e*b+1)*d.n8):new Uint8Array((e*b+1)*d.n8);f.set(a.getCoef(0),0);for(let c=1;c<=e;c++){let e=c*d.n8,g=a.getCoef(c);f.set(g,e*b)}return new fm(f,a.curve,a.logger)}split(a,b,c){if(a<1)throw Error(`Polynomials can't be split in ${a} parts`);if(1===a)return[this];if(0!==c.length&&c.length<a-1)throw Error(`Blinding factors length must be ${a-1}`);let d=(b+1)*this.Fr.n8,e=[],f=Math.ceil((this.degree()+1)*this.Fr.n8/d);if(f<a)for(let b=f;b<a;b++)e[b]=new fm(new Uint8Array(this.Fr.n8),this.curve,this.logger);a=Math.min(a,f);for(let b=0;b<a;b++){let f=a-1===b,g=f?this.coef.byteLength-(a-1)*d:d+this.Fr.n8,h=g/this.Fr.n8>32768?new aK(g):new Uint8Array(g);e[b]=new fm(h,this.curve,this.logger);let i=b*d,j=f?this.coef.byteLength:(b+1)*d;if(e[b].coef.set(this.coef.slice(i,j),0),f||e[b].coef.set(c[b],d),0!==b){let a=this.Fr.sub(e[b].coef.slice(0,this.Fr.n8),c[b-1]);e[b].coef.set(a,0)}f&&e[b].truncate()}return e}truncate(){let a=this.degree();if(a+1<this.coef.byteLength/this.Fr.n8){let b=a+1>32768?new aK((a+1)*this.Fr.n8):new Uint8Array((a+1)*this.Fr.n8);b.set(this.coef.slice(0,(a+1)*this.Fr.n8),0),this.coef=b}}static lagrangePolynomialInterpolation(a,b,c){let d=c.Fr,e=f(0);for(let b=1;b<a.length;b++)e.add(f(b));return e;function f(e){let f;for(let b=0;b<a.length;b++)b!==e&&(void 0===f?((f=new fm(a.length>32768?new aK(a.length*d.n8):new Uint8Array(a.length*d.n8),c)).setCoef(0,d.neg(a[b])),f.setCoef(1,d.one)):f.byXSubValue(a[b]));let g=f.evaluate(a[e]);g=d.inv(g);let h=d.mul(b[e],g);return f.mulScalar(h),f}}static zerofierPolynomial(a,b){let c=b.Fr,d=new fm(a.length+1>32768?new aK((a.length+1)*c.n8):new Uint8Array((a.length+1)*c.n8),b);d.setCoef(0,c.neg(a[0])),d.setCoef(1,c.one);for(let b=1;b<a.length;b++)d.byXSubValue(a[b]);return d}print(){let a=this.Fr,b="";for(let c=this.degree();c>=0;c--){let d=this.getCoef(c);!a.eq(a.zero,d)&&(a.isNegative(d)?b+=" - ":c!==this.degree()&&(b+=" + "),b+=a.toString(d),c>0&&(b+=c>1?"x^"+c:"x"))}console.log(b)}async multiExponentiation(a,b){let c=this.coef.byteLength/this.Fr.n8,d=a.slice(0,c*this.G1.F.n8*2),e=await this.Fr.batchFromMontgomery(this.coef),f=await this.G1.multiExpAffine(d,e,this.logger,b);return this.G1.toAffine(f)}}class fn{constructor(a,b,c){this.eval=a,this.curve=b,this.Fr=b.Fr,this.logger=c}static async fromPolynomial(a,b,c,d){let e=new aK(a.length()*b*c.Fr.n8);return e.set(a.coef,0),new fn(await c.Fr.fft(e),c,d)}getEvaluation(a){let b=a*this.Fr.n8;if(b+this.Fr.n8>this.eval.byteLength)throw Error("Evaluations.getEvaluation() out of bounds");return this.eval.slice(b,b+this.Fr.n8)}length(){let a=this.eval.byteLength/this.Fr.n8;if(a!==Math.floor(this.eval.byteLength/this.Fr.n8))throw Error("Polynomial evaluations buffer has incorrect size");return 0===a&&this.logger.warn("Polynomial has length zero"),a}}let{stringifyBigInts:fo}=m;async function fp(a,b,c,d){let{fd:e,sections:f}=await bu(b,"wtns",2,0x2000000,8388608);c&&c.debug("> Reading witness file");let g=await cK(e,f);c&&c.debug("> Reading zkey file");let{fd:h,sections:i}=await bu(a,"zkey",2,0x2000000,8388608),j=await cx(h,i,void 0,d);if("plonk"!=j.protocol)throw Error("zkey file is not plonk");if(!l.eq(j.r,g.q))throw Error("Curve of the witness does not match the curve of the proving key");if(g.nWitness!=j.nVars-j.nAdditions)throw Error(`Invalid witness length. Circuit: ${j.nVars}, witness: ${g.nWitness}, ${j.nAdditions}`);let k=j.curve,m=k.Fr,n=k.Fr.n8,o=j.domainSize*n;c&&(c.debug("----------------------------"),c.debug("  PLONK PROVE SETTINGS"),c.debug(`  Curve:         ${k.name}`),c.debug(`  Circuit power: ${j.power}`),c.debug(`  Domain size:   ${j.domainSize}`),c.debug(`  Vars:          ${j.nVars}`),c.debug(`  Public vars:   ${j.nPublic}`),c.debug(`  Constraints:   ${j.nConstraints}`),c.debug(`  Additions:     ${j.nAdditions}`),c.debug("----------------------------")),c&&c.debug("> Reading witness file data");let p=await bD(e,f,2);p.set(m.zero,0);let q=new aK(n*j.nAdditions),r={},s={},t={},u={},v=new e3(k,c),w=new fk(k);c&&c.debug("> Reading Section 3. Additions"),await A(),c&&c.debug("> Reading Section 12. Sigma1, Sigma2 & Sigma 3"),c&&c.debug("\xb7\xb7\xb7 Reading Sigma polynomials "),s.Sigma1=new fm(new aK(o),k,c),s.Sigma2=new fm(new aK(o),k,c),s.Sigma3=new fm(new aK(o),k,c),await h.readToBuffer(s.Sigma1.coef,0,o,i[12][0].p),await h.readToBuffer(s.Sigma2.coef,0,o,i[12][0].p+5*o),await h.readToBuffer(s.Sigma3.coef,0,o,i[12][0].p+10*o),c&&c.debug("\xb7\xb7\xb7 Reading Sigma evaluations"),t.Sigma1=new fn(new aK(4*o),k,c),t.Sigma2=new fn(new aK(4*o),k,c),t.Sigma3=new fn(new aK(4*o),k,c),await h.readToBuffer(t.Sigma1.eval,0,4*o,i[12][0].p+o),await h.readToBuffer(t.Sigma2.eval,0,4*o,i[12][0].p+6*o),await h.readToBuffer(t.Sigma3.eval,0,4*o,i[12][0].p+11*o),c&&c.debug("> Reading Section 14. Powers of Tau");let x=await bD(h,i,14),y=[];for(let a=1;a<=j.nPublic;a++){let b=p.slice(a*m.n8,a*m.n8+m.n8);y.push(l.fromRprLE(b))}c&&c.debug(""),c&&c.debug("> ROUND 1"),await D(),c&&c.debug("> ROUND 2"),await F(),c&&c.debug("> ROUND 3"),await H(),c&&c.debug("> ROUND 4"),await J(),c&&c.debug("> ROUND 5"),await K(),await h.close(),await e.close();let z=v.toObjectProof(!1);return z.protocol="plonk",z.curve=k.name,c&&c.debug("PLONK PROVER FINISHED"),{proof:fo(z),publicSignals:fo(y)};async function A(){c&&c.debug("\xb7\xb7\xb7 Computing additions");let a=await bD(h,i,3),b=8+2*n;for(let d=0;d<j.nAdditions;d++){c&&0!==d&&d%1e5==0&&c.debug(`    addition ${d}/${j.nAdditions}`);let e=d*b,f=B(a,e),g=B(a,e+=4);e+=4;let h=a.slice(e,e+n);e+=n;let i=a.slice(e,e+n),k=C(f),l=C(g),o=m.add(m.mul(h,k),m.mul(i,l));q.set(o,n*d)}}function B(a,b){let c=a.slice(b,b+4);return new DataView(c.buffer,c.byteOffset,c.byteLength).getUint32(0,!0)}function C(a){return a<j.nVars-j.nAdditions?p.slice(a*n,a*n+n):a<j.nVars?q.slice((a-(j.nVars-j.nAdditions))*n,(a-(j.nVars-j.nAdditions))*n+n):k.Fr.zero}async function D(){u.b=[];for(let a=1;a<=11;a++)u.b[a]=k.Fr.random();c&&c.debug("> Computing A, B, C wire polynomials"),await E(),c&&c.debug("> Computing A, B, C MSM");let a=await s.A.multiExponentiation(x,"A"),b=await s.B.multiExponentiation(x,"B"),d=await s.C.multiExponentiation(x,"C");return v.addPolynomial("A",a),v.addPolynomial("B",b),v.addPolynomial("C",d),0}async function E(){c&&c.debug("\xb7\xb7\xb7 Reading data from zkey file"),r.A=new aK(o),r.B=new aK(o),r.C=new aK(o);let a=await bD(h,i,4),b=await bD(h,i,5),d=await bD(h,i,6);for(let c=0;c<j.nConstraints;c++){let e=c*n,f=4*c,g=B(a,f);r.A.set(C(g),e);let h=B(b,f);r.B.set(C(h),e);let i=B(d,f);r.C.set(C(i),e)}if(r.A=await m.batchToMontgomery(r.A),r.B=await m.batchToMontgomery(r.B),r.C=await m.batchToMontgomery(r.C),c&&c.debug("\xb7\xb7\xb7 Computing A ifft"),s.A=await fm.fromEvaluations(r.A,k,c),c&&c.debug("\xb7\xb7\xb7 Computing B ifft"),s.B=await fm.fromEvaluations(r.B,k,c),c&&c.debug("\xb7\xb7\xb7 Computing C ifft"),s.C=await fm.fromEvaluations(r.C,k,c),c&&c.debug("\xb7\xb7\xb7 Computing A fft"),t.A=await fn.fromPolynomial(s.A,4,k,c),c&&c.debug("\xb7\xb7\xb7 Computing B fft"),t.B=await fn.fromPolynomial(s.B,4,k,c),c&&c.debug("\xb7\xb7\xb7 Computing C fft"),t.C=await fn.fromPolynomial(s.C,4,k,c),s.A.blindCoefficients([u.b[2],u.b[1]]),s.B.blindCoefficients([u.b[4],u.b[3]]),s.C.blindCoefficients([u.b[6],u.b[5]]),s.A.degree()>=j.domainSize+2)throw Error("A Polynomial is not well calculated");if(s.B.degree()>=j.domainSize+2)throw Error("B Polynomial is not well calculated");if(s.C.degree()>=j.domainSize+2)throw Error("C Polynomial is not well calculated")}async function F(){c&&c.debug("> Computing challenges beta and gamma"),w.reset(),w.addPolCommitment(j.Qm),w.addPolCommitment(j.Ql),w.addPolCommitment(j.Qr),w.addPolCommitment(j.Qo),w.addPolCommitment(j.Qc),w.addPolCommitment(j.S1),w.addPolCommitment(j.S2),w.addPolCommitment(j.S3);for(let a=0;a<j.nPublic;a++)w.addScalar(r.A.slice(a*n,a*n+n));w.addPolCommitment(v.getPolynomial("A")),w.addPolCommitment(v.getPolynomial("B")),w.addPolCommitment(v.getPolynomial("C")),u.beta=w.getChallenge(),c&&c.debug("\xb7\xb7\xb7 challenges.beta: "+m.toString(u.beta,16)),w.reset(),w.addScalar(u.beta),u.gamma=w.getChallenge(),c&&c.debug("\xb7\xb7\xb7 challenges.gamma: "+m.toString(u.gamma,16)),c&&c.debug("> Computing Z polynomial"),await G(),c&&c.debug("> Computing Z MSM");let a=await s.Z.multiExponentiation(x,"Z");v.addPolynomial("Z",a)}async function G(){c&&c.debug("\xb7\xb7\xb7 Computing Z evaluations");let a=new aK(o),b=new aK(o);a.set(m.one,0),b.set(m.one,0);let d=m.one;for(let c=0;c<j.domainSize;c++){let e=c*n,f=r.A.slice(e,e+n),g=r.B.slice(e,e+n),h=r.C.slice(e,e+n),i=m.mul(u.beta,d),k=m.add(f,i);k=m.add(k,u.gamma);let l=m.add(g,m.mul(j.k1,i));l=m.add(l,u.gamma);let o=m.add(h,m.mul(j.k2,i));o=m.add(o,u.gamma);let p=m.mul(k,m.mul(l,o)),q=m.add(f,m.mul(t.Sigma1.getEvaluation(4*c),u.beta));q=m.add(q,u.gamma);let s=m.add(g,m.mul(t.Sigma2.getEvaluation(4*c),u.beta));s=m.add(s,u.gamma);let v=m.add(h,m.mul(t.Sigma3.getEvaluation(4*c),u.beta));v=m.add(v,u.gamma);let w=m.mul(q,m.mul(s,v));p=m.mul(a.slice(e,e+n),p),a.set(p,(c+1)%j.domainSize*n),w=m.mul(b.slice(e,e+n),w),b.set(w,(c+1)%j.domainSize*n),d=m.mul(d,m.w[j.power])}b=await m.batchInverse(b);for(let c=0;c<j.domainSize;c++){let d=c*n,e=m.mul(a.slice(d,d+n),b.slice(d,d+n));a.set(e,d)}if(r.Z=a,!m.eq(a.slice(0,n),m.one))throw Error("Copy constraints does not match");if(c&&c.debug("\xb7\xb7\xb7 Computing Z ifft"),s.Z=await fm.fromEvaluations(r.Z,k,c),c&&c.debug("\xb7\xb7\xb7 Computing Z fft"),t.Z=await fn.fromPolynomial(s.Z,4,k,c),s.Z.blindCoefficients([u.b[9],u.b[8],u.b[7]]),s.Z.degree()>=j.domainSize+3)throw Error("Z Polynomial is not well calculated");delete r.Z}async function H(){c&&c.debug("> Computing challenge alpha"),w.reset(),w.addScalar(u.beta),w.addScalar(u.gamma),w.addPolCommitment(v.getPolynomial("Z")),u.alpha=w.getChallenge(),u.alpha2=m.square(u.alpha),c&&c.debug("\xb7\xb7\xb7 challenges.alpha: "+m.toString(u.alpha,16)),c&&c.debug("> Computing T polynomial"),await I(),c&&c.debug("> Computing T MSM");let a=await s.T1.multiExponentiation(x,"T1"),b=await s.T2.multiExponentiation(x,"T2"),d=await s.T3.multiExponentiation(x,"T3");v.addPolynomial("T1",a),v.addPolynomial("T2",b),v.addPolynomial("T3",d)}async function I(){c&&c.debug(`\xb7\xb7\xb7 Reading sections 8, 9, 7, 10, 11. Q selectors`),t.QL=new fn(new aK(4*o),k,c),t.QR=new fn(new aK(4*o),k,c),t.QM=new fn(new aK(4*o),k,c),t.QO=new fn(new aK(4*o),k,c),t.QC=new fn(new aK(4*o),k,c),await h.readToBuffer(t.QL.eval,0,4*o,i[8][0].p+o),await h.readToBuffer(t.QR.eval,0,4*o,i[9][0].p+o),await h.readToBuffer(t.QM.eval,0,4*o,i[7][0].p+o),await h.readToBuffer(t.QO.eval,0,4*o,i[10][0].p+o),await h.readToBuffer(t.QC.eval,0,4*o,i[11][0].p+o),t.Lagrange=new fn(new aK(4*o*j.nPublic),k,c);for(let a=0;a<j.nPublic;a++)await h.readToBuffer(t.Lagrange.eval,a*o*4,4*o,i[13][0].p+5*a*o+o);r.T=new aK(4*o),r.Tz=new aK(4*o),c&&c.debug("\xb7\xb7\xb7 Computing T evaluations");let a=m.one;for(let b=0;b<4*j.domainSize;b++){c&&0!==b&&b%1e5==0&&c.debug(`      T evaluation ${b}/${4*j.domainSize}`);let d=t.A.getEvaluation(b),e=t.B.getEvaluation(b),f=t.C.getEvaluation(b),g=t.Z.getEvaluation(b),h=t.Z.getEvaluation((4*j.domainSize+4+b)%(4*j.domainSize)),i=t.QM.getEvaluation(b),k=t.QL.getEvaluation(b),l=t.QR.getEvaluation(b),o=t.QO.getEvaluation(b),p=t.QC.getEvaluation(b),q=t.Sigma1.getEvaluation(b),s=t.Sigma2.getEvaluation(b),v=t.Sigma3.getEvaluation(b),w=m.add(u.b[2],m.mul(u.b[1],a)),x=m.add(u.b[4],m.mul(u.b[3],a)),y=m.add(u.b[6],m.mul(u.b[5],a)),z=m.square(a),A=m.add(m.add(m.mul(u.b[7],z),m.mul(u.b[8],a)),u.b[9]),B=m.mul(a,m.w[j.power]),C=m.square(B),D=m.add(m.add(m.mul(u.b[7],C),m.mul(u.b[8],B)),u.b[9]),E=m.zero;for(let a=0;a<j.nPublic;a++){let c=4*a*j.domainSize+b,d=t.Lagrange.getEvaluation(c),e=r.A.slice(a*n,(a+1)*n);E=m.sub(E,m.mul(d,e))}let[F,G]=fl.mul2(d,e,w,x,b%4,m);F=m.mul(F,i),G=m.mul(G,i),F=m.add(F,m.mul(d,k)),G=m.add(G,m.mul(w,k)),F=m.add(F,m.mul(e,l)),G=m.add(G,m.mul(x,l)),F=m.add(F,m.mul(f,o)),G=m.add(G,m.mul(y,o)),F=m.add(F,E),F=m.add(F,p);let H=m.mul(u.beta,a),I=d;I=m.add(I,H),I=m.add(I,u.gamma);let J=e;J=m.add(J,m.mul(H,j.k1)),J=m.add(J,u.gamma);let K=f;K=m.add(K,m.mul(H,j.k2)),K=m.add(K,u.gamma);let[L,M]=fl.mul4(I,J,K,g,w,x,y,A,b%4,m);L=m.mul(L,u.alpha),M=m.mul(M,u.alpha);let N=d;N=m.add(N,m.mul(u.beta,q)),N=m.add(N,u.gamma);let O=e;O=m.add(O,m.mul(u.beta,s)),O=m.add(O,u.gamma);let P=f;P=m.add(P,m.mul(u.beta,v)),P=m.add(P,u.gamma);let[Q,R]=fl.mul4(N,O,P,h,w,x,y,D,b%4,m);Q=m.mul(Q,u.alpha),R=m.mul(R,u.alpha);let S=m.sub(g,m.one);S=m.mul(S,t.Lagrange.getEvaluation(b)),S=m.mul(S,u.alpha2);let T=m.mul(A,t.Lagrange.getEvaluation(b));T=m.mul(T,u.alpha2);let U=m.add(m.sub(m.add(F,L),Q),S),V=m.add(m.sub(m.add(G,M),R),T);r.T.set(U,b*n),r.Tz.set(V,b*n),a=m.mul(a,m.w[j.power+2])}if(c&&c.debug("\xb7\xb7\xb7 Computing T ifft"),s.T=await fm.fromEvaluations(r.T,k,c),c&&c.debug("\xb7\xb7\xb7 Computing T / ZH"),s.T.divZh(j.domainSize,4),c&&c.debug("\xb7\xb7\xb7 Computing Tz ifft"),s.Tz=await fm.fromEvaluations(r.Tz,k,c),s.T.add(s.Tz),s.T.degree()>=3*j.domainSize+6)throw Error("T Polynomial is not well calculated");c&&c.debug("\xb7\xb7\xb7 Computing T1, T2, T3 polynomials"),s.T1=new fm(new aK((j.domainSize+1)*n),k,c),s.T2=new fm(new aK((j.domainSize+1)*n),k,c),s.T3=new fm(new aK((j.domainSize+6)*n),k,c),s.T1.coef.set(s.T.coef.slice(0,o),0),s.T2.coef.set(s.T.coef.slice(o,2*o),0),s.T3.coef.set(s.T.coef.slice(2*o,3*o+6*n),0),s.T1.setCoef(j.domainSize,u.b[10]);let b=m.sub(s.T2.getCoef(0),u.b[10]);s.T2.setCoef(0,b),s.T2.setCoef(j.domainSize,u.b[11]);let d=m.sub(s.T3.getCoef(0),u.b[11]);s.T3.setCoef(0,d)}async function J(){c&&c.debug("> Computing challenge xi"),w.reset(),w.addScalar(u.alpha),w.addPolCommitment(v.getPolynomial("T1")),w.addPolCommitment(v.getPolynomial("T2")),w.addPolCommitment(v.getPolynomial("T3")),u.xi=w.getChallenge(),u.xiw=m.mul(u.xi,m.w[j.power]),c&&c.debug("\xb7\xb7\xb7 challenges.xi: "+m.toString(u.xi,16)),v.addEvaluation("eval_a",s.A.evaluate(u.xi)),v.addEvaluation("eval_b",s.B.evaluate(u.xi)),v.addEvaluation("eval_c",s.C.evaluate(u.xi)),v.addEvaluation("eval_s1",s.Sigma1.evaluate(u.xi)),v.addEvaluation("eval_s2",s.Sigma2.evaluate(u.xi)),v.addEvaluation("eval_zw",s.Z.evaluate(u.xiw))}async function K(){c&&c.debug("> Computing challenge v"),w.reset(),w.addScalar(u.xi),w.addScalar(v.getEvaluation("eval_a")),w.addScalar(v.getEvaluation("eval_b")),w.addScalar(v.getEvaluation("eval_c")),w.addScalar(v.getEvaluation("eval_s1")),w.addScalar(v.getEvaluation("eval_s2")),w.addScalar(v.getEvaluation("eval_zw")),u.v=[],u.v[1]=w.getChallenge(),c&&c.debug("\xb7\xb7\xb7 challenges.v: "+m.toString(u.v[1],16));for(let a=2;a<6;a++)u.v[a]=m.mul(u.v[a-1],u.v[1]);c&&c.debug("> Computing linearisation polynomial R(X)"),await L(),c&&c.debug("> Computing opening proof polynomial Wxi(X) polynomial"),s.Wxi=new fm(new aK(o+6*n),k,c),s.Wxi.add(s.R),s.Wxi.add(s.A,u.v[1]),s.Wxi.add(s.B,u.v[2]),s.Wxi.add(s.C,u.v[3]),s.Wxi.add(s.Sigma1,u.v[4]),s.Wxi.add(s.Sigma2,u.v[5]),s.Wxi.subScalar(m.mul(u.v[1],v.evaluations.eval_a)),s.Wxi.subScalar(m.mul(u.v[2],v.evaluations.eval_b)),s.Wxi.subScalar(m.mul(u.v[3],v.evaluations.eval_c)),s.Wxi.subScalar(m.mul(u.v[4],v.evaluations.eval_s1)),s.Wxi.subScalar(m.mul(u.v[5],v.evaluations.eval_s2)),s.Wxi.divByZerofier(1,u.xi),c&&c.debug("> Computing opening proof polynomial Wxiw(X) polynomial"),M(),c&&c.debug("> Computing Wxi, Wxiw MSM");let a=await s.Wxi.multiExponentiation(x,"Wxi"),b=await s.Wxiw.multiExponentiation(x,"Wxiw");v.addPolynomial("Wxi",a),v.addPolynomial("Wxiw",b)}async function L(){let a=k.Fr;s.QL=new fm(new aK(o),k,c),s.QR=new fm(new aK(o),k,c),s.QM=new fm(new aK(o),k,c),s.QO=new fm(new aK(o),k,c),s.QC=new fm(new aK(o),k,c),await h.readToBuffer(s.QL.coef,0,o,i[8][0].p),await h.readToBuffer(s.QR.coef,0,o,i[9][0].p),await h.readToBuffer(s.QM.coef,0,o,i[7][0].p),await h.readToBuffer(s.QO.coef,0,o,i[10][0].p),await h.readToBuffer(s.QC.coef,0,o,i[11][0].p),u.xin=u.xi;for(let b=0;b<j.power;b++)u.xin=a.square(u.xin);u.zh=a.sub(u.xin,a.one);let b=[],d=a.e(j.domainSize),e=a.one;for(let c=1;c<=Math.max(1,j.nPublic);c++)b[c]=a.div(a.mul(e,u.zh),a.mul(d,a.sub(u.xi,e))),e=a.mul(e,a.w[j.power]);let f=a.div(a.sub(u.xin,a.one),a.mul(d,a.sub(u.xi,a.one)));if(c){c.debug("Lagrange Evaluations: ");for(let d=1;d<b.length;d++)c.debug(`L${d}(xi)=`+a.toString(b[d],16))}let g=a.zero;for(let c=0;c<y.length;c++){let d=a.e(y[c]);g=a.sub(g,a.mul(d,b[c+1]))}c&&c.debug("PI: "+a.toString(g,16));let l=a.mul(v.evaluations.eval_a,v.evaluations.eval_b),m=v.evaluations.eval_a,p=a.mul(u.beta,u.xi);m=a.add(m,p),m=a.add(m,u.gamma);let q=v.evaluations.eval_b;q=a.add(q,a.mul(p,j.k1)),q=a.add(q,u.gamma);let r=v.evaluations.eval_c;r=a.add(r,a.mul(p,j.k2)),r=a.add(r,u.gamma);let t=a.mul(a.mul(a.mul(m,q),r),u.alpha),w=v.evaluations.eval_a;w=a.add(w,a.mul(u.beta,v.evaluations.eval_s1)),w=a.add(w,u.gamma);let x=v.evaluations.eval_b;x=a.add(x,a.mul(u.beta,v.evaluations.eval_s2)),x=a.add(x,u.gamma);let z=a.mul(w,x);z=a.mul(z,v.evaluations.eval_zw),z=a.mul(z,u.alpha);let A=a.mul(f,u.alpha2);s.R=new fm(new aK((j.domainSize+6)*n),k,c),s.R.add(s.QM,l),s.R.add(s.QL,v.evaluations.eval_a),s.R.add(s.QR,v.evaluations.eval_b),s.R.add(s.QO,v.evaluations.eval_c),s.R.add(s.QC),s.R.add(s.Z,t),s.R.sub(s.Sigma3,a.mul(z,u.beta)),s.R.add(s.Z,A);let B=fm.fromPolynomial(s.T3,k,c);B.mulScalar(a.square(u.xin)),B.add(s.T2,u.xin),B.add(s.T1),B.mulScalar(u.zh),s.R.sub(B);let C=a.sub(g,a.mul(z,a.add(v.evaluations.eval_c,u.gamma)));C=a.sub(C,A),c&&c.debug("r0: "+a.toString(C,16)),s.R.addScalar(C)}async function M(){s.Wxiw=fm.fromPolynomial(s.Z,k,c),s.Wxiw.subScalar(v.evaluations.eval_zw),s.Wxiw.divByZerofier(1,u.xiw)}}let{unstringifyBigInts:fq}=m;async function fr(a,b,c,d,e,f){let g=fq(a),h={type:"mem"};return await cW(g,b,h,e),await fp(c,h,d,f)}let{unstringifyBigInts:fs}=m;async function ft(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;let F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an=fs(a);c=fs(c);let ao=fs(b),ap=await bL(an.curve),aq=ap.Fr,ar=ap.G1;d&&d.info("PLONK VERIFIER STARTED");let as=(e=ap,f=c,F=e.G1,G=e.Fr,(H={}).A=F.fromObject(f.A),H.B=F.fromObject(f.B),H.C=F.fromObject(f.C),H.Z=F.fromObject(f.Z),H.T1=F.fromObject(f.T1),H.T2=F.fromObject(f.T2),H.T3=F.fromObject(f.T3),H.eval_a=G.fromObject(f.eval_a),H.eval_b=G.fromObject(f.eval_b),H.eval_c=G.fromObject(f.eval_c),H.eval_zw=G.fromObject(f.eval_zw),H.eval_s1=G.fromObject(f.eval_s1),H.eval_s2=G.fromObject(f.eval_s2),H.Wxi=F.fromObject(f.Wxi),H.Wxiw=F.fromObject(f.Wxiw),H);if(g=ap,h=an,I=g.G1,J=g.G2,K=g.Fr,h.Qm=I.fromObject(h.Qm),h.Ql=I.fromObject(h.Ql),h.Qr=I.fromObject(h.Qr),h.Qo=I.fromObject(h.Qo),h.Qc=I.fromObject(h.Qc),h.S1=I.fromObject(h.S1),h.S2=I.fromObject(h.S2),h.S3=I.fromObject(h.S3),h.k1=K.fromObject(h.k1),h.k2=K.fromObject(h.k2),h.X_2=J.fromObject(h.X_2),an=h,i=ap,j=as,!((L=i.G1).isValid(j.A)&&L.isValid(j.B)&&L.isValid(j.C)&&L.isValid(j.Z)&&L.isValid(j.T1)&&L.isValid(j.T2)&&L.isValid(j.T3)&&L.isValid(j.Wxi)&&L.isValid(j.Wxiw))||0)return d.error("Proof commitments are not valid."),!1;if(ao.length!=an.nPublic)return d&&d.error("Invalid number of public inputs"),!1;if(!(fv(k=ap,(l=as).eval_a)&&fv(k,l.eval_b)&&fv(k,l.eval_c)&&fv(k,l.eval_s1)&&fv(k,l.eval_s2)&&fv(k,l.eval_zw)))return d&&d.error("Proof evaluations are not valid"),!1;if(!function(a,b){for(let c=0;c<b.length;c++)if(!fu(a,b[c]))return!1;return!0}(ap,ao))return d&&d.error("Public inputs are not valid."),!1;let at=function(a,b,c,d){let e=a.Fr,f={},g=new fk(a);g.addPolCommitment(d.Qm),g.addPolCommitment(d.Ql),g.addPolCommitment(d.Qr),g.addPolCommitment(d.Qo),g.addPolCommitment(d.Qc),g.addPolCommitment(d.S1),g.addPolCommitment(d.S2),g.addPolCommitment(d.S3);for(let a=0;a<c.length;a++)g.addScalar(e.e(c[a]));g.addPolCommitment(b.A),g.addPolCommitment(b.B),g.addPolCommitment(b.C),f.beta=g.getChallenge(),g.reset(),g.addScalar(f.beta),f.gamma=g.getChallenge(),g.reset(),g.addScalar(f.beta),g.addScalar(f.gamma),g.addPolCommitment(b.Z),f.alpha=g.getChallenge(),g.reset(),g.addScalar(f.alpha),g.addPolCommitment(b.T1),g.addPolCommitment(b.T2),g.addPolCommitment(b.T3),f.xi=g.getChallenge(),g.reset(),g.addScalar(f.xi),g.addScalar(b.eval_a),g.addScalar(b.eval_b),g.addScalar(b.eval_c),g.addScalar(b.eval_s1),g.addScalar(b.eval_s2),g.addScalar(b.eval_zw),f.v=[],f.v[1]=g.getChallenge();for(let a=2;a<6;a++)f.v[a]=e.mul(f.v[a-1],f.v[1]);return g.reset(),g.addPolCommitment(b.Wxi),g.addPolCommitment(b.Wxiw),f.u=g.getChallenge(),f}(ap,as,ao,an);if(d){d.debug("beta: "+aq.toString(at.beta,16)),d.debug("gamma: "+aq.toString(at.gamma,16)),d.debug("alpha: "+aq.toString(at.alpha,16)),d.debug("xi: "+aq.toString(at.xi,16));for(let a=1;a<6;a++)d&&d.debug("v: "+aq.toString(at.v[a],16));d.debug("u: "+aq.toString(at.u,16))}let au=function(a,b,c){let d=a.Fr,e=b.xi,f=1;for(let a=0;a<c.power;a++)e=d.square(e),f*=2;b.xin=e,b.zh=d.sub(e,d.one);let g=[],h=d.e(f),i=d.one;for(let a=1;a<=Math.max(1,c.nPublic);a++)g[a]=d.div(d.mul(i,b.zh),d.mul(h,d.sub(b.xi,i))),i=d.mul(i,d.w[c.power]);return g}(ap,at,an);if(d)for(let a=1;a<au.length;a++)d.debug(`L${a}(xi)=`+aq.toString(au[a],16));if(ao.length!=an.nPublic)return d.error("Number of public signals does not match with vk"),!1;let av=function(a,b,c){let d=a.Fr,e=d.zero;for(let a=0;a<b.length;a++){let f=d.e(b[a]);e=d.sub(e,d.mul(f,c[a+1]))}return e}(ap,ao,au);d&&d.debug("PI(xi): "+aq.toString(av,16));let aw=(m=ap,n=as,o=at,p=av,q=au[1],N=(M=m.Fr).mul(q,M.square(o.alpha)),O=M.add(n.eval_a,M.mul(o.beta,n.eval_s1)),O=M.add(O,o.gamma),P=M.add(n.eval_b,M.mul(o.beta,n.eval_s2)),P=M.add(P,o.gamma),Q=M.add(n.eval_c,o.gamma),R=M.mul(M.mul(O,P),Q),R=M.mul(R,n.eval_zw),R=M.mul(R,o.alpha),M.sub(M.sub(p,N),R));d&&d.debug("r0: "+aq.toString(aw,16));let ax=(r=ap,s=as,t=at,u=an,v=au[1],S=r.G1,T=r.Fr,U=S.timesFr(u.Qm,T.mul(s.eval_a,s.eval_b)),U=S.add(U,S.timesFr(u.Ql,s.eval_a)),U=S.add(U,S.timesFr(u.Qr,s.eval_b)),U=S.add(U,S.timesFr(u.Qo,s.eval_c)),U=S.add(U,u.Qc),V=T.mul(t.beta,t.xi),W=T.add(T.add(s.eval_a,V),t.gamma),X=T.add(T.add(s.eval_b,T.mul(V,u.k1)),t.gamma),Y=T.add(T.add(s.eval_c,T.mul(V,u.k2)),t.gamma),Z=T.mul(T.mul(T.mul(W,X),Y),t.alpha),$=T.mul(v,T.square(t.alpha)),_=S.timesFr(s.Z,T.add(T.add(Z,$),t.u)),aa=T.add(T.add(s.eval_a,T.mul(t.beta,s.eval_s1)),t.gamma),ab=T.add(T.add(s.eval_b,T.mul(t.beta,s.eval_s2)),t.gamma),ac=T.mul(T.mul(t.alpha,t.beta),s.eval_zw),ad=S.timesFr(u.S3,T.mul(T.mul(aa,ab),ac)),ae=s.T1,af=S.timesFr(s.T2,t.xin),ag=S.timesFr(s.T3,T.square(t.xin)),ah=S.add(ae,S.add(af,ag)),ah=S.timesFr(ah,t.zh),S.sub(S.sub(S.add(U,_),ad),ah));d&&d.debug("D: "+ar.toString(ar.toAffine(ax),16));let ay=(w=ap,x=as,y=at,z=an,A=ax,aj=(ai=w.G1).add(A,ai.timesFr(x.A,y.v[1])),aj=ai.add(aj,ai.timesFr(x.B,y.v[2])),aj=ai.add(aj,ai.timesFr(x.C,y.v[3])),aj=ai.add(aj,ai.timesFr(z.S1,y.v[4])),aj=ai.add(aj,ai.timesFr(z.S2,y.v[5])));d&&d.debug("F: "+ar.toString(ar.toAffine(ay),16));let az=(B=ap,C=as,D=at,E=aw,ak=B.G1,am=(al=B.Fr).add(al.neg(E),al.mul(D.v[1],C.eval_a)),am=al.add(am,al.mul(D.v[2],C.eval_b)),am=al.add(am,al.mul(D.v[3],C.eval_c)),am=al.add(am,al.mul(D.v[4],C.eval_s1)),am=al.add(am,al.mul(D.v[5],C.eval_s2)),am=al.add(am,al.mul(D.u,C.eval_zw)),ak.timesFr(ak.one,am));d&&d.debug("E: "+ar.toString(ar.toAffine(az),16));let aA=await fw(ap,as,at,an,az,ay);return d&&(aA?d.info("OK!"):d.warn("Invalid Proof")),aA}function fu(a,b){return l.geq(b,0)&&l.lt(b,a.r)}function fv(a,b){return fu(a,l.fromRprLE(b))}async function fw(a,b,c,d,e,f){let g=a.G1,h=a.Fr,i=b.Wxi;i=g.add(i,g.timesFr(b.Wxiw,c.u));let j=g.timesFr(b.Wxi,c.xi),k=h.mul(h.mul(c.u,c.xi),h.w[d.power]);return j=g.add(j,g.timesFr(b.Wxiw,k)),j=g.add(j,f),j=g.sub(j,e),await a.pairingEq(g.neg(i),d.X_2,j,a.G2.one)}let{unstringifyBigInts:fx}=m;function fy(a){let b=a.toString(16);for(;b.length<64;)b="0"+b;return`"0x${b}"`}async function fz(a,b){let c=fx(a),d=fx(b),e=await bL(c.curve);e.G1,e.Fr;let f="";for(let a=0;a<d.length;a++)""!=f&&(f+=","),f+=fy(d[a]);return`[${fy(c.A[0])}, ${fy(c.A[1])},${fy(c.B[0])},${fy(c.B[1])},${fy(c.C[0])},${fy(c.C[1])},${fy(c.Z[0])},${fy(c.Z[1])},${fy(c.T1[0])},${fy(c.T1[1])},${fy(c.T2[0])},${fy(c.T2[1])},${fy(c.T3[0])},${fy(c.T3[1])},${fy(c.Wxi[0])},${fy(c.Wxi[1])},${fy(c.Wxiw[0])},${fy(c.Wxiw[1])},${fy(c.eval_a)},${fy(c.eval_b)},${fy(c.eval_c)},${fy(c.eval_s1)},${fy(c.eval_s2)},${fy(c.eval_zw)}][${f}]`}function fA(a,b){return[a,0,0,b.one,b.zero,b.zero,b.zero,b.zero]}function fB(a,b,c,d,e,f,g,h){return[a,b,c,d,e,f,g,h]}function fC(a,b,c,d,e,f,g,h,i){return[a,b,c,d,e,f,g,h]}class fD{constructor(a,b,c,d,e){this.Fr=a,this.logger=e,this.fnGetAdditionConstraint=c,this.fnGetMultiplicationConstraint=d}processR1csConstraint(a,b,c,d){this.normalizeLinearCombination(b),this.normalizeLinearCombination(c),this.normalizeLinearCombination(d);let e=this.getLinearCombinationType(b),f=this.getLinearCombinationType(c);if(0===e||0===f)return this.processR1csAdditionConstraint(a,d);if(1===e){let e=this.joinLinearCombinations(c,d,b[0]);return this.processR1csAdditionConstraint(a,e)}if(1!==f)return this.processR1csMultiplicationConstraint(a,b,c,d);{let e=this.joinLinearCombinations(b,d,c[0]);return this.processR1csAdditionConstraint(a,e)}}getLinearCombinationType(a){let b=this.Fr.zero,c=0,d=Object.keys(a);for(let e=0;e<d.length;e++)0n==a[d[e]]?delete a[d[e]]:0==d[e]?b=this.Fr.add(b,a[d[e]]):c++;return c>0?2:+!this.Fr.isZero(b)}normalizeLinearCombination(a){let b=Object.keys(a);for(let c=0;c<b.length;c++)this.Fr.isZero(a[b[c]])&&delete a[b[c]];return a}joinLinearCombinations(a,b,c){let d={};for(let b in a)void 0===d[b]?d[b]=this.Fr.mul(c,a[b]):d[b]=this.Fr.add(d[b],this.Fr.mul(c,a[b]));for(let a in b){let c=this.Fr.neg(b[a]);void 0===d[a]?d[a]=c:d[a]=this.Fr.add(d[a],c)}return this.normalizeLinearCombination(d)}reduceCoefs(a,b,c,d,e){let f={k:this.Fr.zero,signals:[],coefs:[]},g=[];for(let a in d)0==a?f.k=this.Fr.add(f.k,d[a]):0n!=d[a]&&g.push([Number(a),d[a]]);for(;g.length>e;){let d=g.shift(),e=g.shift(),f=a.nVars++,h=this.fnGetAdditionConstraint(d[0],e[0],f,this.Fr.neg(d[1]),this.Fr.neg(e[1]),this.Fr.zero,this.Fr.one,this.Fr.zero);b.push(h),c.push([d[0],e[0],d[1],e[1]]),g.push([f,this.Fr.one])}for(let a=0;a<g.length;a++)f.signals[a]=g[a][0],f.coefs[a]=g[a][1];for(;f.coefs.length<e;)f.signals.push(0),f.coefs.push(this.Fr.zero);return f}processR1csAdditionConstraint(a,b){let c=[],d=[],e=this.reduceCoefs(a,c,d,b,3),f=this.fnGetAdditionConstraint(e.signals[0],e.signals[1],e.signals[2],e.coefs[0],e.coefs[1],this.Fr.zero,e.coefs[2],e.k);return c.push(f),[c,d]}processR1csMultiplicationConstraint(a,b,c,d){let e=[],f=[],g=this.reduceCoefs(a,e,f,b,1),h=this.reduceCoefs(a,e,f,c,1),i=this.reduceCoefs(a,e,f,d,1),j=this.fnGetMultiplicationConstraint(g.signals[0],h.signals[0],i.signals[0],this.Fr.mul(g.coefs[0],h.k),this.Fr.mul(g.k,h.coefs[0]),this.Fr.mul(g.coefs[0],h.coefs[0]),this.Fr.neg(i.coefs[0]),this.Fr.sub(this.Fr.mul(g.k,h.k),i.k));return e.push(j),[e,f]}}class fE{constructor(a,b,c){this.n=a,this.polynomials=Array(a).fill(void 0),this.curve=b,this.Fr=b.Fr,this.G1=b.G1,this.logger=c}addPolynomial(a,b){if(a>this.n-1)throw Error("CPolynomial:addPolynomial, cannot add a polynomial to a position greater than n-1");this.polynomials[a]=b}degree(){return Math.max(...this.polynomials.map((a,b)=>void 0===a?0:a.degree()*this.n+b))}getPolynomial(){let a=this.polynomials.map(a=>void 0===a?0:a.degree()),b=this.degree(),c=2**(ce(b-1)+1),d=this.Fr.n8,e=new fm(new aK(c*d),this.curve,this.logger);for(let c=0;c<b;c++){let b=c*d,f=b*this.n;for(let g=0;g<this.n;g++)void 0!==this.polynomials[g]&&c<=a[g]&&e.coef.set(this.polynomials[g].coef.slice(b,b+d),f+g*d)}return e}async multiExponentiation(a,b){let c=this.getPolynomial(),d=c.coef.byteLength/this.Fr.n8,e=a.slice(0,d*this.G1.F.n8*2),f=await this.Fr.batchFromMontgomery(c.coef),g=await this.G1.multiExpAffine(e,f,this.logger,b);return this.G1.toAffine(g)}}async function fF(a,b,c,d){var e,f;let g,h,i,j;d&&d.info("FFLONK SETUP STARTED"),globalThis.gc&&globalThis.gc(),d&&d.info("> Reading PTau file");let{fd:k,sections:m}=await bu(b,"ptau",1,4194304,0x1000000);if(!m[12])throw Error("Powers of Tau is not well prepared. Section 12 missing.");d&&d.info("> Getting curve from PTau settings");let{curve:n}=await c7(k,m);d&&d.info("> Reading r1cs file");let{fd:o,sections:p}=await bu(a,"r1cs",1,4194304,0x1000000),q=await ev(o,p,{loadConstraints:!1,loadCustomGates:!0});if(q.prime!==n.r)throw Error("r1cs curve does not match powers of tau ceremony curve");let r=n.Fr,s=n.Fr.n8,t=2*n.G1.F.n8,u=2*n.G2.F.n8,v={},w={},x={nVars:q.nVars,nPublic:q.nOutputs+q.nPubInputs},y=new eK,z=new eK;if(d&&d.info("> Processing FFlonk constraints"),await G(n.Fr,q,d),globalThis.gc&&globalThis.gc(),x.cirPower=Math.max(3,ce(y.length+2-1)+1),x.domainSize=2**x.cirPower,m[2][0].size<(9*x.domainSize+18)*t)throw Error("Powers of Tau is not big enough for this circuit size. Section 2 too small.");if(m[3][0].size<u)throw Error("Powers of Tau is not well prepared. Section 3 too small.");d&&(d.info("----------------------------"),d.info("  FFLONK SETUP SETTINGS"),d.info(`  Curve:         ${n.name}`),d.info(`  Circuit power: ${x.cirPower}`),d.info(`  Domain size:   ${x.domainSize}`),d.info(`  Vars:          ${x.nVars}`),d.info(`  Public vars:   ${x.nPublic}`),d.info(`  Constraints:   ${y.length}`),d.info(`  Additions:     ${z.length}`),d.info("----------------------------")),d&&d.info("> computing k1 and k2");let[A,B]=function(){let a=r.two;for(;c(a,[],x.cirPower);)r.add(a,r.one);let b=r.add(a,r.one);for(;c(b,[a],x.cirPower);)r.add(b,r.one);return[a,b];function c(a,b,c){let d=2**c,e=r.one;for(let f=0;f<d;f++){if(r.eq(a,e))return!0;for(let c=0;c<b.length;c++)if(r.eq(a,r.mul(b[c],e)))return!0;e=r.mul(e,r.w[c])}return!1}}();d&&d.info("> computing w3");let C=(h=r.e(31624),i=l.div(0x810b7bdd032f006f40d60f3c0403964dc08a6b6bef43d6d8b505398a8000000n,l.e(3)),r.exp(h,i));d&&d.info("> computing w4");let D=r.w[2];d&&d.info("> computing w8");let E=r.w[3];d&&d.info("> computing wr");let F=(e=x.cirPower,j=(f=n.Fr).e(0x108c3d36f14c2facdf4d615f022a01cfcf001cc24e3db9d89373caf21d767f0n),f.exp(j,2**(28-e)));return await H(),await o.close(),await k.close(),d&&d.info("FFLONK SETUP FINISHED"),0;async function G(a,b,c){for(let b=0;b<x.nPublic;b++)y.push(fA(b+1,a));let d=new fD(a,fA,fB,fC,c),e=await bD(o,p,2),f=0;for(let a=0;a<b.nConstraints;a++){c&&0!==a&&a%5e5==0&&c.info(`    processing r1cs constraints ${a}/${b.nConstraints}`);let[e,f]=d.processR1csConstraint(x,...function(){let a=[];return a[0]=g(),a[1]=g(),a[2]=g(),a}());y.push(...e),z.push(...f)}function g(){let a={},c=e.slice(f,f+4);f+=4;let d=new DataView(c.buffer).getUint32(0,!0),g=e.slice(f,f+(4+b.n8)*d);f+=(4+b.n8)*d;let h=new DataView(g.buffer);for(let c=0;c<d;c++){let d=h.getUint32(c*(4+b.n8),!0),e=b.F.fromRprLE(g,c*(4+b.n8)+4);a[d]=e}return a}return 0}async function H(){d&&d.info("> Writing the zkey file");let a=await bv(c,"zkey",1,17,4194304,0x1000000);d&&d.info(`\xb7\xb7\xb7 Writing Section 1. Zkey Header`),await I(a),d&&d.info(`\xb7\xb7\xb7 Writing Section 3. Additions`),await J(a),globalThis.gc&&globalThis.gc(),d&&d.info(`\xb7\xb7\xb7 Writing Section 4. A Map`),await K(a,4,0,"A map"),globalThis.gc&&globalThis.gc(),d&&d.info(`\xb7\xb7\xb7 Writing Section 5. B Map`),await K(a,5,1,"B map"),globalThis.gc&&globalThis.gc(),d&&d.info(`\xb7\xb7\xb7 Writing Section 6. C Map`),await K(a,6,2,"C map"),globalThis.gc&&globalThis.gc(),d&&d.info(`\xb7\xb7\xb7 Writing Section 7. QL`),await L(a,7,3,"QL"),globalThis.gc&&globalThis.gc(),d&&d.info(`\xb7\xb7\xb7 Writing Section 8. QR`),await L(a,8,4,"QR"),globalThis.gc&&globalThis.gc(),d&&d.info(`\xb7\xb7\xb7 Writing Section 9. QM`),await L(a,9,5,"QM"),globalThis.gc&&globalThis.gc(),d&&d.info(`\xb7\xb7\xb7 Writing Section 10. QO`),await L(a,10,6,"QO"),globalThis.gc&&globalThis.gc(),d&&d.info(`\xb7\xb7\xb7 Writing Section 11. QC`),await L(a,11,7,"QC"),globalThis.gc&&globalThis.gc(),d&&d.info(`\xb7\xb7\xb7 Writing Sections 12,13,14. Sigma1, Sigma2 & Sigma 3`),await M(a),globalThis.gc&&globalThis.gc(),d&&d.info(`\xb7\xb7\xb7 Writing Section 15. Lagrange Polynomials`),await N(a),globalThis.gc&&globalThis.gc(),d&&d.info(`\xb7\xb7\xb7 Writing Section 16. Powers of Tau`),await O(a),globalThis.gc&&globalThis.gc(),d&&d.info(`\xb7\xb7\xb7 Writing Section 17. C0`),await P(a),globalThis.gc&&globalThis.gc(),d&&d.info(`\xb7\xb7\xb7 Writing Section 2. FFlonk Header`),await Q(a),globalThis.gc&&globalThis.gc(),d&&d.info("> Writing the zkey file finished"),await a.close()}async function I(a){await bw(a,1),await a.writeULE32(10),await bx(a)}async function J(a){await bw(a,3);let b=new Uint8Array(8+2*s),c=new DataView(b.buffer);for(let e=0;e<z.length;e++){d&&0!==e&&e%5e5==0&&d.info(`      writing Additions: ${e}/${z.length}`);let f=z[e];c.setUint32(0,f[0],!0),c.setUint32(4,f[1],!0),b.set(f[2],8),b.set(f[3],8+s),await a.write(b)}await bx(a)}async function K(a,b,c,e){await bw(a,b);for(let b=0;b<y.length;b++)d&&0!==b&&b%5e5==0&&d.info(`      writing witness ${e}: ${b}/${y.length}`),await a.writeULE32(y[b][c]);await bx(a)}async function L(a,b,c,e){let f=new aK(x.domainSize*s);for(let a=0;a<y.length;a++)f.set(y[a][c],a*s),d&&0!==a&&a%5e5==0&&d.info(`      writing ${e}: ${a}/${y.length}`);v[e]=await fm.fromEvaluations(f,n,d),w[e]=await fn.fromPolynomial(v[e],4,n,d),await bw(a,b),await a.write(v[e].coef),await a.write(w[e].eval),await bx(a)}async function M(a){let b=new aK(s*x.domainSize*3),c=new eK(x.nVars),e=new eK(x.nVars),f=r.one;for(let a=0;a<x.domainSize;a++)a<y.length?(g(y[a][0],a),g(y[a][1],x.domainSize+a),g(y[a][2],2*x.domainSize+a)):a<x.domainSize-2?(g(0,a),g(0,x.domainSize+a),g(0,2*x.domainSize+a)):(b.set(f,a*s),b.set(r.mul(f,A),(x.domainSize+a)*s),b.set(r.mul(f,B),(2*x.domainSize+a)*s)),f=r.mul(f,r.w[x.cirPower]),d&&0!==a&&a%5e5==0&&d.info(`      writing sigma phase1: ${a}/${y.length}`);for(let a=0;a<x.nVars;a++)void 0!==e[a]?b.set(c[a],e[a]*s):console.log("Variable not used"),d&&0!==a&&a%5e5==0&&d.info(`      writing sigma phase2: ${a}/${x.nVars}`);globalThis.gc&&globalThis.gc();for(let c=0;c<3;c++){let e=0===c?12:1===c?13:14,f="S"+(c+1);v[f]=await fm.fromEvaluations(b.slice(x.domainSize*s*c,x.domainSize*s*(c+1)),n,d),w[f]=await fn.fromPolynomial(v[f],4,n,d),await bw(a,e),await a.write(v[f].coef),await a.write(w[f].eval),await bx(a),globalThis.gc&&globalThis.gc()}return 0;function g(a,d){let g;void 0===c[a]?e[a]=d:b.set(c[a],d*s),g=d<x.domainSize?f:d<2*x.domainSize?r.mul(f,A):r.mul(f,B),c[a]=g}}async function N(a){await bw(a,15);let b=Math.max(x.nPublic,1);for(let c=0;c<b;c++){let b=new aK(x.domainSize*s);b.set(r.one,c*s),await R(a,b)}await bx(a)}async function O(a){await bw(a,16),g=new aK((9*x.domainSize+18)*t),await k.readToBuffer(g,0,(9*x.domainSize+18)*t,m[2][0].p),await a.write(g),await bx(a)}async function P(a){let b=new fE(8,n,d);if(b.addPolynomial(0,v.QL),b.addPolynomial(1,v.QR),b.addPolynomial(2,v.QO),b.addPolynomial(3,v.QM),b.addPolynomial(4,v.QC),b.addPolynomial(5,v.S1),b.addPolynomial(6,v.S2),b.addPolynomial(7,v.S3),v.C0=b.getPolynomial(),v.C0.degree()>=8*x.domainSize)throw Error("C0 Polynomial is not well calculated");await bw(a,17),await a.write(v.C0.coef),await bx(a)}async function Q(a){let b;await bw(a,2);let c=n.q,d=(Math.floor((l.bitLength(c)-1)/64)+1)*8;await a.writeULE32(d),await bA(a,c,d);let e=n.r,f=(Math.floor((l.bitLength(e)-1)/64)+1)*8;await a.writeULE32(f),await bA(a,e,f),await a.writeULE32(x.nVars),await a.writeULE32(x.nPublic),await a.writeULE32(x.domainSize),await a.writeULE32(z.length),await a.writeULE32(y.length),await a.write(A),await a.write(B),await a.write(C),await a.write(D),await a.write(E),await a.write(F),b=await k.read(u,m[3][0].p+u),await a.write(b);let h=await v.C0.multiExponentiation(g,"C0");await a.write(h),await bx(a)}async function R(a,b){let[c,d]=await fm.to4T(b,x.domainSize,[],r);return await a.write(c),await a.write(d),[c,d]}}let{stringifyBigInts:fG}=m;async function fH(a,b,c,d){c&&c.info("FFLONK PROVER STARTED"),c&&c.info("> Reading witness file");let{fd:e,sections:f}=await bu(b,"wtns",2,0x2000000,8388608),g=await cK(e,f);c&&c.info("> Reading zkey file");let{fd:h,sections:i}=await bu(a,"zkey",2,0x2000000,8388608),j=await cx(h,i,void 0,d);if(10!==j.protocolId)throw Error("zkey file is not fflonk");if(!l.eq(j.r,g.q))throw Error("Curve of the witness does not match the curve of the proving key");if(g.nWitness!==j.nVars-j.nAdditions)throw Error(`Invalid witness length. Circuit: ${j.nVars}, witness: ${g.nWitness}, ${j.nAdditions}`);let k=j.curve,m=k.Fr,n=k.Fr.n8,o=2*k.G1.F.n8,p=j.domainSize*n;c&&(c.info("----------------------------"),c.info("  FFLONK PROVE SETTINGS"),c.info(`  Curve:         ${k.name}`),c.info(`  Circuit power: ${j.power}`),c.info(`  Domain size:   ${j.domainSize}`),c.info(`  Vars:          ${j.nVars}`),c.info(`  Public vars:   ${j.nPublic}`),c.info(`  Constraints:   ${j.nConstraints}`),c.info(`  Additions:     ${j.nAdditions}`),c.info("----------------------------")),c&&c.info("> Reading witness file data");let q=await bD(e,f,2);await e.close(),q.set(m.zero,0);let r=new aK(j.nAdditions*n),s={},t={},u={},v={},w={},x={},y=new e3(k,c);c&&c.info("> Reading Section 3. Additions"),await C(),c&&c.info("> Reading Sections 12,13,14. Sigma1, Sigma2 & Sigma 3"),c&&c.info("\xb7\xb7\xb7 Reading Sigma polynomials "),t.Sigma1=new fm(new aK(p),k,c),t.Sigma2=new fm(new aK(p),k,c),t.Sigma3=new fm(new aK(p),k,c),await h.readToBuffer(t.Sigma1.coef,0,p,i[12][0].p),await h.readToBuffer(t.Sigma2.coef,0,p,i[13][0].p),await h.readToBuffer(t.Sigma3.coef,0,p,i[14][0].p),c&&c.info("\xb7\xb7\xb7 Reading Sigma evaluations"),u.Sigma1=new fn(new aK(4*p),k,c),u.Sigma2=new fn(new aK(4*p),k,c),u.Sigma3=new fn(new aK(4*p),k,c),await h.readToBuffer(u.Sigma1.eval,0,4*p,i[12][0].p+p),await h.readToBuffer(u.Sigma2.eval,0,4*p,i[13][0].p+p),await h.readToBuffer(u.Sigma3.eval,0,4*p,i[14][0].p+p),c&&c.info("> Reading Section 16. Powers of Tau");let z=new aK(16*j.domainSize*o);await h.readToBuffer(z,0,(9*j.domainSize+18)*o,i[16][0].p),globalThis.gc&&globalThis.gc(),c&&c.info(""),c&&c.info("> ROUND 1"),await F(),delete t.T0,delete u.QL,delete u.QR,delete u.QM,delete u.QO,delete u.QC,globalThis.gc&&globalThis.gc(),c&&c.info("> ROUND 2"),await G(),delete s.A,delete s.B,delete s.C,delete u.A,delete u.B,delete u.C,delete u.Sigma1,delete u.Sigma2,delete u.Sigma3,delete u.lagrange1,delete u.Z,globalThis.gc&&globalThis.gc(),c&&c.info("> ROUND 3"),await H(),delete t.A,delete t.B,delete t.C,delete t.Z,delete t.T1,delete t.T2,delete t.Sigma1,delete t.Sigma2,delete t.Sigma3,delete t.QL,delete t.QR,delete t.QM,delete t.QC,delete t.QO,globalThis.gc&&globalThis.gc(),c&&c.info("> ROUND 4"),await I(),globalThis.gc&&globalThis.gc(),c&&c.info("> ROUND 5"),await J(),delete t.C0,delete t.C1,delete t.C2,delete t.R1,delete t.R2,delete t.F,delete t.L,delete t.ZT,delete t.ZTS2,await h.close(),globalThis.gc&&globalThis.gc(),y.addEvaluation("inv",function(){let a=w.xi;for(let b=0;b<j.power;b++)a=m.square(a);v.zh=m.sub(a,m.one),function(a,b,c,d){let e=d.Fr,f=b.length,g=e.mul(e.e(f),e.exp(b[0],f-2));for(let d=0;d<f;d++){let h=b[(f-1)*d%f],i=e.sub(c,b[d]);a[["LiS0_"+(d+1)]]=e.mul(e.mul(g,h),i)}}(v,x.S0.h0w8,w.y,k),function(a,b,c,d){let e=d.Fr,f=b.length,g=e.mul(e.e(f),e.exp(b[0],f-2));for(let d=0;d<f;d++){let h=b[(f-1)*d%f],i=e.sub(c,b[d]);a[["LiS1_"+(d+1)]]=e.mul(e.mul(g,h),i)}}(v,x.S1.h1w4,w.y,k),function(a,b,c,d,e,f,g){let h=g.Fr,i=h.mul(h.e(3),b[0]),j=h.sub(e,f),k=h.mul(i,j);for(let c=0;c<3;c++){let e=b[2*c%3],f=h.sub(d,b[c]);a[["LiS2_"+(c+1)]]=h.mul(k,h.mul(e,f))}let l=h.mul(h.e(3),c[0]),m=h.sub(f,e);k=h.mul(l,m);for(let b=0;b<3;b++){let e=c[2*b%3],f=h.sub(d,c[b]);a[["LiS2_"+(b+1+3)]]=h.mul(k,h.mul(e,f))}}(v,x.S2.h2w3,x.S2.h3w3,w.y,w.xi,w.xiw,k);let b=Math.max(1,j.nPublic),c=m.one;for(let a=0;a<b;a++)v["Li_"+(a+1)]=m.mul(m.e(j.domainSize),m.sub(w.xi,c)),c=m.mul(c,m.w[j.power]);let d=m.one;for(let a of Object.values(v))if(Array.isArray(a))for(let b of a)d=m.mul(d,b);else d=m.mul(d,a);return m.inv(d)}());let A=y.toObjectProof();A.protocol="fflonk",A.curve=k.name;let B=[];for(let a=1;a<=j.nPublic;a++){let b=a*n,c=q.slice(b,b+n);B.push(l.fromRprLE(c))}return c&&c.info("FFLONK PROVER FINISHED"),{proof:fG(A),publicSignals:fG(B)};async function C(){c&&c.info("\xb7\xb7\xb7 Computing additions");let a=await bD(h,i,3),b=8+2*n;for(let d=0;d<j.nAdditions;d++){c&&0!==d&&d%1e5==0&&c.info(`    addition ${d}/${j.nAdditions}`);let e=d*b,f=D(a,e),g=D(a,e+=4);e+=4;let h=a.slice(e,e+n);e+=n;let i=a.slice(e,e+n),k=E(f),l=E(g),o=m.add(m.mul(h,k),m.mul(i,l));r.set(o,n*d)}}function D(a,b){let c=a.slice(b,b+4);return new DataView(c.buffer,c.byteOffset,c.byteLength).getUint32(0,!0)}function E(a){let b=j.nVars-j.nAdditions;if(a<b)return q.slice(a*n,a*n+n);if(a<j.nVars){let c=(a-b)*n;return r.slice(c,c+n)}return m.zero}async function F(){w.b=[];for(let a=1;a<=9;a++)w.b[a]=m.random();c&&c.info("> Computing A, B, C wire polynomials"),await b(),c&&c.info("> Computing T0 polynomial"),await d(),c&&c.info("> Computing C1 polynomial"),await e(),c&&c.info("> Computing C1 multi exponentiation");let a=await t.C1.multiExponentiation(z,"C1");return y.addPolynomial("C1",a),0;async function b(){c&&c.info("\xb7\xb7\xb7 Reading data from zkey file"),s.A=new aK(p),s.B=new aK(p),s.C=new aK(p);let a=await bD(h,i,4),b=await bD(h,i,5),d=await bD(h,i,6);for(let c=0;c<j.nConstraints;c++){let e=c*n,f=4*c,g=D(a,f);s.A.set(E(g),e);let h=D(b,f);s.B.set(E(h),e);let i=D(d,f);s.C.set(E(i),e)}if(s.A.set(w.b[1],p-64),s.A.set(w.b[2],p-32),s.B.set(w.b[3],p-64),s.B.set(w.b[4],p-32),s.C.set(w.b[5],p-64),s.C.set(w.b[6],p-32),s.A=await m.batchToMontgomery(s.A),s.B=await m.batchToMontgomery(s.B),s.C=await m.batchToMontgomery(s.C),c&&c.info("\xb7\xb7\xb7 Computing A ifft"),t.A=await fm.fromEvaluations(s.A,k,c),c&&c.info("\xb7\xb7\xb7 Computing B ifft"),t.B=await fm.fromEvaluations(s.B,k,c),c&&c.info("\xb7\xb7\xb7 Computing C ifft"),t.C=await fm.fromEvaluations(s.C,k,c),c&&c.info("\xb7\xb7\xb7 Computing A fft"),u.A=await fn.fromPolynomial(t.A,4,k,c),c&&c.info("\xb7\xb7\xb7 Computing B fft"),u.B=await fn.fromPolynomial(t.B,4,k,c),c&&c.info("\xb7\xb7\xb7 Computing C fft"),u.C=await fn.fromPolynomial(t.C,4,k,c),t.A.degree()>=j.domainSize)throw Error("A Polynomial is not well calculated");if(t.B.degree()>=j.domainSize)throw Error("B Polynomial is not well calculated");if(t.C.degree()>=j.domainSize)throw Error("C Polynomial is not well calculated")}async function d(){c&&c.info(`\xb7\xb7\xb7 Reading sections 7, 8, 9, 10, 11. Q selectors`),u.QL=new fn(new aK(4*p),k,c),u.QR=new fn(new aK(4*p),k,c),u.QM=new fn(new aK(4*p),k,c),u.QO=new fn(new aK(4*p),k,c),u.QC=new fn(new aK(4*p),k,c),await h.readToBuffer(u.QL.eval,0,4*p,i[7][0].p+p),await h.readToBuffer(u.QR.eval,0,4*p,i[8][0].p+p),await h.readToBuffer(u.QM.eval,0,4*p,i[9][0].p+p),await h.readToBuffer(u.QO.eval,0,4*p,i[10][0].p+p),await h.readToBuffer(u.QC.eval,0,4*p,i[11][0].p+p),u.lagrange1=new fn(await bD(h,i,15),k,c),s.T0=new aK(4*p),c&&c.info("\xb7\xb7\xb7 Computing T0 evaluations");for(let a=0;a<4*j.domainSize;a++){c&&0!==a&&a%1e5==0&&c.info(`      T0 evaluation ${a}/${4*j.domainSize}`);let b=u.A.getEvaluation(a),d=u.B.getEvaluation(a),e=u.C.getEvaluation(a),f=u.QL.getEvaluation(a),g=u.QR.getEvaluation(a),h=u.QM.getEvaluation(a),i=u.QO.getEvaluation(a),k=u.QC.getEvaluation(a),l=m.zero;for(let b=0;b<j.nPublic;b++){let c=5*b*j.domainSize+j.domainSize+a,d=u.lagrange1.getEvaluation(c),e=s.A.slice(b*n,(b+1)*n);l=m.sub(l,m.mul(d,e))}let o=m.mul(b,f),p=m.mul(d,g),q=m.mul(m.mul(b,d),h),r=m.mul(e,i),t=m.add(o,m.add(p,m.add(q,m.add(r,m.add(k,l)))));s.T0.set(t,a*n)}if(c&&c.info("buffer T0: "+s.T0.byteLength/n),c&&c.info("\xb7\xb7\xb7 Computing T0 ifft"),t.T0=await fm.fromEvaluations(s.T0,k,c),c&&c.info("T0 length: "+t.T0.length()),c&&c.info("T0 degree: "+t.T0.degree()),c&&c.info("\xb7\xb7\xb7 Computing T0 / ZH"),t.T0.divByZerofier(j.domainSize,m.one),t.T0.degree()>=2*j.domainSize-2)throw Error(`T0 Polynomial is not well calculated (degree is ${t.T0.degree()} and must be less than ${2*j.domainSize+2}`);delete s.T0}async function e(){let a=new fE(4,k,c);if(a.addPolynomial(0,t.A),a.addPolynomial(1,t.B),a.addPolynomial(2,t.C),a.addPolynomial(3,t.T0),t.C1=a.getPolynomial(),t.C1.degree()>=8*j.domainSize-8)throw Error("C1 Polynomial is not well calculated")}}async function G(){c&&c.info("> Computing challenges beta and gamma");let a=new fk(k);a.addPolCommitment(j.C0);for(let b=0;b<j.nPublic;b++)a.addScalar(s.A.slice(b*n,b*n+n));a.addPolCommitment(y.getPolynomial("C1")),w.beta=a.getChallenge(),c&&c.info("\xb7\xb7\xb7 challenges.beta: "+m.toString(w.beta)),a.reset(),a.addScalar(w.beta),w.gamma=a.getChallenge(),c&&c.info("\xb7\xb7\xb7 challenges.gamma: "+m.toString(w.gamma)),c&&c.info("> Computing Z polynomial"),await d(),c&&c.info("> Computing T1 polynomial"),await e(),c&&c.info("> Computing T2 polynomial"),await f(),c&&c.info("> Computing C2 polynomial"),await g(),c&&c.info("> Computing C2 multi exponentiation");let b=await t.C2.multiExponentiation(z,"C2");return y.addPolynomial("C2",b),0;async function d(){c&&c.info("\xb7\xb7\xb7 Computing Z evaluations");let a=new aK(p),b=new aK(p);a.set(m.one,0),b.set(m.one,0);let d=m.one;for(let e=0;e<j.domainSize;e++){c&&0!==e&&e%1e5==0&&c.info(`    Z evaluation ${e}/${j.domainSize}`);let f=e*n,g=m.mul(w.beta,d),h=s.A.slice(f,f+n);h=m.add(h,g),h=m.add(h,w.gamma);let i=s.B.slice(f,f+n);i=m.add(i,m.mul(j.k1,g)),i=m.add(i,w.gamma);let k=s.C.slice(f,f+n);k=m.add(k,m.mul(j.k2,g)),k=m.add(k,w.gamma);let l=m.mul(h,m.mul(i,k)),o=s.A.slice(f,f+n);o=m.add(o,m.mul(w.beta,u.Sigma1.getEvaluation(4*e))),o=m.add(o,w.gamma);let p=s.B.slice(f,f+n);p=m.add(p,m.mul(w.beta,u.Sigma2.getEvaluation(4*e))),p=m.add(p,w.gamma);let q=s.C.slice(f,f+n);q=m.add(q,m.mul(w.beta,u.Sigma3.getEvaluation(4*e))),q=m.add(q,w.gamma);let r=m.mul(o,m.mul(p,q));l=m.mul(a.slice(f,f+n),l),a.set(l,(e+1)%j.domainSize*n),r=m.mul(b.slice(f,f+n),r),b.set(r,(e+1)%j.domainSize*n),d=m.mul(d,m.w[j.power])}b=await m.batchInverse(b);for(let c=0;c<j.domainSize;c++){let d=c*n,e=m.mul(a.slice(d,d+n),b.slice(d,d+n));a.set(e,d)}if(s.Z=a,!m.eq(a.slice(0,n),m.one))throw Error("Copy constraints does not match");if(c&&c.info("\xb7\xb7\xb7 Computing Z ifft"),t.Z=await fm.fromEvaluations(s.Z,k,c),c&&c.info("\xb7\xb7\xb7 Computing Z fft"),u.Z=await fn.fromPolynomial(t.Z,4,k,c),t.Z.blindCoefficients([w.b[9],w.b[8],w.b[7]]),t.Z.degree()>=j.domainSize+3)throw Error("Z Polynomial is not well calculated");delete s.Z}async function e(){c&&c.info("\xb7\xb7\xb7 Computing T1 evaluations"),s.T1=new aK(2*p),s.T1z=new aK(2*p);let a=m.one;for(let b=0;b<2*j.domainSize;b++){c&&0!==b&&b%1e5==0&&c.info(`    T1 evaluation ${b}/${4*j.domainSize}`);let d=m.square(a),e=u.Z.getEvaluation(2*b),f=m.add(m.add(m.mul(w.b[7],d),m.mul(w.b[8],a)),w.b[9]),g=u.lagrange1.getEvaluation(j.domainSize+2*b),h=m.mul(m.sub(e,m.one),g),i=m.mul(f,g);s.T1.set(h,b*n),s.T1z.set(i,b*n),a=m.mul(a,m.w[j.power+1])}if(c&&c.info("\xb7\xb7\xb7 Computing T1 ifft"),t.T1=await fm.fromEvaluations(s.T1,k,c),t.T1.divByZerofier(j.domainSize,m.one),c&&c.info("\xb7\xb7\xb7 Computing T1z ifft"),t.T1z=await fm.fromEvaluations(s.T1z,k,c),t.T1.add(t.T1z),t.T1.degree()>=j.domainSize+2)throw Error("T1 Polynomial is not well calculated");delete s.T1,delete s.T1z,delete t.T1z}async function f(){c&&c.info("\xb7\xb7\xb7 Computing T2 evaluations"),s.T2=new aK(4*p),s.T2z=new aK(4*p);let a=m.one;for(let b=0;b<4*j.domainSize;b++){c&&0!==b&&b%1e5==0&&c.info(`    T2 evaluation ${b}/${4*j.domainSize}`);let d=m.square(a),e=m.mul(a,m.w[j.power]),f=m.square(e),g=u.A.getEvaluation(b),h=u.B.getEvaluation(b),i=u.C.getEvaluation(b),k=u.Z.getEvaluation(b),l=u.Z.getEvaluation((4*j.domainSize+4+b)%(4*j.domainSize)),o=m.add(m.add(m.mul(w.b[7],d),m.mul(w.b[8],a)),w.b[9]),p=m.add(m.add(m.mul(w.b[7],f),m.mul(w.b[8],e)),w.b[9]),q=u.Sigma1.getEvaluation(b),r=u.Sigma2.getEvaluation(b),t=u.Sigma3.getEvaluation(b),v=m.mul(w.beta,a),x=m.add(g,v);x=m.add(x,w.gamma);let y=m.add(h,m.mul(v,j.k1));y=m.add(y,w.gamma);let z=m.add(i,m.mul(v,j.k2));z=m.add(z,w.gamma);let A=m.mul(m.mul(m.mul(x,y),z),k),B=m.mul(m.mul(m.mul(x,y),z),o),C=m.add(g,m.mul(w.beta,q));C=m.add(C,w.gamma);let D=m.add(h,m.mul(w.beta,r));D=m.add(D,w.gamma);let E=m.add(i,m.mul(w.beta,t));E=m.add(E,w.gamma);let F=m.mul(m.mul(m.mul(C,D),E),l),G=m.mul(m.mul(m.mul(C,D),E),p),H=m.sub(A,F),I=m.sub(B,G);s.T2.set(H,b*n),s.T2z.set(I,b*n),a=m.mul(a,m.w[j.power+2])}if(c&&c.info("\xb7\xb7\xb7 Computing T2 ifft"),t.T2=await fm.fromEvaluations(s.T2,k,c),c&&c.info("\xb7\xb7\xb7 Computing T2 / ZH"),t.T2.divByZerofier(j.domainSize,m.one),c&&c.info("\xb7\xb7\xb7 Computing T2z ifft"),t.T2z=await fm.fromEvaluations(s.T2z,k,c),t.T2.add(t.T2z),t.T2.degree()>=3*j.domainSize)throw Error("T2 Polynomial is not well calculated");delete s.T2,delete s.T2z,delete t.T2z}async function g(){let a=new fE(3,k,c);if(a.addPolynomial(0,t.Z),a.addPolynomial(1,t.T1),a.addPolynomial(2,t.T2),t.C2=a.getPolynomial(),t.C2.degree()>=9*j.domainSize)throw Error("C2 Polynomial is not well calculated")}}async function H(){c&&c.info("> Computing challenge xi");let a=new fk(k);a.addScalar(w.gamma),a.addPolCommitment(y.getPolynomial("C2")),w.xiSeed=a.getChallenge();let b=m.square(w.xiSeed);x.w8=[],x.w8[0]=m.one;for(let a=1;a<8;a++)x.w8[a]=m.mul(x.w8[a-1],j.w8);x.w4=[],x.w4[0]=m.one;for(let a=1;a<4;a++)x.w4[a]=m.mul(x.w4[a-1],j.w4);x.w3=[],x.w3[0]=m.one,x.w3[1]=j.w3,x.w3[2]=m.square(j.w3),x.S0={},x.S0.h0w8=[],x.S0.h0w8[0]=m.mul(b,w.xiSeed);for(let a=1;a<8;a++)x.S0.h0w8[a]=m.mul(x.S0.h0w8[0],x.w8[a]);x.S1={},x.S1.h1w4=[],x.S1.h1w4[0]=m.square(x.S0.h0w8[0]);for(let a=1;a<4;a++)x.S1.h1w4[a]=m.mul(x.S1.h1w4[0],x.w4[a]);x.S2={},x.S2.h2w3=[],x.S2.h2w3[0]=m.mul(x.S1.h1w4[0],b),x.S2.h2w3[1]=m.mul(x.S2.h2w3[0],x.w3[1]),x.S2.h2w3[2]=m.mul(x.S2.h2w3[0],x.w3[2]),x.S2.h3w3=[],x.S2.h3w3[0]=m.mul(x.S2.h2w3[0],j.wr),x.S2.h3w3[1]=m.mul(x.S2.h3w3[0],x.w3[1]),x.S2.h3w3[2]=m.mul(x.S2.h3w3[0],x.w3[2]),w.xi=m.mul(m.square(x.S2.h2w3[0]),x.S2.h2w3[0]),c&&c.info("\xb7\xb7\xb7 challenges.xi: "+m.toString(w.xi)),t.QL=new fm(new aK(p),k,c),t.QR=new fm(new aK(p),k,c),t.QM=new fm(new aK(p),k,c),t.QO=new fm(new aK(p),k,c),t.QC=new fm(new aK(p),k,c),await h.readToBuffer(t.QL.coef,0,p,i[7][0].p),await h.readToBuffer(t.QR.coef,0,p,i[8][0].p),await h.readToBuffer(t.QM.coef,0,p,i[9][0].p),await h.readToBuffer(t.QO.coef,0,p,i[10][0].p),await h.readToBuffer(t.QC.coef,0,p,i[11][0].p),c&&c.info("\xb7\xb7\xb7 Computing evaluations"),y.addEvaluation("ql",t.QL.evaluate(w.xi)),y.addEvaluation("qr",t.QR.evaluate(w.xi)),y.addEvaluation("qm",t.QM.evaluate(w.xi)),y.addEvaluation("qo",t.QO.evaluate(w.xi)),y.addEvaluation("qc",t.QC.evaluate(w.xi)),y.addEvaluation("s1",t.Sigma1.evaluate(w.xi)),y.addEvaluation("s2",t.Sigma2.evaluate(w.xi)),y.addEvaluation("s3",t.Sigma3.evaluate(w.xi)),y.addEvaluation("a",t.A.evaluate(w.xi)),y.addEvaluation("b",t.B.evaluate(w.xi)),y.addEvaluation("c",t.C.evaluate(w.xi)),y.addEvaluation("z",t.Z.evaluate(w.xi)),w.xiw=m.mul(w.xi,m.w[j.power]),y.addEvaluation("zw",t.Z.evaluate(w.xiw)),y.addEvaluation("t1w",t.T1.evaluate(w.xiw)),y.addEvaluation("t2w",t.T2.evaluate(w.xiw))}async function I(){c&&c.info("> Computing challenge alpha");let a=new fk(k);a.addScalar(w.xiSeed),a.addScalar(y.getEvaluation("ql")),a.addScalar(y.getEvaluation("qr")),a.addScalar(y.getEvaluation("qm")),a.addScalar(y.getEvaluation("qo")),a.addScalar(y.getEvaluation("qc")),a.addScalar(y.getEvaluation("s1")),a.addScalar(y.getEvaluation("s2")),a.addScalar(y.getEvaluation("s3")),a.addScalar(y.getEvaluation("a")),a.addScalar(y.getEvaluation("b")),a.addScalar(y.getEvaluation("c")),a.addScalar(y.getEvaluation("z")),a.addScalar(y.getEvaluation("zw")),a.addScalar(y.getEvaluation("t1w")),a.addScalar(y.getEvaluation("t2w")),w.alpha=a.getChallenge(),c&&c.info("\xb7\xb7\xb7 challenges.alpha: "+m.toString(w.alpha)),c&&c.info("> Reading C0 polynomial"),t.C0=new fm(new aK(8*p),k,c),await h.readToBuffer(t.C0.coef,0,8*p,i[17][0].p),c&&c.info("> Computing R0 polynomial"),function(){if(t.R0=fm.lagrangePolynomialInterpolation([x.S0.h0w8[0],x.S0.h0w8[1],x.S0.h0w8[2],x.S0.h0w8[3],x.S0.h0w8[4],x.S0.h0w8[5],x.S0.h0w8[6],x.S0.h0w8[7]],[t.C0.evaluate(x.S0.h0w8[0]),t.C0.evaluate(x.S0.h0w8[1]),t.C0.evaluate(x.S0.h0w8[2]),t.C0.evaluate(x.S0.h0w8[3]),t.C0.evaluate(x.S0.h0w8[4]),t.C0.evaluate(x.S0.h0w8[5]),t.C0.evaluate(x.S0.h0w8[6]),t.C0.evaluate(x.S0.h0w8[7])],k),t.R0.degree()>7)throw Error("R0 Polynomial is not well calculated")}(),c&&c.info("> Computing R1 polynomial"),function(){if(t.R1=fm.lagrangePolynomialInterpolation([x.S1.h1w4[0],x.S1.h1w4[1],x.S1.h1w4[2],x.S1.h1w4[3]],[t.C1.evaluate(x.S1.h1w4[0]),t.C1.evaluate(x.S1.h1w4[1]),t.C1.evaluate(x.S1.h1w4[2]),t.C1.evaluate(x.S1.h1w4[3])],k),t.R1.degree()>3)throw Error("R1 Polynomial is not well calculated")}(),c&&c.info("> Computing R2 polynomial"),function(){if(t.R2=fm.lagrangePolynomialInterpolation([x.S2.h2w3[0],x.S2.h2w3[1],x.S2.h2w3[2],x.S2.h3w3[0],x.S2.h3w3[1],x.S2.h3w3[2]],[t.C2.evaluate(x.S2.h2w3[0]),t.C2.evaluate(x.S2.h2w3[1]),t.C2.evaluate(x.S2.h2w3[2]),t.C2.evaluate(x.S2.h3w3[0]),t.C2.evaluate(x.S2.h3w3[1]),t.C2.evaluate(x.S2.h3w3[2])],k),t.R2.degree()>5)throw Error("R2 Polynomial is not well calculated")}(),c&&c.info("> Computing F polynomial"),await d(),c&&c.info("> Computing W1 multi exponentiation");let b=await t.F.multiExponentiation(z,"W1");return y.addPolynomial("W1",b),0;async function d(){c&&c.info("\xb7\xb7\xb7 Computing F polynomial"),t.F=fm.fromPolynomial(t.C0,k,c),t.F.sub(t.R0),t.F.divByZerofier(8,w.xi);let a=fm.fromPolynomial(t.C1,k,c);a.sub(t.R1),a.mulScalar(w.alpha),a.divByZerofier(4,w.xi);let b=fm.fromPolynomial(t.C2,k,c);if(b.sub(t.R2),b.mulScalar(m.square(w.alpha)),b.divByZerofier(3,w.xi),b.divByZerofier(3,w.xiw),t.F.add(a),t.F.add(b),t.F.degree()>=9*j.domainSize-6)throw Error("F Polynomial is not well calculated")}}async function J(){c&&c.info("> Computing challenge y");let a=new fk(k);a.addScalar(w.alpha),a.addPolCommitment(y.getPolynomial("W1")),w.y=a.getChallenge(),c&&c.info("\xb7\xb7\xb7 challenges.y: "+m.toString(w.y)),c&&c.info("> Computing L polynomial"),await g(),c&&c.info("> Computing ZTS2 polynomial"),await i();let b=t.ZTS2.evaluate(w.y);b=m.inv(b),t.L.mulScalar(b);let d=fm.fromCoefficientsArray([m.neg(w.y),m.one],k);c&&c.info("> Computing W' = L / ZTS2 polynomial");let e=t.L.divBy(d);if(e.degree()>0)throw Error(`Degree of L(X)/(ZTS2(y)(X-y)) remainder is ${e.degree()} and should be 0`);if(t.L.degree()>=9*j.domainSize-1)throw Error("Degree of L(X)/(ZTS2(y)(X-y)) is not correct");c&&c.info("> Computing W' multi exponentiation");let f=await t.L.multiExponentiation(z,"W2");return y.addPolynomial("W2",f),0;async function g(){c&&c.info("\xb7\xb7\xb7 Computing L polynomial");let a=t.R0.evaluate(w.y),b=t.R1.evaluate(w.y),d=t.R2.evaluate(w.y),e=m.sub(w.y,x.S0.h0w8[0]);for(let a=1;a<8;a++)e=m.mul(e,m.sub(w.y,x.S0.h0w8[a]));let f=m.sub(w.y,x.S1.h1w4[0]);for(let a=1;a<4;a++)f=m.mul(f,m.sub(w.y,x.S1.h1w4[a]));let g=m.sub(w.y,x.S2.h2w3[0]);for(let a=1;a<3;a++)g=m.mul(g,m.sub(w.y,x.S2.h2w3[a]));for(let a=0;a<3;a++)g=m.mul(g,m.sub(w.y,x.S2.h3w3[a]));let i=m.mul(f,g),l=m.mul(w.alpha,m.mul(e,g)),n=m.mul(m.square(w.alpha),m.mul(e,f));v.denH1=f,v.denH2=g,t.L=fm.fromPolynomial(t.C0,k,c),t.L.subScalar(a),t.L.mulScalar(i);let o=fm.fromPolynomial(t.C1,k,c);o.subScalar(b),o.mulScalar(l);let p=fm.fromPolynomial(t.C2,k,c);p.subScalar(d),p.mulScalar(n),t.L.add(o),t.L.add(p),c&&c.info("> Computing ZT polynomial"),await h();let q=t.ZT.evaluate(w.y);if(t.F.mulScalar(q),t.L.sub(t.F),t.L.degree()>=9*j.domainSize)throw Error("L Polynomial is not well calculated");delete s.L}async function h(){t.ZT=fm.zerofierPolynomial([x.S0.h0w8[0],x.S0.h0w8[1],x.S0.h0w8[2],x.S0.h0w8[3],x.S0.h0w8[4],x.S0.h0w8[5],x.S0.h0w8[6],x.S0.h0w8[7],x.S1.h1w4[0],x.S1.h1w4[1],x.S1.h1w4[2],x.S1.h1w4[3],x.S2.h2w3[0],x.S2.h2w3[1],x.S2.h2w3[2],x.S2.h3w3[0],x.S2.h3w3[1],x.S2.h3w3[2]],k)}async function i(){t.ZTS2=fm.zerofierPolynomial([x.S1.h1w4[0],x.S1.h1w4[1],x.S1.h1w4[2],x.S1.h1w4[3],x.S2.h2w3[0],x.S2.h2w3[1],x.S2.h2w3[2],x.S2.h3w3[0],x.S2.h3w3[1],x.S2.h3w3[2]],k)}}}let{unstringifyBigInts:fI}=m;async function fJ(a,b,c,d,e,f){let g=fI(a),h={type:"mem"};return await cW(g,b,h,e),await fH(c,h,d,f)}let{unstringifyBigInts:fK}=m;async function fL(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;let t,u,v,w,x;d&&d.info("FFLONK VERIFIER STARTED"),a=fK(a),c=fK(c);let y=await bL(a.curve),z=(e=y,(f=a).k1=e.Fr.fromObject(f.k1),f.k2=e.Fr.fromObject(f.k2),f.w=e.Fr.fromObject(f.w),f.w3=e.Fr.fromObject(f.w3),f.w4=e.Fr.fromObject(f.w4),f.w8=e.Fr.fromObject(f.w8),f.wr=e.Fr.fromObject(f.wr),f.X_2=e.G2.fromObject(f.X_2),f.C0=e.G1.fromObject(f.C0),f),A=new e3(y,d);A.fromObjectProof(c);let B=fK(b);if(B.length!==z.nPublic)return d.error("Number of public signals does not match with vk"),!1;let C=y.Fr;if(d&&(d.info("----------------------------"),d.info("  FFLONK VERIFY SETTINGS"),d.info(`  Curve:         ${y.name}`),d.info(`  Circuit power: ${z.power}`),d.info(`  Domain size:   ${2**z.power}`),d.info(`  Public vars:   ${z.nPublic}`),d.info("----------------------------")),d&&d.info("> Checking commitments belong to G1"),g=y,h=A,i=z,!((t=g.G1).isValid(h.polynomials.C1)&&t.isValid(h.polynomials.C2)&&t.isValid(h.polynomials.W1)&&t.isValid(h.polynomials.W2)&&t.isValid(i.C0)))return d&&d.error("Proof commitments are not valid"),!1;if(d&&d.info("> Checking evaluations belong to F"),!(fN(j=y,(k=A).evaluations.ql)&&fN(j,k.evaluations.qr)&&fN(j,k.evaluations.qm)&&fN(j,k.evaluations.qo)&&fN(j,k.evaluations.qc)&&fN(j,k.evaluations.s1)&&fN(j,k.evaluations.s2)&&fN(j,k.evaluations.s3)&&fN(j,k.evaluations.a)&&fN(j,k.evaluations.b)&&fN(j,k.evaluations.c)&&fN(j,k.evaluations.z)&&fN(j,k.evaluations.zw)&&fN(j,k.evaluations.t1w)&&fN(j,k.evaluations.t2w)))return d&&d.error("Proof evaluations are not valid."),!1;if(d&&d.info("> Checking public inputs belong to F"),!function(a,b){for(let c=0;c<b.length;c++)if(!fM(a,b[c]))return!1;return!0}(y,B))return d&&d.error("Public inputs are not valid."),!1;d&&d.info("> Computing challenges");let{challenges:D,roots:E}=function(a,b,c,d,e){let f=a.Fr,g={},h={},i=new fk(a);i.addPolCommitment(c.C0);for(let a=0;a<d.length;a++)i.addScalar(f.e(d[a]));i.addPolCommitment(b.polynomials.C1),g.beta=i.getChallenge(),i.reset(),i.addScalar(g.beta),g.gamma=i.getChallenge(),i.reset(),i.addScalar(g.gamma),i.addPolCommitment(b.polynomials.C2);let j=i.getChallenge(),k=f.square(j),l=[];l[1]=c.w8,l[2]=f.square(c.w8),l[3]=f.mul(l[2],c.w8),l[4]=f.mul(l[3],c.w8),l[5]=f.mul(l[4],c.w8),l[6]=f.mul(l[5],c.w8),l[7]=f.mul(l[6],c.w8);let m=[];m[1]=c.w4,m[2]=f.square(c.w4),m[3]=f.mul(m[2],c.w4);let n=[];n[1]=c.w3,n[2]=f.square(c.w3),h.S0={},h.S0.h0w8=[],h.S0.h0w8[0]=f.mul(k,j);for(let a=1;a<8;a++)h.S0.h0w8[a]=f.mul(h.S0.h0w8[0],l[a]);h.S1={},h.S1.h1w4=[],h.S1.h1w4[0]=f.square(h.S0.h0w8[0]);for(let a=1;a<4;a++)h.S1.h1w4[a]=f.mul(h.S1.h1w4[0],m[a]);h.S2={},h.S2.h2w3=[],h.S2.h2w3[0]=f.mul(h.S1.h1w4[0],k),h.S2.h2w3[1]=f.mul(h.S2.h2w3[0],n[1]),h.S2.h2w3[2]=f.mul(h.S2.h2w3[0],n[2]),h.S2.h3w3=[],h.S2.h3w3[0]=f.mul(h.S2.h2w3[0],c.wr),h.S2.h3w3[1]=f.mul(h.S2.h3w3[0],n[1]),h.S2.h3w3[2]=f.mul(h.S2.h3w3[0],n[2]),g.xi=f.mul(f.square(h.S2.h2w3[0]),h.S2.h2w3[0]),g.xiw=f.mul(g.xi,f.w[c.power]),g.xiN=g.xi,c.domainSize=1;for(let a=0;a<c.power;a++)g.xiN=f.square(g.xiN),c.domainSize*=2;return i.reset(),i.addScalar(j),i.addScalar(b.evaluations.ql),i.addScalar(b.evaluations.qr),i.addScalar(b.evaluations.qm),i.addScalar(b.evaluations.qo),i.addScalar(b.evaluations.qc),i.addScalar(b.evaluations.s1),i.addScalar(b.evaluations.s2),i.addScalar(b.evaluations.s3),i.addScalar(b.evaluations.a),i.addScalar(b.evaluations.b),i.addScalar(b.evaluations.c),i.addScalar(b.evaluations.z),i.addScalar(b.evaluations.zw),i.addScalar(b.evaluations.t1w),i.addScalar(b.evaluations.t2w),g.alpha=i.getChallenge(),i.reset(),i.addScalar(g.alpha),i.addPolCommitment(b.polynomials.W1),g.y=i.getChallenge(),e&&(e.info("\xb7\xb7\xb7 challenges.beta:  "+f.toString(g.beta)),e.info("\xb7\xb7\xb7 challenges.gamma: "+f.toString(g.gamma)),e.info("\xb7\xb7\xb7 challenges.xi:    "+f.toString(g.xi)),e.info("\xb7\xb7\xb7 challenges.alpha: "+f.toString(g.alpha)),e.info("\xb7\xb7\xb7 challenges.y:     "+f.toString(g.y))),{challenges:g,roots:h}}(y,A,z,B,d);d&&d.info("> Computing Zero polynomial evaluation Z_H(xi)"),D.zh=C.sub(D.xiN,C.one),D.invzh=C.inv(D.zh),d&&d.info("> Computing Lagrange evaluations");let F=await fO(y,D,z);d&&d.info("> Computing polynomial identities PI(X)");let G=function(a,b,c){let d=a.Fr,e=d.zero;for(let a=0;a<b.length;a++){let f=d.e(b[a]);e=d.sub(e,d.mul(f,c[a+1]))}return e}(y,B,F);d&&d.info("> Computing r0(y)");let H=function(a,b,c,d,e){let f=d.Fr,g=fQ(c.S0.h0w8,b.y,b.xi,d);e&&e.info("\xb7\xb7\xb7 Computing r0(y)");let h=f.zero;for(let b=0;b<8;b++){let d=[];d[1]=c.S0.h0w8[b];for(let a=2;a<8;a++)d[a]=f.mul(d[a-1],c.S0.h0w8[b]);let e=f.add(a.evaluations.ql,f.mul(a.evaluations.qr,d[1]));e=f.add(e,f.mul(a.evaluations.qo,d[2])),e=f.add(e,f.mul(a.evaluations.qm,d[3])),e=f.add(e,f.mul(a.evaluations.qc,d[4])),e=f.add(e,f.mul(a.evaluations.s1,d[5])),e=f.add(e,f.mul(a.evaluations.s2,d[6])),e=f.add(e,f.mul(a.evaluations.s3,d[7])),h=f.add(h,f.mul(e,g[b]))}return h}(A,D,E,y,d);d&&d.info("> Computing r1(y)");let I=function(a,b,c,d,e,f){let g=e.Fr,h=fQ(c.S1.h1w4,b.y,b.xi,e);f&&f.info("\xb7\xb7\xb7 Computing T0(xi)");let i=g.mul(a.evaluations.ql,a.evaluations.a);i=g.add(i,g.mul(a.evaluations.qr,a.evaluations.b)),i=g.add(i,g.mul(a.evaluations.qm,g.mul(a.evaluations.a,a.evaluations.b))),i=g.add(i,g.mul(a.evaluations.qo,a.evaluations.c)),i=g.add(i,a.evaluations.qc),i=g.add(i,d),i=g.mul(i,b.invzh),f&&f.info("\xb7\xb7\xb7 Computing C1(h_1_4^i) values");let j=g.zero;for(let b=0;b<4;b++){let d=a.evaluations.a;d=g.add(d,g.mul(c.S1.h1w4[b],a.evaluations.b));let e=g.square(c.S1.h1w4[b]);d=g.add(d,g.mul(e,a.evaluations.c)),d=g.add(d,g.mul(g.mul(e,c.S1.h1w4[b]),i)),j=g.add(j,g.mul(d,h[b]))}return j}(A,D,E,G,y,d);d&&d.info("> Computing r2(y)");let J=function(a,b,c,d,e,f,g){let h=f.Fr,i=function(a,b,c,d,e){let f=e.Fr,g=[],h=a[0].length,i=h*a.length,j=f.exp(b,i),k=f.mul(f.add(c,d),f.exp(b,h)),l=f.mul(c,d),m=f.add(f.sub(j,k),l),n=f.mul(f.mul(f.e(h),a[0][0]),f.sub(c,d));for(let c=0;c<h;c++){let d=a[0][(h-1)*c%h],e=f.sub(b,a[0][c]),i=f.mul(n,f.mul(d,e));g[c]=f.div(m,i)}n=f.mul(f.mul(f.e(h),a[1][0]),f.sub(d,c));for(let c=0;c<h;c++){let d=a[1][(h-1)*c%h],e=f.sub(b,a[1][c]),i=f.mul(n,f.mul(d,e));g[c+h]=f.div(m,i)}return g}([c.S2.h2w3,c.S2.h3w3],b.y,b.xi,b.xiw,f);g&&g.info("\xb7\xb7\xb7 Computing T1(xi)");let j=h.sub(a.evaluations.z,h.one);j=h.mul(j,d),j=h.mul(j,b.invzh),g&&g.info("\xb7\xb7\xb7 Computing T2(xi)");let k=h.mul(b.beta,b.xi),l=h.add(a.evaluations.a,h.add(k,b.gamma)),m=h.add(a.evaluations.b,h.add(h.mul(k,e.k1),b.gamma)),n=h.add(a.evaluations.c,h.add(h.mul(k,e.k2),b.gamma)),o=h.mul(l,h.mul(m,h.mul(n,a.evaluations.z))),p=h.add(a.evaluations.a,h.add(h.mul(b.beta,a.evaluations.s1),b.gamma)),q=h.add(a.evaluations.b,h.add(h.mul(b.beta,a.evaluations.s2),b.gamma)),r=h.add(a.evaluations.c,h.add(h.mul(b.beta,a.evaluations.s3),b.gamma)),s=h.mul(p,h.mul(q,h.mul(r,a.evaluations.zw))),t=h.sub(o,s);t=h.mul(t,b.invzh),g&&g.info("\xb7\xb7\xb7 Computing C2(h_2_3^i) values");let u=h.zero;for(let b=0;b<3;b++){let d=h.add(a.evaluations.z,h.mul(c.S2.h2w3[b],j));d=h.add(d,h.mul(h.square(c.S2.h2w3[b]),t)),u=h.add(u,h.mul(d,i[b]))}g&&g.info("\xb7\xb7\xb7 Computing C2(h_3_3^i) values");for(let b=0;b<3;b++){let d=h.add(a.evaluations.zw,h.mul(c.S2.h3w3[b],a.evaluations.t1w));d=h.add(d,h.mul(h.square(c.S2.h3w3[b]),a.evaluations.t2w)),u=h.add(u,h.mul(d,i[b+3]))}return u}(A,D,E,F[1],z,y,d);d&&d.info("> Computing F");let K=function(a,b,c,d,e){let f=a.G1,g=a.Fr,h=g.sub(d.y,e.S0.h0w8[0]);for(let a=1;a<8;a++)h=g.mul(h,g.sub(d.y,e.S0.h0w8[a]));d.temp=h;let i=g.sub(d.y,e.S1.h1w4[0]);for(let a=1;a<4;a++)i=g.mul(i,g.sub(d.y,e.S1.h1w4[a]));let j=g.sub(d.y,e.S2.h2w3[0]);for(let a=1;a<3;a++)j=g.mul(j,g.sub(d.y,e.S2.h2w3[a]));for(let a=0;a<3;a++)j=g.mul(j,g.sub(d.y,e.S2.h3w3[a]));d.quotient1=g.mul(d.alpha,g.div(h,i)),d.quotient2=g.mul(g.square(d.alpha),g.div(h,j));let k=f.timesFr(b.polynomials.C1,d.quotient1),l=f.timesFr(b.polynomials.C2,d.quotient2);return f.add(c.C0,f.add(k,l))}(y,A,z,D,E);d&&d.info("> Computing E");let L=(l=y,m=D,n=H,o=I,p=J,u=l.G1,w=(v=l.Fr).mul(o,m.quotient1),x=v.mul(p,m.quotient2),u.timesFr(u.one,v.add(n,v.add(w,x))));d&&d.info("> Computing J");let M=(q=y,r=A,s=D,q.G1.timesFr(r.polynomials.W1,s.temp));d&&d.info("> Validate all evaluations with a pairing");let N=await fP(y,A,D,z,K,L,M);return d&&(N?d.info("PROOF VERIFIED SUCCESSFULLY"):d.warn("Invalid Proof")),d&&d.info("FFLONK VERIFIER FINISHED"),N}function fM(a,b){return l.geq(b,0)&&l.lt(b,a.r)}function fN(a,b){return fM(a,l.fromRprLE(b))}async function fO(a,b,c){let d=a.Fr,e=Math.max(1,c.nPublic),f=new aK(e*d.n8),g=new aK(e*d.n8),h=d.one;for(let a=0;a<e;a++){let e=a*d.n8;f.set(d.mul(h,b.zh),e),g.set(d.mul(d.e(c.domainSize),d.sub(b.xi,h)),e),h=d.mul(h,c.w)}g=await d.batchInverse(g);let i=[];for(let a=0;a<e;a++){let b=a*d.n8;i[a+1]=d.mul(f.slice(b,b+d.n8),g.slice(b,b+d.n8))}return i}async function fP(a,b,c,d,e,f,g){let h=a.G1,i=h.timesFr(b.polynomials.W2,c.y);i=h.add(h.sub(h.sub(e,f),g),i);let j=a.G2.one,k=b.polynomials.W2,l=d.X_2;return await a.pairingEq(h.neg(i),j,k,l)}function fQ(a,b,c,d){let e=d.Fr,f=a.length,g=e.sub(e.exp(b,f),c),h=e.mul(e.e(f),e.exp(a[0],f-2)),i=[];for(let c=0;c<f;c++){let d=a[(f-1)*c%f],j=e.sub(b,a[c]);i[c]=e.div(g,e.mul(e.mul(h,d),j))}return i}let{unstringifyBigInts:fR}=m;function fS(a){let b=a.toString(16);for(;b.length<64;)b="0"+b;return`0x${b}`}async function fT(a,b){let c=fR(b),d=fR(a),e=await bL(c.curve);e.G1,e.Fr;let f="";for(let a=0;a<d.length;a++)""!==f&&(f+=","),f+=fS(d[a]);return`[${fS(c.polynomials.C1[0])}, ${fS(c.polynomials.C1[1])},${fS(c.polynomials.C2[0])},${fS(c.polynomials.C2[1])},${fS(c.polynomials.W1[0])},${fS(c.polynomials.W1[1])},${fS(c.polynomials.W2[0])},${fS(c.polynomials.W2[1])},${fS(c.evaluations.ql)},${fS(c.evaluations.qr)},${fS(c.evaluations.qm)},${fS(c.evaluations.qo)},${fS(c.evaluations.qc)},${fS(c.evaluations.s1)},${fS(c.evaluations.s2)},${fS(c.evaluations.s3)},${fS(c.evaluations.a)},${fS(c.evaluations.b)},${fS(c.evaluations.c)},${fS(c.evaluations.z)},${fS(c.evaluations.zw)},${fS(c.evaluations.t1w)},${fS(c.evaluations.t2w)},${fS(c.evaluations.inv)}],[${f}]`}},9497:a=>{a.exports=function(a,b,c,d,e,f){void 0===f&&(f=d<e);let g=a.addFunction(b);g.addParam("pIn1","i32"),g.addParam("pIn2","i32"),g.addParam("n","i32"),g.addParam("pOut","i32"),g.addLocal("i","i32"),g.addLocal("itIn1","i32"),g.addLocal("itIn2","i32"),g.addLocal("itOut","i32");let h=g.getCodeBuilder();f?g.addCode(h.setLocal("itIn1",h.i32_add(h.getLocal("pIn1"),h.i32_mul(h.i32_sub(h.getLocal("n"),h.i32_const(1)),h.i32_const(d)))),h.setLocal("itIn2",h.i32_add(h.getLocal("pIn2"),h.i32_mul(h.i32_sub(h.getLocal("n"),h.i32_const(1)),h.i32_const(d)))),h.setLocal("itOut",h.i32_add(h.getLocal("pOut"),h.i32_mul(h.i32_sub(h.getLocal("n"),h.i32_const(1)),h.i32_const(e)))),h.setLocal("i",h.i32_const(0)),h.block(h.loop(h.br_if(1,h.i32_eq(h.getLocal("i"),h.getLocal("n"))),h.call(c,h.getLocal("itIn1"),h.getLocal("itIn2"),h.getLocal("itOut")),h.setLocal("itIn1",h.i32_sub(h.getLocal("itIn1"),h.i32_const(d))),h.setLocal("itIn2",h.i32_sub(h.getLocal("itIn2"),h.i32_const(d))),h.setLocal("itOut",h.i32_sub(h.getLocal("itOut"),h.i32_const(e))),h.setLocal("i",h.i32_add(h.getLocal("i"),h.i32_const(1))),h.br(0)))):g.addCode(h.setLocal("itIn1",h.getLocal("pIn1")),h.setLocal("itIn2",h.getLocal("pIn2")),h.setLocal("itOut",h.getLocal("pOut")),h.setLocal("i",h.i32_const(0)),h.block(h.loop(h.br_if(1,h.i32_eq(h.getLocal("i"),h.getLocal("n"))),h.call(c,h.getLocal("itIn1"),h.getLocal("itIn2"),h.getLocal("itOut")),h.setLocal("itIn1",h.i32_add(h.getLocal("itIn1"),h.i32_const(d))),h.setLocal("itIn2",h.i32_add(h.getLocal("itIn2"),h.i32_const(d))),h.setLocal("itOut",h.i32_add(h.getLocal("itOut"),h.i32_const(e))),h.setLocal("i",h.i32_add(h.getLocal("i"),h.i32_const(1))),h.br(0))))}}};